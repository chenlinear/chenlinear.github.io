{
  "version": "https://jsonfeed.org/version/1",
  "title": "Chen Li",
  "home_page_url": "https://chenlinear.github.io",
  "feed_url": "https://chenlinear.github.iofeed.json",
  "description": "Chen Li's personal blog",
  "favicon": "https://chenlinear.github.io/assets/favicon.ico",
  "expired": false,
  "author": {
    "name": "Chen Li",
    "url": "https://chenlinear.github.io"
  },
  "items": [
    
    

    
    {
      "id": "f7f376af0759b42a759a858ac0aa1af0495c9c59",
      "title": "Presuppositions of Physics Simulations",
      "summary": "",
      "content_text": "I haven\u0026rsquo;t done a simulation project, but these are my presuppositions of simulation. Let\u0026rsquo;s see how they would change over time (haha pun intended).\n§1 Simulation in General We divide space into several grids, but we also have Adaptive Mesh Refinement, see [2312.05438] Adaptive mesh refinement in binary black holes simulations. Also, there are Adaptive step size.\nButterfly Effect: [2401.13381]Spontaneous stochasticity amplifies even thermal noise to the largest scales of turbulence in a few eddy turnover times\nThere are 3 kinds of simulation:\nradiative processes, spectrum. dark matter halos, n-body/test particle, gravity. source population, luminosity distribution, redshift. neutrino in the universe. §2 Language n-body - Which programs are fastest? (Benchmarks Game), like that\u0026rsquo;s even a question.\n§3 Memory Usage In particle n-body simulation, because of the shape of the tensor [num_particles, num_properties] (num_properties refers to $x$, $y$, $z$, $v_x$, $v_y$, $v_z$, spin, etc) does not change, the memory usage is almost const.\nAlso, if we encode time in this tensor, we should put it in the first dimension such that [time_steps, num_particles, num_properties]. Because now if we want to take a picture from the video, we just do x[time_step]. In terms of semetic, this feels natural. In terms of meaning, this shows that, time is just a set of tensors.\n§4 Framework §4.1 Run Only use functional programming, instead of object-oriented programming. Because the latter one is not necessary and the previous one, without state and so on, is faster.\ndef one_step(): ... def save(): ...# save as `.parquet`? for i in range(): one_step()# the next step is determined by the previous step, so GPU is not much useful here save() §4.2 Plot Plot the animation of the simulation, and plot the variation of derived properties such kinetic energy, potential energy and so on:\ndef plot_animation(): .... def plot_kinetic_energy(): ... def plot_potential_energy(): ... ",
      "content_html": "\u003cp\u003eI haven\u0026rsquo;t done a simulation project, but these are my presuppositions of simulation. Let\u0026rsquo;s see how they would change over time (haha pun intended).\u003c/p\u003e\n\u003ch2 id=\"1-simulation-in-general\"\u003e§1 Simulation in General\u003c/h2\u003e\n\u003cp\u003eWe divide space into several grids, but we also have Adaptive Mesh Refinement, see \u003ca href=\"https://arxiv.org/abs/2312.05438\"\u003e[2312.05438] \u003cem\u003eAdaptive mesh refinement in binary black holes simulations\u003c/em\u003e\u003c/a\u003e. Also, there are \u003ca href=\"https://en.wikipedia.org/wiki/Adaptive_step_size\"\u003eAdaptive step size\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eButterfly Effect: \u003ca href=\"https://arxiv.org/abs/2401.13881\"\u003e[2401.13381]\u003cem\u003eSpontaneous stochasticity amplifies even thermal noise to the largest scales of turbulence in a few eddy turnover times\u003c/em\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThere are 3 kinds of simulation:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eradiative processes, spectrum.\u003c/li\u003e\n\u003cli\u003edark matter halos, n-body/test particle, gravity.\u003c/li\u003e\n\u003cli\u003esource population, luminosity distribution, redshift. neutrino in the universe.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"2-language\"\u003e§2 Language\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://benchmarksgame-team.pages.debian.net/benchmarksgame/performance/nbody.html\"\u003en-body - Which programs are fastest? (Benchmarks Game)\u003c/a\u003e, like that\u0026rsquo;s even a question.\u003c/p\u003e\n\u003ch2 id=\"3-memory-usage\"\u003e§3 Memory Usage\u003c/h2\u003e\n\u003cp\u003eIn particle n-body simulation, because of the shape of the tensor \u003ccode\u003e[num_particles, num_properties]\u003c/code\u003e (\u003ccode\u003enum_properties\u003c/code\u003e refers to $x$, $y$, $z$, $v_x$, $v_y$, $v_z$, spin, etc) does not change, the memory usage is almost const.\u003c/p\u003e\n\u003cp\u003eAlso, if we encode time in this tensor, we should put it in the first dimension such that \u003ccode\u003e[time_steps, num_particles, num_properties]\u003c/code\u003e. Because now if we want to take a picture from the video, we just do \u003ccode\u003ex[time_step]\u003c/code\u003e. In terms of semetic, this feels natural. In terms of meaning, this shows that, time is just a set of tensors.\u003c/p\u003e\n\u003c!-- Can we use `torch.nn.Linear` to do the simulation? --\u003e\n\u003ch2 id=\"4-framework\"\u003e§4 Framework\u003c/h2\u003e\n\u003ch3 id=\"41-run\"\u003e§4.1 Run\u003c/h3\u003e\n\u003cp\u003eOnly use \u003ca href=\"https://en.wikipedia.org/wiki/Functional_programming\"\u003efunctional programming\u003c/a\u003e, instead of \u003ca href=\"https://en.wikipedia.org/wiki/Object-oriented_programming\"\u003eobject-oriented programming\u003c/a\u003e. Because the latter one is not necessary and the previous one, without state and so on, is faster.\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edef one_step():\n    ...\n\ndef save():\n    ...# save as `.parquet`?\n\nfor i in range():\n    one_step()# the next step is determined by the previous step, so GPU is not much useful here\n    save()\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"42-plot\"\u003e§4.2 Plot\u003c/h3\u003e\n\u003cp\u003ePlot the animation of the simulation, and plot the variation of derived properties such kinetic energy, potential energy and so on:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edef plot_animation():\n    ....\n\ndef plot_kinetic_energy():\n    ...\n\ndef plot_potential_energy():\n    ...\n\u003c/code\u003e\u003c/pre\u003e",
      "url": "https://chenlinear.github.io/posts/20240901-presupposition-of-physics-simulations/",
      "date_published": "1096-01-09T90:11:00+00:00",
      "date_modified": "1096-01-09T90:11:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "fe7a9b32f9235a0a33c7269aed366c3a2d9aa469",
      "title": "1.58",
      "summary": "",
      "content_text": "Sabine mentioned today that the \u0026ldquo;dimension\u0026rdquo; of fractal is $log{(\\frac{3}{2})} \\approx 1.58$, which reminds me about this LLM quantization method called BitNet with ternary {-1, 0, 1} parameter thus 1.58 bit. I would assume the only connection here is just the number.\n",
      "content_html": "\u003cp\u003e\u003ca href=\"https://www.youtube.com/watch?v=-Xfv5NNPbLs\"\u003eSabine mentioned today\u003c/a\u003e that the \u0026ldquo;dimension\u0026rdquo; of \u003cstrong\u003efractal\u003c/strong\u003e is $log{(\\frac{3}{2})} \\approx 1.58$, which reminds me about this LLM quantization method called \u003ca href=\"https://arxiv.org/abs/2402.17764\"\u003eBitNet\u003c/a\u003e with ternary {-1, 0, 1} parameter thus 1.58 bit. I would assume the only connection here is just the number.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20240710-1-58/",
      "date_published": "10076-10-09T70:1010:00+00:00",
      "date_modified": "10076-10-09T70:1010:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "ec1aac91e880a7236cd7e49344d3a2aa697882ca",
      "title": "Physics Intuition",
      "summary": "",
      "content_text": "I had an argument with a friend the other day. He\u0026rsquo;s quitting physics and will be teaching high school, which in my opinion is more of less a waste of talent.\n§1 Complexity, or Why Most Physics Work is Writing Code Here is our differences: He thinks most people in the physics business are doing something he does not like, which is writing code. For example, in his CP violation paper, what he mostly did is to get familiar with the code base. In his opinion, people should have physics intuition to come up with different theories and test it in experiments. Most of what we beginners do is the latter part, in other words, writing code. But my point is that physics has changed a lot and can not devolve back into the 20th century. The 21st century is about complexity:\nTheories that are complicated, intertwined and conflicted. Time: Experiments take decades now. Money: Newton did not need millions of dollars to buy lenses. With complexity comes with communication, which is inherently inefficient. Computers do so much more than line fitting, which is not achievable by human labor. Compared with this list, writing code does not seem so bad.\nI am sorry nature does not allow analytical solution for crystal lattice so that we use approximations and computer simulations, but there is just no other way.\nPart of me blame the education system for a little bit: in undergrad, physics history in textbooks stops at mid-20th century.\nBTW, in The Three Body Problem, if the Trisolarans write simulation program of their three body solar system, at least they can predict the movement of the solar system in the next decade or so. In the meantime, they can continue to observe the movement of the solar system and modify the CONSTANT of the program for better precision, such as the mass of each sun and their distances between each other. Also, in order to get better precision, they can replace Newtonian dynamics with General Relativity. Thus given their highly-advanced technology (near-light-speed travel and so on), there\u0026rsquo;s no need to leave their solar system and come to our solar system. Yes there\u0026rsquo;s no analytical solution for the three body problem, but simulation is really useful.\nEven though I said decade or so in the last paragraph, I don\u0026rsquo;t know the specific time the program can predict, but I assume they evolved to intelligent beings thus must have a relatively long stable time. Maybe I can do a lot of simulations and take a mean value. And a more analytical method would be finding the saddle point in the system, as Poincaré did. Anyway, we only have one sun in the solar system so I\u0026rsquo;m not interested really.\n§2 I Have Trust Issues (with My Physics Intuition) Throughout our argument, one term he kept using is \u0026ldquo;comprehension\u0026rdquo;. I kept saying I would prefer \u0026ldquo;hypothesis\u0026rdquo;. I think this tells the difference between us. You see, I don\u0026rsquo;t trust my intuition at all. Because at the end of day what we do is guessing, systematically guessing through math yes, but still guessing. I am being so cynical mostly because of my experience, and Immanuel Kant. (BTW, I heard undergraduate philosophy education stops at Descartes, the 17th century.)\nAll physics intuitions are wrong, but some are more wrong. I read this article Physical Intuition vs. “Math” today, and the author wrote so many awesome examples.\nI am so happy to announce: I have trust issues. And I don\u0026rsquo;t need intervention.\n§3 Be Constructive Just some notes for myself:\nWrite code: You\u0026rsquo;re speaking three languages: the physics experiment language, programming language and physics theory language. Beware nobody else is trilingual, not even your professor, especially not your professor. Read papers. Not about the math though, more about ideas and directions. Show up to meetings and listen to people. Put physics models in your brain cache the whole time. ",
      "content_html": "\u003cp\u003eI had an argument with a friend the other day. He\u0026rsquo;s quitting physics and will be teaching high school, which in my opinion is more of less a waste of talent.\u003c/p\u003e\n\u003ch2 id=\"1-complexity-or-why-most-physics-work-is-writing-code\"\u003e§1 Complexity, or Why Most Physics Work is Writing Code\u003c/h2\u003e\n\u003cp\u003eHere is our differences: He thinks most people in the physics business are doing something he does not like, which is writing code. For example, in his CP violation paper, what he mostly did is to get familiar with the code base. In his opinion, people should have physics intuition to come up with different theories and test it in experiments. Most of what we beginners do is the latter part, in other words, writing code. But my point is that physics has changed a lot and can not devolve back into the 20th century. The 21st century is about complexity:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eTheories that are complicated, intertwined and conflicted.\u003c/li\u003e\n\u003cli\u003eTime: Experiments take decades now.\u003c/li\u003e\n\u003cli\u003eMoney: Newton did not need millions of dollars to buy lenses.\u003c/li\u003e\n\u003cli\u003eWith complexity comes with communication, which is inherently inefficient.\u003c/li\u003e\n\u003cli\u003eComputers do so much more than line fitting, which is not achievable by human labor.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCompared with this list, writing code does not seem so bad.\u003c/p\u003e\n\u003cp\u003eI am sorry nature does not allow analytical solution for crystal lattice so that we use approximations and computer simulations, but there is just no other way.\u003c/p\u003e\n\u003cp\u003ePart of me blame the education system for a little bit: in undergrad, physics history in textbooks stops at mid-20th century.\u003c/p\u003e\n\u003cp\u003eBTW, in \u003cem\u003eThe Three Body Problem\u003c/em\u003e, if the Trisolarans write simulation program of their three body solar system, at least they can predict the movement of the solar system in the next decade or so. In the meantime, they can continue to observe the movement of the solar system and modify the \u003ccode\u003eCONSTANT\u003c/code\u003e of the program for better precision, such as the mass of each sun and their distances between each other. Also, in order to get better precision, they can replace Newtonian dynamics with General Relativity. Thus given their highly-advanced technology (near-light-speed travel and so on), there\u0026rsquo;s no need to leave their solar system and come to our solar system. Yes there\u0026rsquo;s no analytical solution for the three body problem, but simulation is really useful.\u003c/p\u003e\n\u003cp\u003eEven though I said decade or so in the last paragraph, I don\u0026rsquo;t know the specific time the program can predict, but I assume they evolved to intelligent beings thus must have a relatively long stable time. Maybe I can do a lot of simulations and take a mean value. And a more analytical method would be finding the \u003ca href=\"https://en.wikipedia.org/wiki/Saddle_point\"\u003esaddle point\u003c/a\u003e in the system, as Poincaré did. Anyway, we only have one sun in the solar system so I\u0026rsquo;m not interested really.\u003c/p\u003e\n\u003ch2 id=\"2-i-have-trust-issues-with-my-physics-intuition\"\u003e§2 I Have Trust Issues (with My Physics Intuition)\u003c/h2\u003e\n\u003cp\u003eThroughout our argument, one term he kept using is \u0026ldquo;comprehension\u0026rdquo;. I kept saying I would prefer \u0026ldquo;hypothesis\u0026rdquo;. I think this tells the difference between us. You see, I don\u0026rsquo;t trust my intuition at all. Because at the end of day what we do is guessing, systematically guessing through math yes, but still guessing. I am being so cynical mostly because of my experience, and Immanuel Kant. (BTW, I heard undergraduate philosophy education stops at Descartes, the 17th century.)\u003c/p\u003e\n\u003cp\u003eAll physics intuitions are wrong, but some are more wrong. I read this article \u003ca href=\"https://www.math.columbia.edu/~woit/wordpress/?p=14013\"\u003e\u003cem\u003ePhysical Intuition vs. “Math”\u003c/em\u003e\u003c/a\u003e today, and the author wrote so many awesome examples.\u003c/p\u003e\n\u003c!-- All models are wrong, but some are useful. -- George E. P. Box --\u003e\n\u003cp\u003eI am so happy to announce: I have trust issues. And I don\u0026rsquo;t need intervention.\u003c/p\u003e\n\u003ch2 id=\"3-be-constructive\"\u003e§3 Be Constructive\u003c/h2\u003e\n\u003cp\u003eJust some notes for myself:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWrite code: You\u0026rsquo;re speaking three languages: the physics experiment language, programming language and physics theory language. Beware nobody else is trilingual, not even your professor, especially not your professor.\u003c/li\u003e\n\u003cli\u003eRead papers. Not about the math though, more about ideas and directions.\u003c/li\u003e\n\u003cli\u003eShow up to meetings and listen to people.\u003c/li\u003e\n\u003cli\u003ePut physics models in your brain cache the whole time.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- Marshall: If I died under suspicious circumstances then beware. Trust no one, not even Ted. Especially not Ted. -- HIMYM S03E02 --\u003e",
      "url": "https://chenlinear.github.io/posts/20240630-physics-intuition/",
      "date_published": "30066-30-09T60:3030:00+00:00",
      "date_modified": "30066-30-09T60:3030:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "d629bf5af6781d5f1af574666c18e49eb9a36956",
      "title": "Trains",
      "summary": "",
      "content_text": "Trains are dragons from The Legend of Zelda: Breath of the Wild:\nThey are huge. They appear and disappear. They are fast and slow at the same time. ",
      "content_html": "\u003cp\u003eTrains are dragons from \u003cem\u003eThe Legend of Zelda: Breath of the Wild\u003c/em\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThey are huge.\u003c/li\u003e\n\u003cli\u003eThey appear and disappear.\u003c/li\u003e\n\u003cli\u003eThey are fast and slow at the same time.\u003c/li\u003e\n\u003c/ul\u003e\n",
      "url": "https://chenlinear.github.io/posts/20240613-trains/",
      "date_published": "13066-13-09T60:1313:00+00:00",
      "date_modified": "13066-13-09T60:1313:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "3d9a41c95a555a482123aea40930c6149dc74d0b",
      "title": "Local Minimum",
      "summary": "",
      "content_text": "Finding a university for PhD and finding an apartment are both about finding the local minimum, which is that one university/apartment that could work. On the contrary, OpenAI is having an obvious bottleneck right now with the recently released not-so-good product and employees\u0026rsquo; leaving. But I assume their struggle is much more fun, because they are finding the global minimum.\nWhen stuck in a local minimum in Machine Learning, the thing to do is to increase the learning rate and get pass it. Well, obviously this does not work in real life, so let\u0026rsquo;s talk about the practical strategy here:\nTo find a university for PhD, what you do is to read a lot of papers, find your topic and send applications. This is career-deterministic, so actually this is about finding the global minimum. To find an apartment, what you do is to browse a lot of (terribly designed, outdated, probably written in React) websites, send applications and have a lot of virtual showings with shaky cameras. Training neural network (my brain) on this type of data is a more or less waste of time. ",
      "content_html": "\u003cp\u003eFinding a university for PhD and finding an apartment are both about finding the local minimum, which is that one university/apartment that could work. On the contrary, OpenAI is having an obvious bottleneck right now with the recently released not-so-good product and employees\u0026rsquo; leaving. But I assume their struggle is much more fun, because they are finding the global minimum.\u003c/p\u003e\n\u003cp\u003eWhen stuck in a local minimum in Machine Learning, the thing to do is to increase the learning rate and get pass it. Well, obviously this does not work in real life, so let\u0026rsquo;s talk about the practical strategy here:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eTo find a university for PhD, what you do is to read a lot of papers, find your topic and send applications. This is career-deterministic, so actually this is about finding the global minimum.\u003c/li\u003e\n\u003cli\u003eTo find an apartment, what you do is to browse a lot of (terribly designed, outdated, probably written in React) websites, send applications and have a lot of virtual showings with shaky cameras. Training neural network (my brain) on this type of data is a more or less waste of time.\u003c/li\u003e\n\u003c/ul\u003e\n",
      "url": "https://chenlinear.github.io/posts/20240519-local-minimum/",
      "date_published": "19056-19-09T50:1919:00+00:00",
      "date_modified": "19056-19-09T50:1919:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "643e3fb2e7cb910cba0b8a60841872538b82c115",
      "title": "Holocene",
      "summary": "",
      "content_text": "Replika is an AI girlfriend released in November 2017. One really bizarre thing is that it will recommend \u0026ldquo;Holocene\u0026rdquo; to everyone, similar to how chatGPT recommend \u0026ldquo;delve\u0026rdquo; to everyone. For both of these situations, the bias of the dataset have demonstrated its power over and over again. This is a comment in the comment section of Bon Iver - Holocene:\nOur replikas: Listen to this song\nMe: Ok\nEverybody here: OUR REPLIKAS GATHERED US HERE\nI brough up the example of Replika to let you know that the practice of AI waifu has been around for quite a while, even back in the AI Holocene of 2017, the year Transformer architecture is presented. gpt-4o (May 2024) is so Scarlett Johansson I can\u0026rsquo;t believe what is it trained on. Starting from the release of GPT-4, it has been 14 month. After 14 month, open source models have basically tied up with GPT-4, the most shing example is Llama 3, with only 70B parameters, smaller than GPT-3 with 170B parameters, and definitely smaller than GPT-4 with 1.8T parameters. I would say OpenAI has only made bad business decisions ever since the release of GPT-4: prompt store, Sora, and now Scarlett Johannsson. And people are leaving: Karpathy quitted on February; now Ilya and Jan also quitted.\nI, a person who did not study ancient history of our planet, find the name \u0026ldquo;Holocene\u0026rdquo; beautiful, and suitable for the state of AI today.\n",
      "content_html": "\u003cp\u003e\u003ca href=\"https://replika.ai/\"\u003eReplika\u003c/a\u003e is an AI girlfriend released in November 2017. One really bizarre thing is that it will recommend \u0026ldquo;Holocene\u0026rdquo; to everyone, similar to how chatGPT recommend \u0026ldquo;delve\u0026rdquo; to everyone. For both of these situations, the bias of the dataset have demonstrated its power over and over again. This is a comment in the comment section of \u003ca href=\"https://www.youtube.com/watch?v=TWcyIpul8OE\"\u003eBon Iver - \u003cem\u003eHolocene\u003c/em\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eOur replikas: Listen to this song\u003cbr\u003e\nMe: Ok\u003cbr\u003e\nEverybody here: OUR REPLIKAS GATHERED US HERE\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eI brough up the example of Replika to let you know that the practice of AI waifu has been around for quite a while, even back in the AI Holocene of 2017, the year Transformer architecture is presented. gpt-4o (May 2024) is so Scarlett Johansson I can\u0026rsquo;t believe what is it trained on. Starting from the release of GPT-4, it has been 14 month. After 14 month, open source models have basically tied up with GPT-4, the most shing example is \u003ca href=\"https://github.com/meta-llama/llama3\"\u003eLlama 3\u003c/a\u003e, with only 70B parameters, smaller than GPT-3 with 170B parameters, and definitely smaller than \u003ca href=\"https://www.youtube.com/watch?v=Y2F8yisiS6E\"\u003eGPT-4 with 1.8T parameters\u003c/a\u003e. I would say OpenAI has only made bad business decisions ever since the release of GPT-4: prompt store, Sora, and now Scarlett Johannsson. And people are leaving: \u003ca href=\"https://twitter.com/karpathy/status/1757600075281547344\"\u003eKarpathy\u003c/a\u003e quitted on February; now \u003ca href=\"https://twitter.com/ilyasut/status/1790517455628198322\"\u003eIlya\u003c/a\u003e and \u003ca href=\"https://twitter.com/janleike/status/1790603862132596961\"\u003eJan\u003c/a\u003e also quitted.\u003c/p\u003e\n\u003cp\u003eI, a person who did not study ancient history of our planet, find the name \u0026ldquo;Holocene\u0026rdquo; beautiful, and suitable for the state of AI today.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20240515-holocene/",
      "date_published": "15056-15-09T50:1515:00+00:00",
      "date_modified": "15056-15-09T50:1515:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "a657afec4f2bc7852329f51425fe9d6d41e7e263",
      "title": "Room Temperature Superconductor, Again",
      "summary": "",
      "content_text": "[2401.00999] Possible Meissner effect near room temperature in copper-substituted lead apatite\nI envy the \u0026ldquo;00999\u0026rdquo; number by the way.\n",
      "content_html": "\u003cp\u003e\u003ca href=\"https://arxiv.org/abs/2401.00999\"\u003e[2401.00999] \u003cem\u003ePossible Meissner effect near room temperature in copper-substituted lead apatite\u003c/em\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eI envy the \u0026ldquo;00999\u0026rdquo; number by the way.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20240102-room-temperature-superconductor-again/",
      "date_published": "2016-02-09T10:22:00+00:00",
      "date_modified": "2016-02-09T10:22:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "f6edcbbb7dc354a1a0971be1f737aedc563559bc",
      "title": "arXiv in HTML",
      "summary": "",
      "content_text": "arXiv now offers papers in HTML format. So basically ar5iv is now native and applied to the latest papers.\nHTML: Better \u0026amp; Worse Here are several reasons why HTML is better:\nYou can just save the link, instead of downloading pdf.\nIn Markdown, you can directly link the pictures in a paper. For example:\n![](https://browse.arxiv.org/html/2308.13285v4/x1.png) You can use immersive-translate.\nHere are several reasons why HTML is worse:\nDependency errors with $\\LaTeX$. But you can avoid it by not using rare $\\LaTeX$ packages.\nPDFs give you sense of feeling of where the certain stuff is. For example, \u0026ldquo;the concept of A is in the lower left of page 3\u0026rdquo;. But you can avoid it by taking notes with Markdown.\nMission Accomplished ar5iv states that\nGoal: incremental improvement until worthy of native arXiv adoption. I\u0026rsquo;m really glad this goal is kind of accomplished.\n",
      "content_html": "\u003cp\u003e\u003ca href=\"https://blog.arxiv.org/2023/12/21/accessibility-update-arxiv-now-offers-papers-in-html-format/\"\u003earXiv now offers papers in HTML format\u003c/a\u003e. So basically \u003ca href=\"https://chenlinear.github.io/posts/20230318-ar5iv/\"\u003ear5iv\u003c/a\u003e is now native and applied to the latest papers.\u003c/p\u003e\n\u003ch2 id=\"html-better--worse\"\u003eHTML: Better \u0026amp; Worse\u003c/h2\u003e\n\u003cp\u003eHere are several reasons why HTML is better:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eYou can just save the link, instead of downloading pdf.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIn Markdown, you can directly link the pictures in a paper. For example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e![](https://browse.arxiv.org/html/2308.13285v4/x1.png)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg\r\n  src=\"https://browse.arxiv.org/html/2308.13285v4/x1.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eYou can use \u003ca href=\"https://chenlinear.github.io/posts/20230602-immersive-translate/\"\u003e\u003ccode\u003eimmersive-translate\u003c/code\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eHere are several reasons why HTML is worse:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eDependency errors with $\\LaTeX$. But you can avoid it by not using rare $\\LaTeX$ packages.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ePDFs give you sense of feeling of where the certain stuff is. For example, \u0026ldquo;the concept of A is in the lower left of page 3\u0026rdquo;. But you can avoid it by taking notes with Markdown.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"mission-accomplished\"\u003eMission Accomplished\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://ar5iv.labs.arxiv.org/\"\u003ear5iv\u003c/a\u003e states that\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eGoal\u003c/strong\u003e: incremental improvement until worthy of native arXiv adoption.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eI\u0026rsquo;m really glad this goal is kind of accomplished.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20231221-arxiv-in-html/",
      "date_published": "21126-21-09T120:2121:00+00:00",
      "date_modified": "21126-21-09T120:2121:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "b700bf38d69d2fdebd589e15908d469f180936c6",
      "title": "Minecraft \u0026 Programming",
      "summary": "",
      "content_text": "These are probably trivial but important experiences to me:\nGo on mcbbs (a website taken down forever now) for mods, modpacks, texture packs, saves and skins is simular to go on GitHub. Update for Minecraft versions is simular to update for Python versions. In Minecraft, 1.8 -\u0026gt; 1.9 is painful. In Python, 2.x -\u0026gt; 3.x is painful. In Minecraft, 64 is the number in a set of items. In PyTorch, we also use $2^n$. Redstone, however, is just a terrible way of programming. Whenever I do redstone, I just want to go do programming instead. ",
      "content_html": "\u003cp\u003eThese are probably trivial but important experiences to me:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eGo on mcbbs (a website taken down forever now) for mods, modpacks, texture packs, saves and skins is simular to go on GitHub.\u003c/li\u003e\n\u003cli\u003eUpdate for Minecraft versions is simular to update for Python versions. In Minecraft, 1.8 -\u0026gt; 1.9 is painful. In Python, 2.x -\u0026gt; 3.x is painful.\u003c/li\u003e\n\u003cli\u003eIn Minecraft, 64 is the number in a set of items. In PyTorch, we also use $2^n$.\u003c/li\u003e\n\u003cli\u003eRedstone, however, is just a terrible way of programming. Whenever I do redstone, I just want to go do programming instead.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!--\n- [【图片】直播，MC 1.3 原版生存【minecraft吧】_百度贴吧 (baidu.com)](https://tieba.baidu.com/p/1766018024)\n- [经典视频回顾 一起玩Meowcraft 第一季 - ztcjohn_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1Cx411e7Aq)\n- [【뷁Maxkim뷁】一起玩Minecraft第一季【Meowcraft】_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1Es411f7mn)\n- [【Minecraft】Mod教程--Railcraft(铁路) Part 1_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1as411S7qA)\n- [Minecraft Mod 介绍 - 建筑模组 BC7 BuildCraft 7 #1-A 基础工具_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1Ms411S7CD)\n--\u003e\n",
      "url": "https://chenlinear.github.io/posts/20231220-minecraft-programming/",
      "date_published": "20126-20-09T120:2020:00+00:00",
      "date_modified": "20126-20-09T120:2020:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "d80232fb5e97c3424c92aa22259b47e36cf24f9d",
      "title": "Machine Learning Notes: Maximum Likelihood, Cross Entropy",
      "summary": "",
      "content_text": "Maximum Likelihood Estimation: We have a model with parameters $\\theta$ and a collection of data examples $X$, the probability of all the examples is the product of each probability:$$L(\\theta)=\\prod_{i=1}^{n} P_i(\\theta; X_i) \\tag{1}$$Then we choose the best parameters $\\theta$ to maximize $L$.\n§1 Examples §1.1 Coin Flip Consider flipping an unfair coin: In 10 flips $X$, there are 7 heads and 3 tails. Say the probability of head for a single flip is $\\theta$, then the probability that this 10 flips happen in this way is $$L(\\theta)=\\theta^7 (1-\\theta)^3 \\tag{2}$$. By doing differentials or drawing this function we can see that, when $\\theta=0.7$ this function has the biggest value $0.0022235661$.\nimport numpy as np import matplotlib.pyplot as plt def likelihood_coin_flip(x): return x**7 * (1 - x)**3 x = np.arange(0, 1, 0.01) y = likelihood_coin_flip(x) plt.plot(x, y) plt.scatter([0.7], [likelihood_coin_flip(0.7)]) plt.xlabel(\u0026#39;x\u0026#39;) plt.ylabel(\u0026#39;y\u0026#39;) plt.show() will get:\n§1.2 Line Fitting For each data point on $\\vec{y}=a\\vec{x}+b$ we can write $$y_i=ax_i+b+\\epsilon_i \\tag{3}$$, where $\\epsilon_i$ is the error for each data point. We assume error $\\epsilon_i$ follows normal distribution with mean value $\\mu=0$ and variance $\\sigma$:$$P(\\epsilon_i)=\\frac{1}{\\sqrt{2\\pi\\sigma^2}}e^{-\\frac{\\epsilon_i^2}{2\\sigma^2}} \\tag{4}$$. Put Eq.3 in Eq.4 we will get:$$P(\\epsilon_i)=\\frac{1}{\\sqrt{2\\pi\\sigma^2}}e^{-\\frac{(y_i-ax_i-b)^2}{2\\sigma^2}} \\tag{5}$$ So likelihood is $$\\begin{aligned} L(a, b)\u0026amp;=\\prod_{i=1}^{n}\\frac{1}{\\sqrt{2\\pi\\sigma^2}}e^{-\\frac{(y_i-ax_i-b)^2}{2\\sigma^2}} \\\\ \u0026amp;=\\frac{1}{\\sqrt{2\\pi\\sigma^2}}e^{-\\frac{\\sum_{i=1}^N (y_i-(ax_i+b))^2}{2\\sigma^2}} \\end{aligned} \\tag{6}$$\nTo maximize likelihood is equivalent to minimize Mean Squared Error (nn.MSELoss) $$\\text{MSE}(a,b)=\\sum_{i=1}^N (y_i-(ax_i+b))^2 \\tag{7}$$\nimport numpy as np import matplotlib.pyplot as plt # https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html from scipy.optimize import minimize x = np.array([1, 2, 3, 4, 5]) y = np.array([1, 4, 5, 8, 9]) def loss_function(params): (a, b) = params y_fit = a * x + b loss = np.sum((y - y_fit)**2) return loss result = minimize(fun=loss_function, x0=(0, 0)) (a_fit, b_fit) = result.x loss = result.fun plt.title(f\u0026#39;loss={loss:.2f}\u0026#39;) plt.scatter(x, y, label=\u0026#39;data points\u0026#39;) plt.plot(x, a_fit * x + b_fit, \u0026#39;r\u0026#39;, label=\u0026#39;fitted line: \u0026#39;+f\u0026#39;y = {a_fit:.2f}x + {b_fit:.2f}\u0026#39;) plt.xlabel(\u0026#39;x\u0026#39;) plt.ylabel(\u0026#39;y\u0026#39;) plt.legend() plt.show() will get:\n§2 Negative Log-Likelihood Negative Log-Likelihood is defined as$$\\text{NLL}(\\theta) = - \\log{L(\\theta)} \\tag{8}$$\nThe purpose of $\\log$ is to fit the likelihood into float32, while maximizing the likelihood is the same thing as maximizing the log-likelihood ($f(x)=\\log x$ is an increasing function of $x$). Minimizing loss is more common in Machine Learning, while minimizing the loss is the same thing as maximizing the negative log-likelihood. §3 Cross Entropy Consider a binary classification: There are $n$ data examples. $1$ and $0$ are the positive and negative class label $y_i$. $p_i$ is the probability that the $i$ example is predicted to be positive. For each data example, if the true label is positive, the probability of correct prediction is $p_i$, or $p_i^{y_i}$; if the true label is negative, the probability of correct prediction is $(1-p_i)$, or $(1-p_i)^{1-y_i}$. We can summarize the probability of correct prediction as $p_i^{y_i} (1-p_i)^{1-y_i}$. Thus, similar to Eq.2 for coin flip, we can write likelihood as $$L(\\theta)=\\prod_{i=1}^{n} p_i^{y_i} (1-p_i)^{1-y_i} \\tag{9}$$. Put Eq.9 in Eq.8 we will get negative log-likelihood for binary classification: $$\\begin{aligned} \\text{NLL}(\\theta) \u0026amp;=-\\log{\\prod_{i=1}^{n} p_i^{y_i} (1-p_i)^{1-y_i}} \\\\ \u0026amp;= - \\sum_{i=1}^n (y_i \\log p_i + (1 - y_i) \\log (1 - p_i)) \\end{aligned} \\tag{10}$$, which is also called Cross Entropy for binary classification, or Binary Cross Entropy.\nCross Entropy for multi-class classification is generalization of binary cross entropy: $$\\text{CE}(y,p) = -\\sum_{i=1}^n y_i \\log{p_i} \\tag{11}$$, where $y_i=1$ for positive class and $y_i=0$ for other negative classes, and $p_i$ is the predicted distribution.\nThe reason nn.CrossEntropyLoss put the probability firstly in nn.LogSoftmax is to normalize the probability so that every probability is positive and the sum of probability is $1$.\n",
      "content_html": "\u003cp\u003e\u003cem\u003eMaximum Likelihood Estimation\u003c/em\u003e: We have a model with parameters $\\theta$ and a collection of data examples $X$, the probability of all the examples is the product of each probability:$$L(\\theta)=\\prod_{i=1}^{n} P_i(\\theta; X_i) \\tag{1}$$Then we choose the best parameters $\\theta$ to maximize $L$.\u003c/p\u003e\n\u003ch2 id=\"1-examples\"\u003e§1 Examples\u003c/h2\u003e\n\u003ch3 id=\"11-coin-flip\"\u003e§1.1 Coin Flip\u003c/h3\u003e\n\u003cp\u003eConsider flipping an unfair coin: In 10 flips $X$, there are 7 heads and 3 tails. Say the probability of head for a single flip is $\\theta$, then the probability that this 10 flips happen in this way is $$L(\\theta)=\\theta^7 (1-\\theta)^3 \\tag{2}$$. By doing differentials or drawing this function we can see that, when $\\theta=0.7$ this function has the biggest value $0.0022235661$.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enumpy\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ematplotlib.pyplot\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003elikelihood_coin_flip\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003earange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0.01\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elikelihood_coin_flip\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eplot\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003escatter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.7\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elikelihood_coin_flip\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.7\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003exlabel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;x\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eylabel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;y\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshow\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"20231219-machine-learning-notes-maximum-likelihood-cross-entropy-coin-flip.png\"\r\n  alt=\"coin-flip\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ch3 id=\"12-line-fitting\"\u003e§1.2 Line Fitting\u003c/h3\u003e\n\u003cp\u003eFor each data point on $\\vec{y}=a\\vec{x}+b$ we can write $$y_i=ax_i+b+\\epsilon_i \\tag{3}$$, where $\\epsilon_i$ is the error for each data point. We assume error $\\epsilon_i$ follows normal distribution with mean value $\\mu=0$ and variance $\\sigma$:$$P(\\epsilon_i)=\\frac{1}{\\sqrt{2\\pi\\sigma^2}}e^{-\\frac{\\epsilon_i^2}{2\\sigma^2}} \\tag{4}$$. Put Eq.3 in Eq.4 we will get:$$P(\\epsilon_i)=\\frac{1}{\\sqrt{2\\pi\\sigma^2}}e^{-\\frac{(y_i-ax_i-b)^2}{2\\sigma^2}} \\tag{5}$$ So likelihood is $$\\begin{aligned} L(a, b)\u0026amp;=\\prod_{i=1}^{n}\\frac{1}{\\sqrt{2\\pi\\sigma^2}}e^{-\\frac{(y_i-ax_i-b)^2}{2\\sigma^2}} \\\\ \u0026amp;=\\frac{1}{\\sqrt{2\\pi\\sigma^2}}e^{-\\frac{\\sum_{i=1}^N (y_i-(ax_i+b))^2}{2\\sigma^2}} \\end{aligned} \\tag{6}$$\u003c/p\u003e\n\u003cp\u003eTo maximize likelihood is equivalent to minimize \u003cem\u003eMean Squared Error\u003c/em\u003e (\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.MSELoss.html\"\u003e\u003ccode\u003enn.MSELoss\u003c/code\u003e\u003c/a\u003e) $$\\text{MSE}(a,b)=\\sum_{i=1}^N (y_i-(ax_i+b))^2 \\tag{7}$$\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enumpy\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ematplotlib.pyplot\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003escipy.optimize\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eminimize\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003earray\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003earray\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e9\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eloss_function\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eparams\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eparams\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ey_fit\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esum\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey_fit\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eresult\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eminimize\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efun\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eloss_function\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex0\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ea_fit\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb_fit\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresult\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresult\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efun\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etitle\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;loss=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e.2f\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003escatter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elabel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;data points\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eplot\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ea_fit\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb_fit\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;r\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elabel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;fitted line: \u0026#39;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;y = \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ea_fit\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e.2f\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ex + \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eb_fit\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e.2f\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003exlabel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;x\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eylabel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;y\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elegend\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshow\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"20231219-machine-learning-notes-maximum-likelihood-cross-entropy-line-fitting.png\"\r\n  alt=\"line-fitting\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ch2 id=\"2-negative-log-likelihood\"\u003e§2 Negative Log-Likelihood\u003c/h2\u003e\n\u003cp\u003e\u003cem\u003eNegative Log-Likelihood\u003c/em\u003e is defined as$$\\text{NLL}(\\theta) = - \\log{L(\\theta)} \\tag{8}$$\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe purpose of $\\log$ is to fit the likelihood into \u003ccode\u003efloat32\u003c/code\u003e, while maximizing the likelihood is the same thing as maximizing the log-likelihood ($f(x)=\\log x$ is an increasing function of $x$).\u003c/li\u003e\n\u003cli\u003eMinimizing loss is more common in Machine Learning, while minimizing the loss is the same thing as maximizing the negative log-likelihood.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"3-cross-entropy\"\u003e§3 Cross Entropy\u003c/h2\u003e\n\u003cp\u003eConsider a binary classification: There are $n$ data examples. $1$ and $0$ are the positive and negative class label $y_i$. $p_i$ is the probability that the $i$ example is predicted to be positive. For each data example, if the true label is positive, the probability of correct prediction is $p_i$, or $p_i^{y_i}$; if the true label is negative, the probability of correct prediction is $(1-p_i)$, or $(1-p_i)^{1-y_i}$. We can summarize the probability of correct prediction as $p_i^{y_i} (1-p_i)^{1-y_i}$. Thus, similar to Eq.2 for coin flip, we can write likelihood as $$L(\\theta)=\\prod_{i=1}^{n} p_i^{y_i} (1-p_i)^{1-y_i} \\tag{9}$$. Put Eq.9 in Eq.8 we will get negative log-likelihood for binary classification: $$\\begin{aligned} \\text{NLL}(\\theta) \u0026amp;=-\\log{\\prod_{i=1}^{n} p_i^{y_i} (1-p_i)^{1-y_i}} \\\\ \u0026amp;= - \\sum_{i=1}^n (y_i \\log p_i + (1 - y_i) \\log (1 - p_i)) \\end{aligned} \\tag{10}$$, which is also called \u003cem\u003eCross Entropy\u003c/em\u003e for binary classification, or \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.BCELoss.html\"\u003e\u003cem\u003eBinary Cross Entropy\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eCross Entropy\u003c/em\u003e for multi-class classification is generalization of binary cross entropy: $$\\text{CE}(y,p) = -\\sum_{i=1}^n y_i \\log{p_i} \\tag{11}$$, where $y_i=1$ for positive class and $y_i=0$ for other negative classes, and $p_i$ is the predicted distribution.\u003c/p\u003e\n\u003cp\u003eThe reason \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html#torch.nn.CrossEntropyLoss\"\u003e\u003ccode\u003enn.CrossEntropyLoss\u003c/code\u003e\u003c/a\u003e put the probability firstly in \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.LogSoftmax.html#torch.nn.LogSoftmax\"\u003e\u003ccode\u003enn.LogSoftmax\u003c/code\u003e\u003c/a\u003e is to normalize the probability so that every probability is positive and the sum of probability is $1$.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20231219-machine-learning-notes-maximum-likelihood-cross-entropy/",
      "date_published": "19126-19-09T120:1919:00+00:00",
      "date_modified": "19126-19-09T120:1919:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "b2e9aba8ae29605b23d4e6c6ee4beb8f2b950438",
      "title": "Machine Learning Notes: einops",
      "summary": "",
      "content_text": "Frankly speaking, when I saw Einstein notation in Classical Mechanics, I\u0026rsquo;m not used to it, especially when it\u0026rsquo;s not explicitly said in the context that Einstein notation is used here. I just feel like we can save the trouble by writing more $\\sum$.\nAnyway, einops do the following things right:\nNotation: output_tensor = rearrange(input_tensor, 't b c -\u0026gt; b c t') API: provide package-specific APIs, e.g. torch, tensorflow, jax. There are more and more similar packages:\neinop einx einshape ",
      "content_html": "\u003cp\u003eFrankly speaking, when I saw Einstein notation in Classical Mechanics, I\u0026rsquo;m not used to it, especially when it\u0026rsquo;s not explicitly said in the context that Einstein notation is used here. I just feel like we can save the trouble by writing more $\\sum$.\u003c/p\u003e\n\u003cp\u003eAnyway, \u003ca href=\"https://github.com/arogozhnikov/einops/\"\u003e\u003ccode\u003eeinops\u003c/code\u003e\u003c/a\u003e do the following things right:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eNotation: \u003ccode\u003eoutput_tensor = rearrange(input_tensor, 't b c -\u0026gt; b c t')\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eAPI: provide package-specific APIs, e.g. \u003ccode\u003etorch\u003c/code\u003e, \u003ccode\u003etensorflow\u003c/code\u003e, \u003ccode\u003ejax\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThere are more and more similar packages:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/cgarciae/einop\"\u003e\u003ccode\u003eeinop\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/fferflo/einx\"\u003e\u003ccode\u003eeinx\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/google-deepmind/einshape/\"\u003e\u003ccode\u003eeinshape\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n",
      "url": "https://chenlinear.github.io/posts/20231218-machine-learning-notes-einops/",
      "date_published": "18126-18-09T120:1818:00+00:00",
      "date_modified": "18126-18-09T120:1818:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "bf6f9cbb69a98ea6b6cef3444d90e6a00fea8aa7",
      "title": "Machine Learning Notes: RNN, LSTM, GRU, RWKV",
      "summary": "",
      "content_text": "\u0026ldquo;Recurrent\u0026rdquo; means that, hidden state $h_t$ is a function of the current input $x_t$ and the last hidden state $h_{t-1}$:$$h_t=f(x_t, h_{t-1}; \\theta)$$where $\\theta$ is all the trainable parameters. We iterate over each word (sub-word) in the entire sequence.\n§1 RNN nn.RNNCell, nn.RNN\nRNN (or vanilla RNN) is composed of 2 Linear layers and an activation function: $$h_t = \\tanh(x_t W_{ih}^T + b_{ih} + h_{t-1}W_{hh}^T + b_{hh})$$\nNote that in the figure below each square represents the same parameters.\nRNNScratch\nclass RNNScratch(nn.Module): def __init__(self, input_size, hidden_size, nonlinearity=\u0026#39;tanh\u0026#39;, bias=True): super().__init__() self.w_ih = nn.Linear(input_size, hidden_size, bias=bias) self.w_hh = nn.Linear(hidden_size, hidden_size, bias=bias) if nonlinearity == \u0026#39;tanh\u0026#39;: self.act = nn.Tanh() elif nonlinearity == \u0026#39;relu\u0026#39;: self.act = nn.ReLU() def forward(self, input, h0): output = torch.Tensor([]) hn = h0 # Iterate over the sequence of input for x in input: # print(\u0026#39;x shape:\u0026#39;, x.shape)# [batch_size, input_size] hn = self.act(self.w_ih(x) + self.w_hh(hn)) # print(\u0026#39;hn shape:\u0026#39;, hn.shape)# [D * num_layers, batch_size, hidden_size] output = torch.cat((output, hn), dim=0) # print(\u0026#39;output shape:\u0026#39;, output.shape)# [seq_length, batch_size, D * hidden_size] # return, same as `torch.nn.RNN` return output, hn testing\nrnn_scratch = RNNScratch(input_size=10, hidden_size=20) input = torch.randn(5, 16, 10)# [seq_length, batch_size, input_size] h0 = torch.zeros(1, 16, 20)# [D * num_layers, batch_size, hidden_size] output, hn = rnn_scratch(input, h0) print(\u0026#39;------\u0026#39;) print(\u0026#39;output shape:\u0026#39;, output.shape)# [seq_length, batch_size, D * hidden_size] print(\u0026#39;hn shape:\u0026#39;, hn.shape)# same as h0 print(torch.all(output[4:5]==hn))# y_{t-1} == h_t will get:\nx shape: torch.Size([16, 10]) hn shape: torch.Size([1, 16, 20]) output shape: torch.Size([1, 16, 20]) x shape: torch.Size([16, 10]) hn shape: torch.Size([1, 16, 20]) output shape: torch.Size([2, 16, 20]) x shape: torch.Size([16, 10]) hn shape: torch.Size([1, 16, 20]) output shape: torch.Size([3, 16, 20]) x shape: torch.Size([16, 10]) hn shape: torch.Size([1, 16, 20]) output shape: torch.Size([4, 16, 20]) x shape: torch.Size([16, 10]) hn shape: torch.Size([1, 16, 20]) output shape: torch.Size([5, 16, 20]) ------ output shape: torch.Size([5, 16, 20]) hn shape: torch.Size([1, 16, 20]) tensor(True) nn.RNN\nrnn = nn.RNN(input_size=10, hidden_size=20) input = torch.randn(5, 16, 10)# [seq_length, batch_size, input_size] h0 = torch.zeros(1, 16, 20)# [D * num_layers, batch_size, hidden_size] output, hn = rnn(input, h0) print(output.shape)# [seq_length, batch_size, D * hidden_size] print(hn.shape)# same as h0 print(torch.all(output[4:5]==hn))# y_{t-1} == h_t will get:\ntorch.Size([5, 16, 20]) torch.Size([1, 16, 20]) tensor(True) §1.1 num_layers RNNDeep\nclass RNNDeep(nn.Module): def __init__(self, input_size, hidden_size, nonlinearity=\u0026#39;tanh\u0026#39;, bias=True, num_layers=1): super().__init__() self.num_layers = num_layers self.rnns = nn.ModuleList([ RNNScratch( input_size if i==0 else hidden_size, hidden_size, nonlinearity, bias ) for i in range(num_layers) ]) def forward(self, input, h0): output = input hn = h0 # Iterate over rnns for i in range(self.num_layers): # print(hn[i:i+1].shape)# [1, batch_size, hidden_size] output, hn[i:i+1] = self.rnns[i](output, hn[i:i+1]) # return, same as `torch.nn.RNN` return output, hn testing\nrnn_deep = RNNDeep(input_size=10, hidden_size=20, num_layers=3) input = torch.randn(5, 16, 10)# [seq_length, batch_size, input_size] h0 = torch.zeros(3, 16, 20)# [D * num_layers, batch_size, hidden_size] output, hn = rnn_deep(input, h0) print(output.shape)# [seq_length, batch_size, D * hidden_size] print(hn.shape)# same as h0 will get:\ntorch.Size([5, 16, 20]) torch.Size([3, 16, 20]) nn.RNN\nrnn = nn.RNN(input_size=10, hidden_size=20, num_layers=3) input = torch.randn(5, 16, 10)# [seq_length, batch_size, input_size] h0 = torch.zeros(3, 16, 20)# [D * num_layers, batch_size, hidden_size] output, hn = rnn(input, h0) print(output.shape)# [seq_length, batch_size, D * hidden_size] print(hn.shape)# same as h0 will get:\ntorch.Size([5, 16, 20]) torch.Size([3, 16, 20]) §1.2 bidirectional bidirecitonal=True $\\to D=2$\nRNNBidirectional\nclass RNNBidirectional(nn.Module): def __init__(self, input_size, hidden_size, nonlinearity=\u0026#39;tanh\u0026#39;, bias=True, num_layers=1): super().__init__() self.num_layers = num_layers# number of layers on one side self.rnn_f = RNNDeep(input_size, hidden_size, nonlinearity, bias, num_layers) self.rnn_b = RNNDeep(input_size, hidden_size, nonlinearity, bias, num_layers) def forward(self, input, h0): seq_length = input.shape[0] # hn_f, hn_b = h0[:self.num_layers], h0[self.num_layers:] hn_f = torch.cat( [h0[2*i:2*i+1] for i in range(self.num_layers)], dim=0 ) hn_b = torch.cat( [h0[2*i+1:2*i+2] for i in range(self.num_layers)], dim=0 ) output_f, hn_f = self.rnn_f(input, hn_f) output_b, hn_b = self.rnn_b(torch.flip(input, dims=[0]), hn_b) output_b = torch.flip(output_b, dims=[0]) output = torch.Tensor([]) # concat every y_i and z_i for i in range(seq_length): output_i = torch.cat((output_f[i:i+1], output_b[i:i+1]), dim=2) output = torch.cat((output, output_i), dim=0) hn = torch.Tensor([]) # concat h_n, (h_n)\u0026#39;, (h_n)\u0026#39;\u0026#39;, ... for i in range(self.num_layers): hn_i = torch.cat((hn_f[i:i+1], hn_b[i:i+1]), dim=0) hn = torch.cat((hn, hn_i), dim=0) return output, hn testing\nrnn_bidirectional = RNNBidirectional(input_size=10, hidden_size=20, num_layers=3) input = torch.randn(5, 16, 10)# [seq_length, batch_size, input_size] h0 = torch.zeros(6, 16, 20)# [D * num_layers, batch_size, hidden_size] output, hn = rnn_bidirectional(input, h0) print(output.shape)# [seq_length, batch_size, D * hidden_size] print(hn.shape)# same as h0 print(torch.all(output[4:5, :, :20]==hn[4:5]))# ouput[seq_length-1:seq_length, :, :hidden_size] == hn[D * num_layers-2:D * num_layers-1] print(torch.all(output[0:1, :, 20:]==hn[5:6]))# ouput[0:1, :, hidden_size:] == hn[D * num_layers-1:D * num_layers] will get:\ntorch.Size([5, 16, 40]) torch.Size([6, 16, 20]) tensor(True) tensor(True) nn.RNN\nrnn = nn.RNN(input_size=10, hidden_size=20, num_layers=3, bidirectional=True) input = torch.randn(5, 16, 10)# [seq_length, batch_size, input_size] h0 = torch.zeros(6, 16, 20)# [D * num_layers, batch_size, hidden_size] output, hn = rnn(input, h0) print(output.shape)# [seq_length, batch_size, D * hidden_size] print(hn.shape)# same as h0 print(torch.all(output[4:5, :, :20]==hn[4:5]))# ouput[seq_length-1:seq_length, :, :hidden_size] == hn[D * num_layers-2:D * num_layers-1] print(torch.all(output[0:1, :, 20:]==hn[5:6]))# ouput[0:1, :, hidden_size:] == hn[D * num_layers-1:D * num_layers] will get:\ntorch.Size([5, 16, 40]) torch.Size([6, 16, 20]) tensor(True) tensor(True) So we introduced two ways to stack up the layers: adding layers is like parallel connection in circuit; bidirectional is like series connection. In the following we will not explicitly write how to do these two ways, because (a) the code is pretty much the same; (b) torch.nn.RNN, torch.nn.LSTM and torch.nn.GRU do these implementations in C++ and CUDA, thus faster.\n§2 LSTM nn.LSTMCell, nn.LSTM\nLSTM introduces input gate $i_t$, forget gate $f_t$, cell gate $g_t$ and output gate $o_t$, which are functions of the current input $x_t$ and the last hidden state $h_{t-1}$: $$\\begin{aligned} i_t \u0026amp;= \\sigma(W_{ii} x_t + b_{ii} + W_{hi} h_{t-1} + b_{hi}) \\\\ f_t \u0026amp;= \\sigma(W_{if} x_t + b_{if} + W_{hf} h_{t-1} + b_{hf}) \\\\ g_t \u0026amp;= \\tanh(W_{ig} x_t + b_{ig} + W_{hg} h_{t-1} + b_{hg}) \\\\ o_t \u0026amp;= \\sigma(W_{io} x_t + b_{io} + W_{ho} h_{t-1} + b_{ho}) \\end{aligned}$$then the current cell state $c_t$ and the current hidden state $h_t$ are:$$\\begin{aligned} c_t \u0026amp;= f_t \\odot c_{t-1} + i_t \\odot g_t \\\\ h_t \u0026amp;= o_t \\odot \\tanh(c_t) \\end{aligned}$$where $\\sigma$ is the sigmoid function $\\sigma(x)=\\frac{1}{1+e^{-x}} \\in (0, 1)$ and $\\odot$ is the Hadamard product. I find this post and this summary paper explaining the design motivation really well. By using sigmoid, the mechanism of these gates is that they are close to masks that marks what to forget and what to remember.\nLSTMScratch\nclass LSTMScratch(nn.Module): def __init__(self, input_size, hidden_size, bias=True): super().__init__() self.w_ii = nn.Linear(input_size, hidden_size, bias=bias) self.w_hi = nn.Linear(hidden_size, hidden_size, bias=bias) self.w_if = nn.Linear(input_size, hidden_size, bias=bias) self.w_hf = nn.Linear(hidden_size, hidden_size, bias=bias) self.w_ig = nn.Linear(input_size, hidden_size, bias=bias) self.w_hg = nn.Linear(hidden_size, hidden_size, bias=bias) self.w_io = nn.Linear(input_size, hidden_size, bias=bias) self.w_ho = nn.Linear(hidden_size, hidden_size, bias=bias) self.sigmoid = nn.Sigmoid() self.tanh = nn.Tanh() def forward(self, input, h0, c0): output = torch.Tensor([]) hn, cn = h0, c0 # Iterate over the sequence of input for x in input: # print(\u0026#39;x shape: \u0026#39;, x.shape)# [batch_size, input_size] i_t = self.sigmoid(self.w_ii(x) + self.w_hi(hn)) f_t = self.sigmoid(self.w_if(x) + self.w_hf(hn)) g_t = self.tanh(self.w_ig(x) + self.w_hg(hn)) o_t = self.sigmoid(self.w_io(x) + self.w_ho(hn)) cn = f_t * cn + i_t * g_t hn = o_t * self.tanh(cn) output = torch.cat((output, hn), dim=0)# only hn is in the output # return, same as `torch.nn.LSTM` return output, (hn, cn) testing\nlstm_scratch = LSTMScratch(input_size=10, hidden_size=20) input = torch.randn(5, 16, 10)# [seq_length, batch_size, input_size] h0 = torch.zeros(1, 16, 20)# [D * num_layers, batch_size, hidden_size] c0 = torch.zeros(1, 16, 20)# [D * num_layers, batch_size, hidden_size] output, (hn, cn) = lstm_scratch(input, h0, c0) print(output.shape)# [seq_length, batch_size, hidden_size] print(hn.shape)# same as h0 print(cn.shape)# same as c0 will get:\ntorch.Size([5, 16, 20]) torch.Size([1, 16, 20]) torch.Size([1, 16, 20]) nn.LSTM\nlstm = nn.LSTM(input_size=10, hidden_size=20) input = torch.randn(5, 16, 10)# [seq_length, batch_size, input_size] h0 = torch.zeros(1, 16, 20)# [D * num_layers, batch_size, hidden_size] c0 = torch.zeros(1, 16, 20)# [D * num_layers, batch_size, hidden_size] output, (hn, cn) = lstm(input, (h0, c0)) print(output.shape)# [seq_length, batch_size, hidden_size] print(hn.shape)# same as h0 print(cn.shape)# same as c0 will get:\ntorch.Size([5, 16, 20]) torch.Size([1, 16, 20]) torch.Size([1, 16, 20]) §2.1 proj_size LSTMProj\nclass LSTMProj(nn.Module): def __init__(self, input_size, hidden_size, proj_size, bias=True): super().__init__() self.w_ii = nn.Linear(input_size, hidden_size, bias=bias) self.w_hi = nn.Linear(proj_size, hidden_size, bias=bias)# proj_size self.w_if = nn.Linear(input_size, hidden_size, bias=bias) self.w_hf = nn.Linear(proj_size, hidden_size, bias=bias)# proj_size self.w_ig = nn.Linear(input_size, hidden_size, bias=bias) self.w_hg = nn.Linear(proj_size, hidden_size, bias=bias)# proj_size self.w_io = nn.Linear(input_size, hidden_size, bias=bias) self.w_ho = nn.Linear(proj_size, hidden_size, bias=bias)# proj_size self.sigmoid = nn.Sigmoid() self.tanh = nn.Tanh() self.w_hr = nn.Linear(hidden_size, proj_size, bias=bias) def forward(self, input, h0, c0): output = torch.Tensor([]) hn, cn = h0, c0 # Iterate over the sequence of input for x in input: # print(\u0026#39;x shape: \u0026#39;, x.shape)# [batch_size, input_size] i_t = self.sigmoid(self.w_ii(x) + self.w_hi(hn)) f_t = self.sigmoid(self.w_if(x) + self.w_hf(hn)) g_t = self.tanh(self.w_ig(x) + self.w_hg(hn)) o_t = self.sigmoid(self.w_io(x) + self.w_ho(hn)) cn = f_t * cn + i_t * g_t hn = o_t * self.tanh(cn) hn = self.w_hr(hn) output = torch.cat((output, hn), dim=0)# only hn is in the output # return, same as `torch.nn.LSTM` return output, (hn, cn) testing\nlstm_proj = LSTMProj(input_size=10, hidden_size=20, proj_size=15) input = torch.randn(5, 16, 10)# [seq_length, batch_size, input_size] h0 = torch.zeros(1, 16, 15)# [D * num_layers, batch_size, proj_size] c0 = torch.zeros(1, 16, 20)# [D * num_layers, batch_size, hidden_size] output, (hn, cn) = lstm_proj(input, h0, c0) print(output.shape)# [seq_length, batch_size, proj_size] print(hn.shape)# same as h0 print(cn.shape)# same as c0 will get:\ntorch.Size([5, 16, 15]) torch.Size([1, 16, 15]) torch.Size([1, 16, 20]) nn.LSTM\nlstm = nn.LSTM(input_size=10, hidden_size=20, proj_size=15) input = torch.randn(5, 16, 10)# [seq_length, batch_size, input_size] h0 = torch.zeros(1, 16, 15)# [D * num_layers, batch_size, proj_size] c0 = torch.zeros(1, 16, 20)# [D * num_layers, batch_size, hidden_size] output, (hn, cn) = lstm(input, (h0, c0)) print(output.shape)# [seq_length, batch_size, proj_size] print(hn.shape)# same as h0 print(cn.shape)# same as c0 will get:\ntorch.Size([5, 16, 15]) torch.Size([1, 16, 15]) torch.Size([1, 16, 20]) /usr/local/lib/python3.10/dist-packages/torch/nn/modules/rnn.py:879: UserWarning: LSTM with projections is not supported with oneDNN. Using default implementation. (Triggered internally at ../aten/src/ATen/native/RNN.cpp:1492.) result = _VF.lstm(input, hx, self._flat_weights, self.bias, self.num_layers, (the warning is about oneDNN.)\n§3 GRU nn.GRUCell, nn.GRU\nGRU introduces reset gate $r_t$, update gate $z_t$ and new gate $n_t$, which are functions of the current input $x_t$ and the last hidden state $h_{t-1}$$$\\begin{aligned} r_t \u0026amp;= \\sigma(W_{ir} x_t + b_{ir} + W_{hr} h_{t-1} + b_{hr}) \\\\ z_t \u0026amp;= \\sigma(W_{iz} x_t + b_{iz} + W_{hz} h_{t-1} + b_{hz}) \\\\ n_t \u0026amp;= \\tanh(W_{in} x_t + b_{in} + r_t \\odot (W_{hn} h_{t-1}+ b_{hn})) \\end{aligned}$$then the current hidden state $h_t$ is$$h_t = (1 - z_t) \\odot n_t + z_t \\odot h_{t-1}$$\nGRUScratch\nclass GRUScratch(nn.Module): def __init__(self, input_size, hidden_size, bias=True): super().__init__() self.w_ir = nn.Linear(input_size, hidden_size, bias=bias) self.w_hr = nn.Linear(hidden_size, hidden_size, bias=bias) self.w_iz = nn.Linear(input_size, hidden_size, bias=bias) self.w_hz = nn.Linear(hidden_size, hidden_size, bias=bias) self.w_in = nn.Linear(input_size, hidden_size, bias=bias) self.w_hn = nn.Linear(hidden_size, hidden_size, bias=bias) self.sigmoid = nn.Sigmoid() self.tanh = nn.Tanh() def forward(self, input, h0): output = torch.Tensor([]) hn = h0 # Iterate over the sequence of input for x in input: # print(\u0026#39;x shape: \u0026#39;, x.shape)# [batch_size, input_size] r_t = self.sigmoid(self.w_ir(x) + self.w_hr(hn)) z_t = self.sigmoid(self.w_iz(x) + self.w_hz(hn)) n_t = self.tanh(self.w_in(x) + r_t * self.w_hn(hn)) hn = (1 - z_t) * n_t + z_t * hn output = torch.cat((output, hn), dim=0) # return, same as `torch.nn.LSTM` return output, hn testing\ngru_scratch = GRUScratch(input_size=10, hidden_size=20) input = torch.randn(5, 16, 10)# [seq_length, batch_size, input_size] h0 = torch.zeros(1, 16, 20)# [D * num_layers, batch_size, hidden_size] output, hn = gru_scratch(input, h0) print(output.shape)# [seq_length, batch_size, hidden_size] print(hn.shape)# same as h0 will get:\ntorch.Size([5, 16, 20]) torch.Size([1, 16, 20]) nn.GRU\ngru = nn.GRU(input_size=10, hidden_size=20) input = torch.randn(5, 16, 10)# [seq_length, batch_size, input_size] h0 = torch.zeros(1, 16, 20)# [D * num_layers, batch_size, hidden_size] output, hn = gru(input, h0) print(output.shape)# [seq_length, batch_size, hidden_size] print(hn.shape)# same as h0 will get:\ntorch.Size([5, 16, 20]) torch.Size([1, 16, 20]) §4 RWKV: The RNN Strikes Back | [2305.13048] RWKV: Reinventing RNNs for the Transformer Era | RWKV-LM (GitHub) | nanoRWKV (GitHub) | rwkv-cpp-accelerated (GitHub) |\nReceptance Weighted Key Value (RWKV) combines the efficient parallelizable training of transformers with the efficient inference of RNNs. Generally speaking it\u0026rsquo;s composed of several layers of Time Mix module and Channel Mix module. It can be considered as a convolutional network across an entire one-dimensional sequence (because $r_t$, $k_t$, $v_t$ does not contain non-linearity thus are weighted sum), which is the same thing we will see in SSM.\nThe Time Mix module is linear projections ($W$) of linear combinations ($\\mu$ and $(1-\\mu)$) of the current input $x_t$ and the last input $x_{t-1}$, $wkv_t$ is weighted sum over the entire past sequence:$$\\begin{aligned} r_t \u0026amp;= W_r (\\mu_r \\odot x_t + (1-\\mu_r) \\odot x_{t-1}) \\\\ k_t \u0026amp;= W_k (\\mu_k \\odot x_t + (1-\\mu_k) \\odot x_{t-1}) \\\\ v_t \u0026amp;= W_v (\\mu_v \\odot x_t + (1-\\mu_v) \\odot x_{t-1}) \\\\ wkv_t \u0026amp;= \\frac{ \\sum_{i=1}^{t-1} e^{-(t-1-i)w+k_i} \\odot v_i + e^{u+k_t} \\odot v_t }{\\sum_{i=1}^{t-1} e^{-(t-1-i)w+k_i} + e^{u+k_t}} \\\\ o_t \u0026amp;= W_o (\\sigma(r_t) \\odot wkv_t) \\end{aligned}$$\nThe Channel Mix module is $$\\begin{aligned} r_t \u0026amp;= W_r (\\mu_r \\odot x_t + (1 - \\mu_r) \\odot x_{t-1} ) \\\\ k_t \u0026amp;= W_k (\\mu_k \\odot x_t + (1 - \\mu_k) \\odot x_{t-1} ) \\\\ o_t \u0026amp;= \\sigma(r_t) \\odot (W_v \\max({k_t}, 0)^2) \\end{aligned}$$\nThe usage of $x_t$ and $x_{t-1}$ is the \u0026ldquo;Token shift\u0026rdquo; in Fig.3 of the paper:\nRWKV-v6 looks scary\u0026hellip;\n§5 RNNLanguageModel The detailed code to train a language model is largely from nanoGPT. Please refer to gpt-fast for training on a larger (like, way larger) dataset.\nclass RNNLanguageModel(nn.Module): def __init__(self, vocab_size=20, emb_size=10, hidden_size=20, window_size=8): super().__init__() self.hidden_size = hidden_size self.embedding = nn.Embedding(vocab_size, emb_size) self.pos_embedding = nn.Embedding(window_size, emb_size) self.rnn = RNNScratch(emb_size, hidden_size) self.layer_norm = nn.LayerNorm(hidden_size) self.proj = nn.Linear(hidden_size, vocab_size) def forward(self, index, targets=None): # index, targets shape: [batch_size, seq_length] batch_size, seq_length = index.shape # embedding embedding = self.embedding(index)# [batch_size, seq_length, emb_size] pos_embedding = self.pos_embedding(torch.arange(seq_length))# [seq_length, emb_size] x = embedding + pos_embedding# [batch_size, seq_length, emb_size] # RNN x = x.permute(1, 0, 2)# [seq_length, batch_size, emb_size] h0 = torch.zeros(1, batch_size, self.hidden_size)# [D * num_layers, batch_size, hidden_size] x, _ = self.rnn(x, h0) # x shape: [seq_length, batch_size, D * hidden_size] x = x.permute(1, 0, 2)# [batch_size, seq_length, D * hidden_size] # project out x = self.layer_norm(x)# [batch_size, seq_length, D * hidden_size] logits = self.proj(x)# [batch_size, seq_length, vocab_size] if targets is None: loss = None else: batch_size, seq_length, vocab_size = logits.shape logits = logits.view(batch_size*seq_length, vocab_size) targets = targets.view(batch_size*seq_length) loss = F.cross_entropy(logits, targets) return logits, loss @torch.no_grad() def generate(self, index, max_new_tokens): # index shape [batch_size, seq_length] for _ in range(max_new_tokens): # crop index to the last window_size tokens index_cond = index[:, -window_size:] # get the predictions logits, loss = self(index_cond) # focus only on the last time step logits = logits[:, -1, :] # [batch_size, vocab_size] # apply softmax to get probabilities probs = F.softmax(logits, dim=-1) # [batch_size, vocab_size] # sample from the distribution index_next = torch.multinomial(probs, num_samples=1) # [batch_size, 1] # append sampled index to the running sequence index = torch.cat((index, index_next), dim=1) # [batch_size, seq_length+1] return index §4.1 Dataset text = \u0026#39;\u0026#39;\u0026#39; All work and no play makes Jack a doll boy. All work and no play makes Jack a doll boy. All work and no play makes Jack a doll boy. All work and no play makes Jack a doll boy. All work and no play makes Jack a doll boy. All work and no play makes Jack a doll boy. All work and no play makes Jack a doll boy. All work and no play makes Jack a doll boy. All work and no play makes Jack a doll boy. All work and no play makes Jack a doll boy. \u0026#39;\u0026#39;\u0026#39; # https://docs.python.org/3/library/re.html#raw-string-notation # text = \u0026#39;All work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\n\u0026#39; # text = r\u0026#39;All work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\n\u0026#39; print(text[:100]) will get:\nAll work and no play makes Jack a doll boy. All work and no play makes Jack a doll boy. All work a Here\u0026rsquo;s a character-level tokenizer, please refer to tiktoken or minbpe (BPE is combining words to get pharses) for a sub-word-level tokenizer.\ncharacters = sorted(list(set(text))) vocab_size = len(characters) print(\u0026#39;\u0026#39;.join(characters)) print(vocab_size) will get:\n.AJabcdeklmnoprswy 20 string_to_int = { character:integer for integer,character in enumerate(characters) } int_to_string = { interger:character for interger,character in enumerate(characters) } encode = lambda strings: [string_to_int[string] for string in strings] # string -\u0026gt; a list of integers decode = lambda ints: \u0026#39;\u0026#39;.join([int_to_string[integer] for integer in ints]) # a list of integers -\u0026gt; string print(encode(\u0026#39;cJ\u0026#39;)) print(decode([7, 4])) will get:\n[7, 4] cJ data = torch.Tensor(encode(text)).to(torch.long) n = int(0.9*len(data)) train_data = data[:n] val_data = data[n:] batch_size = 4 window_size = 8 def get_batch(split): # generate a small batch of data of inputs x and targets y if split == \u0026#39;train\u0026#39;: data = train_data else: data = val_data ix = torch.randint(len(data) - window_size, (batch_size,)) x = torch.stack([data[i:i+window_size] for i in ix])# [batch_size, window_size] y = torch.stack([data[i+1:i+window_size+1] for i in ix])# [batch_size, window_size] return x, y §4.2 Train and Predict eval_iters = 200 @torch.no_grad() def estimate_loss(): out = {} model.eval() for split in [\u0026#39;train\u0026#39;, \u0026#39;val\u0026#39;]: losses = torch.zeros(eval_iters) for k in range(eval_iters): X, Y = get_batch(split) logits, loss = model(X, Y) losses[k] = loss.item() out[split] = losses.mean() model.train() return out torch.manual_seed(2001) model = RNNLanguageModel() optimizer = torch.optim.AdamW(model.parameters(), lr=1e-3) # train max_iters = 2000 eval_interval = 100 for iter in range(max_iters): # every once in a while evaluate the loss on train and val sets if iter % eval_interval == 0 or iter == max_iters - 1: losses = estimate_loss() print(f\u0026#34;step {iter}: train loss {losses[\u0026#39;train\u0026#39;]:.4f}, val loss {losses[\u0026#39;val\u0026#39;]:.4f}\u0026#34;) # sample a batch of data xb, yb = get_batch(\u0026#39;train\u0026#39;) # evaluate the loss logits, loss = model(xb, yb) optimizer.zero_grad(set_to_none=True) loss.backward() optimizer.step() will get:\nstep 0: train loss 3.0177, val loss 3.0082 step 100: train loss 2.2342, val loss 2.1759 step 200: train loss 1.5963, val loss 1.5902 step 300: train loss 1.1176, val loss 1.1208 step 400: train loss 0.7405, val loss 0.7353 step 500: train loss 0.5035, val loss 0.4992 step 600: train loss 0.3738, val loss 0.3645 step 700: train loss 0.3333, val loss 0.3219 step 800: train loss 0.2738, val loss 0.2673 step 900: train loss 0.2465, val loss 0.2517 step 1000: train loss 0.2248, val loss 0.2286 step 1100: train loss 0.2163, val loss 0.2102 step 1200: train loss 0.1975, val loss 0.2043 step 1300: train loss 0.1981, val loss 0.1930 step 1400: train loss 0.1873, val loss 0.1965 step 1500: train loss 0.1792, val loss 0.1813 step 1600: train loss 0.1752, val loss 0.1775 step 1700: train loss 0.1713, val loss 0.1809 step 1800: train loss 0.1673, val loss 0.1762 step 1900: train loss 0.1762, val loss 0.1739 step 1999: train loss 0.1697, val loss 0.1724 # generate from the trained model context = torch.zeros((1, 1)).to(torch.long) # context = torch.unsqueeze(torch.Tensor(encode(\u0026#39;cJ\u0026#39;)).to(torch.long), dim=0) print(decode(model.generate(context, max_new_tokens=500)[0].tolist())) will get Jack Torrance played by Jack Nicholson:\nAll boy. All work and no plakes Jack a doll boy. All work and no play. All work and no play makesl play makes Jack a doll boy. All work and no play makes Jack a doll boy.. All work and no play makes Jack a doll boy. All work and no play makes Jack a doll boy. All work and no play makes Jack a Jack a doll boy. All work and no play makes Jack a doll boy. All work amakes Jack a doll boy. All work ank a doll boy. Alak a d no playes Jack a doll boy. All work and no play makes Jack a doll By the way, I guess the reasons Transformers outperform RNNs are:\nTransformers don\u0026rsquo;t use for loops thus are more parallel-processing-friendly. (There is this new architecture with Transformers that the same single Transformer layer is repeated several times, which is like using Transformer layer as RNN layer.) Transformers can look into the entire sequence equally while RNNs focus more on the current input of the entire sequence. On the other hand, the advantages of RNNs are:\nThe scaling of memory usage is linear (Transformers are quadratically, please refer to Tab.1 of [2305.13048] RWKV: Reinventing RNNs for the Transformer Era). The memory usage is constant, because hn is passed down. ",
      "content_html": "\u003cp\u003e\u0026ldquo;Recurrent\u0026rdquo; means that, hidden state $h_t$ is a function of the current input $x_t$ and the last hidden state $h_{t-1}$:$$h_t=f(x_t, h_{t-1}; \\theta)$$where $\\theta$ is all the trainable parameters. We iterate over each word (sub-word) in the entire sequence.\u003c/p\u003e\n\u003ch2 id=\"1-rnn\"\u003e§1 RNN\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.RNNCell.html\"\u003e\u003ccode\u003enn.RNNCell\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.RNN.html\"\u003e\u003ccode\u003enn.RNN\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eRNN (or vanilla RNN) is composed of 2 Linear layers and an activation function: $$h_t = \\tanh(x_t W_{ih}^T + b_{ih} + h_{t-1}W_{hh}^T + b_{hh})$$\u003c/p\u003e\n\u003cp\u003eNote that in the figure below each square represents the same parameters.\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"20231217-machine-learning-notes-rnn-lstm-gru-rwkv-rnnscratch.svg\"\r\n  alt=\"RNNScratch\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eRNNScratch\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eRNNScratch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enonlinearity\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;tanh\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ih\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hh\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enonlinearity\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;tanh\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eact\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTanh\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enonlinearity\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;relu\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eact\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eReLU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTensor\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Iterate over the sequence of input\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# print(\u0026#39;x shape:\u0026#39;, x.shape)# [batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eact\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ih\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hh\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# print(\u0026#39;hn shape:\u0026#39;, hn.shape)# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# print(\u0026#39;output shape:\u0026#39;, output.shape)# [seq_length, batch_size, D * hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# return, same as `torch.nn.RNN`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003etesting\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ernn_scratch\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eRNNScratch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ernn_scratch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;------\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;output shape:\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, D * hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;hn shape:\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as h0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eall\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# y_{t-1} == h_t\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e16, 10\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehn shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoutput shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e16, 10\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehn shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoutput shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e2, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e16, 10\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehn shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoutput shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e3, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e16, 10\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehn shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoutput shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e4, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e16, 10\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehn shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoutput shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e------\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoutput shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehn shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eTrue\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.RNN\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ernn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eRNN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ernn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, D * hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as h0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eall\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# y_{t-1} == h_t\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eTrue\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"11-num_layers\"\u003e§1.1 \u003ccode\u003enum_layers\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"20231217-machine-learning-notes-rnn-lstm-gru-rwkv-rnndeep.svg\"\r\n  alt=\"RNNDeep\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eRNNDeep\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eRNNDeep\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enonlinearity\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;tanh\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ernns\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModuleList\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eRNNScratch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#111\"\u003enonlinearity\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Iterate over rnns\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# print(hn[i:i+1].shape)# [1, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ernns\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e](\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# return, same as `torch.nn.RNN`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003etesting\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ernn_deep\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eRNNDeep\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ernn_deep\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, D * hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as h0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e3, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.RNN\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ernn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eRNN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ernn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, D * hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as h0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e3, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"12-bidirectional\"\u003e§1.2 \u003ccode\u003ebidirectional\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ebidirecitonal=True\u003c/code\u003e $\\to D=2$\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"20231217-machine-learning-notes-rnn-lstm-gru-rwkv-rnnbidirectional.svg\"\r\n  alt=\"RNNBidirectional\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eRNNBidirectional\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eRNNBidirectional\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enonlinearity\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;tanh\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# number of layers on one side\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ernn_f\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eRNNDeep\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enonlinearity\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ernn_b\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eRNNDeep\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enonlinearity\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# hn_f, hn_b = h0[:self.num_layers], h0[self.num_layers:]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ehn_f\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ehn_b\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput_f\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn_f\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ernn_f\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn_f\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput_b\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn_b\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ernn_b\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eflip\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edims\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn_b\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput_b\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eflip\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput_b\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edims\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTensor\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# concat every y_i and z_i\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eoutput_i\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput_f\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput_b\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput_i\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTensor\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# concat h_n, (h_n)\u0026#39;, (h_n)\u0026#39;\u0026#39;, ...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ehn_i\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn_f\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn_b\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn_i\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003etesting\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ernn_bidirectional\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eRNNBidirectional\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ernn_bidirectional\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, D * hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as h0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eall\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# ouput[seq_length-1:seq_length, :, :hidden_size] == hn[D * num_layers-2:D * num_layers-1]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eall\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# ouput[0:1, :, hidden_size:] == hn[D * num_layers-1:D * num_layers]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 16, 40\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e6, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eTrue\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eTrue\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.RNN\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ernn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eRNN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebidirectional\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ernn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, D * hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as h0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eall\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# ouput[seq_length-1:seq_length, :, :hidden_size] == hn[D * num_layers-2:D * num_layers-1]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eall\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# ouput[0:1, :, hidden_size:] == hn[D * num_layers-1:D * num_layers]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 16, 40\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e6, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eTrue\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eTrue\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSo we introduced two ways to stack up the layers: adding layers is like parallel connection in circuit; bidirectional is like series connection. In the following we will not explicitly write how to do these two ways, because (a) the code is pretty much the same; (b) \u003ccode\u003etorch.nn.RNN\u003c/code\u003e, \u003ccode\u003etorch.nn.LSTM\u003c/code\u003e and \u003ccode\u003etorch.nn.GRU\u003c/code\u003e do these implementations in C++ and CUDA, thus faster.\u003c/p\u003e\n\u003ch2 id=\"2-lstm\"\u003e§2 LSTM\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.LSTMCell.html\"\u003e\u003ccode\u003enn.LSTMCell\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.LSTM.html\"\u003e\u003ccode\u003enn.LSTM\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eLSTM introduces input gate $i_t$, forget gate $f_t$, cell gate $g_t$ and output gate $o_t$, which are functions of the current input $x_t$ and the last hidden state $h_{t-1}$: $$\\begin{aligned} i_t \u0026amp;= \\sigma(W_{ii} x_t + b_{ii} + W_{hi} h_{t-1} + b_{hi}) \\\\ f_t \u0026amp;= \\sigma(W_{if} x_t + b_{if} + W_{hf} h_{t-1} + b_{hf}) \\\\ g_t \u0026amp;= \\tanh(W_{ig} x_t + b_{ig} + W_{hg} h_{t-1} + b_{hg}) \\\\ o_t \u0026amp;= \\sigma(W_{io} x_t + b_{io} + W_{ho} h_{t-1} + b_{ho}) \\end{aligned}$$then the current cell state $c_t$ and the current hidden state $h_t$ are:$$\\begin{aligned} c_t \u0026amp;= f_t \\odot c_{t-1} + i_t \\odot g_t \\\\ h_t \u0026amp;= o_t \\odot \\tanh(c_t) \\end{aligned}$$where $\\sigma$ is the \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.Sigmoid.html\"\u003esigmoid function\u003c/a\u003e $\\sigma(x)=\\frac{1}{1+e^{-x}} \\in (0, 1)$ and $\\odot$ is the \u003ca href=\"https://en.wikipedia.org/wiki/Hadamard_product_(matrices)\"\u003eHadamard product\u003c/a\u003e. I find \u003ca href=\"https://colah.github.io/posts/2015-08-Understanding-LSTMs/\"\u003ethis post\u003c/a\u003e and \u003ca href=\"https://arxiv.org/abs/2410.01201\"\u003ethis summary paper\u003c/a\u003e explaining the design motivation really well. By using sigmoid, the mechanism of these gates is that they are close to masks that marks what to forget and what to remember.\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eLSTMScratch\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eLSTMScratch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ii\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hi\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_if\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hf\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ig\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hg\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_io\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ho\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esigmoid\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSigmoid\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etanh\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTanh\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ec0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTensor\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ec0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Iterate over the sequence of input\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# print(\u0026#39;x shape: \u0026#39;, x.shape)# [batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ei_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esigmoid\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ii\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hi\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ef_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esigmoid\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_if\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hf\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eg_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etanh\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ig\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hg\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eo_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esigmoid\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_io\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ho\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ef_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eg_t\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eo_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etanh\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# only hn is in the output\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# return, same as `torch.nn.LSTM`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003etesting\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elstm_scratch\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eLSTMScratch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ec0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elstm_scratch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ec0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as h0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as c0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.LSTM\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elstm\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLSTM\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ec0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elstm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ec0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as h0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as c0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"21-proj_size\"\u003e§2.1 \u003ccode\u003eproj_size\u003c/code\u003e\u003c/h3\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eLSTMProj\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eLSTMProj\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eproj_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ii\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hi\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eproj_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# proj_size\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_if\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hf\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eproj_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# proj_size\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ig\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hg\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eproj_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# proj_size\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_io\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ho\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eproj_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# proj_size\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esigmoid\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSigmoid\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etanh\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTanh\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eproj_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ec0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTensor\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ec0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Iterate over the sequence of input\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# print(\u0026#39;x shape: \u0026#39;, x.shape)# [batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ei_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esigmoid\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ii\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hi\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ef_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esigmoid\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_if\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hf\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eg_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etanh\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ig\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hg\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eo_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esigmoid\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_io\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ho\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ef_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eg_t\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eo_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etanh\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# only hn is in the output\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# return, same as `torch.nn.LSTM`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003etesting\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elstm_proj\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eLSTMProj\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eproj_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e15\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e15\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, proj_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ec0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elstm_proj\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ec0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, proj_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as h0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as c0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 16, 15\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 15\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.LSTM\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elstm\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLSTM\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eproj_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e15\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e15\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, proj_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ec0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elstm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ec0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, proj_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as h0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as c0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 16, 15\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 15\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/usr/local/lib/python3.10/dist-packages/torch/nn/modules/rnn.py:879: UserWarning: LSTM with projections is not supported with oneDNN. Using default implementation. \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eTriggered internally at ../aten/src/ATen/native/RNN.cpp:1492.\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#111\"\u003eresult\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e _VF.lstm\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003einput, hx, self._flat_weights, self.bias, self.num_layers,\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e(the warning is about \u003ca href=\"https://github.com/oneapi-src/oneDNN\"\u003e\u003ccode\u003eoneDNN\u003c/code\u003e\u003c/a\u003e.)\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"3-gru\"\u003e§3 GRU\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.GRUCell.html\"\u003e\u003ccode\u003enn.GRUCell\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.GRU.html\"\u003e\u003ccode\u003enn.GRU\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eGRU introduces reset gate $r_t$, update gate $z_t$ and new gate $n_t$, which are functions of the current input $x_t$ and the last hidden state $h_{t-1}$$$\\begin{aligned} r_t \u0026amp;= \\sigma(W_{ir} x_t + b_{ir} + W_{hr} h_{t-1} + b_{hr}) \\\\ z_t \u0026amp;= \\sigma(W_{iz} x_t + b_{iz} + W_{hz} h_{t-1} + b_{hz}) \\\\ n_t \u0026amp;= \\tanh(W_{in} x_t + b_{in} + r_t \\odot (W_{hn} h_{t-1}+ b_{hn})) \\end{aligned}$$then the current hidden state $h_t$ is$$h_t = (1 - z_t) \\odot n_t + z_t \\odot h_{t-1}$$\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eGRUScratch\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eGRUScratch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ir\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_iz\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hz\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_in\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esigmoid\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSigmoid\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etanh\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTanh\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTensor\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Iterate over the sequence of input\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# print(\u0026#39;x shape: \u0026#39;, x.shape)# [batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003er_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esigmoid\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_ir\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ez_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esigmoid\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_iz\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hz\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003en_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etanh\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_in\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003er_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_hn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ez_t\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003en_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ez_t\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# return, same as `torch.nn.LSTM`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003etesting\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003egru_scratch\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eGRUScratch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003egru_scratch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as h0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.GRU\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003egru\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eGRU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, input_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003egru\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same as h0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 16, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"4-rwkv-the-rnn-strikes-back\"\u003e§4 RWKV: The RNN Strikes Back\u003c/h2\u003e\n\u003cp\u003e| \u003ca href=\"https://arxiv.org/abs/2305.13048\"\u003e[2305.13048] \u003cem\u003eRWKV: Reinventing RNNs for the Transformer Era\u003c/em\u003e\u003c/a\u003e | \u003ca href=\"https://github.com/BlinkDL/RWKV-LM\"\u003eRWKV-LM (GitHub)\u003c/a\u003e | \u003ca href=\"https://github.com/BlinkDL/nanoRWKV\"\u003enanoRWKV (GitHub)\u003c/a\u003e | \u003ca href=\"https://github.com/harrisonvanderbyl/rwkv-cpp-accelerated\"\u003erwkv-cpp-accelerated (GitHub)\u003c/a\u003e |\u003c/p\u003e\n\u003cp\u003eReceptance Weighted Key Value (RWKV) combines the efficient parallelizable training of transformers with the efficient inference of RNNs. Generally speaking it\u0026rsquo;s composed of several layers of Time Mix module and Channel Mix module. It can be considered as a convolutional network across an entire one-dimensional sequence (because $r_t$, $k_t$, $v_t$ does not contain non-linearity thus are weighted sum), which is the same thing we will see in SSM.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eThe Time Mix module is linear projections ($W$) of linear combinations ($\\mu$ and $(1-\\mu)$) of the current input $x_t$ and the last input $x_{t-1}$, $wkv_t$ is weighted sum over the entire past sequence:$$\\begin{aligned} r_t \u0026amp;= W_r (\\mu_r \\odot x_t + (1-\\mu_r) \\odot x_{t-1}) \\\\ k_t \u0026amp;= W_k (\\mu_k \\odot x_t + (1-\\mu_k) \\odot x_{t-1}) \\\\ v_t \u0026amp;= W_v (\\mu_v \\odot x_t + (1-\\mu_v) \\odot x_{t-1}) \\\\ wkv_t \u0026amp;= \\frac{ \\sum_{i=1}^{t-1} e^{-(t-1-i)w+k_i} \\odot v_i + e^{u+k_t} \\odot v_t }{\\sum_{i=1}^{t-1} e^{-(t-1-i)w+k_i} + e^{u+k_t}} \\\\ o_t \u0026amp;= W_o (\\sigma(r_t) \\odot wkv_t) \\end{aligned}$$\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe Channel Mix module is $$\\begin{aligned} r_t \u0026amp;= W_r (\\mu_r \\odot x_t + (1 - \\mu_r) \\odot x_{t-1} ) \\\\ k_t \u0026amp;= W_k (\\mu_k \\odot x_t + (1 - \\mu_k) \\odot x_{t-1} ) \\\\ o_t \u0026amp;= \\sigma(r_t) \\odot (W_v \\max({k_t}, 0)^2) \\end{aligned}$$\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe usage of $x_t$ and $x_{t-1}$ is the \u0026ldquo;Token shift\u0026rdquo; in Fig.3 of the paper:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://pbs.twimg.com/media/FwyDRLvaQAEBYok?format=png\"\r\n  alt=\"fig3_of_2305.13048\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://twitter.com/BlinkDL_AI/status/1735258602473197721\"\u003eRWKV-v6\u003c/a\u003e looks scary\u0026hellip;\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://pbs.twimg.com/media/GBTgK7TbYAAeeCN?format=jpg\"\r\n  alt=\"RWKV-v6\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ch2 id=\"5-rnnlanguagemodel\"\u003e§5 RNNLanguageModel\u003c/h2\u003e\n\u003cp\u003eThe detailed code to train a language model is largely from \u003ca href=\"https://github.com/karpathy/nanoGPT\"\u003enanoGPT\u003c/a\u003e. Please refer to \u003ca href=\"https://github.com/pytorch-labs/gpt-fast/\"\u003egpt-fast\u003c/a\u003e for training on a larger (like, way larger) dataset.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eRNNLanguageModel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eemb_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ewindow_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eemb_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epos_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ewindow_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eemb_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ernn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eRNNScratch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eemb_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLayerNorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eproj\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etargets\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# index, targets shape: [batch_size, seq_length]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# embedding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eembedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, emb_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003epos_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epos_embedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003earange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, emb_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eembedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epos_embedding\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, emb_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# RNN\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epermute\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [seq_length, batch_size, emb_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [D * num_layers, batch_size, hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ernn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eh0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# x shape: [seq_length, batch_size, D * hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epermute\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, D * hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# project out\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, D * hidden_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eproj\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, vocab_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etargets\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eis\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003etargets\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etargets\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecross_entropy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etargets\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75af00\"\u003e@torch.no_grad\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003egenerate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emax_new_tokens\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# index shape [batch_size, seq_length]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emax_new_tokens\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# crop index to the last window_size tokens\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eindex_cond\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ewindow_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# get the predictions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex_cond\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# focus only on the last time step\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:]\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# [batch_size, vocab_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# apply softmax to get probabilities\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eprobs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esoftmax\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# [batch_size, vocab_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# sample from the distribution\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eindex_next\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emultinomial\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eprobs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_samples\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# [batch_size, 1]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# append sampled index to the running sequence\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex_next\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length+1]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"41-dataset\"\u003e§4.1 Dataset\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etext\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# https://docs.python.org/3/library/re.html#raw-string-notation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# text = \u0026#39;All work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\n\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# text = r\u0026#39;All work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\nAll work and no play makes Jack a doll boy. \\n\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etext\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work a\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eHere\u0026rsquo;s a character-level tokenizer, please refer to \u003ca href=\"https://github.com/openai/tiktoken\"\u003e\u003ccode\u003etiktoken\u003c/code\u003e\u003c/a\u003e or \u003ca href=\"https://github.com/karpathy/minbpe/\"\u003e\u003ccode\u003eminbpe\u003c/code\u003e\u003c/a\u003e (BPE is combining words to get pharses) for a sub-word-level tokenizer.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003echaracters\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esorted\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elist\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eset\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etext\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elen\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003echaracters\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ejoin\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003echaracters\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e.AJabcdeklmnoprswy\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003estring_to_int\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e \u003cspan style=\"color:#111\"\u003echaracter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einteger\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einteger\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003echaracter\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eenumerate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003echaracters\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eint_to_string\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einterger\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003echaracter\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einterger\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003echaracter\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eenumerate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003echaracters\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eencode\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003elambda\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estrings\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estring_to_int\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estring\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estrings\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# string -\u0026gt; a list of integers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edecode\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003elambda\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eints\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ejoin\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint_to_string\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einteger\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einteger\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eints\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# a list of integers -\u0026gt; string\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eencode\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;cJ\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edecode\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e7, 4\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecJ\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTensor\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eencode\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etext\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elong\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003en\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.9\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elen\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etrain_data\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003en\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eval_data\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003en\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ewindow_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eget_batch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esplit\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# generate a small batch of data of inputs x and targets y\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esplit\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;train\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etrain_data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eval_data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eix\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elen\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ewindow_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estack\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ewindow_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eix\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, window_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estack\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ewindow_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eix\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, window_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"42-train-and-predict\"\u003e§4.2 Train and Predict\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eeval_iters\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e200\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75af00\"\u003e@torch.no_grad\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eestimate_loss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eeval\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esplit\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;train\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;val\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003elosses\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eeval_iters\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eeval_iters\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eX\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eY\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eget_batch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esplit\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eX\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eY\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003elosses\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eitem\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esplit\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elosses\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emean\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emanual_seed\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2001\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eRNNLanguageModel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoptim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eAdamW\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eparameters\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elr\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1e-3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# train\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emax_iters\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eeval_interval\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eiter\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emax_iters\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# every once in a while evaluate the loss on train and val sets\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eiter\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eeval_interval\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eiter\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emax_iters\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003elosses\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eestimate_loss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;step \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eiter\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e: train loss \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elosses\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;train\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e.4f\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e, val loss \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elosses\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;val\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e.4f\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# sample a batch of data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003exb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eyb\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eget_batch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;train\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# evaluate the loss\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003exb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eyb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezero_grad\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eset_to_none\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebackward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estep\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 0: train loss 3.0177, val loss 3.0082\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 100: train loss 2.2342, val loss 2.1759\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 200: train loss 1.5963, val loss 1.5902\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 300: train loss 1.1176, val loss 1.1208\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 400: train loss 0.7405, val loss 0.7353\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 500: train loss 0.5035, val loss 0.4992\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 600: train loss 0.3738, val loss 0.3645\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 700: train loss 0.3333, val loss 0.3219\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 800: train loss 0.2738, val loss 0.2673\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 900: train loss 0.2465, val loss 0.2517\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 1000: train loss 0.2248, val loss 0.2286\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 1100: train loss 0.2163, val loss 0.2102\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 1200: train loss 0.1975, val loss 0.2043\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 1300: train loss 0.1981, val loss 0.1930\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 1400: train loss 0.1873, val loss 0.1965\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 1500: train loss 0.1792, val loss 0.1813\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 1600: train loss 0.1752, val loss 0.1775\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 1700: train loss 0.1713, val loss 0.1809\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 1800: train loss 0.1673, val loss 0.1762\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 1900: train loss 0.1762, val loss 0.1739\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep 1999: train loss 0.1697, val loss 0.1724\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# generate from the trained model\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003econtext\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elong\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# context = torch.unsqueeze(torch.Tensor(encode(\u0026#39;cJ\u0026#39;)).to(torch.long), dim=0)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edecode\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egenerate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econtext\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emax_new_tokens\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etolist\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get Jack Torrance played by Jack Nicholson:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll boy. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work and no plakes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work and no play. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work and no play makesl play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work and no play makes Jack a doll boy.. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work and no play makes Jack a Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work and no play makes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work amakes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work ank a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAlak a d no playes Jack a doll boy. \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAll work and no play makes Jack a doll\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eBy the way, I guess the reasons Transformers outperform RNNs are:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eTransformers don\u0026rsquo;t use \u003ccode\u003efor\u003c/code\u003e loops thus are more parallel-processing-friendly. (There is this new architecture with Transformers that the same single Transformer layer is repeated several times, which is like using Transformer layer as RNN layer.)\u003c/li\u003e\n\u003cli\u003eTransformers can look into the entire sequence equally while RNNs focus more on the current input of the entire sequence.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOn the other hand, the advantages of RNNs are:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe scaling of memory usage is linear (Transformers are quadratically, please refer to Tab.1 of \u003ca href=\"https://arxiv.org/abs/2305.13048\"\u003e[2305.13048] \u003cem\u003eRWKV: Reinventing RNNs for the Transformer Era\u003c/em\u003e\u003c/a\u003e).\u003c/li\u003e\n\u003cli\u003eThe memory usage is constant, because \u003ccode\u003ehn\u003c/code\u003e is passed down.\u003c/li\u003e\n\u003c/ul\u003e\n",
      "url": "https://chenlinear.github.io/posts/20231217-machine-learning-notes-rnn-lstm-gru-rwkv/",
      "date_published": "17126-17-09T120:1717:00+00:00",
      "date_modified": "17126-17-09T120:1717:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "4e50afaa14d2aa9590ff3df4ec739aacdf744a5c",
      "title": "Wow It Fits! — Secondhand Machine Learning",
      "summary": "",
      "content_text": "(There are a lot of pictures so it might take a while to load. This article is actually longer than it looks, because I use tabsets a lot.)\n§1 Intro This section is about tensor (high-dimensional matrix) and torch.nn.\n§1.1 Tensor In the rest of the article, we will always:\nimport torch import torch.nn as nn import torch.nn.functional as F from torchinfo import summary §1.1.1 Shape e.g. [H, W, C] (usually used in numpy or matplotlib.pyplot) or [C, H, W] (usually used in torch) or [batch_size, C, H, W].\ndummy = torch.randn(1, 3, 32, 32)# [batch_size, C, H, W] print(dummy.shape) will get:\ntorch.Size([1, 3, 32, 32]) Commonly used method to change the shape of a tensor:\n.view() .reshape() (.reshape() is for non-contiguous tensor, try .view() first. x.reshape() is equal to x.contiguous().view()) .unsqueeze() .squeeze() .transpose() .permute() einops provides a more intuitive way to change the shape.\n§1.1.2 Device torch.device\nTensor device\ndummy = torch.randn(1, 3, 32, 32) print(dummy.device) dummy = dummy.to(\u0026#39;cuda\u0026#39;) print(dummy.device) dummy = dummy.to(\u0026#39;cpu\u0026#39;) print(dummy.device) will get:\ncpu cuda:0 cpu Model device\nclass Model(nn.Module): def __init__(self): super().__init__() ... def forward(self, x): ... return x model = Model() model.to(\u0026#39;cuda\u0026#39;) Be on the same device\nAll tensors and objects (datasets, models) should be on the same device.\ndummy = torch.rand(1, 3, 32, 32).to(\u0026#39;cuda\u0026#39;) class Model(nn.Module): def __init__(self): super().__init__() self.conv1 = nn.Conv2d(3, 16, kernel_size=3, stride=1, padding=1) self.conv2 = nn.Conv2d(16, 32, kernel_size=3, stride=1, padding=1) self.fc1 = nn.Linear(32 * 32 * 32, 128) self.fc2 = nn.Linear(128, 10) def forward(self, x): x = F.relu(self.conv1(x)) x = F.relu(self.conv2(x)) x = x.view(x.size(0), -1) x = F.relu(self.fc1(x)) x = self.fc2(x) return x model = Model().to(\u0026#39;cuda\u0026#39;) print(model(dummy).shape) will get:\ntorch.Size([1, 10]) §1.1.3 Type torch.dtype\nnumpy.ndarray -\u0026gt; torch.Tensor:\nfloat64 -\u0026gt; float32\ndummy = np.random.rand(1, 3, 32, 32) print(dummy.dtype) dummy = torch.from_numpy(dummy) print(dummy.dtype) print(dummy.device) dummy = dummy.to(torch.float32) print(dummy.dtype) will get:\nfloat64 torch.float64 cpu torch.float32 torch.Tensor -\u0026gt; numpy.ndarray:\ncuda -\u0026gt; cpu, float32 -\u0026gt; float64\ndummy = torch.rand(1, 3, 32, 32).to(\u0026#39;cuda\u0026#39;) print(dummy.dtype) print(dummy.device) dummy = dummy.to(\u0026#39;cpu\u0026#39;) dummy = dummy.numpy() print(dummy.dtype) dummy = dummy.astype(\u0026#39;float64\u0026#39;) print(dummy.dtype) will get:\ntorch.float32 cuda:0 float32 float64 §1.2 torch.nn nn.Conv2d\nnn.Conv2d. Convolution is a kind of weighted mean.\nx = torch.randn(1, 3, 28, 28) print(x.shape) conv2d = nn.Conv2d(in_channels=3, out_channels=12, kernel_size=3) x = conv2d(x) print(x.shape) will get:\ntorch.Size([1, 3, 28, 28]) torch.Size([1, 12, 26, 26]) nn.MaxPool2d\nnn.MaxPool2d\nx = torch.randn(1, 3, 28, 28) print(x.shape) pool = nn.MaxPool2d(kernel_size=2) x = pool(x) print(x.shape) will get:\ntorch.Size([1, 3, 28, 28]) torch.Size([1, 3, 14, 14]) nn.BatchNorm2d\nnn.BatchNorm2d, See Fig.2 of [1803.08494] Group Normalization.\nbatchnorm = nn.BatchNorm2d(3) x = torch.randn(1, 3, 3, 3) print(x) x = batchnorm(x) print(x) nn.Linear\nnn.Linear. For fully connected layer.\nlinear = nn.Linear(3, 12) x = torch.randn(128, 3) x = linear(x) print(x.shape) will get:\ntorch.Size([128, 12]) nn.Dropout\nnn.Dropout. For fully connected layer. Using the samples in the Bernoulli distribution, some elements of the input tensor are randomly zeroed with probability $p$. To use it:\ndropout = nn.Dropout(p=0.5, inplace=False) x = dropout(x) x can be a tensor in any shape.\nnn.ReLU or F.relu\nnn.ReLU, F.relu. Activation function, $\\text{ReLU}(x)=\\max{(0,x)}$, to use it：\nx = nn.ReLU(x) or:\nx = F.relu(x) x can be a tensor in any shape.\nnn.RNN\nnn.RNN\ninput_size = 10 hidden_size = 20 num_layers = 2 seq_length = 5 batch_size = 3 rnn = nn.RNN(input_size, hidden_size, num_layers) input_data = torch.randn(seq_length, batch_size, input_size) output, hidden_state = rnn(input_data) print(output.shape) will get:\ntorch.Size([5, 3, 20]) nn.Module\nnn.Module. Construct a block of layers. It could be the entire model or just a block of the entire model or loss function, etc.\nclass MyBlock(nn.Module): def __init__(self): super().__init__() # define every layer self.conv1 = nn.Conv2d(1, 20, 5) self.conv2 = nn.Conv2d(20, 20, 5) def forward(self, x): # define forward propagation x = F.relu(self.conv1(x)) x = F.relu(self.conv2(x)) return x nn.Sequential\nnn.Sequential. Compared with nn.Module, nn.Sequential can add the layers more easily and don\u0026rsquo;t have to define forward propagation. This is more useful when building a simple neural network\nmodel = nn.Sequential( nn.Conv2d(1, 20, 5), nn.ReLU(), nn.Conv2d(20, 64, 5), ) x = torch.randn(1, 1, 30, 30) y = model(x) print(y.shape) will get:\ntorch.Size([1, 64, 22, 22]) §2 CNN MNIST is here for the purpose of introducing the pipeline of Machine Learning; AlexNet showed the power of cuda and deep neural network; ResNet is the most popular CNN to this day and residual connections are also used in Transformers.\n| CNN Explainer | Handwritten Digit Recognizer CNN |\n§2.1 MNIST | mnist (torch) | What is torch.nn really? | MNIST Benchmark | Deep Neural Nets: 33 years ago and 33 years from now |\nIn mnist (torch):\nclass Net(): def __init__(): def forward(): def train(): def test(): def main(): if __name__ == \u0026#39;__main__\u0026#39;: main() Cross Entropy Loss\nF.log_softmax, F.nll_loss, F.cross_entropy\npred = torch.randn(16, 10)# [batch_size, num_classes] target = torch.randint(10, (16,))# [batch_size,] print(F.nll_loss(F.log_softmax(pred, dim=1), target)) print(F.cross_entropy(pred, target)) will get:\ntensor(2.6026) tensor(2.6026)# same result class Net\nclass Net(nn.Module): def __init__(self): ... def forward(self, x): ... output = F.log_softmax(x, dim=1) return output summary(Net(), input_size=(16, 1, 28, 28))# [batch_size, C, H, W] will get:\n========================================================================================== Layer (type:depth-idx) Output Shape Param # ========================================================================================== Net [16, 10] -- ├─Conv2d: 1-1 [16, 32, 26, 26] 320 ├─Conv2d: 1-2 [16, 64, 24, 24] 18,496 ├─Dropout: 1-3 [16, 64, 12, 12] -- ├─Linear: 1-4 [16, 128] 1,179,776 ├─Dropout: 1-5 [16, 128] -- ├─Linear: 1-6 [16, 10] 1,290 ========================================================================================== Total params: 1,199,882 Trainable params: 1,199,882 Non-trainable params: 0 Total mult-adds (M): 192.82 ========================================================================================== Input size (MB): 0.05 Forward/backward pass size (MB): 7.51 Params size (MB): 4.80 Estimated Total Size (MB): 12.35 ========================================================================================== def train\ndef train(args, model, device, train_loader, optimizer, epoch): # set the model to training mode: activate dropout and batch normalization. model.train() # go through each batch. for batch_idx, (data, target) in enumerate(train_loader): # put data and target to device. data, target = data.to(device), target.to(device) # the optimizer\u0026#39;s gradient is reset to 0. optimizer.zero_grad() # forward pass. output = model(data) # calculate loss. loss = F.nll_loss(output, target) # calculate the gradients. loss.backward() # backward propagation. optimizer.step() # print loss if batch_idx % args.log_interval == 0: print(\u0026#39;Train Epoch: {} [{}/{} ({:.0f}%)]\\tLoss: {:.6f}\u0026#39;.format( epoch, batch_idx * len(data), len(train_loader.dataset), 100. * batch_idx / len(train_loader), loss.item())) # if `dry_run`, only run 1 epoch. if args.dry_run: break def test\ndef test(model, device, test_loader): # set the model to evaluation mode. model.eval() test_loss = 0 correct = 0 # gradient calculations are disabled. with torch.no_grad(): for data, target in test_loader: # put data and target to device. data, target = data.to(device), target.to(device) # forward pass. output = model(data) # calculate loss, sum up batch loss. test_loss += F.nll_loss(output, target, reduction=\u0026#39;sum\u0026#39;).item() # get the index of the max log-probability. pred = output.argmax(dim=1, keepdim=True) # compare predicted labels with target labels. correct += pred.eq(target.view_as(pred)).sum().item() # average loss per sample. test_loss /= len(test_loader.dataset) # print print(\u0026#39;\\nTest set: Average loss: {:.4f}, Accuracy: {}/{} ({:.0f}%)\\n\u0026#39;.format( test_loss, correct, len(test_loader.dataset), 100. * correct / len(test_loader.dataset))) def main\ndef main(): # Training settings parser = argparse.ArgumentParser(description=\u0026#39;PyTorch MNIST Example\u0026#39;) parser.add_argument(\u0026#39;--batch-size\u0026#39;, type=int, default=64, metavar=\u0026#39;N\u0026#39;, help=\u0026#39;input batch size for training (default: 64)\u0026#39;) parser.add_argument(\u0026#39;--test-batch-size\u0026#39;, type=int, default=1000, metavar=\u0026#39;N\u0026#39;, help=\u0026#39;input batch size for testing (default: 1000)\u0026#39;) parser.add_argument(\u0026#39;--epochs\u0026#39;, type=int, default=14, metavar=\u0026#39;N\u0026#39;, help=\u0026#39;number of epochs to train (default: 14)\u0026#39;) parser.add_argument(\u0026#39;--lr\u0026#39;, type=float, default=1.0, metavar=\u0026#39;LR\u0026#39;, help=\u0026#39;learning rate (default: 1.0)\u0026#39;) parser.add_argument(\u0026#39;--gamma\u0026#39;, type=float, default=0.7, metavar=\u0026#39;M\u0026#39;, help=\u0026#39;Learning rate step gamma (default: 0.7)\u0026#39;) parser.add_argument(\u0026#39;--no-cuda\u0026#39;, action=\u0026#39;store_true\u0026#39;, default=False, help=\u0026#39;disables CUDA training\u0026#39;) parser.add_argument(\u0026#39;--no-mps\u0026#39;, action=\u0026#39;store_true\u0026#39;, default=False, help=\u0026#39;disables macOS GPU training\u0026#39;) parser.add_argument(\u0026#39;--dry-run\u0026#39;, action=\u0026#39;store_true\u0026#39;, default=False, help=\u0026#39;quickly check a single pass\u0026#39;) parser.add_argument(\u0026#39;--seed\u0026#39;, type=int, default=1, metavar=\u0026#39;S\u0026#39;, help=\u0026#39;random seed (default: 1)\u0026#39;) parser.add_argument(\u0026#39;--log-interval\u0026#39;, type=int, default=10, metavar=\u0026#39;N\u0026#39;, help=\u0026#39;how many batches to wait before logging training status\u0026#39;) parser.add_argument(\u0026#39;--save-model\u0026#39;, action=\u0026#39;store_true\u0026#39;, default=False, help=\u0026#39;For Saving the current Model\u0026#39;) args = parser.parse_args() use_cuda = not args.no_cuda and torch.cuda.is_available() use_mps = not args.no_mps and torch.backends.mps.is_available() torch.manual_seed(args.seed) if use_cuda: device = torch.device(\u0026#34;cuda\u0026#34;) elif use_mps: device = torch.device(\u0026#34;mps\u0026#34;) else: device = torch.device(\u0026#34;cpu\u0026#34;) train_kwargs = {\u0026#39;batch_size\u0026#39;: args.batch_size} test_kwargs = {\u0026#39;batch_size\u0026#39;: args.test_batch_size} if use_cuda: cuda_kwargs = {\u0026#39;num_workers\u0026#39;: 1, \u0026#39;pin_memory\u0026#39;: True, \u0026#39;shuffle\u0026#39;: True} train_kwargs.update(cuda_kwargs) test_kwargs.update(cuda_kwargs) # https://pytorch.org/vision/stable/transforms.html transform=transforms.Compose([ transforms.ToTensor(), transforms.Normalize((0.1307,), (0.3081,)) ]) # load training dataset and testing dataset dataset1 = datasets.MNIST(\u0026#39;../data\u0026#39;, train=True, download=True, transform=transform) dataset2 = datasets.MNIST(\u0026#39;../data\u0026#39;, train=False, transform=transform) train_loader = torch.utils.data.DataLoader(dataset1,**train_kwargs) test_loader = torch.utils.data.DataLoader(dataset2, **test_kwargs) # put model to device model = Net().to(device) # set optimizer and scheduler optimizer = optim.Adadelta(model.parameters(), lr=args.lr) scheduler = StepLR(optimizer, step_size=1, gamma=args.gamma) # train and test for epoch in range(1, args.epochs + 1): train(args, model, device, train_loader, optimizer, epoch) test(model, device, test_loader) scheduler.step() # save model if args.save_model: torch.save(model.state_dict(), \u0026#34;mnist_cnn.pt\u0026#34;) Later we will use fastai instead of writing def train, def test, def main from scratch.\npython main.py will get (full log see 02_mnist.log):\nDownloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ../data/MNIST/raw/train-images-idx3-ubyte.gz 100% 9912422/9912422 [00:00\u0026lt;00:00, 96238958.45it/s] Extracting ../data/MNIST/raw/train-images-idx3-ubyte.gz to ../data/MNIST/raw Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ../data/MNIST/raw/train-labels-idx1-ubyte.gz 100% 28881/28881 [00:00\u0026lt;00:00, 151799115.07it/s] Extracting ../data/MNIST/raw/train-labels-idx1-ubyte.gz to ../data/MNIST/raw Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ../data/MNIST/raw/t10k-images-idx3-ubyte.gz 100% 1648877/1648877 [00:00\u0026lt;00:00, 27617389.31it/s] Extracting ../data/MNIST/raw/t10k-images-idx3-ubyte.gz to ../data/MNIST/raw Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ../data/MNIST/raw/t10k-labels-idx1-ubyte.gz 100% 4542/4542 [00:00\u0026lt;00:00, 20180644.88it/s] Extracting ../data/MNIST/raw/t10k-labels-idx1-ubyte.gz to ../data/MNIST/raw Train Epoch: 1 [0/60000 (0%)]\tLoss: 2.282550 Train Epoch: 1 [640/60000 (1%)]\tLoss: 1.384441 ... Train Epoch: 1 [58880/60000 (98%)]\tLoss: 0.064402 Train Epoch: 1 [59520/60000 (99%)]\tLoss: 0.033435 Test set: Average loss: 0.0468, Accuracy: 9842/10000 (98%) Train Epoch: 2 [0/60000 (0%)]\tLoss: 0.098867 Train Epoch: 2 [640/60000 (1%)]\tLoss: 0.016046 ... Train Epoch: 2 [58880/60000 (98%)]\tLoss: 0.108346 Train Epoch: 2 [59520/60000 (99%)]\tLoss: 0.108657 Test set: Average loss: 0.0327, Accuracy: 9894/10000 (99%) ... Test set: Average loss: 0.0346, Accuracy: 9887/10000 (99%) ... Test set: Average loss: 0.0314, Accuracy: 9891/10000 (99%) ... Test set: Average loss: 0.0301, Accuracy: 9903/10000 (99%) ... Test set: Average loss: 0.0301, Accuracy: 9913/10000 (99%) ... Test set: Average loss: 0.0293, Accuracy: 9918/10000 (99%) ... Test set: Average loss: 0.0295, Accuracy: 9919/10000 (99%) ... Test set: Average loss: 0.0296, Accuracy: 9915/10000 (99%) ... Test set: Average loss: 0.0277, Accuracy: 9919/10000 (99%) ... Test set: Average loss: 0.0284, Accuracy: 9922/10000 (99%) ... Test set: Average loss: 0.0272, Accuracy: 9922/10000 (99%) ... Test set: Average loss: 0.0278, Accuracy: 9921/10000 (99%) ... Test set: Average loss: 0.0278, Accuracy: 9922/10000 (99%) §2.2 AlexNet: Deep Learning Revolution ImageNet: 14,197,122 images, 21841 synsets indexed.\n| paper | torchvision.models.alexnet | AlexNet (pytorch.org) |\nMethods Do we use it today? 2 GPUs: written in cuda, split into 2 different pipelines with connection. ✔️\u0026amp;✖️ Simple activation function ReLU ($\\text{ReLU} (x) = \\max{(0,x)}$), instead of Tanh ($\\text{Tanh} (x) = \\tanh{(x)}$) or Sigmoid ($\\sigma (x)= (1+e^{-x})^{-1}$). ✔️ Local response normalization ✖️ Overlapping pooling ✖️ The feature map ($C$) keeps increasing (3 $\\to$ 48 $\\to$ 128 $\\to$ 192 $\\to$ 128), while the resolution ($H$, $W$) keeps decreasing (224 $\\to$ 55 $\\to$ 27 $\\to$ 13 $\\to$ 13 $\\to$ 13). ✔️ Kernel size keeps decreasing (11 $\\to$ 5 $\\to$ 3 $\\to$ 3 $\\to$ 3) ✖️, same kernel size 3, see ResNet below Multiple linear layers. (take most of the parameters, 55M/61M) ✖️ Data augmentation (Image translations and horizontal reflections, color jitter) ✔️, actually this is more data Dropout ✔️ summary(AlexNet(), input_size=(16, 3, 224, 224)) will get:\n========================================================================================== Layer (type:depth-idx) Output Shape Param # ========================================================================================== AlexNet [16, 1000] -- ├─Sequential: 1-1 [16, 256, 6, 6] -- │ └─Conv2d: 2-1 [16, 64, 55, 55] 23,296 │ └─ReLU: 2-2 [16, 64, 55, 55] -- │ └─MaxPool2d: 2-3 [16, 64, 27, 27] -- │ └─Conv2d: 2-4 [16, 192, 27, 27] 307,392 │ └─ReLU: 2-5 [16, 192, 27, 27] -- │ └─MaxPool2d: 2-6 [16, 192, 13, 13] -- │ └─Conv2d: 2-7 [16, 384, 13, 13] 663,936 │ └─ReLU: 2-8 [16, 384, 13, 13] -- │ └─Conv2d: 2-9 [16, 256, 13, 13] 884,992 │ └─ReLU: 2-10 [16, 256, 13, 13] -- │ └─Conv2d: 2-11 [16, 256, 13, 13] 590,080 │ └─ReLU: 2-12 [16, 256, 13, 13] -- │ └─MaxPool2d: 2-13 [16, 256, 6, 6] -- ├─AdaptiveAvgPool2d: 1-2 [16, 256, 6, 6] -- ├─Sequential: 1-3 [16, 1000] -- │ └─Dropout: 2-14 [16, 9216] -- │ └─Linear: 2-15 [16, 4096] 37,752,832 │ └─ReLU: 2-16 [16, 4096] -- │ └─Dropout: 2-17 [16, 4096] -- │ └─Linear: 2-18 [16, 4096] 16,781,312 │ └─ReLU: 2-19 [16, 4096] -- │ └─Linear: 2-20 [16, 1000] 4,097,000 ========================================================================================== Total params: 61,100,840 Trainable params: 61,100,840 Non-trainable params: 0 Total mult-adds (G): 11.43 ========================================================================================== Input size (MB): 9.63 Forward/backward pass size (MB): 63.26 Params size (MB): 244.40 Estimated Total Size (MB): 317.29 ========================================================================================== §2.3 ResNet: Deeper | paper | torchvision.models.resnet | ResNet (pytorch.org) |\nProblem: With deeper layers, the loss goes upwards (see Fig.1 of the paper), but even if all the added layers are identity functions, the loss would be the same.\nMethods Do we use it today? Residual connections to learn the differences and go deeper (50, 101, 152, 1202 layers, with 0.85M parameters to 19.4M parameters) ✔️ The feature map ($C$) keeps increasing (64 $\\to$ 128 $\\to$ 256 $\\to$ 512), while the number of the resolution ($H$, $W$) keeps decreasing (224 $\\to$ 112 $\\to$ 56 $\\to$ 28 $\\to$ 14 $\\to$ 7 $\\to$ 1). ✔️ Stride 2 convolution kernel, instead of pooling ✔️ Bottleneck building block: $1 \\times 1$ convolution kernel ✔️\u0026amp;✖️ Adopt batch normalization (BN) right after each convolution and before activation ✔️\u0026amp;✖️, ongoing debate Basically residual is:\nSorry, not that \u0026ldquo;residual\u0026rdquo;. 🤣\nclass Res(nn.Module): def __init__(self): super.__init__() ... def forward(self, x): residual = x x = ...(x) x += residual residual = x x = ...(x) x += residual return x By using residual connections, the model will learn linearity first and non-linearity after. We will see residual connections in Transformers.\ntorchvision.models.resnet\ndef conv3x3(): def conv1x1(): class BasicBlock(): def __init__(): def forward(): class Bottleneck(): def __init__(): def forward(): class ResNet(): def __init__(): def _make_layer(): def _forward_impl(): def forward(): class ResNet18_Weights(): ... def resnet18(): ... To use it:\nfrom torchvision.models.resnet import resnet18 model = resnet18() summary(model, input_size=(16, 3, 224, 224)) or\nmodel = torch.hub.load(\u0026#39;pytorch/vision:v0.10.0\u0026#39;, \u0026#39;resnet18\u0026#39;, pretrained=True) summary(model, input_size=(16, 3, 224, 224)) will get:\nDownloading: \u0026#34;https://github.com/pytorch/vision/zipball/v0.10.0\u0026#34; to /root/.cache/torch/hub/v0.10.0.zip /usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:208: UserWarning: The parameter \u0026#39;pretrained\u0026#39; is deprecated since 0.13 and may be removed in the future, please use \u0026#39;weights\u0026#39; instead. warnings.warn( /usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for \u0026#39;weights\u0026#39; are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights. warnings.warn(msg) Downloading: \u0026#34;https://download.pytorch.org/models/resnet18-f37072fd.pth\u0026#34; to /root/.cache/torch/hub/checkpoints/resnet18-f37072fd.pth 100%|██████████| 44.7M/44.7M [00:00\u0026lt;00:00, 114MB/s] ========================================================================================== Layer (type:depth-idx) Output Shape Param # ========================================================================================== ResNet [16, 1000] -- ├─Conv2d: 1-1 [16, 64, 112, 112] 9,408 ├─BatchNorm2d: 1-2 [16, 64, 112, 112] 128 ├─ReLU: 1-3 [16, 64, 112, 112] -- ├─MaxPool2d: 1-4 [16, 64, 56, 56] -- ├─Sequential: 1-5 [16, 64, 56, 56] -- │ └─BasicBlock: 2-1 [16, 64, 56, 56] -- │ │ └─Conv2d: 3-1 [16, 64, 56, 56] 36,864 │ │ └─BatchNorm2d: 3-2 [16, 64, 56, 56] 128 │ │ └─ReLU: 3-3 [16, 64, 56, 56] -- │ │ └─Conv2d: 3-4 [16, 64, 56, 56] 36,864 │ │ └─BatchNorm2d: 3-5 [16, 64, 56, 56] 128 │ │ └─ReLU: 3-6 [16, 64, 56, 56] -- │ └─BasicBlock: 2-2 [16, 64, 56, 56] -- │ │ └─Conv2d: 3-7 [16, 64, 56, 56] 36,864 │ │ └─BatchNorm2d: 3-8 [16, 64, 56, 56] 128 │ │ └─ReLU: 3-9 [16, 64, 56, 56] -- │ │ └─Conv2d: 3-10 [16, 64, 56, 56] 36,864 │ │ └─BatchNorm2d: 3-11 [16, 64, 56, 56] 128 │ │ └─ReLU: 3-12 [16, 64, 56, 56] -- ├─Sequential: 1-6 [16, 128, 28, 28] -- │ └─BasicBlock: 2-3 [16, 128, 28, 28] -- │ │ └─Conv2d: 3-13 [16, 128, 28, 28] 73,728 │ │ └─BatchNorm2d: 3-14 [16, 128, 28, 28] 256 │ │ └─ReLU: 3-15 [16, 128, 28, 28] -- │ │ └─Conv2d: 3-16 [16, 128, 28, 28] 147,456 │ │ └─BatchNorm2d: 3-17 [16, 128, 28, 28] 256 │ │ └─Sequential: 3-18 [16, 128, 28, 28] 8,448 │ │ └─ReLU: 3-19 [16, 128, 28, 28] -- │ └─BasicBlock: 2-4 [16, 128, 28, 28] -- │ │ └─Conv2d: 3-20 [16, 128, 28, 28] 147,456 │ │ └─BatchNorm2d: 3-21 [16, 128, 28, 28] 256 │ │ └─ReLU: 3-22 [16, 128, 28, 28] -- │ │ └─Conv2d: 3-23 [16, 128, 28, 28] 147,456 │ │ └─BatchNorm2d: 3-24 [16, 128, 28, 28] 256 │ │ └─ReLU: 3-25 [16, 128, 28, 28] -- ├─Sequential: 1-7 [16, 256, 14, 14] -- │ └─BasicBlock: 2-5 [16, 256, 14, 14] -- │ │ └─Conv2d: 3-26 [16, 256, 14, 14] 294,912 │ │ └─BatchNorm2d: 3-27 [16, 256, 14, 14] 512 │ │ └─ReLU: 3-28 [16, 256, 14, 14] -- │ │ └─Conv2d: 3-29 [16, 256, 14, 14] 589,824 │ │ └─BatchNorm2d: 3-30 [16, 256, 14, 14] 512 │ │ └─Sequential: 3-31 [16, 256, 14, 14] 33,280 │ │ └─ReLU: 3-32 [16, 256, 14, 14] -- │ └─BasicBlock: 2-6 [16, 256, 14, 14] -- │ │ └─Conv2d: 3-33 [16, 256, 14, 14] 589,824 │ │ └─BatchNorm2d: 3-34 [16, 256, 14, 14] 512 │ │ └─ReLU: 3-35 [16, 256, 14, 14] -- │ │ └─Conv2d: 3-36 [16, 256, 14, 14] 589,824 │ │ └─BatchNorm2d: 3-37 [16, 256, 14, 14] 512 │ │ └─ReLU: 3-38 [16, 256, 14, 14] -- ├─Sequential: 1-8 [16, 512, 7, 7] -- │ └─BasicBlock: 2-7 [16, 512, 7, 7] -- │ │ └─Conv2d: 3-39 [16, 512, 7, 7] 1,179,648 │ │ └─BatchNorm2d: 3-40 [16, 512, 7, 7] 1,024 │ │ └─ReLU: 3-41 [16, 512, 7, 7] -- │ │ └─Conv2d: 3-42 [16, 512, 7, 7] 2,359,296 │ │ └─BatchNorm2d: 3-43 [16, 512, 7, 7] 1,024 │ │ └─Sequential: 3-44 [16, 512, 7, 7] 132,096 │ │ └─ReLU: 3-45 [16, 512, 7, 7] -- │ └─BasicBlock: 2-8 [16, 512, 7, 7] -- │ │ └─Conv2d: 3-46 [16, 512, 7, 7] 2,359,296 │ │ └─BatchNorm2d: 3-47 [16, 512, 7, 7] 1,024 │ │ └─ReLU: 3-48 [16, 512, 7, 7] -- │ │ └─Conv2d: 3-49 [16, 512, 7, 7] 2,359,296 │ │ └─BatchNorm2d: 3-50 [16, 512, 7, 7] 1,024 │ │ └─ReLU: 3-51 [16, 512, 7, 7] -- ├─AdaptiveAvgPool2d: 1-9 [16, 512, 1, 1] -- ├─Linear: 1-10 [16, 1000] 513,000 ========================================================================================== Total params: 11,689,512 Trainable params: 11,689,512 Non-trainable params: 0 Total mult-adds (G): 29.03 ========================================================================================== Input size (MB): 9.63 Forward/backward pass size (MB): 635.96 Params size (MB): 46.76 Estimated Total Size (MB): 692.35 ========================================================================================== Homemade ResNet18\nclass ResidualBlock(nn.Module): def __init__(self, in_channels, out_channels, stride=1): super().__init__() self.conv1 = nn.Conv2d(in_channels, out_channels, kernel_size=3, stride=stride, padding=1, bias=False) self.bn1 = nn.BatchNorm2d(out_channels) self.relu = nn.ReLU() self.conv2 = nn.Conv2d(out_channels, out_channels, kernel_size=3, stride=1, padding=1, bias=False) self.bn2 = nn.BatchNorm2d(out_channels) if stride != 1 or in_channels != out_channels: self.residual = nn.Sequential( nn.Conv2d(in_channels, out_channels, stride=stride, kernel_size=1, bias=False), nn.BatchNorm2d(out_channels) ) else: self.residual = nn.Identity() def forward(self, x): residual = x x = self.conv1(x) x = self.bn1(x) x = self.relu(x) x = self.conv2(x) x = self.bn2(x) x += self.residual(residual) x = self.relu(x) return x class ResNet18(nn.Module): def __init__(self, num_classes=1000): super().__init__() self.conv1 = nn.Conv2d(3, 64, kernel_size=7, stride=2, padding=3, bias=False) self.bn1 = nn.BatchNorm2d(64) self.relu = nn.ReLU() self.maxpool = nn.MaxPool2d(kernel_size=3, stride=2, padding=1) self.layer1 = self._make_layer(64, 64, num_layers=2, stride=1) self.layer2 = self._make_layer(64, 128, num_layers=2, stride=2) self.layer3 = self._make_layer(128, 256, num_layers=2, stride=2) self.layer4 = self._make_layer(256, 512, num_layers=2, stride=2) self.avgpool = nn.AdaptiveAvgPool2d((1,1)) self.fc = nn.Linear(512, num_classes)# fully connected def _make_layer(self, in_channels, out_channels, num_layers, stride=1): layers = [] layers.append(ResidualBlock(in_channels, out_channels, stride)) for _ in range(1, num_layers): layers.append(ResidualBlock(out_channels, out_channels)) return nn.Sequential(*layers) def forward(self, x): x = self.conv1(x) x = self.bn1(x) x = self.relu(x) x = self.maxpool(x) x = self.layer1(x) x = self.layer2(x) x = self.layer3(x) x = self.layer4(x) x = self.avgpool(x) x = x.view(x.size(0), -1) x = self.fc(x) return x summary(ResNet18(), input_size = (16, 3, 224, 224)) will get:\n========================================================================================== Layer (type:depth-idx) Output Shape Param # ========================================================================================== ResNet18 [16, 1000] -- ├─Conv2d: 1-1 [16, 64, 112, 112] 9,408 ├─BatchNorm2d: 1-2 [16, 64, 112, 112] 128 ├─ReLU: 1-3 [16, 64, 112, 112] -- ├─MaxPool2d: 1-4 [16, 64, 56, 56] -- ├─Sequential: 1-5 [16, 64, 56, 56] -- │ └─ResidualBlock: 2-1 [16, 64, 56, 56] -- │ │ └─Conv2d: 3-1 [16, 64, 56, 56] 36,864 │ │ └─BatchNorm2d: 3-2 [16, 64, 56, 56] 128 │ │ └─ReLU: 3-3 [16, 64, 56, 56] -- │ │ └─Conv2d: 3-4 [16, 64, 56, 56] 36,864 │ │ └─BatchNorm2d: 3-5 [16, 64, 56, 56] 128 │ │ └─Identity: 3-6 [16, 64, 56, 56] -- │ │ └─ReLU: 3-7 [16, 64, 56, 56] -- │ └─ResidualBlock: 2-2 [16, 64, 56, 56] -- │ │ └─Conv2d: 3-8 [16, 64, 56, 56] 36,864 │ │ └─BatchNorm2d: 3-9 [16, 64, 56, 56] 128 │ │ └─ReLU: 3-10 [16, 64, 56, 56] -- │ │ └─Conv2d: 3-11 [16, 64, 56, 56] 36,864 │ │ └─BatchNorm2d: 3-12 [16, 64, 56, 56] 128 │ │ └─Identity: 3-13 [16, 64, 56, 56] -- │ │ └─ReLU: 3-14 [16, 64, 56, 56] -- ├─Sequential: 1-6 [16, 128, 28, 28] -- │ └─ResidualBlock: 2-3 [16, 128, 28, 28] -- │ │ └─Conv2d: 3-15 [16, 128, 28, 28] 73,728 │ │ └─BatchNorm2d: 3-16 [16, 128, 28, 28] 256 │ │ └─ReLU: 3-17 [16, 128, 28, 28] -- │ │ └─Conv2d: 3-18 [16, 128, 28, 28] 147,456 │ │ └─BatchNorm2d: 3-19 [16, 128, 28, 28] 256 │ │ └─Sequential: 3-20 [16, 128, 28, 28] 8,448 │ │ └─ReLU: 3-21 [16, 128, 28, 28] -- │ └─ResidualBlock: 2-4 [16, 128, 28, 28] -- │ │ └─Conv2d: 3-22 [16, 128, 28, 28] 147,456 │ │ └─BatchNorm2d: 3-23 [16, 128, 28, 28] 256 │ │ └─ReLU: 3-24 [16, 128, 28, 28] -- │ │ └─Conv2d: 3-25 [16, 128, 28, 28] 147,456 │ │ └─BatchNorm2d: 3-26 [16, 128, 28, 28] 256 │ │ └─Identity: 3-27 [16, 128, 28, 28] -- │ │ └─ReLU: 3-28 [16, 128, 28, 28] -- ├─Sequential: 1-7 [16, 256, 14, 14] -- │ └─ResidualBlock: 2-5 [16, 256, 14, 14] -- │ │ └─Conv2d: 3-29 [16, 256, 14, 14] 294,912 │ │ └─BatchNorm2d: 3-30 [16, 256, 14, 14] 512 │ │ └─ReLU: 3-31 [16, 256, 14, 14] -- │ │ └─Conv2d: 3-32 [16, 256, 14, 14] 589,824 │ │ └─BatchNorm2d: 3-33 [16, 256, 14, 14] 512 │ │ └─Sequential: 3-34 [16, 256, 14, 14] 33,280 │ │ └─ReLU: 3-35 [16, 256, 14, 14] -- │ └─ResidualBlock: 2-6 [16, 256, 14, 14] -- │ │ └─Conv2d: 3-36 [16, 256, 14, 14] 589,824 │ │ └─BatchNorm2d: 3-37 [16, 256, 14, 14] 512 │ │ └─ReLU: 3-38 [16, 256, 14, 14] -- │ │ └─Conv2d: 3-39 [16, 256, 14, 14] 589,824 │ │ └─BatchNorm2d: 3-40 [16, 256, 14, 14] 512 │ │ └─Identity: 3-41 [16, 256, 14, 14] -- │ │ └─ReLU: 3-42 [16, 256, 14, 14] -- ├─Sequential: 1-8 [16, 512, 7, 7] -- │ └─ResidualBlock: 2-7 [16, 512, 7, 7] -- │ │ └─Conv2d: 3-43 [16, 512, 7, 7] 1,179,648 │ │ └─BatchNorm2d: 3-44 [16, 512, 7, 7] 1,024 │ │ └─ReLU: 3-45 [16, 512, 7, 7] -- │ │ └─Conv2d: 3-46 [16, 512, 7, 7] 2,359,296 │ │ └─BatchNorm2d: 3-47 [16, 512, 7, 7] 1,024 │ │ └─Sequential: 3-48 [16, 512, 7, 7] 132,096 │ │ └─ReLU: 3-49 [16, 512, 7, 7] -- │ └─ResidualBlock: 2-8 [16, 512, 7, 7] -- │ │ └─Conv2d: 3-50 [16, 512, 7, 7] 2,359,296 │ │ └─BatchNorm2d: 3-51 [16, 512, 7, 7] 1,024 │ │ └─ReLU: 3-52 [16, 512, 7, 7] -- │ │ └─Conv2d: 3-53 [16, 512, 7, 7] 2,359,296 │ │ └─BatchNorm2d: 3-54 [16, 512, 7, 7] 1,024 │ │ └─Identity: 3-55 [16, 512, 7, 7] -- │ │ └─ReLU: 3-56 [16, 512, 7, 7] -- ├─AdaptiveAvgPool2d: 1-9 [16, 512, 1, 1] -- ├─Linear: 1-10 [16, 1000] 513,000 ========================================================================================== Total params: 11,689,512 Trainable params: 11,689,512 Non-trainable params: 0 Total mult-adds (G): 29.03 ========================================================================================== Input size (MB): 9.63 Forward/backward pass size (MB): 635.96 Params size (MB): 46.76 Estimated Total Size (MB): 692.35 ========================================================================================== §3 Transformer Transformer is a general function fitter.\n§3.1 Embedding Embedding is ordered higher-dimensional representation vectors.\n§3.1.1 nn.Embedding Words in hidden_dim vector space: $\\vec{R} + \\vec{L} = \\vec{J}$, $\\vec{king} - \\vec{man} = \\vec{queen} - \\vec{woman}$.\ntiktoken, Tiktokenizer\nnn.Embedding\nnn.Embedding\nNUM_INDEX = 3 EMBEDDING_DIM = 4 embedding = nn.Embedding(NUM_INDEX, EMBEDDING_DIM) print(embedding.weight.detach()) index = torch.LongTensor([2, 0]) print(embedding(index)) will get:\ntensor([[ 0.0378, 1.0396, -0.9673, 0.9697], [-0.7824, 1.8141, 0.5336, -1.6396], [ 0.1903, 0.6592, 1.4589, -0.6018]]) tensor([[ 0.1903, 0.6592, 1.4589, -0.6018], [ 0.0378, 1.0396, -0.9673, 0.9697]], grad_fn=\u0026lt;EmbeddingBackward0\u0026gt;) F.one_hot then linear\nF.one_hot\none_hot = F.one_hot(index, num_classes=NUM_INDEX) print(one_hot) linear = nn.Linear(NUM_INDEX, EMBEDDING_DIM, bias=False) linear.weight = nn.Parameter(embedding.weight.T.detach()) print(linear(one_hot.float())) will get:\ntensor([[0, 0, 1], [1, 0, 0]]) tensor([[ 0.1903, 0.6592, 1.4589, -0.6018], [ 0.0378, 1.0396, -0.9673, 0.9697]], grad_fn=\u0026lt;MmBackward0\u0026gt;)# same result §3.1.2 Sinusoidal Positional Embedding class Embedding\nclass Embedding(nn.Module): def __init__(self, hidden_dim=768, vocab_size=50257): super().__init__() self.embedding = nn.Embedding(vocab_size, hidden_dim) self.hidden_dim = hidden_dim def forward(self, x): return self.embedding(x) * math.sqrt(self.hidden_dim) class PositionalEncoding\nThe positional encoding $$\\begin{aligned} PE_{(pos, 2i)} \u0026amp;= \\sin(\\frac{pos}{ 10000^{2i/{d_{model}}}}) \\\\ PE_{(pos, 2i + 1)} \u0026amp;= \\cos(\\frac{pos}{10000^{2i/{d_{model}}}}) \\end{aligned}$$, where $pos$ is each element in the sequence up to vocab_size, and $d_{model}$ is hidden_dim.\nclass PositionalEncoding(nn.Module): def __init__(self, hidden_dim=768, vocab_size=50257, dropout=0.0): super().__init__() self.dropout = nn.Dropout(dropout) pe = torch.zeros(vocab_size, hidden_dim) position = torch.arange(0, vocab_size).unsqueeze(1) div_term = torch.exp(torch.arange(0, hidden_dim, 2) * -(math.log(10000.0) / hidden_dim)) pe[:, 0::2] = torch.sin(position * div_term) pe[:, 1::2] = torch.cos(position * div_term) pe = pe.unsqueeze(0) self.pe = pe def forward(self, x): seq_length = x.shape[1] x = x + self.pe[:, :seq_length].requires_grad_(False) return self.dropout(x) testing\ndummy = torch.randint(50257, (1, 196))# [batch_size, seq_length], words as int numbers embeddings = Embedding() dummy = embeddings(dummy) print(dummy.shape)# [batch_size, seq_length, hidden_dim] positional_encoding = PositionalEncoding() dummy = positional_encoding(dummy) print(dummy.shape)# [batch_size, seq_length, hidden_dim] will get:\ntorch.Size([1, 196, 768]) torch.Size([1, 196, 768]) We will often see another way to write it:\nclass SinusoidalPosEmb\nclass SinusoidalPosEmb(nn.Module): def __init__(self, hidden_dim=768, M=10000): super().__init__() self.hidden_dim = hidden_dim self.M = M def forward(self, x): device = x.device half_dim = self.hidden_dim // 2 emb = math.log(self.M) / half_dim emb = torch.exp(torch.arange(half_dim, device=device) * (-emb)) emb = x[..., None] * emb[None, ...] emb = torch.cat((emb.sin(), emb.cos()), dim=-1) return emb testing\ndummy = torch.rand(1, 196)# [batch_size, seq_length], words as float numbers sinusoidal_pos_emb = SinusoidalPosEmb() dummy = sinusoidal_pos_emb(dummy) print(dummy.shape)# [batch_size, seq_length, hidden_dim] will get:\ntorch.Size([1, 196, 768]) §3.2 Transformer Encoder §3.2.1 FFN (MLP) A Neural Probabilistic Language Model\nEquation\nFeed Forward Network works on each [seq_length, ] vector individually $$\\text{FFN}(x)=(\\text{ReLU}(xW_1+b_1))W_2+b_2$$, where $\\text{ReLU}(x)=\\max{(0,x)}$. Here we replace nn.ReLU with nn.GELU.\nclass FFN\nclass FFN(nn.Module): def __init__(self, in_features=768, hidden_features=3072, out_features=768, dropout=0.0): super().__init__() self.linear1 = nn.Linear(in_features, hidden_features) self.act = nn.GELU() self.dropout = nn.Dropout(dropout) self.linear2 = nn.Linear(hidden_features, out_features) def forward(self, x): x = self.linear1(x) x = self.act(x) x = self.dropout(x) x = self.linear2(x) return x testing\ndummy = torch.rand(1, 196, 768)# [batch_size, seq_length, hidden_dim] ffn = FFN() dummy = ffn(dummy) print(dummy.shape) will get:\ntorch.Size([1, 196, 768]) §3.2.2 MultiheadAttention nn.MultiheadAttention, F.scaled_dot_product_attention, FlexAttention\nEquation\nSelf-Attention: Given an input $x$, we will get query $Q$, key $K$, value $V$ by $$\\begin{aligned} Q\u0026amp;=xW^Q \\\\ K\u0026amp;=xW^K \\\\ V\u0026amp;=xW^V\\end{aligned}$$Then $$\\text{Attention}(Q, K, V) = \\frac{1}{\\sqrt{d_{k}}}\\text{Softmax}(QK^\\mathsf{T})V$$, where for a vector $\\vec{z_i}$, $\\text{Softmax}(\\vec{z_i}) = \\frac{e^{\\vec{z_i}}}{\\sum_{i=0}^N e^{\\vec{z_i}}}$, and $$\\text{MultiheadAttention} (Q, K, V) = \\text{Concat}(\\text{head}_1, \\cdots, \\text{head}_h) W^O$$, where $\\text{head}_i = \\text{Attention} (xW^Q_i, xW^K_i, xW^V_i)$, and $h$ is num_heads in the code.\nThe advantage of Softmax:\nMatthew effect Non-linearity Normalization Note that in the figure below, only q_size = k_size is necessary. But in the code, q_size = k_size = v_size = hidden_dim.\nclass MultiheadAttention\nclass MultiheadAttention(nn.Module): def __init__(self, hidden_dim=768, num_heads=12, dropout=0.0): super().__init__() self.num_heads = num_heads self.scale = (hidden_dim // num_heads) ** -0.5 self.w_qkv = nn.Linear(hidden_dim, hidden_dim * 3) self.w_o = nn.Linear(hidden_dim, hidden_dim) self.dropout = nn.Dropout(dropout) def forward(self, x, is_causal=False): batch_size, seq_length, hidden_dim = x.shape qkv = self.w_qkv(x)# [batch_size, seq_length, hidden_dim * 3] qkv = qkv.view(batch_size, seq_length, 3, self.num_heads, -1)# [batch_size, seq_length, 3, num_heads, hidden_dim // num_heads] qkv = qkv.permute(2, 0, 3, 1, 4)# [3, batch_size, num_heads, seq_length, hidden_dim // num_heads] q, k, v = qkv# q, k, v shape: [batch_size, num_heads, seq_length, hidden_dim // num_heads] # attn shape: [batch_size, num_heads, seq_length, seq_length] attn = self.scale * q @ (k.transpose(-2, -1))# `torch.matmul` if is_causal:# masked/causal attention attn = attn.masked_fill_(# `torch.Tensor.masked_fill_`, add mask by broadcasting torch.triu(torch.ones((seq_length, seq_length), dtype=torch.bool), diagonal=1), float(\u0026#39;-inf\u0026#39;) ) attn = attn.softmax(dim=-1) attn = self.dropout(attn) x = attn @ v# [batch_size, num_heads, seq_length, hidden_dim // num_heads] x = x.transpose(1, 2)# [batch_size, seq_length, num_heads, hidden_dim // num_heads] x = x.reshape(batch_size, seq_length, hidden_dim)# [batch_size, seq_length, hidden_dim] x = self.w_o(x)# [batch_size, seq_length, hidden_dim] x = self.dropout(x) return x testing\nAdd 4 lines of print():\nclass MultiheadAttention(nn.Module): def __init__(self, hidden_dim=768, num_heads=12, dropout=0.0): super().__init__() self.num_heads = num_heads self.scale = (hidden_dim // num_heads) ** -0.5 self.w_qkv = nn.Linear(hidden_dim, hidden_dim * 3) self.w_o = nn.Linear(hidden_dim, hidden_dim) self.dropout = nn.Dropout(dropout) def forward(self, x, is_causal=False): batch_size, seq_length, hidden_dim = x.shape qkv = self.w_qkv(x)# [batch_size, seq_length, hidden_dim * 3] qkv = qkv.view(batch_size, seq_length, 3, self.num_heads, -1)# [batch_size, seq_length, 3, num_heads, hidden_dim // num_heads] qkv = qkv.permute(2, 0, 3, 1, 4)# [3, batch_size, num_heads, seq_length, hidden_dim // num_heads] q, k, v = qkv# q, k, v shape: [batch_size, num_heads, seq_length, hidden_dim // num_heads] # attn shape: [batch_size, num_heads, seq_length, seq_length] attn = self.scale * q @ (k.transpose(-2, -1))# `torch.matmul` if is_causal:# masked/causal attention attn = attn.masked_fill_(# `torch.Tensor.masked_fill_`, add mask by broadcasting torch.triu(torch.ones((seq_length, seq_length), dtype=torch.bool), diagonal=1), float(\u0026#39;-inf\u0026#39;) ) print(attn) print(attn.shape) attn = attn.softmax(dim=-1) print(attn) print(attn.shape) attn = self.dropout(attn) x = attn @ v# [batch_size, num_heads, seq_length, hidden_dim // num_heads] x = x.transpose(1, 2)# [batch_size, seq_length, num_heads, hidden_dim // num_heads] x = x.reshape(batch_size, seq_length, hidden_dim)# [batch_size, seq_length, hidden_dim] x = self.w_o(x)# [batch_size, seq_length, hidden_dim] x = self.dropout(x) return x dummy = torch.rand(1, 4, 6)# [batch_size, seq_length, hidden_dim] multihead_attention = MultiheadAttention(hidden_dim=6, num_heads=2) print(\u0026#39;No mask:\u0026#39;) _ = multihead_attention(dummy) print(\u0026#39;Masked:\u0026#39;) _ = multihead_attention(dummy, is_causal=True) will get:\nNo mask: tensor([[[[-0.0302, -0.0241, -0.0071, -0.0822], [ 0.0041, 0.0307, 0.0372, -0.0366], [-0.0460, -0.0571, 0.1467, 0.1020], [-0.0685, -0.0811, 0.1513, 0.0700]], [[ 0.0744, 0.0987, 0.2944, 0.3069], [ 0.0538, 0.0855, 0.2632, 0.2898], [-0.0052, 0.0453, 0.1585, 0.2132], [ 0.0034, 0.0774, 0.2627, 0.3394]]]], grad_fn=\u0026lt;UnsafeViewBackward0\u0026gt;) torch.Size([1, 2, 4, 4])# [batch_size, num_heads, seq_length, seq_length] tensor([[[[0.2513, 0.2529, 0.2572, 0.2386], [0.2487, 0.2554, 0.2571, 0.2388], [0.2293, 0.2268, 0.2780, 0.2659], [0.2282, 0.2254, 0.2843, 0.2621]], [[0.2206, 0.2261, 0.2749, 0.2784], [0.2207, 0.2278, 0.2721, 0.2794], [0.2235, 0.2351, 0.2633, 0.2781], [0.2095, 0.2256, 0.2716, 0.2932]]]], grad_fn=\u0026lt;SoftmaxBackward0\u0026gt;) torch.Size([1, 2, 4, 4]) Masked: tensor([[[[-0.0302, -inf, -inf, -inf], [ 0.0041, 0.0307, -inf, -inf], [-0.0460, -0.0571, 0.1467, -inf], [-0.0685, -0.0811, 0.1513, 0.0700]], [[ 0.0744, -inf, -inf, -inf], [ 0.0538, 0.0855, -inf, -inf], [-0.0052, 0.0453, 0.1585, -inf], [ 0.0034, 0.0774, 0.2627, 0.3394]]]], grad_fn=\u0026lt;MaskedFillBackward0\u0026gt;) torch.Size([1, 2, 4, 4]) tensor([[[[1.0000, 0.0000, 0.0000, 0.0000], [0.4934, 0.5066, 0.0000, 0.0000], [0.3124, 0.3089, 0.3787, 0.0000], [0.2282, 0.2254, 0.2843, 0.2621]], [[1.0000, 0.0000, 0.0000, 0.0000], [0.4921, 0.5079, 0.0000, 0.0000], [0.3096, 0.3257, 0.3647, 0.0000], [0.2095, 0.2256, 0.2716, 0.2932]]]], grad_fn=\u0026lt;SoftmaxBackward0\u0026gt;) torch.Size([1, 2, 4, 4]) Use F.scaled_dot_product_attention:\nclass MultiheadAttention(nn.Module): def __init__(self, hidden_dim=768, num_heads=12, dropout=0.0): super().__init__() self.num_heads = num_heads self.dropout = dropout self.w_qkv = nn.Linear(hidden_dim, hidden_dim * 3) self.w_o = nn.Linear(hidden_dim, hidden_dim) def forward(self, x, is_causal=False): batch_size, seq_length, hidden_dim = x.shape qkv = self.w_qkv(x)# [batch_size, seq_length, hidden_dim * 3] qkv = qkv.view(batch_size, seq_length, 3, self.num_heads, -1)# [batch_size, seq_length, 3, num_heads, hidden_dim // num_heads] qkv = qkv.permute(2, 0, 3, 1, 4)# [3, batch_size, num_heads, seq_length, hidden_dim // num_heads] q, k, v = qkv# q, k, v shape: [batch_size, num_heads, seq_length, hidden_dim // num_heads] x = F.scaled_dot_product_attention(q, k, v, dropout_p=(self.dropout if self.training else 0.0), is_causal=is_causal)# [batch_size, num_heads, seq_length, hidden_dim // num_heads] x = x.transpose(1, 2)# [batch_size, seq_length, num_heads, hidden_dim // num_heads] x = x.view(batch_size, seq_length, hidden_dim)# [batch_size, seq_length, hidden_dim] x = self.w_o(x)# [batch_size, seq_length, hidden_dim] return x dummy = torch.rand(1, 196, 768)# [batch_size, seq_length, hidden_dim] multihead_attention = MultiheadAttention() dummy = multihead_attention(dummy) print(dummy.shape) will get:\ntorch.Size([1, 196, 768]) §3.2.3 TransformerEncoderLayer nn.TransformerEncoderLayer\nclass TransformerEncoderLayer(nn.Module): def __init__(self, num_layers=12, num_heads=12, hidden_dim=768, ffn_dim=3072, dropout=0.0): super().__init__() self.layer_norm_1 = nn.LayerNorm(hidden_dim) self.attention = MultiheadAttention(hidden_dim, num_heads, dropout) self.layer_norm_2 = nn.LayerNorm(hidden_dim) self.ffn = FFN(hidden_dim, ffn_dim, hidden_dim, dropout) self.dropout = nn.Dropout(dropout) self.attn_scale = 1 / math.sqrt(2 * num_layersr) def forward(self, x): residual = x x = self.layer_norm_1(x) x = self.attn_scale * self.attention(x) x = self.dropout(x) x += residual residual = x x = self.layer_norm_2(x) x = self.ffn(x) x = self.dropout(x) x += residual return x In contrast with the Original Transformer, Layer Norm is put before Attention, see [2002.04745] On Layer Normalization in the Transformer Architecture.\nsummary(TransformerEncoderLayer(), input_size=(1, 196, 768)) will get:\n========================================================================================== Layer (type:depth-idx) Output Shape Param # ========================================================================================== TransformerEncoderLayer [1, 196, 768] -- ├─LayerNorm: 1-1 [1, 196, 768] 1,536 ├─MultiheadAttention: 1-2 [1, 196, 768] -- │ └─Linear: 2-1 [1, 196, 2304] 1,771,776 │ └─Dropout: 2-2 [1, 12, 196, 196] -- │ └─Linear: 2-3 [1, 196, 768] 590,592 │ └─Dropout: 2-4 [1, 196, 768] -- ├─Dropout: 1-3 [1, 196, 768] -- ├─LayerNorm: 1-4 [1, 196, 768] 1,536 ├─FFN: 1-5 [1, 196, 768] -- │ └─Linear: 2-5 [1, 196, 3072] 2,362,368 │ └─GELU: 2-6 [1, 196, 3072] -- │ └─Dropout: 2-7 [1, 196, 3072] -- │ └─Linear: 2-8 [1, 196, 768] 2,360,064 │ └─Dropout: 2-9 [1, 196, 768] -- ├─Dropout: 1-6 [1, 196, 768] -- ========================================================================================== Total params: 7,087,872 Trainable params: 7,087,872 Non-trainable params: 0 Total mult-adds (M): 7.09 ========================================================================================== Input size (MB): 0.60 Forward/backward pass size (MB): 13.25 Params size (MB): 28.35 Estimated Total Size (MB): 42.20 ========================================================================================== Most of the parameters is in FNN rather than MultiheadAttention. FFN takes 66.66%, while MultiheadAttention takes 33.33%. This is even more so with MoE, which has several FFNs.\n§3.2.4 TransformerEncoder nn.TransformerEncoder\nclass TransformerEncoder(nn.Module): def __init__(self, num_layers=12, num_heads=12, hidden_dim=768, ffn_dim=3072, dropout=0.0): super().__init__() self.transformer_encoder_layers = nn.ModuleList([ TransformerEncoderLayer(num_layers, num_heads, hidden_dim, ffn_dim, dropout) for _ in range(num_layers) ]) def forward(self, x): for transformer_encoder_layer in self.transformer_encoder_layers: x = transformer_encoder_layer(x) return x §3.3 Encoder-Decoder, Encoder-Only, Decoder-Only Encoder-Decoder: seq2seq Encoder-Decoder: Transformer | Understanding Transformer model architectures (practicalai.io) | 11.9. Large-Scale Pretraining with Transformers (d2l.ai) |\nNLP CV Encoder-Decoder [1706.03762] Attention is All You Need, T5 BEiT Encoder-Only BERT, ModernBERT ViT Decoder-Only GPT, GPT-2, GPT-3, nanoGPT, modded-nanogpt Fig.1 of [2304.13712] Harnessing the Power of LLMs in Practice: A Survey on ChatGPT and Beyond:\nOriginal Transformer, Encoder Original Transformer, Decoder ViT (Encoder-Only) GPT (Decoder-Only) Self-Attention or Cross-Attention Self-Attention The first Self-Attention, the second Cross-Attention Self-Attention Self-Attention Mask/Causal ✖️ ✔️ ✖️ ✔️ §3.4 Attention is All You Need (the Original Transformer) [1706.03762] Attention Is All You Need\nA pure Transformer structure instead of RNNs. Use Softmax to let query $Q$ choose different $K^\\mathsf{T}$. The encoder provides keys $K$ and value $V$, while the decoder provides query $Q$. (Cross-Attention) §3.5 Vision Transformer (ViT) [2010.11929] An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale\nA pure Transformer structure instead of CNNs. General function fitter instead of good inductive prior. With enough data. §3.5.1 PatchEmbedding class PatchEmbedding\nclass PatchEmbedding(nn.Module): def __init__(self, in_channels=3, patch_size=16, hidden_dim=768): super().__init__() self.conv2d = nn.Conv2d( in_channels=in_channels, out_channels=hidden_dim, kernel_size=patch_size, stride=patch_size, padding=0 ) self.hidden_dim = hidden_dim def forward(self, x): batch_size = x.shape[0] x = self.conv2d(x) x = x.view(batch_size, -1, self.hidden_dim) return x class PatchEmbedding_noConv\nor without convolution:\nclass PatchEmbedding_noConv(nn.Module): def __init__(self, hidden_dim=768): super().__init__() self.hidden_dim = hidden_dim def forward(self, x): batch_size = x.shape[0] x = x.view(batch_size, -1, self.hidden_dim) return x §3.5.2 VisionTransformer Homemade TransformerEncoder\nclass VisionTransformer(nn.Module): def __init__( self, image_size=224, in_channels=3, patch_size=16, num_classes=1000, num_layers=12, num_heads=12, hidden_dim=768, ffn_dim=3072, dropout=0.0 ): super().__init__() self.patch_embedding = PatchEmbedding(in_channels, patch_size, hidden_dim) self.pos_embedding = nn.Parameter(torch.empty(1, (image_size // patch_size)**2, hidden_dim).normal_(std=0.02)) self.class_token = nn.Parameter(torch.empty(1, 1, hidden_dim)) self.transformer_encoder = TransformerEncoder(num_layers, num_heads, hidden_dim, ffn_dim, dropout) # self.layer_norm = nn.LayerNorm(hidden_dim) self.proj = nn.Linear(hidden_dim, num_classes) def forward(self, x): x = self.patch_embedding(x) x += self.pos_embedding batch_size = x.shape[0] batch_class_token = self.class_token.expand(batch_size, -1, -1) x = torch.cat([batch_class_token, x], dim=1) x = self.transformer_encoder(x) # x = self.layer_norm(x) x = self.proj(x[:, 0, :]) return x summary(VisionTransformer(),input_size=(16, 3, 224, 224)) will get:\n=============================================================================================== Layer (type:depth-idx) Output Shape Param # =============================================================================================== VisionTransformer [16, 1000] 151,296 ├─PatchEmbedding: 1-1 [16, 196, 768] -- │ └─Conv2d: 2-1 [16, 768, 14, 14] 590,592 ├─TransformerEncoder: 1-2 [16, 197, 768] -- │ └─ModuleList: 2-2 -- -- │ │ └─TransformerEncoderLayer: 3-1 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-2 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-3 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-4 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-5 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-6 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-7 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-8 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-9 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-10 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-11 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-12 [16, 197, 768] 7,087,872 ├─Linear: 1-3 [16, 1000] 769,000 =============================================================================================== Total params: 86,565,352 Trainable params: 86,565,352 Non-trainable params: 0 Total mult-adds (G): 3.23 =============================================================================================== Input size (MB): 9.63 Forward/backward pass size (MB): 2575.69 Params size (MB): 345.66 Estimated Total Size (MB): 2930.98 =============================================================================================== nn.TransformerEncoder (torch 2.2.0+cu121)\nclass VisionTransformer_torch(nn.Module): def __init__( self, image_size=224, in_channels=3, patch_size=16, num_classes=1000, num_layers=12, num_heads=12, hidden_dim=768, ffn_dim=3072, dropout=0.0 ): super().__init__() self.patch_embedding = PatchEmbedding(in_channels, patch_size, hidden_dim) self.pos_embedding = nn.Parameter(torch.empty(1, (image_size // patch_size)**2, hidden_dim).normal_(std=0.02)) self.class_token = nn.Parameter(torch.empty(1, 1, hidden_dim)) transformer_encoder_layer = nn.TransformerEncoderLayer(d_model=hidden_dim, nhead=num_heads, dim_feedforward=ffn_dim, dropout=dropout, batch_first=True) self.transformer_encoder = nn.TransformerEncoder(transformer_encoder_layer, num_layers=num_layers) # self.layer_norm = nn.LayerNorm(hidden_dim) self.proj = nn.Linear(hidden_dim, num_classes) def forward(self, x): x = self.patch_embedding(x) x += self.pos_embedding batch_size = x.shape[0] batch_class_token = self.class_token.expand(batch_size, -1, -1) x = torch.cat([batch_class_token, x], dim=1) x = self.transformer_encoder(x) # x = self.layer_norm(x) x = self.proj(x[:, 0, :]) return x summary(VisionTransformer_torch(),input_size=(16, 3, 224, 224)) will, surprisingly, get the same total parameters (86,565,352), though the sizes (MB) are way smaller:\n=============================================================================================== Layer (type:depth-idx) Output Shape Param # =============================================================================================== VisionTransformer_torch [16, 1000] 151,296 ├─PatchEmbedding: 1-1 [16, 196, 768] -- │ └─Conv2d: 2-1 [16, 768, 14, 14] 590,592 ├─TransformerEncoder: 1-2 [16, 197, 768] -- │ └─ModuleList: 2-2 -- -- │ │ └─TransformerEncoderLayer: 3-1 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-2 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-3 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-4 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-5 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-6 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-7 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-8 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-9 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-10 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-11 [16, 197, 768] 7,087,872 │ │ └─TransformerEncoderLayer: 3-12 [16, 197, 768] 7,087,872 ├─Linear: 1-3 [16, 1000] 769,000 =============================================================================================== Total params: 86,565,352 Trainable params: 86,565,352 Non-trainable params: 0 Total mult-adds (G): 1.86 =============================================================================================== Input size (MB): 9.63 Forward/backward pass size (MB): 19.40 Params size (MB): 5.44 Estimated Total Size (MB): 34.47 =============================================================================================== §3.5.3 fine-tuning of ViT [2203.09795] Three things everyone should know about Vision Transformers:\nParallel vision transformers. Fine-tuning attention is all you need. Patch preprocessing with masked self-supervised learning. §3.6 Generative Pre-trained Transformer (GPT) Note that in the original Transformer, the Decoder has two attention. However in the Decoder of GPT, there is only one attention. And GPTs are called \u0026ldquo;Decoder-Only\u0026rdquo; because:\nBy using masks, GPTs are autoregressive, meaning that the model takes previous $(t-1)^{th}$ words to produce the $t^{th}$ word. Their task is to generate text, similar to the Decoder in the original Transformer. §3.6.1 GPTDecoderLayer class GPTDecoderLayer(nn.Module): def __init__(self, num_layers=12, num_heads=12, hidden_dim=768, ffn_dim=3072, dropout=0.0): super().__init__() self.layer_norm_1 = nn.LayerNorm(hidden_dim) self.attention = MultiheadAttention(hidden_dim, num_heads, dropout) self.layer_norm_2 = nn.LayerNorm(hidden_dim) self.ffn = FFN(hidden_dim, ffn_dim, hidden_dim, dropout) self.dropout = nn.Dropout(dropout) self.attn_scale = 1 / math.sqrt(2 * num_layersr) def forward(self, x, is_causal=True): residual = x x = self.layer_norm_1(x) x = self.attn_scale * self.attention(x, is_causal) x = self.dropout(x) x += residual residual = x x = self.layer_norm_2(x) x = self.ffn(x) x = self.dropout(x) x += residual return x §3.6.2 GPTDecoder class GPTDecoder(nn.Module): def __init__(self, num_layers=12, num_heads=12, hidden_dim=768, ffn_dim=3072, dropout=0.0): super().__init__() self.gpt_decoder_layers = nn.ModuleList([ GPTDecoderLayer(num_layers, num_heads, hidden_dim, ffn_dim, dropout) for _ in range(num_layers) ]) def forward(self, x, is_causal=True): for gpt_decoder_layer in self.gpt_decoder_layers: x = gpt_decoder_layer(x, is_causal) return x §3.6.3 GPTLanguageModel class GPTLanguageModel(nn.Module): def __init__( self, vocab_size=50257, window_size=1024, num_layers=12, num_heads=12, hidden_dim=768, ffn_dim=3072, dropout=0.0 ): super().__init__() self.embedding = Embedding(hidden_dim, vocab_size) self.positional_encoding = PositionalEncoding(hidden_dim, vocab_size, dropout) self.gpt_decoder = GPTDecoder(num_layers, num_heads, hidden_dim, ffn_dim, dropout) self.layer_norm = nn.LayerNorm(hidden_dim) self.proj = nn.Linear(hidden_dim, vocab_size, bias=False) self.proj.weight = self.embedding.weight# https://arxiv.org/abs/1608.05859 def forward(self, index, targets=None): # index, targets shape: [batch_size, seq_length] batch_size, seq_length = index.shape # embedding x = self.embedding(index)# [batch_size, seq_length, hidden_dim] x = self.positional_encoding(x)# [batch_size, seq_length, hidden_dim] # Transformer Decoder x = self.gpt_decoder(x)# [batch_size, seq_length, hidden_dim] # project out x = self.layer_norm(x)# [batch_size, seq_length, hidden_dim] logits = self.proj(x)# [batch_size, seq_length, vocab_size] if targets is None: loss = None else: batch_size, seq_length, vocab_size = logits.shape logits = logits.view(batch_size*seq_length, vocab_size) targets = targets.view(batch_size*seq_length) loss = F.cross_entropy(logits, targets) return logits, loss @torch.no_grad() def generate(self, index, max_new_tokens): # index shape [batch_size, seq_length] for _ in range(max_new_tokens): # crop index to the last window_size tokens index_cond = index[:, -window_size:] # get the predictions logits, loss = self(index_cond) # focus only on the last time step logits = logits[:, -1, :] # [batch_size, vocab_size] # apply softmax to get probabilities probs = F.softmax(logits, dim=-1) # [batch_size, vocab_size] # sample from the distribution index_next = torch.multinomial(probs, num_samples=1) # [batch_size, 1] # append sampled index to the running sequence index = torch.cat((index, index_next), dim=1) # [batch_size, seq_length+1] return index gpt_language_model = GPTLanguageModel() index = torch.randint(50257, (1, 196))# [batch_size, seq_length] targets = torch.randint(50257, (1, 196))# [batch_size, seq_length] logits, loss = gpt_language_model(index, targets) print(logits.shape)# [batch_size*seq_length, vocab_size] print(loss) will get:\ntorch.Size([196, 50257]) tensor(10.9951, grad_fn=\u0026lt;NllLossBackward0\u0026gt;) §3.6.4 fine-tuning of LLM The ULMFiT 3-step approach (see Fig.1 of [1801.06146] Universal Language Model Fine-tuning for Text Classification):\nLanguage Model pre-training. Instruction tuning. RLHF (Reinforcement Learning from Human Feedback). §3.7 Variants Generally speaking most papers have this kind of naming convention:\nOriginal Transformer: 1706.03762 Vanilla Transformer: The original Transformer with ReLU activation and layer normalization 1607.06450 outside of the residual path. Transformer+GELU: A variant of the vanilla Transformer that uses GELU 1606.08415 activations or its approximation. Transformer++: A variant of the vanilla Transformer that uses RoPE embedding 2104.09864, RMS normalization 1910.07467, Swish activation or GeGLU activation in the FFN 2002.05202. The bias terms in all the linear layers in FFN layers and Attention layers are False, except for the final encoder layer. For example, ModernBERT. Below is an implementation of Transformer++:\nPyTorch\ndef precompute_freqs_cis(dim, end, rope_theta=10000.0): freqs = 1.0 / (rope_theta ** (torch.arange(0, dim, 2)[: (dim // 2)].float() / dim)) t = torch.arange(end, device=freqs.device, dtype=torch.float32) freqs = torch.outer(t, freqs) freqs_cis = torch.polar(torch.ones_like(freqs), freqs)# complex64 return freqs_cis def reshape_for_broadcast(freqs_cis, x): ndim = x.ndim assert 0 \u0026lt;= 1 \u0026lt; ndim assert freqs_cis.shape == (x.shape[1], x.shape[-1]) shape = [d if i == 1 or i == ndim - 1 else 1 for i, d in enumerate(x.shape)] return freqs_cis.view(*shape) def apply_rotary_emb(q, k, freqs_cis): q_ = torch.view_as_complex(q.float().reshape(*q.shape[:-1], -1, 2)) k_ = torch.view_as_complex(k.float().reshape(*k.shape[:-1], -1, 2)) freqs_cis = reshape_for_broadcast(freqs_cis, q_) q_out = torch.view_as_real(q_ * freqs_cis).flatten(3) k_out = torch.view_as_real(k_ * freqs_cis).flatten(3) return q_out.type_as(q), k_out.type_as(k) class GeGLU_FFN(nn.Module): def __init__(self, in_features=768, hidden_features=3072, out_features=768, dropout=0.0, bias=False): super().__init__() self.linear1 = nn.Linear(in_features, hidden_features * 2, bias=bias) self.dropout = nn.Dropout(dropout) self.linear2 = nn.Linear(hidden_features, out_features, bias=bias) def geglu(self, x): assert x.shape[-1] % 2 == 0 a, b = x.chunk(2, dim=-1) return a * F.gelu(b) def forward(self, x): return self.linear2(self.dropout(self.geglu(self.linear1(x)))) class MultiheadAttention(nn.Module): def __init__(self, hidden_dim=768, num_heads=12, dropout=0.0, bias=False): super().__init__() self.num_heads = num_heads self.dropout = dropout self.w_qkv = nn.Linear(hidden_dim, hidden_dim * 3, bias=bias) self.w_o = nn.Linear(hidden_dim, hidden_dim, bias=bias) def forward(self, x, freqs_cis, is_causal=False): batch_size, seq_length, hidden_dim = x.shape qkv = self.w_qkv(x)# [batch_size, seq_length, hidden_dim * 3] qkv = qkv.view(batch_size, seq_length, 3, self.num_heads, -1)# [batch_size, seq_length, 3, num_heads, hidden_dim // num_heads] qkv = qkv.permute(2, 0, 1, 3, 4)# [3, batch_size, seq_length, num_heads, hidden_dim // num_heads] q, k, v = qkv# q, k, v shape: [batch_size, seq_length, num_heads, hidden_dim // num_heads] q, k = apply_rotary_emb(q, k, freqs_cis) q, k, v = q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2)# q, k, v shape: [batch_size, num_heads, seq_length, hidden_dim // num_heads] x = F.scaled_dot_product_attention(q, k, v, dropout_p=(self.dropout if self.training else 0.0), is_causal=is_causal)# [batch_size, num_heads, seq_length, hidden_dim // num_heads] x = x.transpose(1, 2)# [batch_size, seq_length, num_heads, hidden_dim // num_heads] x = x.view(batch_size, seq_length, hidden_dim)# [batch_size, seq_length, hidden_dim] x = self.w_o(x)# [batch_size, seq_length, hidden_dim] return x class TransformerLayer(nn.Module): def __init__(self, num_layers=12, num_heads=12, hidden_dim=768, ffn_dim=3072, dropout=0.0, bias=False): super().__init__() self.rms_norm = nn.RMSNorm(hidden_dim, eps=1e-5) self.attention = MultiheadAttention(hidden_dim, num_heads, dropout, bias) self.ffn = GeGLU_FFN(hidden_dim, ffn_dim, hidden_dim, dropout, bias) self.dropout = nn.Dropout(dropout) self.attn_scale = 1 / math.sqrt(2 * num_layers) def forward(self, x, freqs_cis, is_causal=False): residual = x x = self.rms_norm(x) x = self.attn_scale * self.attention(x, freqs_cis, is_causal) x = self.dropout(x) x += residual residual = x x = self.rms_norm(x) x = self.ffn(x) x = self.dropout(x) x += residual return x class Transformer(nn.Module): def __init__(self, num_layers=12, num_heads=12, hidden_dim=768, ffn_dim=3072, dropout=0.0, bias=False, max_seq_length=196, rope_theta=10000.0): super().__init__() self.freqs_cis = precompute_freqs_cis(hidden_dim // num_heads, max_seq_length * 2, rope_theta) self.transformer_layers = nn.ModuleList() for _ in range(num_layers-1): self.transformer_layers.append(TransformerLayer(num_layers, num_heads, hidden_dim, ffn_dim, dropout, bias)) self.transformer_layers.append(TransformerLayer(num_layers, num_heads, hidden_dim, ffn_dim, dropout, bias=True)) # self.rms_norm = nn.RMSNorm(hidden_dim, eps=1e-5) def forward(self, x, is_causal=False): _, seq_length, _ = x.shape self.freqs_cis = self.freqs_cis.to(x.device) freqs_cis = self.freqs_cis[:seq_length] for transformer_layer in self.transformer_layers: x = transformer_layer(x, freqs_cis, is_causal) # x = self.rms_norm(x) return x dummy = torch.rand(1, 196, 768).to(\u0026#39;cuda\u0026#39;)# [batch_size, seq_length, hidden_dim] transformer = Transformer().to(\u0026#39;cuda\u0026#39;) # transformer = torch.compile(transformer) dummy = transformer(dummy) print(dummy.shape) will get:\ntorch.Size([1, 196, 768]) FlashAttention\nOr, after installing:\npip install triton pip install flash-attn --no-build-isolation We can use flash_attn.layers.rotary.RotaryEmbedding:\nfrom flash_attn.layers.rotary import RotaryEmbedding # from flash_attn import flash_attn_qkvpacked_func class GeGLU_FFN(nn.Module): def __init__(self, in_features=768, hidden_features=3072, out_features=768, dropout=0.0, bias=False): super().__init__() self.linear1 = nn.Linear(in_features, hidden_features * 2, bias=bias) self.dropout = nn.Dropout(dropout) self.linear2 = nn.Linear(hidden_features, out_features, bias=bias) def geglu(self, x): assert x.shape[-1] % 2 == 0 a, b = x.chunk(2, dim=-1) return a * F.gelu(b) def forward(self, x): return self.linear2(self.dropout(self.geglu(self.linear1(x)))) class MultiheadAttention(nn.Module): def __init__(self, hidden_dim=768, num_heads=12, dropout=0.0, bias=False): super().__init__() self.num_heads = num_heads self.dropout = dropout self.w_qkv = nn.Linear(hidden_dim, hidden_dim * 3, bias=bias) self.w_o = nn.Linear(hidden_dim, hidden_dim, bias=bias) self.rotary_embedding = RotaryEmbedding(hidden_dim // num_heads) def forward(self, x, is_causal=False): batch_size, seq_length, hidden_dim = x.shape qkv = self.w_qkv(x)# [batch_size, seq_length, hidden_dim * 3] qkv = qkv.view(batch_size, seq_length, 3, self.num_heads, -1)# [batch_size, seq_length, 3, num_heads, hidden_dim // num_heads] qkv = self.rotary_embedding(qkv)# [batch_size, seq_length, 3, num_heads, hidden_dim // num_heads] qkv = qkv.permute(2, 0, 3, 1, 4)# [3, batch_size, num_heads, seq_length, hidden_dim // num_heads] q, k, v = qkv# q, k, v shape: [batch_size, num_heads, seq_length, hidden_dim // num_heads] x = F.scaled_dot_product_attention(q, k, v, dropout_p=(self.dropout if self.training else 0.0), is_causal=is_causal)# [batch_size, num_heads, seq_length, hidden_dim // num_heads] x = x.transpose(1, 2)# [batch_size, seq_length, num_heads, hidden_dim // num_heads] # x = flash_attn_qkvpacked_func(qkv, dropout_p=(self.dropout if self.training else 0.0), softmax_scale=None, causal=False, window_size=(-1, -1), alibi_slopes=None, deterministic=False)# [batch_size, seq_length, num_heads, hidden_dim // num_heads] x = x.view(batch_size, seq_length, hidden_dim)# [batch_size, seq_length, hidden_dim] x = self.w_o(x)# [batch_size, seq_length, hidden_dim] return x class TransformerLayer(nn.Module): def __init__(self, num_layers=12, num_heads=12, hidden_dim=768, ffn_dim=3072, dropout=0.0, bias=False): super().__init__() self.rms_norm = nn.RMSNorm(hidden_dim, eps=1e-5) self.attention = MultiheadAttention(hidden_dim, num_heads, dropout, bias) self.ffn = GeGLU_FFN(hidden_dim, ffn_dim, hidden_dim, dropout, bias) self.dropout = nn.Dropout(dropout) self.attn_scale = 1 / math.sqrt(2 * num_layers) def forward(self, x, is_causal=False): residual = x x = self.rms_norm(x) x = self.attn_scale * self.attention(x, is_causal) x = self.dropout(x) x += residual residual = x x = self.rms_norm(x) x = self.ffn(x) x = self.dropout(x) x += residual return x class Transformer(nn.Module): def __init__(self, num_layers=12, num_heads=12, hidden_dim=768, ffn_dim=3072, dropout=0.0, bias=False): super().__init__() self.transformer_layers = nn.ModuleList() for _ in range(num_layers-1): self.transformer_layers.append(TransformerLayer(num_layers, num_heads, hidden_dim, ffn_dim, dropout, bias)) self.transformer_layers.append(TransformerLayer(num_layers, num_heads, hidden_dim, ffn_dim, dropout, bias=True)) # self.rms_norm = nn.RMSNorm(hidden_dim, eps=1e-5) def forward(self, x, is_causal=False): for transformer_layer in self.transformer_layers: x = transformer_layer(x, is_causal) # x = self.rms_norm(x) return x dummy = torch.rand(1, 196, 768).to(\u0026#39;cuda\u0026#39;)# [batch_size, seq_length, hidden_dim] transformer = Transformer().to(\u0026#39;cuda\u0026#39;) transformer = torch.compile(transformer) dummy = transformer(dummy) print(dummy.shape) will get:\ntorch.Size([1, 196, 768]) §3.8 Mixture of Experts (MoE) Mixture of Experts (MoE): | [1701.06538] Outrageously Large Neural Networks: The Sparsely-Gated Mixture-of-Experts Layer | mixture-of-experts (GitHub) | st-moe-pytorch (GitHub) | FastMoE (GitHub) | Training MoEs at Scale with PyTorch |\nMixtral of Experts: | [2401.04088] Mixtral of Experts | mistral-src (GitHub) |\nFFN in the original Transformer is replaced by Mixture of Expert layer (weighted FFNs). Given $n$ experts $\\lbrace{E_0, E_i, \u0026hellip;, E_{n-1}}\\rbrace$, the output of the MoE is$$\\text{MoE}(x) = \\sum_{i=0}^{n-1} {G(x)}_{i} \\cdot E_i(x)$$where $$G(x) = \\text{Softmax}(\\text{TopK}(x W_g))$$By using torch.topk, we only uses $K$ Experts, thus this model is also called Sparse Mixture of Experts (SMoE). Another benefit of experts is that we can put different experts on different GPUs, which is the similar approach of AlexNet. (It is rumored that GPT4 is using 16 experts with top2 gating. I guess Ilya Sutskever pulled the same trick again.) This usage of $\\text{TopK}$ is similar to Beam Search for inferencing.\nIn Mixtral of Experts, $E(x)$ is SwiGLU FFN: $$\\text{FFN}_\\text{SwiGLU}(x) = (\\text{Swish}_1(xW_1) \\odot xV)W_2$$here we use F.silu.\nclass FFN_SwiGLU(nn.Module): def __init__(self, hidden_dim=4096, ffn_dim=14336): super().__init__() self.w1 = nn.Linear(hidden_dim, ffn_dim, bias=False) self.v = nn.Linear(hidden_dim, ffn_dim, bias=False) self.w2 = nn.Linear(ffn_dim, hidden_dim, bias=False) def forward(self, x): return self.w2(F.silu(self.w1(x)) * self.v(x)) # https://github.com/pytorch/torchtitan/blob/main/torchtitan/models/llama/model.py#L250 # https://github.com/pytorch/torchtitan/blob/main/torchtitan/models/llama/model.py#L300 def init_weights(self, init_std): nn.init.trunc_normal_(self.w1.weight, mean=0.0, std=0.02) nn.init.trunc_normal_(self.v.weight, mean=0.0, std=init_std) nn.init.trunc_normal_(self.w2.weight, mean=0.0, std=init_std) class MoELayer(nn.Module): def __init__(self, hidden_dim=4096, ffn_dim=14336, num_experts=8, num_experts_per_tok=2): super().__init__() self.experts = nn.ModuleList([ FFN_SwiGLU(hidden_dim, ffn_dim) for _ in range(num_experts) ]) self.gate = nn.Linear(hidden_dim, num_experts, bias=False) self.num_experts_per_tok = num_experts_per_tok def forward(self, inputs): inputs_squashed = inputs.view(-1, inputs.shape[-1])# [batch_size * seq_length, hidden_dim] gate_logits = self.gate(inputs_squashed)# [batch_size * seq_length, num_experts] weights, selected_experts = torch.topk(gate_logits, self.num_experts_per_tok)# both [batch_size * seq_length, num_experts_per_tok] # print(selected_experts) weights = F.softmax(weights, dim=1) # iterate over each expert results = torch.zeros_like(inputs_squashed) for i, expert in enumerate(self.experts): (index, nth_expert) = torch.where(selected_experts == i)# both [num_index], num_index ≤ batch_size * seq_length # print(torch.where(selected_experts == i)) results[index] += weights[index, nth_expert, None] * expert(inputs_squashed[index])# [num_index, 1] * [num_index, hidden_dim] results = results.view_as(inputs) return results moe_layer = MoELayer(hidden_dim=8, ffn_dim=16) dummy = torch.rand(1, 3, 8)# [batch_size, seq_length, hidden_dim] dummy = moe_layer(dummy)# [batch_size, seq_length, hidden_dim] will get:\ntensor([[7, 3], [7, 0], [7, 0]]) (tensor([1, 2]), tensor([1, 1])) (tensor([], dtype=torch.int64), tensor([], dtype=torch.int64)) (tensor([], dtype=torch.int64), tensor([], dtype=torch.int64)) (tensor([0]), tensor([1])) (tensor([], dtype=torch.int64), tensor([], dtype=torch.int64)) (tensor([], dtype=torch.int64), tensor([], dtype=torch.int64)) (tensor([], dtype=torch.int64), tensor([], dtype=torch.int64)) (tensor([0, 1, 2]), tensor([0, 0, 0])) There is a similar architecture called MoD (Mixture of Depth), where certain Transformer blocks are skipped by some gated mechanism. Below is Fig.1 of [2404.02258] Mixture-of-Depths: Dynamically allocating compute in transformer-based language models:\nNaturally, Route is a nn.Linear. I find this post explaining the technical difficulty we have with this architecture really well.\n[2407.09298] Transformer Layers as Painters does a lot of experiments on removing or sharing layers in Transformer:\n1.There are three distinct classes of layers (with Middle being the largest). 2. The middle layers have some degree of uniformity (but not redundancy). And 3. Execution order matters more for math and reasoning tasks than semantic tasks.\n§3.9 Scaling Laws, Emergence | [2010.14701] Scaling Laws for Autoregressive Generative Modeling | [2203.15556] Training Compute-Optimal Large Language Models | [2304.01373] Pythia: A Suite for Analyzing Large Language Models Across Training and Scaling |\nPreviously in this article it is stated that Transformer is a general function fitter, one of the reasons is that Transformers follow scaling laws with fitting line being almost perfect.\nBelow is Fig.1 of [2010.14701] Scaling Laws for Autoregressive Generative Modeling. As we can see, the line of power law can be fitted almost perfectly. And every time I look at it I\u0026rsquo;m amazed, you don\u0026rsquo;t see this kind of smoothness in other NNs. RNN, for example, is really hard to train.\nThe effect of scaling law can sometimes be misunderstood as emergence, see Emergent abilities and grokking: Fundamental, Mirage, or both? – Windows On Theory. I especially enjoy the \u0026ldquo;jumping over a 1-meter hurdle\u0026rdquo; analogue. Metrics of LLMs can be tricky.\n§3.10 Transformers are CNNs, RNNs, GNNs Another reason that Transformers are general function fitter is that: CNNs assume invariance of space transformation (adjacent pixels are related); RNNs assume the continuity of time series (adjacent words are related); GNNs assume the preservation of graph symmetry (a graph can be rearranged or mapped onto itself while preserving the configuration of its connections); and Transformers do not have these initial bias.\nAt the end of the day, we are transforming [batch_size, seq_length, hidden_dim] to [batch_size, seq_length, hidden_dim]. The intermediate steps are not important, or we happen to have found the general function fitter that is good enough for most tasks: Transformer, as I mentioned in the beginning of this chapter. See The Bitter Lesson.\n§4 fastai | fastai (GitHub) | fastai (docs) | Practical Deep Learning |\n§4.1 Dataloaders We did not write Datasets \u0026amp; DataLoaders, because it\u0026rsquo;s highly variable from tasks to tasks. In general I would suggest:\nLet your brain (bio-neural networks) understand the dataset intuitively by visualizing lots of examples from the dataset. (See A Recipe for Training Neural Networks) Use polars, mojo to load data because it\u0026rsquo;s faster and more memory saving. Pytorch to fastai details:\nfrom torch.utils.data import Dataset, DataLoader, SequentialSampler, BatchSampler from fastai.vision.all import * # subclass `torch.utils.data.Dataset` to create a custom Dataset class MyDataset(Dataset): def __init__(self): ... def __len__(self): ... def __getitem__(self, index): ... return image, label# shape: image is [C, H, W], label is [] # use `torch.utils.data` to load data dataset = MyDataset() data_size = len(dataset) train_size = int(0.8 * data_size)# 80% is train_loader indices = list(range(data_size)) train_indices = indices[:train_size] train_batch_sampler = BatchSampler(SequentialSampler(train_indices),batch_size=32,drop_last=False) train_loader = DataLoader(dataset,num_workers=4,batch_sampler=train_batch_sampler) val_indices = indices[train_size:] val_batch_sampler = BatchSampler(SequentialSampler(val_indices),batch_size=32,drop_last=False) val_loader = DataLoader(dataset,num_workers=1,batch_sampler=val_batch_sampler) # use `fastai.vision.all.DataLoaders` to combine training data and validation data dls = DataLoaders(train_loader, val_loader) Or you can use DataBlock.\n§4.2 Learner Load the model:\nmodel = MyModel().cuda() Use fastai.vision.all.OptimWrapper to wrap AdamW optimizer:\ndef WrapperAdamW(param_groups,**kwargs): return OptimWrapper(param_groups,torch.optim.AdamW) Learner, Learner.to_fp16, Callbacks:\nfrom functools import partial# python standard library learn = Learner( dls, model, path=\u0026#39;custom_path\u0026#39;, loss_func=custom_loss, metrics=[custom_metric], opt_func=partial(WrapperAdamW,eps=1e-7), # opt_func=partial(OptimWrapper,opt=torch.optim.AdamW,eps=1e-7) cbs=[ CSVLogger(), GradientClip(3.0), EMACallback(), SaveModelCallback(monitor=\u0026#39;custom_metric\u0026#39;,comp=np.less,every_epoch=True), GradientAccumulation(n_acc=4096//32)# divided by `batch_size` ] ).to_fp16() Learner.lr_find, [1506.01186] Cyclical Learning Rates for Training Neural Networks:\nlearn.lr_find(suggest_funcs=(slide, valley)) Learner.fit_one_cycle uses 1cycle policy:\nlearn.fit_one_cycle( 8, lr_max=1e-5, wd=0.05, pct_start=0.25, div=25, div_final=100000, ) Learner.save:\nlearn.save(\u0026#34;my_model_opt\u0026#34;, with_opt=True) learn.save(\u0026#34;my_model\u0026#34;, with_opt=False) Learner.compile, torch.compile:\nfrom fastxtend.callback import compiler Learner(...).compile() # or Learner(..., cbs=CompilerCallback()) §5 Transfer Learning For different dataset and different goals.\n§5.1 Load Pretrained ResNet, ViT | Which Timm Models Are Best 2023-11-29 | Kaggle |\nResNet101\nfastai.vision.all.vision_learner\nfrom fastai.vision.all import * # https://github.com/pytorch/vision/tree/main/torchvision/models from torchvision.models import resnet101 # https://pytorch.org/vision/stable/models.html from torchvision.models import ResNet101_Weights dls = ... learn = vision_learner( dls, resnet101, pretrained=True, weights=ResNet101_Weights.IMAGENET1K_V2, metrics=error_rate ) learn.fine_tune( freeze_epochs=1,# freeze_epochs run first epochs=3, ) learn.save(\u0026#34;finetuned_resnet101\u0026#34;, with_opt=False) ViT_B_16\nfastai.vision.all.Learner:\nfrom fastai.vision.all import * from torchvision.models import vit_b_16 from torchvision.models import ViT_B_16_Weights dls = ... # https://github.com/rasbt/ViT-finetuning-scripts/ model = vit_b_16(weights=ViT_B_16_Weights.IMAGENET1K_V1) model.heads.head = nn.Linear(in_features=768, out_features=2)# replace projection layer model.to(\u0026#34;cuda\u0026#34;) learn = Learner(dls, model, metrics=error_rate) learn.fine_tune(freeze_epochs=1, epochs=3) learn.save(\u0026#34;finetuned_vit_b_16\u0026#34;, with_opt=False) §5.2 Acoustic/Gravitational Wave Classification [1912.11370] Big Transfer (BiT): General Visual Representation Learning:\nWe scale up pre-training, and propose a simple recipe that we call Big Transfer (BiT).\n§5.2.1 Acoustic Wave Classification Great results on audio classification with fastai library | by Ethan Sutin UrbanSoundClassification.ipynb (GitHub) Each subfigure of the figure below is a Power Spectrum:\nThe horizontal axis is Time ($\\text{s}$). The vertical axis is Frequency ($\\text{Hz}$) of the vibration. The color (from dark to red to white) is Sound Intensity Level ($\\text{dB}$): Use librosa.display.specshow to draw Power Spectrum, then save as .png:\nS = librosa.feature.melspectrogram(y=samples, sr=sample_rate) librosa.display.specshow(librosa.power_to_db(S, ref=np.max)) filename = spectrogram_path/fold/Path(audio_file).name.replace(\u0026#39;.wav\u0026#39;,\u0026#39;.png\u0026#39;) plt.savefig(filename, dpi=400, bbox_inches=\u0026#39;tight\u0026#39;,pad_inches=0) Use fastai to load pretrained model ResNet34:\nlearn = cnn_learner(data, models.resnet34, metrics=error_rate) §5.2.2 Gravitational Wave Classification [2303.13917] Convolutional Neural Networks for the classification of glitches in gravitational-wave data streams The picture below is Fig.2 of the paper:\nUse fastai to load pretrained model ResNet18, ResNet26, ResNet34, ResNet50, ConvNext_Nano, ConvNext_Tiny.\n§5.3 Category \u0026ldquo;Unknown\u0026rdquo;, Confidence Level Choose the size of the model by the size of the dataset, to avoid overfitting. When the output probability of the final MLP layer is not dominated by one category (less than 95% or some threshold), you should be extra careful. Because actually this prediction is not correct. There is an entire research field on predicting the confidence level of a prediction, see [2103.15718] von Mises-Fisher Loss: An Exploration of Embedding Geometries for Supervised Learning, [2107.03342] A Survey of Uncertainty in Deep Neural Networks, [1706.04599] On Calibration of Modern Neural Networks. ",
      "content_html": "\u003cp\u003e(There are a lot of pictures so it might take a while to load. This article is actually longer than it looks, because I use \u003ca href=\"https://yihui.org/en/2023/10/section-tabsets/\"\u003etabsets\u003c/a\u003e a lot.)\u003c/p\u003e\n\u003ch2 id=\"1-intro\"\u003e§1 Intro\u003c/h2\u003e\n\u003cp\u003eThis section is about tensor (high-dimensional matrix) and \u003ccode\u003etorch.nn\u003c/code\u003e.\u003c/p\u003e\n\u003ch3 id=\"11-tensor\"\u003e§1.1 Tensor\u003c/h3\u003e\n\u003cp\u003eIn the rest of the article, we will always:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch.nn\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch.nn.functional\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorchinfo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"111-shape\"\u003e§1.1.1 Shape\u003c/h4\u003e\n\u003cp\u003ee.g. [H, W, C] (usually used in \u003ccode\u003enumpy\u003c/code\u003e or \u003ccode\u003ematplotlib.pyplot\u003c/code\u003e) or [C, H, W] (usually used in \u003ccode\u003etorch\u003c/code\u003e) or [batch_size, C, H, W].\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/00-pytorch-different-tensor-dimensions.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, C, H, W]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 3, 32, 32\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eCommonly used method to change the shape of a tensor:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.Tensor.view.html\"\u003e\u003ccode\u003e.view()\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.reshape.html\"\u003e\u003ccode\u003e.reshape()\u003c/code\u003e\u003c/a\u003e (\u003ccode\u003e.reshape()\u003c/code\u003e is for non-contiguous tensor, try \u003ccode\u003e.view()\u003c/code\u003e first. \u003ccode\u003ex.reshape()\u003c/code\u003e is equal to \u003ccode\u003ex.contiguous().view()\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.unsqueeze.html\"\u003e\u003ccode\u003e.unsqueeze()\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.squeeze.html\"\u003e\u003ccode\u003e.squeeze()\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.transpose.html\"\u003e\u003ccode\u003e.transpose()\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.permute.html\"\u003e\u003ccode\u003e.permute()\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/arogozhnikov/einops\"\u003e\u003ccode\u003eeinops\u003c/code\u003e\u003c/a\u003e provides a more intuitive way to change the shape.\u003c/p\u003e\n\u003ch4 id=\"112-device\"\u003e§1.1.2 Device\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/tensor_attributes.html#torch-device\"\u003e\u003ccode\u003etorch.device\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eTensor device\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;cuda\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;cpu\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecpu\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecuda:0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecpu\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eModel device\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eModel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eModel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;cuda\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBe on the same device\u003c/p\u003e\n\u003cp\u003eAll tensors and objects (datasets, models) should be on the same device.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;cuda\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eModel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epadding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epadding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efc1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efc2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esize\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efc1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efc2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eModel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;cuda\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 10\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"113-type\"\u003e§1.1.3 Type\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/tensor_attributes.html#torch-dtype\"\u003e\u003ccode\u003etorch.dtype\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enumpy.ndarray\u003c/code\u003e -\u0026gt; \u003ccode\u003etorch.Tensor\u003c/code\u003e:\u003c/p\u003e\n\u003cp\u003efloat64 -\u0026gt; float32\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandom\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efrom_numpy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efloat64\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.float64\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecpu\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.float32\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003etorch.Tensor\u003c/code\u003e -\u0026gt; \u003ccode\u003enumpy.ndarray\u003c/code\u003e:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ecuda\u003c/code\u003e -\u0026gt; \u003ccode\u003ecpu\u003c/code\u003e, float32 -\u0026gt; float64\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;cuda\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;cpu\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enumpy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eastype\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;float64\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.float32\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecuda:0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efloat32\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efloat64\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"12-torchnn\"\u003e§1.2 \u003ccode\u003etorch.nn\u003c/code\u003e\u003c/h3\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.Conv2d\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html\"\u003e\u003ccode\u003enn.Conv2d\u003c/code\u003e\u003c/a\u003e. Convolution is a kind of weighted mean.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e28\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e28\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003econv2d\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003econv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 3, 28, 28\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 12, 26, 26\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.MaxPool2d\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.MaxPool2d.html\"\u003e\u003ccode\u003enn.MaxPool2d\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e28\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e28\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003epool\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eMaxPool2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epool\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 3, 28, 28\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 3, 14, 14\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.BatchNorm2d\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.BatchNorm2d.html\"\u003e\u003ccode\u003enn.BatchNorm2d\u003c/code\u003e\u003c/a\u003e, See Fig.2 of \u003ca href=\"https://arxiv.org/abs/1803.08494\"\u003e[1803.08494] \u003cem\u003eGroup Normalization\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ebatchnorm\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eBatchNorm2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebatchnorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.Linear\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.Linear.html\"\u003e\u003ccode\u003enn.Linear\u003c/code\u003e\u003c/a\u003e. For fully connected layer.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elinear\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e128, 12\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.Dropout\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.Dropout.html\"\u003e\u003ccode\u003enn.Dropout\u003c/code\u003e\u003c/a\u003e. For fully connected layer. Using the samples in the Bernoulli distribution, some elements of the input tensor are randomly zeroed with probability $p$. To use it:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ep\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einplace\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003ex\u003c/code\u003e can be a tensor in any shape.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.ReLU\u003c/code\u003e or \u003ccode\u003eF.relu\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.ReLU.html\"\u003e\u003ccode\u003enn.ReLU\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.functional.relu.html\"\u003e\u003ccode\u003eF.relu\u003c/code\u003e\u003c/a\u003e. Activation function, $\\text{ReLU}(x)=\\max{(0,x)}$, to use it：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eReLU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eor:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003ex\u003c/code\u003e can be a tensor in any shape.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.RNN\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.RNN.html\"\u003e\u003ccode\u003enn.RNN\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ernn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eRNN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput_data\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_state\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ernn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_data\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 3, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.Module\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.Module.html\"\u003e\u003ccode\u003enn.Module\u003c/code\u003e\u003c/a\u003e. Construct a block of layers. It could be the entire model or just a block of the entire model or loss function, etc.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMyBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# define every layer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# define forward propagation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.Sequential\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.Sequential.html\"\u003e\u003ccode\u003enn.Sequential\u003c/code\u003e\u003c/a\u003e. Compared with \u003ccode\u003enn.Module\u003c/code\u003e, \u003ccode\u003enn.Sequential\u003c/code\u003e can add the layers more easily and don\u0026rsquo;t have to define forward propagation. This is more useful when building a simple neural network\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSequential\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eReLU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e30\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e30\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 64, 22, 22\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"2-cnn\"\u003e§2 CNN\u003c/h2\u003e\n\u003cp\u003eMNIST is here for the purpose of introducing the pipeline of Machine Learning; AlexNet showed the power of cuda and deep neural network; ResNet is the most popular CNN to this day and residual connections are also used in Transformers.\u003c/p\u003e\n\u003cp\u003e| \u003ca href=\"https://poloclub.github.io/cnn-explainer/\"\u003eCNN Explainer\u003c/a\u003e | \u003ca href=\"https://www.shadertoy.com/view/msVXWD\"\u003eHandwritten Digit Recognizer CNN\u003c/a\u003e |\u003c/p\u003e\n\u003ch3 id=\"21-mnist\"\u003e§2.1 MNIST\u003c/h3\u003e\n\u003cp\u003e| \u003ca href=\"https://github.com/pytorch/examples/tree/main/mnist\"\u003emnist (torch)\u003c/a\u003e | \u003ca href=\"https://pytorch.org/tutorials/beginner/nn_tutorial.html\"\u003e\u003cem\u003eWhat is torch.nn really?\u003c/em\u003e\u003c/a\u003e | \u003ca href=\"https://paperswithcode.com/sota/image-classification-on-mnist\"\u003eMNIST Benchmark\u003c/a\u003e | \u003ca href=\"https://karpathy.github.io/2022/03/14/lecun1989/\"\u003e\u003cem\u003eDeep Neural Nets: 33 years ago and 33 years from now\u003c/em\u003e\u003c/a\u003e |\u003c/p\u003e\n\u003ccenter\u003e\u003cimg src=\"https://production-media.paperswithcode.com/datasets/MNIST-0000000001-2e09631a_09liOmx.jpg\"\u003e\u003c/center\u003e\n\u003cp\u003eIn \u003ca href=\"https://github.com/pytorch/examples/tree/main/mnist\"\u003emnist (torch)\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eNet\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003etrain\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003etest\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003emain\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__name__\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;__main__\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003emain\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eCross Entropy Loss\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.functional.log_softmax.html\"\u003e\u003ccode\u003eF.log_softmax\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.functional.nll_loss.html\"\u003e\u003ccode\u003eF.nll_loss\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.functional.cross_entropy.html\"\u003e\u003ccode\u003eF.cross_entropy\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003epred\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_classes]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etarget\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size,]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enll_loss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elog_softmax\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epred\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etarget\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecross_entropy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epred\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etarget\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e2.6026\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e2.6026\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same result\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eclass Net\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eNet\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elog_softmax\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eNet\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e28\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e28\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, C, H, W]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLayer \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etype:depth-idx\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e                   Output Shape              Param \u003cspan style=\"color:#75715e\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNet                                      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 10\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                  --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Conv2d: 1-1                            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 32, 26, 26\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          \u003cspan style=\"color:#ae81ff\"\u003e320\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Conv2d: 1-2                            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 24, 24\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          18,496\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Dropout: 1-3                           \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 12, 12\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Linear: 1-4                            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                 1,179,776\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Dropout: 1-5                           \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                 --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Linear: 1-6                            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 10\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                  1,290\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal params: 1,199,882\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrainable params: 1,199,882\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNon-trainable params: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal mult-adds \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eM\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 192.82\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInput size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 0.05\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eForward/backward pass size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 7.51\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eParams size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 4.80\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEstimated Total Size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 12.35\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003edef train\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003etrain\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etrain_loader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eepoch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# set the model to training mode: activate dropout and batch normalization.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# go through each batch.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebatch_idx\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etarget\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eenumerate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_loader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# put data and target to device.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etarget\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etarget\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# the optimizer\u0026#39;s gradient is reset to 0.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezero_grad\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# forward pass.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# calculate loss.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enll_loss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etarget\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# calculate the gradients.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebackward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# backward propagation.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estep\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# print loss\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebatch_idx\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elog_interval\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;Train Epoch: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e [\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{:.0f}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e%)]\u003c/span\u003e\u003cspan style=\"color:#8045ff\"\u003e\\t\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003eLoss: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{:.6f}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eformat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#111\"\u003eepoch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebatch_idx\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elen\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elen\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_loader\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edataset\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#ae81ff\"\u003e100.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebatch_idx\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elen\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_loader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eitem\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# if `dry_run`, only run 1 epoch.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edry_run\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#00a8c8\"\u003ebreak\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003edef test\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003etest\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etest_loader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# set the model to evaluation mode.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eeval\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003etest_loss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ecorrect\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# gradient calculations are disabled.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ewith\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eno_grad\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etarget\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etest_loader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# put data and target to device.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etarget\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etarget\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# forward pass.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# calculate loss, sum up batch loss.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003etest_loss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enll_loss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etarget\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ereduction\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;sum\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eitem\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# get the index of the max log-probability.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003epred\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eargmax\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ekeepdim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# compare predicted labels with target labels.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ecorrect\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epred\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eeq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etarget\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview_as\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epred\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esum\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eitem\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# average loss per sample.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003etest_loss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elen\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etest_loader\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edataset\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# print\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#8045ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003eTest set: Average loss: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{:.4f}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e, Accuracy: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{:.0f}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e%)\u003c/span\u003e\u003cspan style=\"color:#8045ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eformat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003etest_loss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecorrect\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elen\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etest_loader\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edataset\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#ae81ff\"\u003e100.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecorrect\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elen\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etest_loader\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edataset\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003edef main\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003emain\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Training settings\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eparser\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eargparse\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eArgumentParser\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edescription\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;PyTorch MNIST Example\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eparser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eadd_argument\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;--batch-size\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edefault\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emetavar\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;N\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        \u003cspan style=\"color:#111\"\u003ehelp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;input batch size for training (default: 64)\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eparser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eadd_argument\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;--test-batch-size\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edefault\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1000\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emetavar\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;N\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        \u003cspan style=\"color:#111\"\u003ehelp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;input batch size for testing (default: 1000)\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eparser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eadd_argument\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;--epochs\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edefault\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e14\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emetavar\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;N\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        \u003cspan style=\"color:#111\"\u003ehelp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;number of epochs to train (default: 14)\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eparser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eadd_argument\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;--lr\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edefault\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emetavar\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;LR\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        \u003cspan style=\"color:#111\"\u003ehelp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;learning rate (default: 1.0)\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eparser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eadd_argument\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;--gamma\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edefault\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.7\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emetavar\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;M\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        \u003cspan style=\"color:#111\"\u003ehelp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;Learning rate step gamma (default: 0.7)\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eparser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eadd_argument\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;--no-cuda\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eaction\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;store_true\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edefault\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        \u003cspan style=\"color:#111\"\u003ehelp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;disables CUDA training\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eparser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eadd_argument\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;--no-mps\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eaction\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;store_true\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edefault\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        \u003cspan style=\"color:#111\"\u003ehelp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;disables macOS GPU training\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eparser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eadd_argument\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;--dry-run\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eaction\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;store_true\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edefault\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        \u003cspan style=\"color:#111\"\u003ehelp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;quickly check a single pass\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eparser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eadd_argument\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;--seed\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edefault\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emetavar\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;S\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        \u003cspan style=\"color:#111\"\u003ehelp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;random seed (default: 1)\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eparser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eadd_argument\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;--log-interval\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edefault\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emetavar\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;N\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        \u003cspan style=\"color:#111\"\u003ehelp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;how many batches to wait before logging training status\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eparser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eadd_argument\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;--save-model\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eaction\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;store_true\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edefault\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        \u003cspan style=\"color:#111\"\u003ehelp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;For Saving the current Model\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eparser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eparse_args\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003euse_cuda\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eno_cuda\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecuda\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eis_available\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003euse_mps\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eno_mps\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebackends\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emps\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eis_available\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emanual_seed\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eseed\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003euse_cuda\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;cuda\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003euse_mps\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;mps\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;cpu\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003etrain_kwargs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;batch_size\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003etest_kwargs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;batch_size\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etest_batch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003euse_cuda\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ecuda_kwargs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;num_workers\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                       \u003cspan style=\"color:#d88200\"\u003e\u0026#39;pin_memory\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                       \u003cspan style=\"color:#d88200\"\u003e\u0026#39;shuffle\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003etrain_kwargs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eupdate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecuda_kwargs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003etest_kwargs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eupdate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecuda_kwargs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# https://pytorch.org/vision/stable/transforms.html\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003etransform\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransforms\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eCompose\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003etransforms\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eToTensor\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003etransforms\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eNormalize\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.1307\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.3081\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# load training dataset and testing dataset\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003edataset1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edatasets\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eMNIST\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;../data\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etrain\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edownload\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                       \u003cspan style=\"color:#111\"\u003etransform\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransform\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003edataset2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edatasets\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eMNIST\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;../data\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etrain\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                       \u003cspan style=\"color:#111\"\u003etransform\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransform\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003etrain_loader\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eutils\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDataLoader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edataset1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_kwargs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003etest_loader\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eutils\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDataLoader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edataset2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etest_kwargs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# put model to device\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eNet\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# set optimizer and scheduler\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoptim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eAdadelta\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eparameters\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elr\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003escheduler\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eStepLR\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estep_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003egamma\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egamma\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# train and test\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eepoch\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eepochs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003etrain\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etrain_loader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eepoch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003etest\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etest_loader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003escheduler\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estep\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# save model\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eargs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esave_model\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esave\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estate_dict\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;mnist_cnn.pt\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eLater we will use \u003ccode\u003efastai\u003c/code\u003e instead of writing \u003ccode\u003edef train\u003c/code\u003e, \u003ccode\u003edef test\u003c/code\u003e, \u003ccode\u003edef main\u003c/code\u003e from scratch.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epython main.py\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get (full log see \u003ca href=\"20231011-wow-it-fits-secondhand-machine-learning-02_mnist.log\"\u003e02_mnist.log\u003c/a\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDownloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDownloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ../data/MNIST/raw/train-images-idx3-ubyte.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e100% 9912422/9912422 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e00:00\u0026lt;00:00, 96238958.45it/s\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExtracting ../data/MNIST/raw/train-images-idx3-ubyte.gz to ../data/MNIST/raw\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDownloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDownloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ../data/MNIST/raw/train-labels-idx1-ubyte.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e100% 28881/28881 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e00:00\u0026lt;00:00, 151799115.07it/s\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExtracting ../data/MNIST/raw/train-labels-idx1-ubyte.gz to ../data/MNIST/raw\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDownloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDownloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ../data/MNIST/raw/t10k-images-idx3-ubyte.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e100% 1648877/1648877 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e00:00\u0026lt;00:00, 27617389.31it/s\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExtracting ../data/MNIST/raw/t10k-images-idx3-ubyte.gz to ../data/MNIST/raw\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDownloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDownloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ../data/MNIST/raw/t10k-labels-idx1-ubyte.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e100% 4542/4542 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e00:00\u0026lt;00:00, 20180644.88it/s\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExtracting ../data/MNIST/raw/t10k-labels-idx1-ubyte.gz to ../data/MNIST/raw\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrain Epoch: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0/60000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e0%\u003cspan style=\"color:#f92672\"\u003e)]\u003c/span\u003e\tLoss: 2.282550\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrain Epoch: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e640/60000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e1%\u003cspan style=\"color:#f92672\"\u003e)]\u003c/span\u003e\tLoss: 1.384441\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrain Epoch: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e58880/60000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e98%\u003cspan style=\"color:#f92672\"\u003e)]\u003c/span\u003e\tLoss: 0.064402\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrain Epoch: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e59520/60000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)]\u003c/span\u003e\tLoss: 0.033435\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0468, Accuracy: 9842/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e98%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrain Epoch: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0/60000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e0%\u003cspan style=\"color:#f92672\"\u003e)]\u003c/span\u003e\tLoss: 0.098867\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrain Epoch: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e640/60000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e1%\u003cspan style=\"color:#f92672\"\u003e)]\u003c/span\u003e\tLoss: 0.016046\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrain Epoch: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e58880/60000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e98%\u003cspan style=\"color:#f92672\"\u003e)]\u003c/span\u003e\tLoss: 0.108346\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrain Epoch: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e59520/60000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)]\u003c/span\u003e\tLoss: 0.108657\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0327, Accuracy: 9894/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0346, Accuracy: 9887/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0314, Accuracy: 9891/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0301, Accuracy: 9903/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0301, Accuracy: 9913/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0293, Accuracy: 9918/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0295, Accuracy: 9919/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0296, Accuracy: 9915/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0277, Accuracy: 9919/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0284, Accuracy: 9922/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0272, Accuracy: 9922/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0278, Accuracy: 9921/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTest set: Average loss: 0.0278, Accuracy: 9922/10000 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e99%\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"22-alexnet-deep-learning-revolution\"\u003e§2.2 AlexNet: Deep Learning Revolution\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://www.image-net.org/\"\u003eImageNet\u003c/a\u003e: 14,197,122 images, 21841 synsets indexed.\u003c/p\u003e\n\u003cp\u003e| \u003ca href=\"https://proceedings.neurips.cc/paper_files/paper/2012/hash/c399862d3b9d6b76c8436e924a68c45b-Abstract.html\"\u003epaper\u003c/a\u003e | \u003ca href=\"https://github.com/pytorch/vision/blob/main/torchvision/models/alexnet.py\"\u003e\u003ccode\u003etorchvision.models.alexnet\u003c/code\u003e\u003c/a\u003e | \u003ca href=\"https://pytorch.org/hub/pytorch_vision_alexnet/\"\u003eAlexNet (pytorch.org)\u003c/a\u003e |\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align:left\"\u003eMethods\u003c/th\u003e\n\u003cth style=\"text-align:left\"\u003eDo we use it today?\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003e2 GPUs: written in \u003ccode\u003ecuda\u003c/code\u003e, split into 2 different pipelines with connection.\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e✔️\u0026amp;✖️\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eSimple activation function \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.ReLU.html\"\u003eReLU\u003c/a\u003e ($\\text{ReLU} (x) = \\max{(0,x)}$), instead of \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.Tanh.html\"\u003eTanh\u003c/a\u003e ($\\text{Tanh} (x) = \\tanh{(x)}$) or \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.functional.sigmoid.html\"\u003eSigmoid\u003c/a\u003e ($\\sigma (x)= (1+e^{-x})^{-1}$).\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e✔️\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eLocal response normalization\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e✖️\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eOverlapping pooling\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e✖️\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eThe feature map ($C$) keeps increasing (3 $\\to$ 48 $\\to$ 128 $\\to$ 192 $\\to$ 128), while the resolution ($H$, $W$) keeps decreasing (224 $\\to$ 55 $\\to$ 27 $\\to$ 13 $\\to$ 13 $\\to$ 13).\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e✔️\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eKernel size keeps decreasing (11 $\\to$ 5 $\\to$ 3 $\\to$ 3 $\\to$ 3)\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e✖️, same kernel size 3, see ResNet below\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eMultiple linear layers. (take most of the parameters, 55M/61M)\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e✖️\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eData augmentation (Image translations and horizontal reflections, color jitter)\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e\u003ca href=\"https://pytorch.org/vision/stable/transforms.html\"\u003e✔️\u003c/a\u003e, actually this is more data\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eDropout\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e✔️\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eAlexNet\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLayer \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etype:depth-idx\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e                   Output Shape              Param \u003cspan style=\"color:#75715e\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAlexNet                                  \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 1000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Sequential: 1-1                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 6, 6\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Conv2d: 2-1                       \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 55, 55\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          23,296\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ReLU: 2-2                         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 55, 55\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─MaxPool2d: 2-3                    \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 27, 27\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Conv2d: 2-4                       \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 192, 27, 27\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         307,392\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ReLU: 2-5                         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 192, 27, 27\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─MaxPool2d: 2-6                    \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 192, 13, 13\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Conv2d: 2-7                       \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 384, 13, 13\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         663,936\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ReLU: 2-8                         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 384, 13, 13\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Conv2d: 2-9                       \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 13, 13\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         884,992\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ReLU: 2-10                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 13, 13\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Conv2d: 2-11                      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 13, 13\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         590,080\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ReLU: 2-12                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 13, 13\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─MaxPool2d: 2-13                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 6, 6\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─AdaptiveAvgPool2d: 1-2                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 6, 6\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Sequential: 1-3                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 1000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Dropout: 2-14                     \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 9216\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Linear: 2-15                      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 4096\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                37,752,832\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ReLU: 2-16                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 4096\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Dropout: 2-17                     \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 4096\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Linear: 2-18                      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 4096\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                16,781,312\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ReLU: 2-19                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 4096\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Linear: 2-20                      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 1000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                4,097,000\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal params: 61,100,840\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrainable params: 61,100,840\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNon-trainable params: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal mult-adds \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eG\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 11.43\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInput size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 9.63\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eForward/backward pass size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 63.26\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eParams size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 244.40\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEstimated Total Size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 317.29\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"23-resnet-deeper\"\u003e§2.3 ResNet: Deeper\u003c/h3\u003e\n\u003cp\u003e| \u003ca href=\"https://arxiv.org/abs/1512.03385\"\u003epaper\u003c/a\u003e | \u003ca href=\"https://github.com/pytorch/vision/blob/main/torchvision/models/resnet.py\"\u003e\u003ccode\u003etorchvision.models.resnet\u003c/code\u003e\u003c/a\u003e | \u003ca href=\"https://pytorch.org/hub/pytorch_vision_resnet/\"\u003eResNet (pytorch.org)\u003c/a\u003e |\u003c/p\u003e\n\u003cp\u003eProblem: With deeper layers, the loss goes upwards (see Fig.1 of the paper), but even if all the added layers are identity functions, the loss would be the same.\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align:left\"\u003eMethods\u003c/th\u003e\n\u003cth style=\"text-align:left\"\u003eDo we use it today?\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eResidual connections to learn the differences and go \u003cstrong\u003edeeper\u003c/strong\u003e (50, 101, 152, 1202 layers, with 0.85M parameters to 19.4M parameters)\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e✔️\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eThe feature map ($C$) keeps increasing (64 $\\to$ 128 $\\to$ 256 $\\to$ 512), while the number of the resolution ($H$, $W$) keeps decreasing (224 $\\to$ 112 $\\to$ 56 $\\to$ 28 $\\to$ 14 $\\to$ 7 $\\to$ 1).\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e✔️\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eStride 2 convolution kernel, instead of pooling\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e✔️\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eBottleneck building block: $1 \\times 1$ convolution kernel\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e✔️\u0026amp;✖️\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eAdopt batch normalization (BN) right after each convolution and before activation\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e✔️\u0026amp;✖️, ongoing debate\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eBasically residual is:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"20231011-wow-it-fits-secondhand-machine-learning-residual-waste.jpg\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eSorry, not that \u0026ldquo;residual\u0026rdquo;. 🤣\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eRes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eBy using residual connections, the model will learn linearity first and non-linearity after. We will see residual connections in Transformers.\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003etorchvision.models.resnet\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003econv3x3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003econv1x1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eBasicBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eBottleneck\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eResNet\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003e_make_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003e_forward_impl\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eResNet18_Weights\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eresnet18\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eTo use it:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorchvision.models.resnet\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresnet18\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresnet18\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eor\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehub\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eload\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;pytorch/vision:v0.10.0\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;resnet18\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epretrained\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDownloading: \u003cspan style=\"color:#d88200\"\u003e\u0026#34;https://github.com/pytorch/vision/zipball/v0.10.0\u0026#34;\u003c/span\u003e to /root/.cache/torch/hub/v0.10.0.zip\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:208: UserWarning: The parameter \u003cspan style=\"color:#d88200\"\u003e\u0026#39;pretrained\u0026#39;\u003c/span\u003e is deprecated since 0.13 and may be removed in the future, please use \u003cspan style=\"color:#d88200\"\u003e\u0026#39;weights\u0026#39;\u003c/span\u003e instead.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  warnings.warn\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or \u003cspan style=\"color:#d88200\"\u003e`\u003c/span\u003eNone\u003cspan style=\"color:#d88200\"\u003e`\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;weights\u0026#39;\u003c/span\u003e are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing \u003cspan style=\"color:#d88200\"\u003e`\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eweights\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eResNet18_Weights.IMAGENET1K_V1\u003cspan style=\"color:#d88200\"\u003e`\u003c/span\u003e. You can also use \u003cspan style=\"color:#d88200\"\u003e`\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eweights\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eResNet18_Weights.DEFAULT\u003cspan style=\"color:#d88200\"\u003e`\u003c/span\u003e to get the most up-to-date weights.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  warnings.warn\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003emsg\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDownloading: \u003cspan style=\"color:#d88200\"\u003e\u0026#34;https://download.pytorch.org/models/resnet18-f37072fd.pth\u0026#34;\u003c/span\u003e to /root/.cache/torch/hub/checkpoints/resnet18-f37072fd.pth\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e100%\u003cspan style=\"color:#111\"\u003e|\u003c/span\u003e██████████\u003cspan style=\"color:#111\"\u003e|\u003c/span\u003e 44.7M/44.7M \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e00:00\u0026lt;00:00, 114MB/s\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLayer \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etype:depth-idx\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e                   Output Shape              Param \u003cspan style=\"color:#75715e\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eResNet                                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 1000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Conv2d: 1-1                            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 112, 112\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e        9,408\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─BatchNorm2d: 1-2                       \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 112, 112\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e        \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─ReLU: 1-3                              \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 112, 112\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e        --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─MaxPool2d: 1-4                         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Sequential: 1-5                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─BasicBlock: 2-1                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-1                  \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          36,864\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-2             \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-3                    \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-4                  \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          36,864\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-5             \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-6                    \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─BasicBlock: 2-2                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-7                  \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          36,864\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-8             \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-9                    \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-10                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          36,864\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-11            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-12                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Sequential: 1-6                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─BasicBlock: 2-3                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-13                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         73,728\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-14            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e256\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-15                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-16                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         147,456\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-17            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e256\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Sequential: 3-18             \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         8,448\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-19                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─BasicBlock: 2-4                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-20                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         147,456\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-21            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e256\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-22                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-23                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         147,456\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-24            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e256\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-25                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Sequential: 1-7                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─BasicBlock: 2-5                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-26                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         294,912\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-27            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-28                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-29                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         589,824\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-30            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Sequential: 3-31             \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         33,280\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-32                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─BasicBlock: 2-6                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-33                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         589,824\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-34            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-35                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-36                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         589,824\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-37            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-38                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Sequential: 1-8                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─BasicBlock: 2-7                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-39                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           1,179,648\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-40            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           1,024\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-41                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-42                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           2,359,296\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-43            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           1,024\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Sequential: 3-44             \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           132,096\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-45                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─BasicBlock: 2-8                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-46                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           2,359,296\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-47            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           1,024\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-48                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-49                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           2,359,296\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-50            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           1,024\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-51                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─AdaptiveAvgPool2d: 1-9                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 1, 1\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Linear: 1-10                           \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 1000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                513,000\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal params: 11,689,512\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrainable params: 11,689,512\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNon-trainable params: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal mult-adds \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eG\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 29.03\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInput size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 9.63\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eForward/backward pass size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 635.96\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eParams size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 46.76\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEstimated Total Size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 692.35\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eHomemade \u003ccode\u003eResNet18\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eResidualBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epadding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebn1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eBatchNorm2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eReLU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epadding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebn2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eBatchNorm2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSequential\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eBatchNorm2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eIdentity\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebn1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebn2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eResNet18\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_classes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1000\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epadding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebn1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eBatchNorm2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eReLU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emaxpool\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eMaxPool2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epadding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e_make_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e  \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e_make_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer3\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e_make_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e256\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer4\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e_make_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e256\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eavgpool\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eAdaptiveAvgPool2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efc\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_classes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# fully connected\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003e_make_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003elayers\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e[]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003elayers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eappend\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eResidualBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003elayers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eappend\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eResidualBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSequential\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebn1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emaxpool\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eavgpool\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esize\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efc\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eResNet18\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLayer \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etype:depth-idx\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e                   Output Shape              Param \u003cspan style=\"color:#75715e\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eResNet18                                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 1000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Conv2d: 1-1                            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 112, 112\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e        9,408\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─BatchNorm2d: 1-2                       \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 112, 112\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e        \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─ReLU: 1-3                              \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 112, 112\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e        --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─MaxPool2d: 1-4                         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Sequential: 1-5                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ResidualBlock: 2-1                \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-1                  \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          36,864\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-2             \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-3                    \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-4                  \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          36,864\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-5             \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Identity: 3-6                \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-7                    \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ResidualBlock: 2-2                \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-8                  \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          36,864\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-9             \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-10                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-11                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          36,864\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-12            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Identity: 3-13               \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-14                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 64, 56, 56\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e          --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Sequential: 1-6                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ResidualBlock: 2-3                \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-15                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         73,728\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-16            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e256\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-17                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-18                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         147,456\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-19            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e256\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Sequential: 3-20             \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         8,448\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-21                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ResidualBlock: 2-4                \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-22                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         147,456\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-23            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e256\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-24                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-25                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         147,456\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-26            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e256\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Identity: 3-27               \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-28                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 128, 28, 28\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Sequential: 1-7                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ResidualBlock: 2-5                \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-29                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         294,912\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-30            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-31                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-32                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         589,824\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-33            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Sequential: 3-34             \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         33,280\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-35                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ResidualBlock: 2-6                \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-36                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         589,824\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-37            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-38                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-39                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         589,824\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-40            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         \u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Identity: 3-41               \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-42                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 256, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Sequential: 1-8                        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ResidualBlock: 2-7                \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-43                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           1,179,648\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-44            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           1,024\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-45                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-46                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           2,359,296\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-47            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           1,024\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Sequential: 3-48             \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           132,096\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-49                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ResidualBlock: 2-8                \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-50                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           2,359,296\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-51            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           1,024\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-52                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Conv2d: 3-53                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           2,359,296\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─BatchNorm2d: 3-54            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           1,024\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─Identity: 3-55               \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─ReLU: 3-56                   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 7, 7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─AdaptiveAvgPool2d: 1-9                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 512, 1, 1\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e           --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Linear: 1-10                           \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 1000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                513,000\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal params: 11,689,512\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrainable params: 11,689,512\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNon-trainable params: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal mult-adds \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eG\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 29.03\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInput size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 9.63\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eForward/backward pass size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 635.96\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eParams size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 46.76\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEstimated Total Size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 692.35\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"3-transformer\"\u003e§3 Transformer\u003c/h2\u003e\n\u003cp\u003eTransformer is a general function fitter.\u003c/p\u003e\n\u003c!-- Transformer is about paying attention to residuals and dropouts haha. --\u003e\n\u003ch3 id=\"31-embedding\"\u003e§3.1 Embedding\u003c/h3\u003e\n\u003cp\u003eEmbedding is ordered higher-dimensional representation vectors.\u003c/p\u003e\n\u003ch4 id=\"311-nnembedding\"\u003e§3.1.1 \u003ccode\u003enn.Embedding\u003c/code\u003e\u003c/h4\u003e\n\u003cp\u003eWords in \u003ccode\u003ehidden_dim\u003c/code\u003e vector space: $\\vec{R} + \\vec{L} = \\vec{J}$, $\\vec{king} - \\vec{man} = \\vec{queen} - \\vec{woman}$.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/openai/tiktoken\"\u003e\u003ccode\u003etiktoken\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://tiktokenizer.vercel.app/\"\u003eTiktokenizer\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.Embedding\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.Embedding.html\"\u003e\u003ccode\u003enn.Embedding\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eNUM_INDEX\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eEMBEDDING_DIM\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eembedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eNUM_INDEX\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eEMBEDDING_DIM\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eweight\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edetach\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLongTensor\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e 0.0378,  1.0396, -0.9673,  0.9697\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.7824,  1.8141,  0.5336, -1.6396\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e 0.1903,  0.6592,  1.4589, -0.6018\u003cspan style=\"color:#f92672\"\u003e]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e 0.1903,  0.6592,  1.4589, -0.6018\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e 0.0378,  1.0396, -0.9673,  0.9697\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003egrad_fn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026lt;EmbeddingBackward0\u0026gt;\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eF.one_hot\u003c/code\u003e then linear\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.functional.one_hot.html\"\u003e\u003ccode\u003eF.one_hot\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eone_hot\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eone_hot\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_classes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eNUM_INDEX\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eone_hot\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elinear\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eNUM_INDEX\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eEMBEDDING_DIM\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elinear\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eweight\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eParameter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eweight\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eT\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edetach\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eone_hot\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e0, 0, 1\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 0, 0\u003cspan style=\"color:#f92672\"\u003e]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e 0.1903,  0.6592,  1.4589, -0.6018\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e 0.0378,  1.0396, -0.9673,  0.9697\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003egrad_fn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026lt;MmBackward0\u0026gt;\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# same result\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"312-sinusoidal-positional-embedding\"\u003e§3.1.2 Sinusoidal Positional Embedding\u003c/h4\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eclass Embedding\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e50257\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emath\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esqrt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eclass PositionalEncoding\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eThe positional encoding $$\\begin{aligned} PE_{(pos, 2i)} \u0026amp;= \\sin(\\frac{pos}{ 10000^{2i/{d_{model}}}}) \\\\ PE_{(pos, 2i + 1)} \u0026amp;= \\cos(\\frac{pos}{10000^{2i/{d_{model}}}}) \\end{aligned}$$, where $pos$ is each element in the sequence up to \u003ccode\u003evocab_size\u003c/code\u003e, and $d_{model}$ is \u003ccode\u003ehidden_dim\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003ePositionalEncoding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e50257\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003epe\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eposition\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003earange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ediv_term\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexp\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003earange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emath\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elog\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10000.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003epe\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e::\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esin\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eposition\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ediv_term\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003epe\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e::\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecos\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eposition\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ediv_term\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003epe\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epe\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epe\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epe\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epe\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erequires_grad_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003etesting\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e50257\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e196\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length], words as int numbers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eembeddings\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eembeddings\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003epositional_encoding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ePositionalEncoding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epositional_encoding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWe will often see another way to write it:\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eclass SinusoidalPosEmb\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eSinusoidalPosEmb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eM\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10000\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eM\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eM\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ehalf_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eemb\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emath\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elog\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eM\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehalf_dim\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eemb\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexp\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003earange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehalf_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eemb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eemb\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eemb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eemb\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eemb\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esin\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eemb\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecos\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eemb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003etesting\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e196\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length], words as float numbers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esinusoidal_pos_emb\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eSinusoidalPosEmb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esinusoidal_pos_emb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"32-transformer-encoder\"\u003e§3.2 Transformer Encoder\u003c/h3\u003e\n\u003ch4 id=\"321-ffn-mlp\"\u003e§3.2.1 FFN (MLP)\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://jmlr.org/papers/volume3/bengio03a/bengio03a.pdf\"\u003e\u003cem\u003eA Neural Probabilistic Language Model\u003c/em\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eEquation\u003c/p\u003e\n\u003cp\u003eFeed Forward Network works on each \u003ccode\u003e[seq_length, ]\u003c/code\u003e vector individually $$\\text{FFN}(x)=(\\text{ReLU}(xW_1+b_1))W_2+b_2$$, where $\\text{ReLU}(x)=\\max{(0,x)}$. Here we replace \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.ReLU.html\"\u003e\u003ccode\u003enn.ReLU\u003c/code\u003e\u003c/a\u003e with \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.GELU.html\"\u003e\u003ccode\u003enn.GELU\u003c/code\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eclass FFN\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eFFN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinear1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_features\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_features\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eact\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eGELU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinear2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_features\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_features\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinear1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eact\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinear2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003etesting\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e196\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003effn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eFFN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"322-multiheadattention\"\u003e§3.2.2 MultiheadAttention\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.MultiheadAttention.html\"\u003e\u003ccode\u003enn.MultiheadAttention\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.functional.scaled_dot_product_attention.html\"\u003e\u003ccode\u003eF.scaled_dot_product_attention\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://pytorch.org/blog/flexattention/\"\u003eFlexAttention\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eEquation\u003c/p\u003e\n\u003cp\u003eSelf-Attention: Given an input $x$, we will get query $Q$, key $K$, value $V$ by $$\\begin{aligned} Q\u0026amp;=xW^Q \\\\ K\u0026amp;=xW^K \\\\ V\u0026amp;=xW^V\\end{aligned}$$Then $$\\text{Attention}(Q, K, V) = \\frac{1}{\\sqrt{d_{k}}}\\text{Softmax}(QK^\\mathsf{T})V$$, where for a vector $\\vec{z_i}$, $\\text{Softmax}(\\vec{z_i}) = \\frac{e^{\\vec{z_i}}}{\\sum_{i=0}^N e^{\\vec{z_i}}}$, and $$\\text{MultiheadAttention} (Q, K, V) = \\text{Concat}(\\text{head}_1, \\cdots, \\text{head}_h) W^O$$, where $\\text{head}_i = \\text{Attention} (xW^Q_i, xW^K_i, xW^V_i)$, and $h$ is \u003ccode\u003enum_heads\u003c/code\u003e in the code.\u003c/p\u003e\n\u003cp\u003eThe advantage of Softmax:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://en.wikipedia.org/wiki/Matthew_effect\"\u003eMatthew effect\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eNon-linearity\u003c/li\u003e\n\u003cli\u003eNormalization\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNote that in the figure below, only \u003ccode\u003eq_size = k_size\u003c/code\u003e is necessary. But in the code, \u003ccode\u003eq_size = k_size = v_size = hidden_dim\u003c/code\u003e.\u003c/p\u003e\n  \u003c!-- ViT中v_size=1，而不是使用cls token --\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"20231011-wow-it-fits-secondhand-machine-learning-attention.svg\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eclass MultiheadAttention\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMultiheadAttention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003escale\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_qkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_o\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_qkv\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim * 3]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, 3, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epermute\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [3, batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# q, k, v shape: [batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# attn shape: [batch_size, num_heads, seq_length, seq_length]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003escale\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e@\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etranspose\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# `torch.matmul`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# masked/causal attention\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emasked_fill_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# `torch.Tensor.masked_fill_`, add mask by broadcasting\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etriu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eones\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebool\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ediagonal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;-inf\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esoftmax\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e@\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etranspose\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ereshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_o\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003etesting\u003c/p\u003e\n\u003cp\u003eAdd 4 lines of \u003ccode\u003eprint()\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMultiheadAttention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003escale\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_qkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_o\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_qkv\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim * 3]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, 3, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epermute\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [3, batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# q, k, v shape: [batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# attn shape: [batch_size, num_heads, seq_length, seq_length]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003escale\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e@\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etranspose\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# `torch.matmul`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# masked/causal attention\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emasked_fill_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# `torch.Tensor.masked_fill_`, add mask by broadcasting\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etriu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eones\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebool\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ediagonal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;-inf\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esoftmax\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eattn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e@\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etranspose\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ereshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_o\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emultihead_attention\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMultiheadAttention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;No mask:\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emultihead_attention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;Masked:\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emultihead_attention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNo mask:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[[[\u003c/span\u003e-0.0302, -0.0241, -0.0071, -0.0822\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e 0.0041,  0.0307,  0.0372, -0.0366\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.0460, -0.0571,  0.1467,  0.1020\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.0685, -0.0811,  0.1513,  0.0700\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e 0.0744,  0.0987,  0.2944,  0.3069\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e 0.0538,  0.0855,  0.2632,  0.2898\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.0052,  0.0453,  0.1585,  0.2132\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e 0.0034,  0.0774,  0.2627,  0.3394\u003cspan style=\"color:#f92672\"\u003e]]]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       \u003cspan style=\"color:#111\"\u003egrad_fn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026lt;UnsafeViewBackward0\u0026gt;\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 2, 4, 4\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_heads, seq_length, seq_length]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[[[\u003c/span\u003e0.2513, 0.2529, 0.2572, 0.2386\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2487, 0.2554, 0.2571, 0.2388\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2293, 0.2268, 0.2780, 0.2659\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2282, 0.2254, 0.2843, 0.2621\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e0.2206, 0.2261, 0.2749, 0.2784\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2207, 0.2278, 0.2721, 0.2794\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2235, 0.2351, 0.2633, 0.2781\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2095, 0.2256, 0.2716, 0.2932\u003cspan style=\"color:#f92672\"\u003e]]]]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003egrad_fn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026lt;SoftmaxBackward0\u0026gt;\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 2, 4, 4\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMasked:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[[[\u003c/span\u003e-0.0302,    -inf,    -inf,    -inf\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e 0.0041,  0.0307,    -inf,    -inf\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.0460, -0.0571,  0.1467,    -inf\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.0685, -0.0811,  0.1513,  0.0700\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e 0.0744,    -inf,    -inf,    -inf\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e 0.0538,  0.0855,    -inf,    -inf\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.0052,  0.0453,  0.1585,    -inf\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e 0.0034,  0.0774,  0.2627,  0.3394\u003cspan style=\"color:#f92672\"\u003e]]]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       \u003cspan style=\"color:#111\"\u003egrad_fn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026lt;MaskedFillBackward0\u0026gt;\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 2, 4, 4\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[[[\u003c/span\u003e1.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.4934, 0.5066, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.3124, 0.3089, 0.3787, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2282, 0.2254, 0.2843, 0.2621\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e1.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.4921, 0.5079, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.3096, 0.3257, 0.3647, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2095, 0.2256, 0.2716, 0.2932\u003cspan style=\"color:#f92672\"\u003e]]]]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003egrad_fn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026lt;SoftmaxBackward0\u0026gt;\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 2, 4, 4\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eUse \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.functional.scaled_dot_product_attention.html\"\u003e\u003ccode\u003eF.scaled_dot_product_attention\u003c/code\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMultiheadAttention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_qkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_o\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_qkv\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim * 3]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, 3, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epermute\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [3, batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# q, k, v shape: [batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003escaled_dot_product_attention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout_p\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etraining\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etranspose\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_o\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e196\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emultihead_attention\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMultiheadAttention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emultihead_attention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"323-transformerencoderlayer\"\u003e§3.2.3 TransformerEncoderLayer\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.TransformerEncoderLayer.html\"\u003e\u003ccode\u003enn.TransformerEncoderLayer\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eTransformerEncoderLayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm_1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLayerNorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattention\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMultiheadAttention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm_2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLayerNorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003effn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eFFN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn_scale\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emath\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esqrt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layersr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm_1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn_scale\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm_2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003effn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn contrast with the Original Transformer, Layer Norm is put before Attention, see \u003ca href=\"https://arxiv.org/abs/2002.04745\"\u003e[2002.04745] \u003cem\u003eOn Layer Normalization in the Transformer Architecture\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTransformerEncoderLayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e196\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLayer \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etype:depth-idx\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e                   Output Shape              Param \u003cspan style=\"color:#75715e\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTransformerEncoderLayer                  \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e             --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─LayerNorm: 1-1                         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e             1,536\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─MultiheadAttention: 1-2                \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e             --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Linear: 2-1                       \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 2304\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            1,771,776\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Dropout: 2-2                      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 12, 196, 196\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Linear: 2-3                       \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e             590,592\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Dropout: 2-4                      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e             --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Dropout: 1-3                           \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e             --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─LayerNorm: 1-4                         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e             1,536\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─FFN: 1-5                               \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e             --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Linear: 2-5                       \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 3072\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            2,362,368\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─GELU: 2-6                         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 3072\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Dropout: 2-7                      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 3072\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Linear: 2-8                       \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e             2,360,064\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Dropout: 2-9                      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e             --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Dropout: 1-6                           \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e             --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal params: 7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrainable params: 7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNon-trainable params: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal mult-adds \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eM\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 7.09\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInput size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 0.60\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eForward/backward pass size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 13.25\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eParams size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 28.35\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEstimated Total Size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 42.20\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==========================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eMost of the parameters is in \u003ccode\u003eFNN\u003c/code\u003e rather than \u003ccode\u003eMultiheadAttention\u003c/code\u003e. \u003ccode\u003eFFN\u003c/code\u003e takes 66.66%, while \u003ccode\u003eMultiheadAttention\u003c/code\u003e takes 33.33%. This is even more so with MoE, which has several FFNs.\u003c/p\u003e\n\u003ch4 id=\"324-transformerencoder\"\u003e§3.2.4 TransformerEncoder\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.TransformerEncoder.html\"\u003e\u003ccode\u003enn.TransformerEncoder\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eTransformerEncoder\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_encoder_layers\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModuleList\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eTransformerEncoderLayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etransformer_encoder_layer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_encoder_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etransformer_encoder_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"33-encoder-decoder-encoder-only-decoder-only\"\u003e§3.3 Encoder-Decoder, Encoder-Only, Decoder-Only\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eEncoder-Decoder: seq2seq\u003c/th\u003e\n\u003cth\u003eEncoder-Decoder: Transformer\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003cimg\r\n  src=\"https://d2l.ai/_images/seq2seq-state.svg\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/td\u003e\n\u003ctd\u003e\u003cimg\r\n  src=\"https://d2l.ai/_images/transformer.svg\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e| \u003ca href=\"https://www.practicalai.io/understanding-transformer-model-architectures/\"\u003e\u003cem\u003eUnderstanding Transformer model architectures\u003c/em\u003e (practicalai.io)\u003c/a\u003e | \u003ca href=\"https://d2l.ai/chapter_attention-mechanisms-and-transformers/large-pretraining-transformers.html\"\u003e\u003cem\u003e11.9. Large-Scale Pretraining with Transformers\u003c/em\u003e (d2l.ai)\u003c/a\u003e |\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align:left\"\u003e\u003c/th\u003e\n\u003cth style=\"text-align:left\"\u003eNLP\u003c/th\u003e\n\u003cth style=\"text-align:left\"\u003eCV\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eEncoder-Decoder\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e\u003ca href=\"https://arxiv.org/abs/1706.03762\"\u003e[1706.03762] \u003cem\u003eAttention is All You Need\u003c/em\u003e\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/1910.10683\"\u003eT5\u003c/a\u003e\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e\u003ca href=\"https://arxiv.org/abs/2106.08254\"\u003eBEiT\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eEncoder-Only\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e\u003ca href=\"https://arxiv.org/abs/1810.04805\"\u003eBERT\u003c/a\u003e, \u003ca href=\"https://github.com/AnswerDotAI/ModernBERT/\"\u003eModernBERT\u003c/a\u003e\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e\u003ca href=\"https://arxiv.org/abs/2010.11929\"\u003eViT\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003eDecoder-Only\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e\u003ca href=\"https://cdn.openai.com/research-covers/language-unsupervised/language_understanding_paper.pdf\"\u003eGPT\u003c/a\u003e, \u003ca href=\"https://cdn.openai.com/better-language-models/language_models_are_unsupervised_multitask_learners.pdf\"\u003eGPT-2\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/2005.14165\"\u003eGPT-3\u003c/a\u003e, \u003ca href=\"https://github.com/karpathy/nanoGPT\"\u003enanoGPT\u003c/a\u003e, \u003ca href=\"https://github.com/KellerJordan/modded-nanogpt/\"\u003emodded-nanogpt\u003c/a\u003e\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eFig.1 of \u003ca href=\"https://arxiv.org/abs/2304.13712\"\u003e[2304.13712] \u003cem\u003eHarnessing the Power of LLMs in Practice: A Survey on ChatGPT and Beyond\u003c/em\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://pbs.twimg.com/media/GBrF-tHWYAA10wE?format=png\"\r\n  alt=\"Fig1_of_2304.13712\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e\u003c/th\u003e\n\u003cth\u003eOriginal Transformer, Encoder\u003c/th\u003e\n\u003cth\u003eOriginal Transformer, Decoder\u003c/th\u003e\n\u003cth\u003eViT (Encoder-Only)\u003c/th\u003e\n\u003cth\u003eGPT (Decoder-Only)\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eSelf-Attention or Cross-Attention\u003c/td\u003e\n\u003ctd\u003eSelf-Attention\u003c/td\u003e\n\u003ctd\u003eThe first Self-Attention, the second Cross-Attention\u003c/td\u003e\n\u003ctd\u003eSelf-Attention\u003c/td\u003e\n\u003ctd\u003eSelf-Attention\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eMask/Causal\u003c/td\u003e\n\u003ctd\u003e✖️\u003c/td\u003e\n\u003ctd\u003e✔️\u003c/td\u003e\n\u003ctd\u003e✖️\u003c/td\u003e\n\u003ctd\u003e✔️\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"34-attention-is-all-you-need-the-original-transformer\"\u003e§3.4 Attention is All You Need (the Original Transformer)\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://arxiv.org/abs/1706.03762\"\u003e[1706.03762] \u003cem\u003eAttention Is All You Need\u003c/em\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eA pure Transformer structure instead of RNNs.\u003c/li\u003e\n\u003cli\u003eUse \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.Softmax.html\"\u003eSoftmax\u003c/a\u003e to let query $Q$ choose different $K^\\mathsf{T}$.\u003c/li\u003e\n\u003cli\u003eThe encoder provides keys $K$ and value $V$, while the decoder provides query $Q$. (Cross-Attention)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"35-vision-transformer-vit\"\u003e§3.5 Vision Transformer (ViT)\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://arxiv.org/abs/2010.11929\"\u003e[2010.11929] \u003cem\u003eAn Image is Worth 16x16 Words: Transformers for Image Recognition at Scale\u003c/em\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eA pure Transformer structure instead of CNNs.\u003c/li\u003e\n\u003cli\u003eGeneral function fitter instead of good inductive prior.\u003c/li\u003e\n\u003cli\u003eWith enough data.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://d2l.ai/_images/vit.svg\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ch4 id=\"351-patchembedding\"\u003e§3.5.1 PatchEmbedding\u003c/h4\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eclass PatchEmbedding\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003ePatchEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv2d\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003epadding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eclass PatchEmbedding_noConv\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eor without convolution:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003ePatchEmbedding_noConv\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"352-visiontransformer\"\u003e§3.5.2 VisionTransformer\u003c/h4\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eHomemade \u003ccode\u003eTransformerEncoder\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eVisionTransformer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eimage_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_classes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1000\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ePatchEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epos_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eParameter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eempty\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eimage_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enormal_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estd\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.02\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eclass_token\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eParameter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eempty\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_encoder\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eTransformerEncoder\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# self.layer_norm = nn.LayerNorm(hidden_dim)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eproj\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_classes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_embedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epos_embedding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_class_token\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eclass_token\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexpand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_class_token\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_encoder\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# x = self.layer_norm(x)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eproj\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eVisionTransformer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e===============================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLayer \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etype:depth-idx\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e                        Output Shape              Param \u003cspan style=\"color:#75715e\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e===============================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eVisionTransformer                             \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 1000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                151,296\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─PatchEmbedding: 1-1                         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 196, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Conv2d: 2-1                            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 768, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         590,592\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─TransformerEncoder: 1-2                     \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ModuleList: 2-2                        --                        --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-1      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-2      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-3      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-4      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-5      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-6      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-7      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-8      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-9      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-10     \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-11     \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-12     \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Linear: 1-3                                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 1000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                769,000\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e===============================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal params: 86,565,352\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrainable params: 86,565,352\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNon-trainable params: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal mult-adds \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eG\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 3.23\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e===============================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInput size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 9.63\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eForward/backward pass size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 2575.69\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eParams size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 345.66\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEstimated Total Size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 2930.98\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e===============================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enn.TransformerEncoder\u003c/code\u003e (\u003ccode\u003etorch 2.2.0+cu121\u003c/code\u003e)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eVisionTransformer_torch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eimage_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_classes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1000\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ePatchEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epos_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eParameter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eempty\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eimage_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enormal_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estd\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.02\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eclass_token\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eParameter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eempty\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003etransformer_encoder_layer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTransformerEncoderLayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ed_model\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enhead\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim_feedforward\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebatch_first\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_encoder\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTransformerEncoder\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_encoder_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# self.layer_norm = nn.LayerNorm(hidden_dim)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eproj\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_classes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_embedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epos_embedding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_class_token\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eclass_token\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexpand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_class_token\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_encoder\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# x = self.layer_norm(x)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eproj\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eVisionTransformer_torch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill, surprisingly, get the same total parameters (\u003ccode\u003e86,565,352\u003c/code\u003e), though the sizes (MB) are way smaller:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e===============================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLayer \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etype:depth-idx\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e                        Output Shape              Param \u003cspan style=\"color:#75715e\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e===============================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eVisionTransformer_torch                       \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 1000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                151,296\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─PatchEmbedding: 1-1                         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 196, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─Conv2d: 2-1                            \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 768, 14, 14\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e         590,592\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─TransformerEncoder: 1-2                     \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    └─ModuleList: 2-2                        --                        --\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-1      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-2      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-3      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-4      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-5      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-6      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-7      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-8      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-9      \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-10     \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-11     \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│    │    └─TransformerEncoderLayer: 3-12     \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 197, 768\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e            7,087,872\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├─Linear: 1-3                                 \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e16, 1000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e                769,000\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e===============================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal params: 86,565,352\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTrainable params: 86,565,352\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNon-trainable params: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal mult-adds \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eG\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 1.86\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e===============================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInput size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 9.63\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eForward/backward pass size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 19.40\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eParams size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 5.44\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEstimated Total Size \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eMB\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e: 34.47\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e===============================================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"353-fine-tuning-of-vit\"\u003e§3.5.3 fine-tuning of ViT\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://arxiv.org/abs/2203.09795\"\u003e[2203.09795] \u003cem\u003eThree things everyone should know about Vision Transformers\u003c/em\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eParallel vision transformers.\u003c/li\u003e\n\u003cli\u003eFine-tuning attention is all you need.\u003c/li\u003e\n\u003cli\u003ePatch preprocessing with masked self-supervised learning.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"36-generative-pre-trained-transformer-gpt\"\u003e§3.6 Generative Pre-trained Transformer (GPT)\u003c/h3\u003e\n\u003cp\u003eNote that in the original Transformer, the Decoder has two attention. However in the Decoder of GPT, there is only one attention. And GPTs are called \u0026ldquo;Decoder-Only\u0026rdquo; because:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eBy using masks, GPTs are autoregressive, meaning that the model takes previous $(t-1)^{th}$ words to produce the $t^{th}$ word.\u003c/li\u003e\n\u003cli\u003eTheir task is to generate text, similar to the Decoder in the original Transformer.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"361-gptdecoderlayer\"\u003e§3.6.1 GPTDecoderLayer\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eGPTDecoderLayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm_1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLayerNorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattention\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMultiheadAttention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm_2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLayerNorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003effn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eFFN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn_scale\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emath\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esqrt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layersr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm_1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn_scale\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm_2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003effn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"362-gptdecoder\"\u003e§3.6.2 GPTDecoder\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eGPTDecoder\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egpt_decoder_layers\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModuleList\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eGPTDecoderLayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003egpt_decoder_layer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egpt_decoder_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003egpt_decoder_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"363-gptlanguagemodel\"\u003e§3.6.3 GPTLanguageModel\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eGPTLanguageModel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e50257\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ewindow_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epositional_encoding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ePositionalEncoding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egpt_decoder\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eGPTDecoder\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLayerNorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eproj\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eproj\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eweight\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eweight\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# https://arxiv.org/abs/1608.05859\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etargets\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# index, targets shape: [batch_size, seq_length]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# embedding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epositional_encoding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Transformer Decoder\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egpt_decoder\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# project out\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eproj\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, vocab_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etargets\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eis\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evocab_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003etargets\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etargets\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecross_entropy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etargets\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75af00\"\u003e@torch.no_grad\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003egenerate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emax_new_tokens\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# index shape [batch_size, seq_length]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emax_new_tokens\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# crop index to the last window_size tokens\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eindex_cond\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ewindow_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# get the predictions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex_cond\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# focus only on the last time step\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:]\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# [batch_size, vocab_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# apply softmax to get probabilities\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eprobs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esoftmax\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# [batch_size, vocab_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# sample from the distribution\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eindex_next\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emultinomial\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eprobs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_samples\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# [batch_size, 1]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# append sampled index to the running sequence\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex_next\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length+1]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003egpt_language_model\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eGPTLanguageModel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e50257\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e196\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etargets\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e50257\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e196\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003egpt_language_model\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etargets\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elogits\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size*seq_length, vocab_size]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e196, 50257\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e10.9951, \u003cspan style=\"color:#111\"\u003egrad_fn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026lt;NllLossBackward0\u0026gt;\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"364-fine-tuning-of-llm\"\u003e§3.6.4 fine-tuning of LLM\u003c/h4\u003e\n\u003cp\u003eThe ULMFiT 3-step approach (see Fig.1 of \u003ca href=\"https://arxiv.org/abs/1801.06146\"\u003e[1801.06146] \u003cem\u003eUniversal Language Model Fine-tuning for Text Classification\u003c/em\u003e\u003c/a\u003e):\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eLanguage Model pre-training.\u003c/li\u003e\n\u003cli\u003eInstruction tuning.\u003c/li\u003e\n\u003cli\u003eRLHF (Reinforcement Learning from Human Feedback).\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"37-variants\"\u003e§3.7 Variants\u003c/h3\u003e\n\u003cp\u003eGenerally speaking most papers have this kind of naming convention:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eOriginal Transformer: \u003ca href=\"https://arxiv.org/abs/1706.03762\"\u003e1706.03762\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eVanilla Transformer: The original Transformer with ReLU activation and layer normalization \u003ca href=\"https://arxiv.org/abs/1607.06450\"\u003e1607.06450\u003c/a\u003e outside of the residual path.\u003c/li\u003e\n\u003cli\u003eTransformer+GELU: A variant of the vanilla Transformer that uses GELU \u003ca href=\"https://arxiv.org/abs/1606.08415\"\u003e1606.08415\u003c/a\u003e activations or its approximation.\u003c/li\u003e\n\u003cli\u003eTransformer++: A variant of the vanilla Transformer that uses RoPE embedding \u003ca href=\"https://arxiv.org/abs/2104.09864\"\u003e2104.09864\u003c/a\u003e, RMS normalization \u003ca href=\"https://arxiv.org/abs/1910.07467\"\u003e1910.07467\u003c/a\u003e, Swish activation or GeGLU activation in the FFN \u003ca href=\"https://arxiv.org/abs/2002.05202\"\u003e2002.05202\u003c/a\u003e. The bias terms in all the linear layers in FFN layers and Attention layers are \u003ccode\u003eFalse\u003c/code\u003e, except for the final encoder layer. For example, \u003ca href=\"https://github.com/AnswerDotAI/ModernBERT\"\u003eModernBERT\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBelow is an implementation of Transformer++:\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ePyTorch\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eprecompute_freqs_cis\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eend\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erope_theta\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10000.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003efreqs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1.0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erope_theta\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003earange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)[:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003et\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003earange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eend\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efreqs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003efreqs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eouter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003et\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efreqs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epolar\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eones_like\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efreqs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efreqs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# complex64\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003ereshape_for_broadcast\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003endim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003endim\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eassert\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e \u003cspan style=\"color:#111\"\u003endim\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eassert\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ed\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#111\"\u003endim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ed\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eenumerate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eapply_rotary_emb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eq_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview_as_complex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ereshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ek_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview_as_complex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ereshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ereshape_for_broadcast\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eq_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eq_out\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview_as_real\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eq_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eflatten\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ek_out\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview_as_real\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ek_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eflatten\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eq_out\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etype_as\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek_out\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etype_as\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eGeGLU_FFN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinear1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_features\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_features\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinear2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_features\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_features\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003egeglu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eassert\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003echunk\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinear2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egeglu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinear1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMultiheadAttention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_qkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_o\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_qkv\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim * 3]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, 3, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epermute\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [3, batch_size, seq_length, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# q, k, v shape: [batch_size, seq_length, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eapply_rotary_emb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etranspose\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etranspose\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etranspose\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# q, k, v shape: [batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003escaled_dot_product_attention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout_p\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etraining\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etranspose\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_o\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eTransformerLayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erms_norm\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eRMSNorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eeps\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1e-5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattention\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMultiheadAttention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003effn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eGeGLU_FFN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn_scale\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emath\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esqrt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erms_norm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn_scale\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erms_norm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003effn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eTransformer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emax_seq_length\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e196\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erope_theta\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10000.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eprecompute_freqs_cis\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emax_seq_length\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erope_theta\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_layers\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModuleList\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eappend\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTransformerLayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eappend\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTransformerLayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# self.rms_norm = nn.RMSNorm(hidden_dim, eps=1e-5)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etransformer_layer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etransformer_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efreqs_cis\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# x = self.rms_norm(x)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e196\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;cuda\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etransformer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eTransformer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;cuda\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# transformer = torch.compile(transformer)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etransformer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eFlashAttention\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eOr, after installing:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epip install triton\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epip install flash-attn --no-build-isolation\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe can use \u003ca href=\"https://github.com/Dao-AILab/flash-attention/blob/main/flash_attn/layers/rotary.py#L341\"\u003e\u003ccode\u003eflash_attn.layers.rotary.RotaryEmbedding\u003c/code\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eflash_attn.layers.rotary\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eRotaryEmbedding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# from flash_attn import flash_attn_qkvpacked_func\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eGeGLU_FFN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinear1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_features\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_features\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinear2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_features\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_features\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003egeglu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eassert\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003echunk\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinear2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egeglu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinear1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMultiheadAttention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_qkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_o\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erotary_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eRotaryEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_qkv\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim * 3]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, 3, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erotary_embedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, 3, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epermute\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [3, batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eqkv\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# q, k, v shape: [batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003escaled_dot_product_attention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eq\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout_p\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etraining\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_heads, seq_length, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etranspose\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# x = flash_attn_qkvpacked_func(qkv, dropout_p=(self.dropout if self.training else 0.0), softmax_scale=None, causal=False, window_size=(-1, -1), alibi_slopes=None, deterministic=False)# [batch_size, seq_length, num_heads, hidden_dim // num_heads]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew_o\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eTransformerLayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erms_norm\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eRMSNorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eeps\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1e-5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattention\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMultiheadAttention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003effn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eGeGLU_FFN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn_scale\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emath\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esqrt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erms_norm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn_scale\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erms_norm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003effn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresidual\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eTransformer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_layers\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModuleList\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eappend\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTransformerLayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_layers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eappend\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTransformerLayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# self.rms_norm = nn.RMSNorm(hidden_dim, eps=1e-5)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etransformer_layer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etransformer_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eis_causal\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# x = self.rms_norm(x)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e196\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;cuda\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etransformer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eTransformer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;cuda\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etransformer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecompile\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etransformer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"38-mixture-of-experts-moe\"\u003e§3.8 Mixture of Experts (MoE)\u003c/h3\u003e\n\u003cp\u003eMixture of Experts (MoE):\n| \u003ca href=\"https://arxiv.org/abs/1701.06538\"\u003e[1701.06538] \u003cem\u003eOutrageously Large Neural Networks: The Sparsely-Gated Mixture-of-Experts Layer\u003c/em\u003e\u003c/a\u003e | \u003ca href=\"https://github.com/davidmrau/mixture-of-experts/\"\u003emixture-of-experts (GitHub)\u003c/a\u003e | \u003ca href=\"https://github.com/lucidrains/st-moe-pytorch\"\u003est-moe-pytorch (GitHub)\u003c/a\u003e | \u003ca href=\"https://github.com/laekov/fastmoe\"\u003eFastMoE (GitHub)\u003c/a\u003e | \u003ca href=\"https://pytorch.org/blog/training-moes/\"\u003e\u003cem\u003eTraining MoEs at Scale with PyTorch\u003c/em\u003e\u003c/a\u003e |\u003c/p\u003e\n\u003cp\u003eMixtral of Experts:\n| \u003ca href=\"https://arxiv.org/abs/2401.04088\"\u003e[2401.04088] \u003cem\u003eMixtral of Experts\u003c/em\u003e\u003c/a\u003e | \u003ca href=\"https://github.com/mistralai/mistral-src/\"\u003emistral-src (GitHub)\u003c/a\u003e |\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://raw.githubusercontent.com/mistralai/mistral-src/main/assets/smoe.png\"\r\n  alt=\"MoE\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eFFN in the original Transformer is replaced by Mixture of Expert layer (weighted FFNs). Given $n$ experts $\\lbrace{E_0, E_i, \u0026hellip;, E_{n-1}}\\rbrace$, the output of the MoE is$$\\text{MoE}(x) = \\sum_{i=0}^{n-1} {G(x)}_{i} \\cdot E_i(x)$$where $$G(x) = \\text{Softmax}(\\text{TopK}(x W_g))$$By using \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.topk.html\"\u003e\u003ccode\u003etorch.topk\u003c/code\u003e\u003c/a\u003e, we only uses $K$ Experts, thus this model is also called Sparse Mixture of Experts (SMoE). Another benefit of experts is that we can put different experts on different GPUs, which is the similar approach of AlexNet. (It is rumored that GPT4 is using 16 experts with top2 gating. I guess Ilya Sutskever pulled the same trick again.) This usage of $\\text{TopK}$ is similar to \u003ca href=\"https://d2l.ai/chapter_recurrent-modern/beam-search.html\"\u003eBeam Search\u003c/a\u003e for inferencing.\u003c/p\u003e\n\u003cp\u003eIn \u003cem\u003eMixtral of Experts\u003c/em\u003e, $E(x)$ is \u003ca href=\"https://arxiv.org/abs/2002.05202\"\u003eSwiGLU FFN\u003c/a\u003e: $$\\text{FFN}_\\text{SwiGLU}(x) = (\\text{Swish}_1(xW_1) \\odot xV)W_2$$here we use \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.functional.silu.html\"\u003e\u003ccode\u003eF.silu\u003c/code\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eFFN_SwiGLU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e4096\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e14336\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esilu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# https://github.com/pytorch/torchtitan/blob/main/torchtitan/models/llama/model.py#L250\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# https://github.com/pytorch/torchtitan/blob/main/torchtitan/models/llama/model.py#L300\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003einit_weights\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einit_std\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einit\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrunc_normal_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew1\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eweight\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emean\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estd\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.02\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einit\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrunc_normal_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ev\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eweight\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emean\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estd\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einit_std\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einit\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrunc_normal_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ew2\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eweight\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emean\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estd\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einit_std\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMoELayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e4096\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e14336\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_experts\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_experts_per_tok\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexperts\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModuleList\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eFFN_SwiGLU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_experts\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egate\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_experts\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_experts_per_tok\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_experts_per_tok\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einputs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003einputs_squashed\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einputs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einputs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size * seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003egate_logits\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einputs_squashed\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size * seq_length, num_experts]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eweights\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eselected_experts\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etopk\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egate_logits\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_experts_per_tok\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# both [batch_size * seq_length, num_experts_per_tok]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# print(selected_experts)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eweights\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esoftmax\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eweights\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# iterate over each expert\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresults\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros_like\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einputs_squashed\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eexpert\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eenumerate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexperts\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enth_expert\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ewhere\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eselected_experts\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# both [num_index], num_index ≤ batch_size * seq_length\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# print(torch.where(selected_experts == i))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eresults\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eweights\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enth_expert\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eexpert\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einputs_squashed\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [num_index, 1] * [num_index, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresults\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresults\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview_as\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einputs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresults\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emoe_layer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMoELayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehidden_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003effn_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emoe_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, seq_length, hidden_dim]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e7, 3\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e7, 0\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e7, 0\u003cspan style=\"color:#f92672\"\u003e]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etensor\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 2\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e, tensor\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 1\u003cspan style=\"color:#f92672\"\u003e]))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etensor\u003cspan style=\"color:#f92672\"\u003e([]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etorch.int64\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e, tensor\u003cspan style=\"color:#f92672\"\u003e([]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etorch.int64\u003cspan style=\"color:#f92672\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etensor\u003cspan style=\"color:#f92672\"\u003e([]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etorch.int64\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e, tensor\u003cspan style=\"color:#f92672\"\u003e([]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etorch.int64\u003cspan style=\"color:#f92672\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etensor\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e0\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e, tensor\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1\u003cspan style=\"color:#f92672\"\u003e]))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etensor\u003cspan style=\"color:#f92672\"\u003e([]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etorch.int64\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e, tensor\u003cspan style=\"color:#f92672\"\u003e([]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etorch.int64\u003cspan style=\"color:#f92672\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etensor\u003cspan style=\"color:#f92672\"\u003e([]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etorch.int64\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e, tensor\u003cspan style=\"color:#f92672\"\u003e([]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etorch.int64\u003cspan style=\"color:#f92672\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etensor\u003cspan style=\"color:#f92672\"\u003e([]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etorch.int64\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e, tensor\u003cspan style=\"color:#f92672\"\u003e([]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etorch.int64\u003cspan style=\"color:#f92672\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etensor\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e0, 1, 2\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e, tensor\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e0, 0, 0\u003cspan style=\"color:#f92672\"\u003e]))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThere is a similar architecture called MoD (Mixture of Depth), where certain Transformer blocks are skipped by some gated mechanism. Below is Fig.1 of \u003ca href=\"https://arxiv.org/abs/2404.02258\"\u003e[2404.02258] \u003cem\u003eMixture-of-Depths: Dynamically allocating compute in transformer-based language models\u003c/em\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://arxiv.org/html/2404.02258v1/extracted/5512346/mod.png\"\r\n  alt=\"MoD\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eNaturally, \u003ca href=\"https://github.com/epfml/llm-baselines/blob/mixture_of_depth/src/models/mod.py\"\u003eRoute is a \u003ccode\u003enn.Linear\u003c/code\u003e\u003c/a\u003e. I find \u003ca href=\"https://huggingface.co/blog/joey00072/mixture-of-depth-is-vibe\"\u003ethis post\u003c/a\u003e explaining the technical difficulty we have with this architecture really well.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://arxiv.org/abs/2407.09298\"\u003e[2407.09298] \u003cem\u003eTransformer Layers as Painters\u003c/em\u003e\u003c/a\u003e does a lot of experiments on removing or sharing layers in Transformer:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e1.There are three distinct classes of layers (with Middle being the largest). 2. The middle layers have some degree of uniformity (but not redundancy). And 3. Execution order matters more for math and reasoning tasks than semantic tasks.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"39-scaling-laws-emergence\"\u003e§3.9 Scaling Laws, Emergence\u003c/h3\u003e\n\u003cp\u003e| \u003ca href=\"https://arxiv.org/abs/2010.14701\"\u003e[2010.14701] \u003cem\u003eScaling Laws for Autoregressive Generative Modeling\u003c/em\u003e\u003c/a\u003e | \u003ca href=\"https://arxiv.org/abs/2203.15556\"\u003e[2203.15556] \u003cem\u003eTraining Compute-Optimal Large Language Models\u003c/em\u003e\u003c/a\u003e | \u003ca href=\"https://arxiv.org/abs/2304.01373\"\u003e[2304.01373] \u003cem\u003ePythia: A Suite for Analyzing Large Language Models Across Training and Scaling\u003c/em\u003e\u003c/a\u003e |\u003c/p\u003e\n\u003cp\u003ePreviously in this article it is stated that Transformer is a general function fitter, one of the reasons is that Transformers follow scaling laws with fitting line being almost perfect.\u003c/p\u003e\n\u003cp\u003eBelow is Fig.1 of \u003ca href=\"https://arxiv.org/abs/2010.14701\"\u003e[2010.14701] \u003cem\u003eScaling Laws for Autoregressive Generative Modeling\u003c/em\u003e\u003c/a\u003e. As we can see, the line of power law can be fitted almost perfectly. And every time I look at it I\u0026rsquo;m amazed, you don\u0026rsquo;t see this kind of smoothness in other NNs. RNN, for example, is really hard to train.\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"20231011-wow-it-fits-secondhand-machine-learning-scaling-laws.png\"\r\n  alt=\"scaling-law\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eThe effect of scaling law can sometimes be misunderstood as emergence, see \u003ca href=\"https://windowsontheory.org/2023/12/22/emergent-abilities-and-grokking-fundamental-mirage-or-both/\"\u003e\u003cem\u003eEmergent abilities and grokking: Fundamental, Mirage, or both?\u003c/em\u003e – Windows On Theory\u003c/a\u003e. I especially enjoy the \u0026ldquo;jumping over a 1-meter hurdle\u0026rdquo; analogue. Metrics of LLMs can be tricky.\u003c/p\u003e\n\u003ch3 id=\"310-transformers-are-cnns-rnns-gnns\"\u003e§3.10 Transformers are CNNs, RNNs, GNNs\u003c/h3\u003e\n\u003cp\u003eAnother reason that Transformers are general function fitter is that: CNNs assume invariance of space transformation (adjacent pixels are related); RNNs assume the continuity of time series (adjacent words are related); GNNs assume the preservation of graph symmetry (a graph can be rearranged or mapped onto itself while preserving the configuration of its connections); and Transformers do not have these initial bias.\u003c/p\u003e\n\u003cp\u003eAt the end of the day, we are transforming \u003ccode\u003e[batch_size, seq_length, hidden_dim]\u003c/code\u003e to \u003ccode\u003e[batch_size, seq_length, hidden_dim]\u003c/code\u003e. The intermediate steps are not important, or we happen to have found the general function fitter that is good enough for most tasks: Transformer, as I mentioned in the beginning of this chapter. See \u003ca href=\"http://www.incompleteideas.net/IncIdeas/BitterLesson.html\"\u003e\u003cem\u003eThe Bitter Lesson\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"4-fastai\"\u003e§4 \u003ccode\u003efastai\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003e| \u003ca href=\"https://github.com/fastai/fastai\"\u003efastai (GitHub)\u003c/a\u003e | \u003ca href=\"https://docs.fast.ai/\"\u003efastai (docs)\u003c/a\u003e | \u003ca href=\"https://course.fast.ai/\"\u003ePractical Deep Learning\u003c/a\u003e |\u003c/p\u003e\n\u003cimg src=\"https://docs.fast.ai/images/layered.png\" width=\"400\"\u003e\n\u003ch3 id=\"41-dataloaders\"\u003e§4.1 \u003ccode\u003eDataloaders\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003eWe did not write \u003ca href=\"https://pytorch.org/tutorials/beginner/basics/data_tutorial.html\"\u003e\u003ccode\u003eDatasets\u003c/code\u003e \u0026amp; \u003ccode\u003eDataLoaders\u003c/code\u003e\u003c/a\u003e, because it\u0026rsquo;s highly variable from tasks to tasks. In general I would suggest:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eLet your brain (bio-neural networks) understand the dataset intuitively by visualizing lots of examples from the dataset. (See \u003ca href=\"https://karpathy.github.io/2019/04/25/recipe/\"\u003e\u003cem\u003eA Recipe for Training Neural Networks\u003c/em\u003e\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eUse \u003ca href=\"https://github.com/pola-rs/polars\"\u003e\u003ccode\u003epolars\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://github.com/modularml/mojo\"\u003e\u003ccode\u003emojo\u003c/code\u003e\u003c/a\u003e to load data because it\u0026rsquo;s faster and more memory saving.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ca href=\"https://docs.fast.ai/examples/migrating_pytorch_verbose.html\"\u003ePytorch to fastai details\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch.utils.data\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eDataset\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eDataLoader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eSequentialSampler\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eBatchSampler\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efastai.vision.all\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# subclass `torch.utils.data.Dataset` to create a custom Dataset\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMyDataset\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDataset\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__len__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__getitem__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eimage\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elabel\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# shape: image is [C, H, W], label is []\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# use `torch.utils.data` to load data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edataset\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMyDataset\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edata_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elen\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edataset\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etrain_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.8\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edata_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# 80% is train_loader\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eindices\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elist\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etrain_indices\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindices\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etrain_batch_sampler\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eBatchSampler\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSequentialSampler\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_indices\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edrop_last\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etrain_loader\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eDataLoader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edataset\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_workers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_sampler\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_batch_sampler\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eval_indices\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindices\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eval_batch_sampler\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eBatchSampler\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSequentialSampler\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eval_indices\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edrop_last\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eval_loader\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eDataLoader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edataset\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_workers\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_sampler\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eval_batch_sampler\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# use `fastai.vision.all.DataLoaders` to combine training data and validation data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edls\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eDataLoaders\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_loader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eval_loader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eOr you can use \u003ca href=\"https://docs.fast.ai/tutorial.datablock.html\"\u003e\u003ccode\u003eDataBlock\u003c/code\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"42-learner\"\u003e§4.2 \u003ccode\u003eLearner\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003eLoad the model:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMyModel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecuda\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUse \u003ccode\u003efastai.vision.all.OptimWrapper\u003c/code\u003e to wrap \u003ca href=\"https://arxiv.org/abs/1711.05101\"\u003e\u003ccode\u003eAdamW\u003c/code\u003e\u003c/a\u003e optimizer:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eWrapperAdamW\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eparam_groups\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ekwargs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eOptimWrapper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eparam_groups\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoptim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eAdamW\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ca href=\"https://docs.fast.ai/learner.html\"\u003e\u003ccode\u003eLearner\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://docs.fast.ai/callback.fp16.html#learner.to_fp16\"\u003e\u003ccode\u003eLearner.to_fp16\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://docs.fast.ai/callback.core.html\"\u003e\u003ccode\u003eCallbacks\u003c/code\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efunctools\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epartial\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# python standard library\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eLearner\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003edls\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003epath\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;custom_path\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eloss_func\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecustom_loss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003emetrics\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecustom_metric\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eopt_func\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epartial\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eWrapperAdamW\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eeps\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1e-7\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# opt_func=partial(OptimWrapper,opt=torch.optim.AdamW,eps=1e-7)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ecbs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eCSVLogger\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eGradientClip\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3.0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eEMACallback\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eSaveModelCallback\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emonitor\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;custom_metric\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecomp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eless\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eevery_epoch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eGradientAccumulation\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003en_acc\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e4096\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# divided by `batch_size`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto_fp16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ca href=\"https://docs.fast.ai/callback.schedule.html#learner.lr_find\"\u003e\u003ccode\u003eLearner.lr_find\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/1506.01186\"\u003e[1506.01186] \u003cem\u003eCyclical Learning Rates for Training Neural Networks\u003c/em\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elr_find\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esuggest_funcs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eslide\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evalley\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ca href=\"https://docs.fast.ai/callback.schedule.html#learner.fit_one_cycle\"\u003e\u003ccode\u003eLearner.fit_one_cycle\u003c/code\u003e\u003c/a\u003e uses \u003ca href=\"https://arxiv.org/abs/1708.07120\"\u003e1cycle policy\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efit_one_cycle\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003elr_max\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1e-5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ewd\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.05\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003epct_start\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.25\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ediv\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e25\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ediv_final\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e100000\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ca href=\"https://docs.fast.ai/learner.html#learner.save\"\u003e\u003ccode\u003eLearner.save\u003c/code\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esave\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;my_model_opt\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ewith_opt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esave\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;my_model\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ewith_opt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ca href=\"https://fastxtend.benjaminwarner.dev/callback.compiler.html\"\u003e\u003ccode\u003eLearner.compile\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://pytorch.org/docs/master/compile/get-started.html\"\u003e\u003ccode\u003etorch.compile\u003c/code\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efastxtend.callback\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecompiler\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eLearner\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecompile\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eLearner\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecbs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eCompilerCallback\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"5-transfer-learning\"\u003e§5 Transfer Learning\u003c/h2\u003e\n\u003cp\u003eFor different dataset and different goals.\u003c/p\u003e\n\u003ch3 id=\"51-load-pretrained-resnet-vit\"\u003e§5.1 Load Pretrained ResNet, ViT\u003c/h3\u003e\n\u003cp\u003e| \u003ca href=\"https://www.kaggle.com/code/csaroff/which-timm-models-are-best-2023-11-29/notebook\"\u003eWhich Timm Models Are Best 2023-11-29 | Kaggle\u003c/a\u003e |\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eResNet101\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.fast.ai/vision.learner.html#vision_learner\"\u003e\u003ccode\u003efastai.vision.all.vision_learner\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efastai.vision.all\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# https://github.com/pytorch/vision/tree/main/torchvision/models\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorchvision.models\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresnet101\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# https://pytorch.org/vision/stable/models.html\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorchvision.models\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eResNet101_Weights\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edls\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evision_learner\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003edls\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eresnet101\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003epretrained\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eweights\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eResNet101_Weights\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eIMAGENET1K_V2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003emetrics\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eerror_rate\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efine_tune\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003efreeze_epochs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# freeze_epochs run first\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eepochs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esave\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;finetuned_resnet101\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ewith_opt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eViT_B_16\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.fast.ai/learner.html\"\u003e\u003ccode\u003efastai.vision.all.Learner\u003c/code\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efastai.vision.all\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorchvision.models\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evit_b_16\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorchvision.models\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eViT_B_16_Weights\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edls\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# https://github.com/rasbt/ViT-finetuning-scripts/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evit_b_16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eweights\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eViT_B_16_Weights\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eIMAGENET1K_V1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eheads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ehead\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# replace projection layer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;cuda\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eLearner\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edls\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emetrics\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eerror_rate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efine_tune\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efreeze_epochs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eepochs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esave\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;finetuned_vit_b_16\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ewith_opt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"52-acousticgravitational-wave-classification\"\u003e§5.2 Acoustic/Gravitational Wave Classification\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://arxiv.org/abs/1912.11370\"\u003e[1912.11370] \u003cem\u003eBig Transfer (BiT): General Visual Representation Learning\u003c/em\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWe scale up pre-training, and propose a simple recipe that we call Big Transfer (BiT).\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"521-acoustic-wave-classification\"\u003e§5.2.1 Acoustic Wave Classification\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://etown.medium.com/great-results-on-audio-classification-with-fastai-library-ccaf906c5f52\"\u003e\u003cem\u003eGreat results on audio classification with fastai library\u003c/em\u003e | by Ethan Sutin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/etown/dl1/blob/master/UrbanSoundClassification.ipynb\"\u003e\u003ccode\u003eUrbanSoundClassification.ipynb\u003c/code\u003e (GitHub)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eEach subfigure of the figure below is a \u003cem\u003ePower Spectrum\u003c/em\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe horizontal axis is \u003cem\u003eTime\u003c/em\u003e ($\\text{s}$).\u003c/li\u003e\n\u003cli\u003eThe vertical axis is \u003cem\u003eFrequency\u003c/em\u003e ($\\text{Hz}$) of the vibration.\u003c/li\u003e\n\u003cli\u003eThe color (from dark to red to white) is \u003cem\u003eSound Intensity Level\u003c/em\u003e ($\\text{dB}$):\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://miro.medium.com/v2/resize:fit:1100/format:webp/1*D_yXVrrJD1Y46Z1T0OTOVA.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eUse \u003ca href=\"https://librosa.org/doc/latest/generated/librosa.display.specshow.html#librosa.display.specshow\"\u003e\u003ccode\u003elibrosa.display.specshow\u003c/code\u003e\u003c/a\u003e to draw \u003cem\u003ePower Spectrum\u003c/em\u003e, then save as \u003ccode\u003e.png\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eS\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elibrosa\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efeature\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emelspectrogram\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esamples\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esr\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esample_rate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elibrosa\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edisplay\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003especshow\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elibrosa\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epower_to_db\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eS\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eref\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emax\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003efilename\u003c/span\u003e  \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003espectrogram_path\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efold\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ePath\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eaudio_file\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ename\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ereplace\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;.wav\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;.png\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esavefig\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efilename\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edpi\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e400\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebbox_inches\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;tight\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epad_inches\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUse \u003ccode\u003efastai\u003c/code\u003e to load pretrained model \u003ccode\u003eResNet34\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecnn_learner\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emodels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eresnet34\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emetrics\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eerror_rate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"522-gravitational-wave-classification\"\u003e§5.2.2 Gravitational Wave Classification\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://arxiv.org/abs/2303.13917\"\u003e[2303.13917] \u003cem\u003eConvolutional Neural Networks for the classification of glitches in gravitational-wave data streams\u003c/em\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe picture below is Fig.2 of the paper:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"20231011-wow-it-fits-secondhand-machine-learning-05_2303.13917_GWs.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eUse \u003ccode\u003efastai\u003c/code\u003e to load pretrained model \u003ccode\u003eResNet18\u003c/code\u003e, \u003ccode\u003eResNet26\u003c/code\u003e, \u003ccode\u003eResNet34\u003c/code\u003e, \u003ccode\u003eResNet50\u003c/code\u003e, \u003ccode\u003eConvNext_Nano\u003c/code\u003e, \u003ccode\u003eConvNext_Tiny\u003c/code\u003e.\u003c/p\u003e\n\u003ch3 id=\"53-category-unknown-confidence-level\"\u003e§5.3 Category \u0026ldquo;Unknown\u0026rdquo;, Confidence Level\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eChoose the size of the model by the size of the dataset, to avoid overfitting.\u003c/li\u003e\n\u003cli\u003eWhen the output probability of the final MLP layer is not dominated by one category (less than 95% or some threshold), you should be extra careful. Because actually this prediction is not correct. There is an entire research field on predicting the confidence level of a prediction, see \u003ca href=\"https://arxiv.org/abs/2103.15718\"\u003e[2103.15718] \u003cem\u003evon Mises-Fisher Loss: An Exploration of Embedding Geometries for Supervised Learning\u003c/em\u003e\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/2107.03342\"\u003e[2107.03342] \u003cem\u003eA Survey of Uncertainty in Deep Neural Networks\u003c/em\u003e\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/1706.04599\"\u003e[1706.04599] \u003cem\u003eOn Calibration of Modern Neural Networks\u003c/em\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n",
      "url": "https://chenlinear.github.io/posts/20231011-wow-it-fits-secondhand-machine-learning/",
      "date_published": "11106-11-09T100:1111:00+00:00",
      "date_modified": "11106-11-09T100:1111:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "9b2299c42785b3557163e681c411baf0d5396f86",
      "title": "Safety Issue of Metaverse",
      "summary": "",
      "content_text": "In this interview about Metaverse, Lex does not mention safety issue, not even once. I understand how exciting he must be to cross the uncanny valley, but this is highly unprofessional and the interview is approximately a commercial.\nI don\u0026rsquo;t think I have to stress how absurd this is:\nScanning your head, more in detail. Because they \u0026ldquo;want to capture your facial expressions\u0026rdquo;. Scanning your house (possibly your family and friends). Potentially, anybody can use your avatar to say stuff. And with the help of voice imitation, it will even sound like you. Deepfake still requires the target\u0026rsquo;s pictures or videos for generation, but now you, the target, are giving these information away. I\u0026rsquo;m not saying the company will do it. Leakage is all you need.\nPrivacy, copyright and labeling slavery have always been major ethical problems for Machine Learning. On the contrary, classifying patterns of Gravitational Waves or reconstructing neutrino events don\u0026rsquo;t have these ethical problems. Because there are less actual factors involved. And, even if Neural Networks went crazy in the process, nobody would get hurt. One of the examples of its potential craziness is that detection of a disease is related to how old the picture is, see AI does not exist but it will ruin everything anyway - YouTube.\nI read about this meme somewhere:\nMe: My dad says you spy on people. Mark Zuckerberg: He\u0026rsquo;s not your dad. ",
      "content_html": "\u003cp\u003eIn \u003ca href=\"https://www.youtube.com/watch?v=MVYrJJNdrEg\"\u003ethis interview about Metaverse\u003c/a\u003e, Lex does not mention safety issue, not even once. I understand how exciting he must be to cross the uncanny valley, but this is highly unprofessional and the interview is approximately a commercial.\u003c/p\u003e\n\u003cp\u003eI don\u0026rsquo;t think I have to stress how absurd this is:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eScanning your head, more in detail. Because they \u0026ldquo;want to capture your facial expressions\u0026rdquo;.\u003c/li\u003e\n\u003cli\u003eScanning your house (possibly your family and friends).\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePotentially, anybody can use your avatar to say stuff. And with the help of voice imitation, it will even sound like you. Deepfake still requires the target\u0026rsquo;s pictures or videos for generation, but now you, the target, are giving these information away. I\u0026rsquo;m not saying the company will do it. \u003cem\u003eLeakage is all you need\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003ePrivacy, copyright and labeling slavery have always been major ethical problems for Machine Learning. On the contrary, \u003ca href=\"https://chenlinear.github.io/posts/20230810-gravity-spy-2.0/\"\u003eclassifying patterns of Gravitational Waves\u003c/a\u003e or \u003ca href=\"https://chenlinear.github.io/posts/20230828-new-paper-on-arxiv-new-repository-iseecube/\"\u003ereconstructing neutrino events\u003c/a\u003e don\u0026rsquo;t have these ethical problems. Because there are less actual factors involved. And, even if Neural Networks went crazy in the process, nobody would get hurt. One of the examples of its potential craziness is that detection of a disease is related to how old the picture is, see \u003ca href=\"https://www.youtube.com/watch?v=EUrOxh_0leE\"\u003e\u003cem\u003eAI does not exist but it will ruin everything anyway\u003c/em\u003e - YouTube\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eI read about this meme somewhere:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003eMe: My dad says you spy on people.\u003c/li\u003e\n\u003cli\u003eMark Zuckerberg: He\u0026rsquo;s not your dad.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230929-safety-issue-of-metaverse/",
      "date_published": "29096-29-09T90:2929:00+00:00",
      "date_modified": "29096-29-09T90:2929:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "a2d016d078a27bc8452a66ddea5df4709b680379",
      "title": "Machine Learning Notes: A Hackers' Guide to Language Models",
      "summary": "",
      "content_text": "Jeremy Howard put a video on YouTube about LLMs: A Hackers\u0026rsquo; Guide to Language Models - YouTube, and the GitHub link is lm-hackers. I would watch it again if I were to do the research on LLMs.\nThe level of detail in this video is amazing. And by \u0026ldquo;the level of detail\u0026rdquo;, I mean\nPython code that teaches ChatGPT to run a Python function. Which is powerful, quite handy and embarrassingly simple1.\nLinks to GitHub repositories, websites, etc. They are often the most useful, because they are sources you will go to when coding, or from these sources you can expand to other sources. Thus they are really helpful if you want to actually do the work instead of having a vague understanding.\nWhen coding, referring to certain links is a habit that may take some time to grow. I used to have the impression that coding is constantly hitting the keyboard (probably from Black Books S02E03), but what really happened to me is that I spend 70% of time searching and reading other people\u0026rsquo;s code (referring to certain links), 20% writing and testing, 10% debugging. And by showing these links, he reduces the time of searching and reading for the viewers.\nIn a sense, they are more close to experience than knowledge. I\u0026rsquo;ll try to do the same thing, try to.\nBy the way, it\u0026rsquo;s astonishing to see how Machine Learning community (GitHub repositories, papers, packages, pre-trained models, fine-tuned models, websites, services) can flourish on one task. The variety, both the good and the bad, is beautiful.\nI love \u0026ldquo;embarrassingly simple\u0026rdquo;. The phrase \u0026ldquo;embarrassingly simple\u0026rdquo; is often used to describe a trend in Machine Learning that, classical heuristic systems are replaced by end-to-end learning systems. Because the world is more complicated than what you can program, that\u0026rsquo;s why we use Machine Learning in the first place. See Full Self-Driving is HARD! Analyzing Elon Musk re: Tesla Autopilot on Lex Fridman\u0026rsquo;s Podcast - YouTube where he talked about Tesla 11. And The Bitter Lesson summarize this phenomenon as that model scale and large amounts of data outperform domain-specific inductive biases.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003eJeremy Howard put a video on YouTube about LLMs: \u003ca href=\"https://www.youtube.com/watch?v=jkrNMKz9pWU\"\u003eA Hackers\u0026rsquo; Guide to Language Models - YouTube\u003c/a\u003e, and the GitHub link is \u003ca href=\"https://github.com/fastai/lm-hackers/tree/main\"\u003elm-hackers\u003c/a\u003e. I would watch it again if I were to do the research on LLMs.\u003c/p\u003e\n\u003cp\u003eThe level of detail in this video is amazing. And by \u0026ldquo;the level of detail\u0026rdquo;, I mean\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ePython code that teaches ChatGPT to run a Python function. Which is powerful, quite handy and embarrassingly simple\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLinks to GitHub repositories, websites, etc. They are often the most useful, because they are sources you will go to \u003cstrong\u003ewhen coding\u003c/strong\u003e, or from these sources you can expand to other sources. Thus they are really helpful if you want to actually do the work instead of having a vague understanding.\u003c/p\u003e\n\u003cp\u003eWhen coding, referring to certain links is a habit that may take some time to grow. I used to have the impression that coding is constantly hitting the keyboard (probably from \u003cem\u003eBlack Books\u003c/em\u003e S02E03), but what really happened to me is that I spend 70% of time searching and reading other people\u0026rsquo;s code (referring to certain links), 20% writing and testing, 10% debugging. And by showing these links, he reduces the time of searching and reading for the viewers.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn a sense, they are more close to experience than knowledge. I\u0026rsquo;ll try to do the same thing, try to.\u003c/p\u003e\n\u003cp\u003eBy the way, it\u0026rsquo;s astonishing to see how Machine Learning community (GitHub repositories, papers, packages, pre-trained models, fine-tuned models, websites, services) can flourish on one task. The variety, both the good and the bad, is beautiful.\u003c/p\u003e\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eI love \u0026ldquo;embarrassingly simple\u0026rdquo;. The phrase \u0026ldquo;embarrassingly simple\u0026rdquo; is often used to describe a trend in Machine Learning that, classical heuristic systems are replaced by end-to-end learning systems. Because the world is more complicated than what you can program, that\u0026rsquo;s why we use Machine Learning in the first place. See \u003ca href=\"https://www.youtube.com/watch?v=rd3R_G6_UfY\"\u003eFull Self-Driving is HARD! Analyzing Elon Musk re: Tesla Autopilot on Lex Fridman\u0026rsquo;s Podcast - YouTube\u003c/a\u003e where he talked about Tesla 11. And \u003ca href=\"http://www.incompleteideas.net/IncIdeas/BitterLesson.html\"\u003e\u003cem\u003eThe Bitter Lesson\u003c/em\u003e\u003c/a\u003e summarize this phenomenon as that model scale and large amounts of data outperform domain-specific inductive biases.\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230928-machine-learning-notes-a-hackers-guide-to-language-models/",
      "date_published": "28096-28-09T90:2828:00+00:00",
      "date_modified": "28096-28-09T90:2828:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "7283667a0009143396765d050c015ec14141d50b",
      "title": "Google Podcasts Shuts Down",
      "summary": "",
      "content_text": "Another gravestone on Google Graveyard.\nTechnically it\u0026rsquo;s not shut down, it\u0026rsquo;s gonna be integrated with YouTube Music. So after YouTube Shorts, which is similar to TikTok, YouTube will start promoting music services now. Instead of using that, I\u0026rsquo;m starting to go through open source podcast apps on GitHub.\nSince you can also subscribe things on Google Podcasts with RSS, I consider its shut down the splash of Google Reader\u0026rsquo;s death. This sentence from Wikipedia page about Google Reader is ironic:\nIn January 2007 Google added video content from YouTube and Google Video to Reader.\nWhy does every app want to combine everything in the world? WeiXin did that and it takes about 1 TB of storage in your phone.\nI really hope \u0026ldquo;Shuts Down\u0026rdquo; will not become a series in my posts. That would be sad.\n",
      "content_html": "\u003cp\u003eAnother gravestone on \u003ca href=\"https://killedbygoogle.com/\"\u003eGoogle Graveyard\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eTechnically it\u0026rsquo;s not shut down, it\u0026rsquo;s gonna be integrated with YouTube Music. So after YouTube Shorts, which is similar to TikTok, YouTube will start promoting music services now. Instead of using that, I\u0026rsquo;m starting to go through open source podcast apps on GitHub.\u003c/p\u003e\n\u003cp\u003eSince you can also subscribe things on Google Podcasts with RSS, I consider its shut down the splash of Google Reader\u0026rsquo;s death. This sentence from \u003ca href=\"https://en.wikipedia.org/wiki/Google_Reader\"\u003eWikipedia page about Google Reader\u003c/a\u003e is ironic:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIn January 2007 Google added video content from YouTube and Google Video to Reader.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eWhy does every app want to combine everything in the world? WeiXin did that and it takes about 1 TB of storage in your phone.\u003c/p\u003e\n\u003cp\u003eI really hope \u0026ldquo;Shuts Down\u0026rdquo; will not become a series in my posts. That would be sad.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230927-google-podcasts-shuts-down/",
      "date_published": "27096-27-09T90:2727:00+00:00",
      "date_modified": "27096-27-09T90:2727:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "ee0dc4b6b9fadde9fcdb959c32bc65262881a290",
      "title": "JWST: K2-18 b",
      "summary": "",
      "content_text": "Webb Discovers Methane, Carbon Dioxide in Atmosphere of K2-18 b | NASA and many other news say K2-18 b is promising for life. What I like about these news is that they tell the readers what \u0026ldquo;Spectrum\u0026rdquo; is, which is a kind of science popularization. And the spectra of K2-18 b shows there exists Methane and Carbon Dioxide in its atmosphere. Thus life is promising.\nOn the contrary, the Mexico alien is a shocking picture, which turned out be a cake.1 And the source of information (Jaime Maussan) is not reliable, as he had reported lots of fake aliens in the past.\nNo doubt the latter one is much more popular in the public. And I don\u0026rsquo;t like it.\nAs GLaDOS said, \u0026ldquo;cake is a lie\u0026rdquo;.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003e\u003ca href=\"https://www.nasa.gov/goddard/2023/webb-discovers-methane-carbon-dioxide-in-atmosphere-of-k2-18b\"\u003eWebb Discovers Methane, Carbon Dioxide in Atmosphere of K2-18 b | NASA\u003c/a\u003e and many other news say K2-18 b is promising for life. What I like about these news is that they tell the readers what \u0026ldquo;Spectrum\u0026rdquo; is, which is a kind of science popularization. And the spectra of K2-18 b shows there exists Methane and Carbon Dioxide in its atmosphere. Thus life is promising.\u003c/p\u003e\n\u003cp\u003eOn the contrary, the Mexico alien is a shocking picture, which turned out be a cake.\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e And the source of information (Jaime Maussan) is not reliable, as he had reported lots of fake aliens in the past.\u003c/p\u003e\n\u003cp\u003eNo doubt the latter one is much more popular in the public. And I don\u0026rsquo;t like it.\u003c/p\u003e\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eAs GLaDOS said, \u0026ldquo;cake is a lie\u0026rdquo;.\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230921-jwst-k2-18-b/",
      "date_published": "21096-21-09T90:2121:00+00:00",
      "date_modified": "21096-21-09T90:2121:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "1dcf6d77fe82cea6b7f68bcdd21554756b7718cf",
      "title": "Neutrino Simulations for SN 2023ixf",
      "summary": "",
      "content_text": "Neutrinos emitted from a supernova can be simulated, see the article on astrobites and the paper [2306.14717] Low and High Energy Neutrinos from SN 2023ixf in M101.\nAbout multi-messenger (for more information, see [2307.14559] TXS 0506+056 with Updated IceCube Data):\nevent SN 1987A TXS 0506+056 category type II supernova blazer year 1987 2017 energy of cosmic neutrino low (~10 MeV) high (~100 TeV) the first confirmed multi-messenger source the first successful multi-messenger campaign involving follow-up observations by telescope worldwide This simulation followed the hypothesis \u0026ldquo;core-collapse supernovae (CC-SNe)\u0026rdquo;.\nAnd the result of the paper:\nLow-energy neutrinos: Super-K reports no significant detection, which supports the conclusions of this paper. Also, this supernova would likely not be detectable by Hyper-K. High-energy neutrinos: IceCube reports no significant detection, which is probably because only a small fraction (less than about 10%) of the kinetic energy is used to accelerate particles. the jet lasts a long time. it is highly relativistic. ",
      "content_html": "\u003cp\u003eNeutrinos emitted from a supernova can be simulated, see \u003ca href=\"https://astrobites.org/2023/09/14/nu-models-to-study-a-new-supernova/\"\u003ethe article on astrobites\u003c/a\u003e and the paper \u003ca href=\"https://arxiv.org/abs/2306.14717\"\u003e[2306.14717] \u003cem\u003eLow and High Energy Neutrinos from SN 2023ixf in M101\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eAbout multi-messenger (for more information, see \u003ca href=\"https://arxiv.org/abs/2307.14559\"\u003e[2307.14559] \u003cem\u003eTXS 0506+056 with Updated IceCube Data\u003c/em\u003e\u003c/a\u003e):\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eevent\u003c/th\u003e\n\u003cth\u003eSN 1987A\u003c/th\u003e\n\u003cth\u003eTXS 0506+056\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003ecategory\u003c/td\u003e\n\u003ctd\u003etype II supernova\u003c/td\u003e\n\u003ctd\u003eblazer\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eyear\u003c/td\u003e\n\u003ctd\u003e1987\u003c/td\u003e\n\u003ctd\u003e2017\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eenergy of cosmic neutrino\u003c/td\u003e\n\u003ctd\u003elow (~10 MeV)\u003c/td\u003e\n\u003ctd\u003ehigh (~100 TeV)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003ethe first confirmed multi-messenger source\u003c/td\u003e\n\u003ctd\u003ethe first successful multi-messenger campaign involving follow-up observations by telescope worldwide\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eThis simulation followed the hypothesis \u0026ldquo;core-collapse supernovae (CC-SNe)\u0026rdquo;.\u003c/p\u003e\n\u003cp\u003eAnd the result of the paper:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eLow-energy neutrinos: Super-K reports no significant detection, which supports the conclusions of this paper. Also, this supernova would likely not be detectable by Hyper-K.\u003c/li\u003e\n\u003cli\u003eHigh-energy neutrinos: IceCube reports no significant detection, which is probably because\n\u003cul\u003e\n\u003cli\u003eonly a small fraction (less than about 10%) of the kinetic energy is used to accelerate particles.\u003c/li\u003e\n\u003cli\u003ethe jet lasts a long time.\u003c/li\u003e\n\u003cli\u003eit is highly relativistic.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230914-neutrino-simulations-for-sn-2023ixf/",
      "date_published": "14096-14-09T90:1414:00+00:00",
      "date_modified": "14096-14-09T90:1414:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "42d68e9026178b756a8d416832fdf432c8ab192d",
      "title": "The Final Form of IceCube",
      "summary": "",
      "content_text": "So I had a dream last night. If infinite money and energy is provided and pollution will not be created, the final form of IceCube is in space, so that atmospheric neutrinos and geoneutrinos can be neglected.\nI guess there are two places to implement PMTs:\nWater launched by rockets, then covered with sheet (to avoid evaporation), which will quickly become ice in space. Or just ice at the beginning. One of the moons of Jupiter or Saturn that contains water. For example, Ganymede. If possible, I want the distances between PMTs is the same and forms a Primitive Cubic (borrowing the concept from Solid State Physics), so that we can perform 3D convolution.\n\u0026ldquo;IceCube-GenZ\u0026rdquo; would be a good name.\n",
      "content_html": "\u003cp\u003eSo I had a dream last night. If infinite money and energy is provided and pollution will not be created, the final form of IceCube is in space, so that atmospheric neutrinos and geoneutrinos can be neglected.\u003c/p\u003e\n\u003cp\u003eI guess there are two places to implement PMTs:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWater launched by rockets, then covered with sheet (to avoid evaporation), which will quickly become ice in space. Or just ice at the beginning.\u003c/li\u003e\n\u003cli\u003eOne of the moons of Jupiter or Saturn that contains water. For example, Ganymede.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIf possible, I want the distances between PMTs is the same and forms a Primitive Cubic (borrowing the concept from Solid State Physics), so that we can perform 3D convolution.\u003c/p\u003e\n\u003cp\u003e\u0026ldquo;IceCube-GenZ\u0026rdquo; would be a good name.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230914-the-final-form-of-icecube/",
      "date_published": "14096-14-09T90:1414:00+00:00",
      "date_modified": "14096-14-09T90:1414:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "de706b2a7353936a524ec2bed084b555cb9e5ccc",
      "title": "Machine Learning Notes: GNN, GraphNeT",
      "summary": "",
      "content_text": "§1 Graph A graph is a data structure that has the shape $\\mathbb{R} ^{N \\times P}$, where\n$N$ is the number of nodes. Note that $N$ might vary in a dataset, but we often use cutting or padding to get a uniform, normalized $N$. $P$ is the number of features. Yes, the concept of \u0026ldquo;features\u0026rdquo; is similar to the concept of \u0026ldquo;channels\u0026rdquo; in CNNs. A picture $\\mathbb{R}^{H \\times W \\times C}$ is of height $H$ and width $W$, thus the total number of pixels is $HW$, and each pixel has $C$ channels, commonly $C=1$ (grey channel) or $C=3$ (RGB channels). Now let\u0026rsquo;s transform this picture into a graph $\\mathbb{R}^{N \\times P}$, where $N=HW$ is the total number of pixels. Thus $P=C+2$, which means the original position information is now encoded into the channels. What\u0026rsquo;s more, graph can represent more than that, thus in a sense, a graph is a generalized picture.\n§1.1 Graph \u0026amp; Matrix Graphs can be represented by adjacency matrix, which can be normalized into Frobenius normal form, see Matrices and graphs - by Tivadar Danka - The Palindrome.\nOften, large part of the matrix is empty, which is called Sparse matrix.\n§2 GNN (PyTorch Geometric Style) See A Gentle Introduction to Graph Neural Networks - Distill.pub. The general idea is that after GNN, part of the nodes are highlighted and the number of features of each nodes can be different. This is in consistence with CNN, where parts of the picture is highlighted and the number of channels (RGB $\\rightarrow$ many more) can be different (see CNN Explainer).\nConsidering the popularity of LLMs, unsurprisingly, GNNs support Attention. For Graph Attention Networks (GAT), see Graph Attention Networks (GAT) (labml.ai) and Graph Attention Networks v2 (GATv2) (labml.ai).\nThis section is a skinner implementation of PyTorch Geometric from scratch, which means it\u0026rsquo;s NOT necessary to install the package, but I still recommend to do so for comparison:\npip install torch_geometric And we import PyTorch as before:\nimport torch import torch.nn as nn import torch.nn.functional as F §2.1 torch_geometric.utils torch_geometric.utils\n§2.1.1 add_self_loops torch_geometric.utils.add_self_loops\ntorch_geometric.utils.add_self_loops is pretty self-explaining.\nfrom torch_geometric.utils import add_self_loops def test_add_self_loops(): x = torch.rand((10, 16))# [num_nodes, in_channels] edge_index = torch.randint(0, 10, size=(2, 7))# [2, num_messages] edge_index, _ = add_self_loops(edge_index, num_nodes=x.shape[-2]) print(edge_index) print(edge_index.shape) test_add_self_loops() will get (note we get self loops here):\ntensor([[4, 9, 7, 9, 3, 6, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9], [5, 7, 4, 2, 7, 1, 2, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9]]) torch.Size([2, 17]) my_add_self_loops\ndef my_add_self_loops(edge_index, num_nodes): self_loops = torch.arange(num_nodes) if edge_index.dim() == 2: self_loops = self_loops.repeat(2, 1) elif edge_index.dim() == 3: batch_size = edge_index.shape[0] self_loops = self_loops.repeat(batch_size, 2, 1) else: raise RuntimeError(f\u0026#39;The dimension of edge_index should be 2 or 3. Got: {edge_index.dim()}\u0026#39;) edge_index = torch.cat((edge_index, self_loops), dim=-1) edge_weight = None return edge_index, edge_weight def test_add_self_loops(): x = torch.rand((10, 16))# [num_nodes, in_channels] edge_index = torch.randint(0, 10, size=(2, 7))# [2, num_messages] edge_index, _ = my_add_self_loops(edge_index, num_nodes=x.shape[-2]) print(edge_index) print(edge_index.shape) x = torch.rand((3, 10, 16))# [batch_size, num_nodes, in_channels] edge_index = torch.randint(0, 10, size=(3, 2, 7))# [batch_size, 2, num_messages] edge_index, _ = my_add_self_loops(edge_index, num_nodes=x.shape[-2]) print(edge_index) print(edge_index.shape) test_add_self_loops() will get:\ntensor([[0, 5, 2, 7, 8, 8, 5, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9], [0, 2, 6, 6, 9, 6, 3, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9]]) torch.Size([2, 17]) tensor([[[5, 7, 2, 4, 9, 8, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9], [5, 3, 3, 7, 0, 1, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9]], [[9, 0, 4, 7, 4, 9, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9], [6, 2, 9, 7, 7, 4, 6, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9]], [[4, 5, 4, 2, 0, 3, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9], [1, 9, 7, 4, 9, 4, 5, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9]]]) torch.Size([3, 2, 17]) §2.1.2 scatter torch_geometric.utils.scatter is the same as Aggregation Operators. Below is the image from Scatter — pytorch_scatter 2.1.1 documentation:\ntorch_geometric.utils.scatter\nfrom torch_geometric.utils import scatter def test_scatter(): x = torch.rand((5, 8))# [num_index, in_channels] print(x) index = torch.randint(0, 5, size=(5,))# [num_index,] print(index) x = scatter(x, index, dim=-2, dim_size=10, reduce=\u0026#39;sum\u0026#39;)# [dim_size, in_channels] print(x) test_scatter() will get:\ntensor([[0.0101, 0.3919, 0.6275, 0.1619, 0.2756, 0.9814, 0.5278, 0.9113], [0.1170, 0.4807, 0.8374, 0.6121, 0.1399, 0.3740, 0.4485, 0.0578], [0.7961, 0.2162, 0.8050, 0.2520, 0.2318, 0.0279, 0.9750, 0.3881], [0.2107, 0.2072, 0.8769, 0.7675, 0.2437, 0.6953, 0.2572, 0.4149], [0.6781, 0.9938, 0.4502, 0.1818, 0.2886, 0.2952, 0.1135, 0.9759]]) tensor([3, 0, 3, 1, 1]) tensor([[0.1170, 0.4807, 0.8374, 0.6121, 0.1399, 0.3740, 0.4485, 0.0578], [0.8888, 1.2010, 1.3271, 0.9493, 0.5323, 0.9904, 0.3706, 1.3908], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.8061, 0.6080, 1.4325, 0.4139, 0.5074, 1.0093, 1.5027, 1.2994], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000]]) my_scatter\ndef my_scatter(input, index, dim_size, reduce=\u0026#39;sum\u0026#39;): if input.dim() == 2:# [num_index, in_channels] num_index, in_channels = input.shape output = torch.zeros(dim_size, in_channels) # if reduce == \u0026#39;sum\u0026#39;: # for i in range(num_index): # output[index[i]] += input[i] index = index.unsqueeze(-1).expand(-1, in_channels) # https://pytorch.org/docs/stable/generated/torch.Tensor.scatter_reduce_.html output = output.scatter_reduce_(0, index, input, reduce=reduce)# [dim_size, in_channels] elif input.dim() == 3:# [batch_size, num_index, in_channels] batch_size, num_index, in_channels = input.shape output = torch.zeros(batch_size, dim_size, in_channels) index = index.unsqueeze(-1).expand(-1, -1, in_channels) output = output.scatter_reduce_(1, index, input, reduce=reduce)# [batch_size, dim_size, in_channels] else: raise RuntimeError(f\u0026#39;The dimension of input should be 2 or 3. Got: {input.dim()}\u0026#39;) return output def test_scatter(): x = torch.rand((5, 8))# [num_index, in_channels] print(x) index = torch.randint(0, 5, size=(5,))# [num_index,] print(index) y1 = scatter(x, index, dim=-2, dim_size=10, reduce=\u0026#39;sum\u0026#39;)# [dim_size, in_channels] print(y1) y2 = my_scatter(x, index, dim_size=10, reduce=\u0026#39;sum\u0026#39;)# [dim_size, in_channels] print(y2) print(torch.all(y1==y2)) x = torch.rand((3, 5, 8))# [batch_size, num_index, in_channels] print(x) index = torch.randint(0, 5, size=(3, 5))# [batch_size, num_index] print(index) x = my_scatter(x, index, dim_size=10, reduce=\u0026#39;sum\u0026#39;)# [batch_size, dim_size, in_channels] print(x) test_scatter() will get:\ntensor([[0.2109, 0.7352, 0.5434, 0.3313, 0.4879, 0.1099, 0.9719, 0.5557], [0.2895, 0.3029, 0.7941, 0.9762, 0.9781, 0.0098, 0.0681, 0.1918], [0.9410, 0.4957, 0.7365, 0.7754, 0.3758, 0.8361, 0.3774, 0.7967], [0.3614, 0.5214, 0.1778, 0.3030, 0.4437, 0.0416, 0.2726, 0.3489], [0.9101, 0.3961, 0.2422, 0.6505, 0.8651, 0.4071, 0.2292, 0.7021]]) tensor([2, 1, 2, 4, 0]) tensor([[0.9101, 0.3961, 0.2422, 0.6505, 0.8651, 0.4071, 0.2292, 0.7021], [0.2895, 0.3029, 0.7941, 0.9762, 0.9781, 0.0098, 0.0681, 0.1918], [1.1520, 1.2309, 1.2798, 1.1066, 0.8637, 0.9460, 1.3493, 1.3524], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.3614, 0.5214, 0.1778, 0.3030, 0.4437, 0.0416, 0.2726, 0.3489], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000]]) tensor([[0.9101, 0.3961, 0.2422, 0.6505, 0.8651, 0.4071, 0.2292, 0.7021], [0.2895, 0.3029, 0.7941, 0.9762, 0.9781, 0.0098, 0.0681, 0.1918], [1.1520, 1.2309, 1.2798, 1.1066, 0.8637, 0.9460, 1.3493, 1.3524], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.3614, 0.5214, 0.1778, 0.3030, 0.4437, 0.0416, 0.2726, 0.3489], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000]]) tensor(True) tensor([[[0.8990, 0.4597, 0.7653, 0.6775, 0.3636, 0.4298, 0.3261, 0.9486], [0.0308, 0.8333, 0.0035, 0.3883, 0.8613, 0.2124, 0.4893, 0.1022], [0.3727, 0.3074, 0.8212, 0.8106, 0.0155, 0.6888, 0.7277, 0.7075], [0.7739, 0.0090, 0.2914, 0.3589, 0.1572, 0.0859, 0.1171, 0.6445], [0.0477, 0.5978, 0.1796, 0.8697, 0.8681, 0.3389, 0.8583, 0.2979]], [[0.4149, 0.0501, 0.1444, 0.3398, 0.8869, 0.3870, 0.7668, 0.9858], [0.4371, 0.0038, 0.9366, 0.7123, 0.5654, 0.9842, 0.3148, 0.0612], [0.3490, 0.4695, 0.7684, 0.2278, 0.1113, 0.5987, 0.1896, 0.7463], [0.9775, 0.8479, 0.6687, 0.1694, 0.2184, 0.3508, 0.8931, 0.6718], [0.9636, 0.9075, 0.9465, 0.2474, 0.2375, 0.7783, 0.7889, 0.4870]], [[0.0773, 0.0997, 0.9874, 0.8786, 0.8156, 0.3476, 0.5336, 0.7997], [0.7374, 0.0760, 0.2192, 0.4114, 0.4912, 0.9106, 0.7786, 0.3500], [0.2275, 0.8594, 0.7933, 0.2454, 0.1883, 0.9494, 0.1048, 0.1753], [0.2489, 0.6791, 0.8371, 0.2103, 0.7531, 0.4672, 0.4845, 0.8223], [0.8476, 0.1368, 0.2671, 0.2773, 0.9175, 0.1492, 0.9960, 0.9908]]]) tensor([[0, 4, 1, 2, 3], [2, 3, 0, 0, 1], [2, 1, 0, 2, 4]]) tensor([[[0.8990, 0.4597, 0.7653, 0.6775, 0.3636, 0.4298, 0.3261, 0.9486], [0.3727, 0.3074, 0.8212, 0.8106, 0.0155, 0.6888, 0.7277, 0.7075], [0.7739, 0.0090, 0.2914, 0.3589, 0.1572, 0.0859, 0.1171, 0.6445], [0.0477, 0.5978, 0.1796, 0.8697, 0.8681, 0.3389, 0.8583, 0.2979], [0.0308, 0.8333, 0.0035, 0.3883, 0.8613, 0.2124, 0.4893, 0.1022], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], [[1.3265, 1.3174, 1.4372, 0.3971, 0.3298, 0.9495, 1.0827, 1.4180], [0.9636, 0.9075, 0.9465, 0.2474, 0.2375, 0.7783, 0.7889, 0.4870], [0.4149, 0.0501, 0.1444, 0.3398, 0.8869, 0.3870, 0.7668, 0.9858], [0.4371, 0.0038, 0.9366, 0.7123, 0.5654, 0.9842, 0.3148, 0.0612], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], [[0.2275, 0.8594, 0.7933, 0.2454, 0.1883, 0.9494, 0.1048, 0.1753], [0.7374, 0.0760, 0.2192, 0.4114, 0.4912, 0.9106, 0.7786, 0.3500], [0.3263, 0.7788, 1.8245, 1.0889, 1.5687, 0.8148, 1.0181, 1.6220], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.8476, 0.1368, 0.2671, 0.2773, 0.9175, 0.1492, 0.9960, 0.9908], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000]]]) §2.1.3 knn_graph torch_geometric.nn.pool.knn_graph. Euclidean distances is similar to Attention.\ndef my_knn_graph(x, k=3, loop=False, cosine=False, xyz=False): if x.dim() == 2:# [num_nodes, in_channels] x = x.unsqueeze(0)# [batch_size, num_nodes, in_channels] squeeze_at_the_end = True elif x.dim() == 3:# [batch_size, num_nodes, in_channels] squeeze_at_the_end = False else: RuntimeError(f\u0026#39;The dimension of x should be 2 or 3. Got: {x.dim()}\u0026#39;) batch_size, num_nodes, _ = x.shape # pick out [batch_size, num_nodes, 3]. In this case, 3 stands for x, y, z. if xyz: x = x[:, :, :3]# [batch_size, num_nodes, 3] if cosine:# cosine distances x_norm = x / torch.norm(x, dim=-1, keepdim=True) similarities = x_norm @ x_norm.transpose(-2, -1) distances = 1 - similarities# [batch_size, num_nodes, num_nodes] else:# Euclidean distances distances = torch.cdist(x, x)# [batch_size, num_nodes, num_nodes] # if `True`, contain self loops if not loop: mask = torch.eye(num_nodes, dtype=torch.bool).unsqueeze(0) distances.masked_fill_(mask, float(\u0026#39;inf\u0026#39;)) # k neighbors _, indices = distances.topk(k=k, dim=-1, largest=False)# [batch_size, num_nodes, k] # concat, source to target row = torch.arange(num_nodes).view(-1, 1).repeat(1, k).view(-1).repeat(batch_size, 1, 1)# [batch_size, 1, num_nodes * k] col = indices.view(batch_size, -1).unsqueeze(-2)# [batch_size, 1, num_nodes * k] edge_index = torch.cat([row, col], dim=-2) # [batch_size, 2, num_nodes * k] if squeeze_at_the_end: edge_index = edge_index.squeeze() return edge_index def test_knn_graph(): x = torch.rand(5, 8)# [num_nodes, in_channels] edge_index = my_knn_graph(x)# [2, num_messages] = [2, num_nodes * k] print(edge_index) print(edge_index.shape) x = torch.rand(3, 5, 8)# [batch_size, num_nodes, in_channels] edge_index = my_knn_graph(x)# [batch_size, 2, num_messages] = [batch_size, 2, num_nodes * k] print(edge_index) print(edge_index.shape) test_knn_graph() will get:\ntensor([[0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4], [2, 1, 4, 3, 2, 0, 1, 0, 3, 1, 2, 0, 0, 2, 1]]) torch.Size([2, 15]) tensor([[[0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4], [3, 1, 2, 2, 3, 0, 3, 1, 0, 2, 0, 4, 3, 2, 1]], [[0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4], [3, 2, 4, 4, 3, 2, 3, 4, 1, 2, 4, 0, 2, 3, 1]], [[0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4], [1, 3, 2, 0, 4, 2, 4, 3, 0, 4, 0, 2, 3, 2, 0]]]) torch.Size([3, 2, 15]) §2.2 torch_geometric.nn.conv §2.2.1 MessagePassing | Creating Message Passing Networks | torch_geometric.nn.conv.MessagePassing |\nWith $x_i \\in R^F$ denoting node features of node $i$ and $e_{j, i} \\in R^D$ denoting (optional) edge features from node $j$ to node $i$, message passing GNNs can be described as $$x_i^{\\prime} = \\gamma ( x_i, \\bigoplus_{j \\in \\mathcal{N}(i)} , \\phi (x_i, x_j,e_{j,i}) ),$$where\n$\\phi$: MessagePassing.message() $\\bigoplus$: MessagePassing.aggregate() $\\gamma$: MessagePassing.update() Below is MyMessagePassing, later in this article TAGConv and EdgeConv are subclasses of this class.\nclass no_batch_MyMessagePassing(nn.Module): def __init__(self, aggr=\u0026#39;sum\u0026#39;): super().__init__() self.aggr = aggr def message(self, x, edge_index): row, col = edge_index# both [num_messages,] x_i, x_j = x[row], x[col]# both [num_messages, in_channels] return x_j def aggregate(self, x_j, edge_index, num_nodes): row, col = edge_index x_j = my_scatter(x_j, col, dim_size=num_nodes, reduce=self.aggr)# [num_nodes, in_channels] return x_j def update(self, x_j): return x_j def propagate(self, x, edge_index=None): num_nodes = x.shape[-2] if edge_index is None: edge_index = torch.zeros((2, 0), dtype=torch.int64)# [2, num_messages] edge_index, _ = my_add_self_loops(edge_index, num_nodes=num_nodes) x_j = self.message(x, edge_index) x_j = self.aggregate(x_j, edge_index, num_nodes) x_j = self.update(x_j) return x_j def forward(self, x, edge_index): return self.propagate(x, edge_index) class MyMessagePassing(nn.Module): def __init__(self, aggr=\u0026#39;sum\u0026#39;): super().__init__() self.aggr = aggr def message(self, x, edge_index): row, col = edge_index[:, 0, :], edge_index[:, 1, :]# both [batch_size, num_messages] # torch do not support `x_i = x[row]` in this case, so here\u0026#39;s the alternative: x_i = torch.gather(x, 1, row.unsqueeze(-1).expand(-1, -1, x.shape[-1]))# [batch_size, num_messages, in_channels] x_j = torch.gather(x, 1, col.unsqueeze(-1).expand(-1, -1, x.shape[-1]))# [batch_size, num_messages, in_channels] return x_j def aggregate(self, x_j, edge_index, num_nodes): row, col = edge_index[:, 0, :], edge_index[:, 1, :]# both [batch_size, num_messages] x_j = my_scatter(x_j, col, dim_size=num_nodes, reduce=self.aggr)# [batch_size, num_nodes, in_channels] return x_j def update(self, x_j): return x_j def propagate(self, x, edge_index=None): batch_size, num_nodes, _ = x.shape if edge_index is None: edge_index = torch.zeros((batch_size, 2, 0), dtype=torch.int64)# [batch_size, 2, num_messages] edge_index, _ = my_add_self_loops(edge_index, num_nodes=num_nodes) x_j = self.message(x, edge_index) x_j = self.aggregate(x_j, edge_index, num_nodes) x_j = self.update(x_j) return x_j def forward(self, x, edge_index): return self.propagate(x, edge_index) §2.2.2 TAGConv torch_geometric.nn.conv.TAGConv\nTAGConv is defined as $$X^{\\prime} = \\sum_{k=0}^K \\left( D^{-1/2} A D^{-1/2} \\right)^k X W_k,$$where $A$ denotes the adjacency matrix and $D_{ii} = \\sum_{j=0} A_{ij}$ its diagonal degree matrix.\nclass MyTAGConv(MyMessagePassing): def __init__(self, in_channels, out_channels, K=4): super().__init__() self.linears = nn.ModuleList([ nn.Linear(in_channels, out_channels, bias=False) for _ in range(K + 1) ]) self.bias = nn.Parameter(torch.empty(out_channels)) def forward(self, x, edge_index): out = self.linears[0](x) for linear in self.linears[1:]: x_j = self.propagate(x, edge_index) out = out + linear(x_j) out = out + self.bias return out my_tag_conv = MyTAGConv(in_channels=16, out_channels=32) x = torch.randn(3, 10, 16)# [batch_size, num_nodes, in_channels] edge_index = my_knn_graph(x, k=3)# [batch_size, 2, num_nodes * k] = [batch_size, 2, num_messages] x = my_tag_conv(x, edge_index) print(x.shape)# [batch_size, num_nodes, out_channels] will get:\ntorch.Size([3, 10, 32]) §2.2.3 EdgeConv torch_geometric.nn.conv.EdgeConv\nEdgeConv is defined as $$x_i^{\\prime} = \\sum_{j \\in \\mathcal{N}(i)} h_{\\mathbf{\\Theta}}(x_i , x_j - x_i)$$ where $h_{\\mathbf{\\Theta}}$ denotes a neural network.\nclass MyEdgeConv(MyMessagePassing): def __init__(self, nn, aggr=\u0026#39;max\u0026#39;): super().__init__(aggr=aggr) self.nn = nn def message(self, x, edge_index): row, col = edge_index[:, 0, :], edge_index[:, 1, :]# both [batch_size, num_messages] # torch do not support `x_i = x[row]` in this case, so here\u0026#39;s the alternative: x_i = torch.gather(x, 1, row.unsqueeze(-1).expand(-1, -1, x.shape[-1]))# [batch_size, num_messages, in_channels] x_j = torch.gather(x, 1, col.unsqueeze(-1).expand(-1, -1, x.shape[-1]))# [batch_size, num_messages, in_channels] x_j = torch.cat([x_i, x_j - x_i], dim=-1)# [batch_size, num_nodes, 2 * in_channels] x_j = self.nn(x_j) return x_j my_edge_conv = MyEdgeConv( nn.Sequential( nn.Linear(32, 64),# [2 * in_channels, hidden_channels] nn.ReLU(), nn.Linear(64, 128),# [hidden_channels, out_channels] nn.ReLU() ) ) x = torch.randn(3, 10, 16)# [batch_size, num_nodes, in_channels] edge_index = my_knn_graph(x, k=3)# [batch_size, 2, num_nodes * k] = [batch_size, 2, num_messages] x = my_edge_conv(x, edge_index) print(x.shape)# [batch_size, num_nodes, out_channels] will get:\ntorch.Size([3, 10, 128]) §3 GraphNeT This section is a general introduction to GitHub repository GraphNeT. See their getting started document, especially the example. In the following article I will focus on the model rather than how to load the data or how to train the model with pytorch-lightning, and I will test these models with dummies. Because I just understand things better in this way and I haven\u0026rsquo;t used these models in practice.\n§3.1 Shape of the Data See 4. The Dataset and DataLoader classes of the getting started document:\ngraph.x: Node feature matrix with shape [num_nodes, num_features] graph.edge_index: Graph connectivity in COO format with shape [2, num_edges] and type torch.long (by default this will be None, i.e., the nodes will all be disconnected). §3.2 graphnet.models.gnn §3.2.1 ConvNet graphnet.models.gnn.ConvNet is based on torch_geometric.nn.TAGConv. For the structure of the model, see Fig.3 of [2107.12187] Reconstruction of Neutrino Events in IceCube using Graph Neural Networks.\nIn [2107.12187], it\u0026rsquo;s stated that:\nIn the simplest way, each pulse can be described by following quantities: the hit DOM, and therefore the position of the pulse, collected charge, and time recorded. \u0026hellip; We can then represent each event by a graph, with the nodes representing the pulses in an abstract 5-dimensional (or 12-dimensional for the Upgrade) space.\nTherefore, the event is an input matrix in the shape of [number_of_pulses, 5], where 5 is x, y, z, time, charge.\n§3.2.2 DynEdge §3.2.2.1 DynEdgeConv The basic layer of DynEdge is graphnet.models.components.layers.DynEdgeConv, which is based on torch_geometric.nn.EdgeConv.\n§3.2.2.2 DynEdge graphnet.models.gnn.DynEdge\n§3.2.2.3 DynEdgeJINST graphnet.models.gnn.DynEdgeJINST is the model in Fig.2 of [2209.03042] Graph Neural Networks for Low-Energy Event Classification \u0026amp; Reconstruction in IceCube. [n, 6] in the figure means the number of nodes is n and the number of features is 6, while [1, n_outputs] means the prediction of this event has n_outputs features (azimuth, zenith, energy, etc.)\n§3.2.2.4 DynEdgeTITO From 1st Place Solution in the Kaggle Competition.\nThe structure of this model is as follows:\ngraphnet.models.gnn.DynEdgeTITO graphnet.models.components.layers.DynTrans graphnet.models.components.layers.EdgeConvTito torch.nn.TransformerEncoder torch.nn.TransformerEncoderLayer graphnet.models.components.layers.DynTrans graphnet.models.components.layers.EdgeConvTito torch.nn.TransformerEncoder torch.nn.TransformerEncoderLayer graphnet.models.components.layers.DynTrans graphnet.models.components.layers.EdgeConvTito torch.nn.TransformerEncoder torch.nn.TransformerEncoderLayer Post-processing Global pooling Read-out For torch.nn.TransformerEncoderLayer, d_model=256 and nhead=8, and by default dim_feedforward=2048.\nOne of the layers graphnet.models.components.layers.EdgeConvTito is a modification on torch_geometric.nn.EdgeConv (See §2.3.3): $$x_i^{\\prime} = \\sum_{j \\in \\mathcal{N}(i)} h_{\\mathbf{\\Theta}}(x_i , x_j - x_i , x_j)$$\nHere we subclass MyMessagePassing to write it from scratch:\nclass MyEdgeConvTito(MyMessagePassing): def __init__(self, nn, aggr=\u0026#39;max\u0026#39;): super().__init__(aggr=aggr) self.nn = nn def message(self, x, edge_index): row, col = edge_index[:, 0, :], edge_index[:, 1, :]# both [batch_size, num_messages] # torch do not support `x_i = x[row]` in this case, so here\u0026#39;s the alternative: x_i = torch.gather(x, 1, row.unsqueeze(-1).expand(-1, -1, x.shape[-1]))# [batch_size, num_messages, in_channels] x_j = torch.gather(x, 1, col.unsqueeze(-1).expand(-1, -1, x.shape[-1]))# [batch_size, num_messages, in_channels] x_j = torch.cat([x_i, x_j - x_i, x_j], dim=-1)# [batch_size, num_nodes, 3 * in_channels] x_j = self.nn(x_j) return x_j my_edge_conv_tito = MyEdgeConvTito( nn.Sequential( nn.Linear(48, 64),# [3 * in_channels, hidden_channels] nn.ReLU(), nn.Linear(64, 128),# [hidden_channels, out_channels] nn.ReLU() ) ) x = torch.randn(3, 10, 16)# [batch_size, num_nodes, in_channels] edge_index = my_knn_graph(x, k=3)# [batch_size, 2, num_nodes * k] = [batch_size, 2, num_messages] x = my_edge_conv_tito(x, edge_index) print(x.shape)# [batch_size, num_nodes, out_channels] will get:\ntorch.Size([3, 10, 128]) ",
      "content_html": "\u003ch2 id=\"1-graph\"\u003e§1 Graph\u003c/h2\u003e\n\u003cp\u003eA graph is a data structure that has the shape $\\mathbb{R} ^{N \\times P}$, where\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e$N$ is the number of nodes. Note that $N$ might vary in a dataset, but we often use cutting or padding to get a uniform, normalized $N$.\u003c/li\u003e\n\u003cli\u003e$P$ is the number of features. Yes, the concept of \u0026ldquo;features\u0026rdquo; is similar to the concept of \u0026ldquo;channels\u0026rdquo; in CNNs.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eA picture $\\mathbb{R}^{H \\times W \\times C}$ is of height $H$ and width $W$, thus the total number of pixels is $HW$, and each pixel has $C$ channels, commonly $C=1$ (grey channel) or $C=3$ (RGB channels). Now let\u0026rsquo;s transform this picture into a graph $\\mathbb{R}^{N \\times P}$, where $N=HW$ is the total number of pixels. Thus $P=C+2$, which means the original position information is now encoded into the channels. What\u0026rsquo;s more, graph can represent more than that, thus in a sense, a graph is a generalized picture.\u003c/p\u003e\n\u003ch3 id=\"11-graph--matrix\"\u003e§1.1 Graph \u0026amp; Matrix\u003c/h3\u003e\n\u003cp\u003eGraphs can be represented by adjacency matrix, which can be normalized into \u003ca href=\"https://en.wikipedia.org/wiki/Frobenius_normal_form\"\u003eFrobenius normal form\u003c/a\u003e, see \u003ca href=\"https://thepalindrome.org/p/matrices-and-graphs\"\u003e\u003cem\u003eMatrices and graphs\u003c/em\u003e - by Tivadar Danka - The Palindrome\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F485ec4b4-6869-43bb-b17c-e2151a428dbe_1920x1080.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eOften, large part of the matrix is empty, which is called \u003ca href=\"https://en.wikipedia.org/wiki/Sparse_matrix\"\u003eSparse matrix\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"2-gnn-pytorch-geometric-style\"\u003e§2 GNN (\u003ccode\u003ePyTorch Geometric\u003c/code\u003e Style)\u003c/h2\u003e\n\u003cp\u003eSee \u003ca href=\"https://distill.pub/2021/gnn-intro/\"\u003e\u003cem\u003eA Gentle Introduction to Graph Neural Networks\u003c/em\u003e - Distill.pub\u003c/a\u003e. The general idea is that after GNN, part of the nodes are highlighted and the number of features of each nodes can be different. This is in consistence with CNN, where parts of the picture is highlighted and the number of channels (RGB $\\rightarrow$ many more) can be different (see \u003ca href=\"https://poloclub.github.io/cnn-explainer/\"\u003eCNN Explainer\u003c/a\u003e).\u003c/p\u003e\n\u003cp\u003eConsidering the popularity of LLMs, unsurprisingly, GNNs support Attention. For \u003ca href=\"https://arxiv.org/abs/1710.10903\"\u003eGraph Attention Networks (GAT)\u003c/a\u003e, see \u003ca href=\"https://nn.labml.ai/graphs/gat/index.html\"\u003eGraph Attention Networks (GAT) (labml.ai)\u003c/a\u003e and \u003ca href=\"https://nn.labml.ai/graphs/gatv2/index.html\"\u003eGraph Attention Networks v2 (GATv2) (labml.ai)\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThis section is a skinner implementation of \u003ca href=\"https://github.com/pyg-team/pytorch_geometric\"\u003e\u003ccode\u003ePyTorch Geometric\u003c/code\u003e\u003c/a\u003e from scratch, which means it\u0026rsquo;s NOT necessary to install the package, but I still recommend to do so for comparison:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epip install torch_geometric\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd we import \u003ccode\u003ePyTorch\u003c/code\u003e as before:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch.nn\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch.nn.functional\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"21-torch_geometricutils\"\u003e§2.1 \u003ccode\u003etorch_geometric.utils\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch-geometric.readthedocs.io/en/2.5.2/modules/utils.html\"\u003e\u003ccode\u003etorch_geometric.utils\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch4 id=\"211-add_self_loops\"\u003e§2.1.1 \u003ccode\u003eadd_self_loops\u003c/code\u003e\u003c/h4\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003etorch_geometric.utils.add_self_loops\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch-geometric.readthedocs.io/en/2.5.2/modules/utils.html#torch_geometric.utils.add_self_loops\"\u003e\u003ccode\u003etorch_geometric.utils.add_self_loops\u003c/code\u003e\u003c/a\u003e is pretty self-explaining.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch_geometric.utils\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd_self_loops\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003etest_add_self_loops\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [num_nodes, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esize\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [2, num_messages]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd_self_loops\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etest_add_self_loops\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get (note we get self loops here):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e4, 9, 7, 9, 3, 6, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e5, 7, 4, 2, 7, 1, 2, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\u003cspan style=\"color:#f92672\"\u003e]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e2, 17\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003emy_add_self_loops\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003emy_add_self_loops\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eself_loops\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003earange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself_loops\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself_loops\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erepeat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself_loops\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself_loops\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erepeat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eraise\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eRuntimeError\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;The dimension of edge_index should be 2 or 3. Got: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself_loops\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eedge_weight\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_weight\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003etest_add_self_loops\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [num_nodes, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esize\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [2, num_messages]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_add_self_loops\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esize\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, 2, num_messages]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_add_self_loops\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etest_add_self_loops\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e0, 5, 2, 7, 8, 8, 5, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0, 2, 6, 6, 9, 6, 3, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\u003cspan style=\"color:#f92672\"\u003e]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e2, 17\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[[\u003c/span\u003e5, 7, 2, 4, 9, 8, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e5, 3, 3, 7, 0, 1, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e9, 0, 4, 7, 4, 9, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e6, 2, 9, 7, 7, 4, 6, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e4, 5, 4, 2, 0, 3, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 9, 7, 4, 9, 4, 5, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\u003cspan style=\"color:#f92672\"\u003e]]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e3, 2, 17\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"212-scatter\"\u003e§2.1.2 \u003ccode\u003escatter\u003c/code\u003e\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch-geometric.readthedocs.io/en/2.5.2/modules/utils.html#torch_geometric.utils.scatter\"\u003e\u003ccode\u003etorch_geometric.utils.scatter\u003c/code\u003e\u003c/a\u003e is the same as \u003ca href=\"https://pytorch-geometric.readthedocs.io/en/2.5.2/modules/nn.html#aggregation-operators\"\u003eAggregation Operators\u003c/a\u003e. Below is the image from \u003ca href=\"https://pytorch-scatter.readthedocs.io/en/latest/functions/scatter.html\"\u003eScatter — pytorch_scatter 2.1.1 documentation\u003c/a\u003e:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://raw.githubusercontent.com/rusty1s/pytorch_scatter/master/docs/source/_figures/add.svg?sanitize=true\"\r\n  alt=\"scatter\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003etorch_geometric.utils.scatter\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch_geometric.utils\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003escatter\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003etest_scatter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [num_index, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esize\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [num_index,]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003escatter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ereduce\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;sum\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [dim_size, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etest_scatter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e0.0101, 0.3919, 0.6275, 0.1619, 0.2756, 0.9814, 0.5278, 0.9113\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.1170, 0.4807, 0.8374, 0.6121, 0.1399, 0.3740, 0.4485, 0.0578\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.7961, 0.2162, 0.8050, 0.2520, 0.2318, 0.0279, 0.9750, 0.3881\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2107, 0.2072, 0.8769, 0.7675, 0.2437, 0.6953, 0.2572, 0.4149\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.6781, 0.9938, 0.4502, 0.1818, 0.2886, 0.2952, 0.1135, 0.9759\u003cspan style=\"color:#f92672\"\u003e]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e3, 0, 3, 1, 1\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e0.1170, 0.4807, 0.8374, 0.6121, 0.1399, 0.3740, 0.4485, 0.0578\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.8888, 1.2010, 1.3271, 0.9493, 0.5323, 0.9904, 0.3706, 1.3908\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.8061, 0.6080, 1.4325, 0.4139, 0.5074, 1.0093, 1.5027, 1.2994\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003emy_scatter\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003emy_scatter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ereduce\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;sum\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [num_index, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enum_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# if reduce == \u0026#39;sum\u0026#39;:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# for i in range(num_index):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e#     output[index[i]] += input[i]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexpand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# https://pytorch.org/docs/stable/generated/torch.Tensor.scatter_reduce_.html\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003escatter_reduce_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ereduce\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ereduce\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [dim_size, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_index, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexpand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003escatter_reduce_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ereduce\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ereduce\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, dim_size, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eraise\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eRuntimeError\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;The dimension of input should be 2 or 3. Got: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003etest_scatter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [num_index, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esize\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [num_index,]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ey1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003escatter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ereduce\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;sum\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [dim_size, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ey1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ey2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_scatter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ereduce\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;sum\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [dim_size, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ey2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eall\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ey1\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ey2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_index, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esize\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_index]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_scatter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ereduce\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;sum\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, dim_size, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etest_scatter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e0.2109, 0.7352, 0.5434, 0.3313, 0.4879, 0.1099, 0.9719, 0.5557\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2895, 0.3029, 0.7941, 0.9762, 0.9781, 0.0098, 0.0681, 0.1918\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.9410, 0.4957, 0.7365, 0.7754, 0.3758, 0.8361, 0.3774, 0.7967\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.3614, 0.5214, 0.1778, 0.3030, 0.4437, 0.0416, 0.2726, 0.3489\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.9101, 0.3961, 0.2422, 0.6505, 0.8651, 0.4071, 0.2292, 0.7021\u003cspan style=\"color:#f92672\"\u003e]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e2, 1, 2, 4, 0\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e0.9101, 0.3961, 0.2422, 0.6505, 0.8651, 0.4071, 0.2292, 0.7021\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2895, 0.3029, 0.7941, 0.9762, 0.9781, 0.0098, 0.0681, 0.1918\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1.1520, 1.2309, 1.2798, 1.1066, 0.8637, 0.9460, 1.3493, 1.3524\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.3614, 0.5214, 0.1778, 0.3030, 0.4437, 0.0416, 0.2726, 0.3489\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e0.9101, 0.3961, 0.2422, 0.6505, 0.8651, 0.4071, 0.2292, 0.7021\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2895, 0.3029, 0.7941, 0.9762, 0.9781, 0.0098, 0.0681, 0.1918\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1.1520, 1.2309, 1.2798, 1.1066, 0.8637, 0.9460, 1.3493, 1.3524\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.3614, 0.5214, 0.1778, 0.3030, 0.4437, 0.0416, 0.2726, 0.3489\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eTrue\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[[\u003c/span\u003e0.8990, 0.4597, 0.7653, 0.6775, 0.3636, 0.4298, 0.3261, 0.9486\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0308, 0.8333, 0.0035, 0.3883, 0.8613, 0.2124, 0.4893, 0.1022\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.3727, 0.3074, 0.8212, 0.8106, 0.0155, 0.6888, 0.7277, 0.7075\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.7739, 0.0090, 0.2914, 0.3589, 0.1572, 0.0859, 0.1171, 0.6445\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0477, 0.5978, 0.1796, 0.8697, 0.8681, 0.3389, 0.8583, 0.2979\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e0.4149, 0.0501, 0.1444, 0.3398, 0.8869, 0.3870, 0.7668, 0.9858\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.4371, 0.0038, 0.9366, 0.7123, 0.5654, 0.9842, 0.3148, 0.0612\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.3490, 0.4695, 0.7684, 0.2278, 0.1113, 0.5987, 0.1896, 0.7463\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.9775, 0.8479, 0.6687, 0.1694, 0.2184, 0.3508, 0.8931, 0.6718\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.9636, 0.9075, 0.9465, 0.2474, 0.2375, 0.7783, 0.7889, 0.4870\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e0.0773, 0.0997, 0.9874, 0.8786, 0.8156, 0.3476, 0.5336, 0.7997\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.7374, 0.0760, 0.2192, 0.4114, 0.4912, 0.9106, 0.7786, 0.3500\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2275, 0.8594, 0.7933, 0.2454, 0.1883, 0.9494, 0.1048, 0.1753\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.2489, 0.6791, 0.8371, 0.2103, 0.7531, 0.4672, 0.4845, 0.8223\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.8476, 0.1368, 0.2671, 0.2773, 0.9175, 0.1492, 0.9960, 0.9908\u003cspan style=\"color:#f92672\"\u003e]]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e0, 4, 1, 2, 3\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e2, 3, 0, 0, 1\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e2, 1, 0, 2, 4\u003cspan style=\"color:#f92672\"\u003e]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[[\u003c/span\u003e0.8990, 0.4597, 0.7653, 0.6775, 0.3636, 0.4298, 0.3261, 0.9486\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.3727, 0.3074, 0.8212, 0.8106, 0.0155, 0.6888, 0.7277, 0.7075\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.7739, 0.0090, 0.2914, 0.3589, 0.1572, 0.0859, 0.1171, 0.6445\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0477, 0.5978, 0.1796, 0.8697, 0.8681, 0.3389, 0.8583, 0.2979\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0308, 0.8333, 0.0035, 0.3883, 0.8613, 0.2124, 0.4893, 0.1022\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e1.3265, 1.3174, 1.4372, 0.3971, 0.3298, 0.9495, 1.0827, 1.4180\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.9636, 0.9075, 0.9465, 0.2474, 0.2375, 0.7783, 0.7889, 0.4870\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.4149, 0.0501, 0.1444, 0.3398, 0.8869, 0.3870, 0.7668, 0.9858\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.4371, 0.0038, 0.9366, 0.7123, 0.5654, 0.9842, 0.3148, 0.0612\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e0.2275, 0.8594, 0.7933, 0.2454, 0.1883, 0.9494, 0.1048, 0.1753\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.7374, 0.0760, 0.2192, 0.4114, 0.4912, 0.9106, 0.7786, 0.3500\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.3263, 0.7788, 1.8245, 1.0889, 1.5687, 0.8148, 1.0181, 1.6220\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.8476, 0.1368, 0.2671, 0.2773, 0.9175, 0.1492, 0.9960, 0.9908\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000\u003cspan style=\"color:#f92672\"\u003e]]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"213-knn_graph\"\u003e§2.1.3 \u003ccode\u003eknn_graph\u003c/code\u003e\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch-geometric.readthedocs.io/en/latest/generated/torch_geometric.nn.pool.knn_graph.html\"\u003e\u003ccode\u003etorch_geometric.nn.pool.knn_graph\u003c/code\u003e\u003c/a\u003e. Euclidean distances is similar to Attention.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003emy_knn_graph\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eloop\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecosine\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003exyz\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [num_nodes, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esqueeze_at_the_end\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esqueeze_at_the_end\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75af00\"\u003eRuntimeError\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;The dimension of x should be 2 or 3. Got: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# pick out [batch_size, num_nodes, 3]. In this case, 3 stands for x, y, z.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003exyz\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, 3]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecosine\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# cosine distances\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_norm\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ekeepdim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esimilarities\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_norm\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e@\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_norm\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etranspose\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003edistances\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esimilarities\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, num_nodes]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# Euclidean distances\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003edistances\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecdist\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, num_nodes]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# if `True`, contain self loops\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eloop\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003emask\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eeye\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebool\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003edistances\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emasked_fill_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emask\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;inf\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# k neighbors\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindices\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edistances\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etopk\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elargest\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, k]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# concat, source to target\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003erow\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003earange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erepeat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erepeat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, 1, num_nodes * k]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eindices\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, 1, num_nodes * k]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erow\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e  \u003cspan style=\"color:#75715e\"\u003e# [batch_size, 2, num_nodes * k]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esqueeze_at_the_end\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003etest_knn_graph\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [num_nodes, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_knn_graph\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [2, num_messages] = [2, num_nodes * k]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_knn_graph\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, 2, num_messages] = [batch_size, 2, num_nodes * k]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etest_knn_graph\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[\u003c/span\u003e0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e2, 1, 4, 3, 2, 0, 1, 0, 3, 1, 2, 0, 0, 2, 1\u003cspan style=\"color:#f92672\"\u003e]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e2, 15\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[[\u003c/span\u003e0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e3, 1, 2, 2, 3, 0, 3, 1, 0, 2, 0, 4, 3, 2, 1\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e3, 2, 4, 4, 3, 2, 3, 4, 1, 2, 4, 0, 2, 3, 1\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1, 3, 2, 0, 4, 2, 4, 3, 0, 4, 0, 2, 3, 2, 0\u003cspan style=\"color:#f92672\"\u003e]]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e3, 2, 15\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"22-torch_geometricnnconv\"\u003e§2.2 \u003ccode\u003etorch_geometric.nn.conv\u003c/code\u003e\u003c/h3\u003e\n\u003ch4 id=\"221-messagepassing\"\u003e§2.2.1 \u003ccode\u003eMessagePassing\u003c/code\u003e\u003c/h4\u003e\n\u003cp\u003e| \u003ca href=\"https://pytorch-geometric.readthedocs.io/en/latest/tutorial/create_gnn.html\"\u003e\u003cem\u003eCreating Message Passing Networks\u003c/em\u003e\u003c/a\u003e | \u003ca href=\"https://pytorch-geometric.readthedocs.io/en/latest/generated/torch_geometric.nn.conv.MessagePassing.html\"\u003e\u003ccode\u003etorch_geometric.nn.conv.MessagePassing\u003c/code\u003e\u003c/a\u003e |\u003c/p\u003e\n\u003cp\u003eWith $x_i \\in R^F$ denoting node features of node $i$ and $e_{j, i} \\in R^D$ denoting (optional) edge features from node $j$ to node $i$, message passing GNNs can be described as $$x_i^{\\prime} = \\gamma ( x_i,\n\\bigoplus_{j \\in \\mathcal{N}(i)} , \\phi\n(x_i, x_j,e_{j,i}) ),$$where\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e$\\phi$: \u003ccode\u003eMessagePassing.message()\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e$\\bigoplus$: \u003ccode\u003eMessagePassing.aggregate()\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e$\\gamma$: \u003ccode\u003eMessagePassing.update()\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBelow is \u003ccode\u003eMyMessagePassing\u003c/code\u003e, later in this article \u003ccode\u003eTAGConv\u003c/code\u003e and \u003ccode\u003eEdgeConv\u003c/code\u003e are subclasses of this class.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eno_batch_MyMessagePassing\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;sum\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003emessage\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003erow\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# both [num_messages,]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_i\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erow\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# both [num_messages, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eaggregate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003erow\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_scatter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ereduce\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [num_nodes, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eupdate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003epropagate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eis\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [2, num_messages]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_add_self_loops\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emessage\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eaggregate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eupdate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epropagate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMyMessagePassing\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;sum\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003emessage\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003erow\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:]\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# both [batch_size, num_messages]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# torch do not support `x_i = x[row]` in this case, so here\u0026#39;s the alternative:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_i\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egather\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erow\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexpand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_messages, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egather\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexpand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_messages, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eaggregate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003erow\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:]\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# both [batch_size, num_messages]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_scatter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ereduce\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eupdate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003epropagate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eis\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezeros\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edtype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, 2, num_messages]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_add_self_loops\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emessage\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eaggregate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_nodes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eupdate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epropagate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"222-tagconv\"\u003e§2.2.2 \u003ccode\u003eTAGConv\u003c/code\u003e\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch-geometric.readthedocs.io/en/latest/generated/torch_geometric.nn.conv.TAGConv.html\"\u003e\u003ccode\u003etorch_geometric.nn.conv.TAGConv\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eTAGConv is defined as $$X^{\\prime} = \\sum_{k=0}^K \\left( D^{-1/2} A\nD^{-1/2} \\right)^k X W_k,$$where $A$ denotes the adjacency matrix and $D_{ii} = \\sum_{j=0} A_{ij}$ its diagonal degree matrix.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMyTAGConv\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eMyMessagePassing\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eK\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinears\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModuleList\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eK\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eParameter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eempty\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinears\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e](\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elinear\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elinears\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:]:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epropagate\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003eout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebias\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emy_tag_conv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMyTAGConv\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_knn_graph\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, 2, num_nodes * k] = [batch_size, 2, num_messages]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_tag_conv\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, out_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e3, 10, 32\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"223-edgeconv\"\u003e§2.2.3 \u003ccode\u003eEdgeConv\u003c/code\u003e\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://pytorch-geometric.readthedocs.io/en/latest/generated/torch_geometric.nn.conv.EdgeConv.html\"\u003e\u003ccode\u003etorch_geometric.nn.conv.EdgeConv\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eEdgeConv is defined as $$x_i^{\\prime} = \\sum_{j \\in \\mathcal{N}(i)} h_{\\mathbf{\\Theta}}(x_i , x_j - x_i)$$ where $h_{\\mathbf{\\Theta}}$ denotes a neural network.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMyEdgeConv\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eMyMessagePassing\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;max\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003emessage\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003erow\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:]\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# both [batch_size, num_messages]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# torch do not support `x_i = x[row]` in this case, so here\u0026#39;s the alternative:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_i\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egather\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erow\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexpand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_messages, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egather\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexpand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_messages, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex_i\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_i\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, 2 * in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emy_edge_conv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMyEdgeConv\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSequential\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [2 * in_channels, hidden_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eReLU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [hidden_channels, out_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eReLU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_knn_graph\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, 2, num_nodes * k] = [batch_size, 2, num_messages]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_edge_conv\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, out_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e3, 10, 128\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"3-graphnet\"\u003e§3 \u003ccode\u003eGraphNeT\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eThis section is a general introduction to GitHub repository \u003ca href=\"https://github.com/graphnet-team/graphnet\"\u003e\u003ccode\u003eGraphNeT\u003c/code\u003e\u003c/a\u003e. See their \u003ca href=\"https://github.com/graphnet-team/graphnet/blob/main/GETTING_STARTED.md\"\u003egetting started document\u003c/a\u003e, especially \u003ca href=\"https://github.com/graphnet-team/graphnet/blob/main/GETTING_STARTED.md#example-energy-reconstruction-using-modelconfig\"\u003ethe example\u003c/a\u003e. In the following article I will focus on the model rather than how to load the data or how to train the model with \u003ccode\u003epytorch-lightning\u003c/code\u003e, and I will test these models with dummies. Because I just understand things better in this way and I haven\u0026rsquo;t used these models in practice.\u003c/p\u003e\n\u003ch3 id=\"31-shape-of-the-data\"\u003e§3.1 Shape of the Data\u003c/h3\u003e\n\u003cp\u003eSee \u003ca href=\"https://github.com/graphnet-team/graphnet/blob/main/GETTING_STARTED.md#4-the-dataset-and-dataloader-classes\"\u003e4. The \u003ccode\u003eDataset\u003c/code\u003e and \u003ccode\u003eDataLoader\u003c/code\u003e classes\u003c/a\u003e of the getting started document:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003egraph.x\u003c/code\u003e: Node feature matrix with shape \u003ccode\u003e[num_nodes, num_features]\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egraph.edge_index\u003c/code\u003e: Graph connectivity in \u003ca href=\"https://pytorch.org/docs/stable/sparse.html#sparse-coo-docs\"\u003eCOO format\u003c/a\u003e with shape \u003ccode\u003e[2, num_edges]\u003c/code\u003e and type \u003ccode\u003etorch.long\u003c/code\u003e (by default this will be \u003ccode\u003eNone\u003c/code\u003e, i.e., the nodes will all be disconnected).\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"32-graphnetmodelsgnn\"\u003e§3.2 \u003ccode\u003egraphnet.models.gnn\u003c/code\u003e\u003c/h3\u003e\n\u003ch4 id=\"321-convnet\"\u003e§3.2.1 \u003ccode\u003eConvNet\u003c/code\u003e\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/graphnet-team/graphnet/blob/main/src/graphnet/models/gnn/convnet.py\"\u003e\u003ccode\u003egraphnet.models.gnn.ConvNet\u003c/code\u003e\u003c/a\u003e is based on \u003ca href=\"https://pytorch-geometric.readthedocs.io/en/latest/generated/torch_geometric.nn.conv.TAGConv.html\"\u003e\u003ccode\u003etorch_geometric.nn.TAGConv\u003c/code\u003e\u003c/a\u003e. For the structure of the model, see Fig.3 of \u003ca href=\"https://arxiv.org/abs/2107.12187\"\u003e[2107.12187] \u003cem\u003eReconstruction of Neutrino Events in IceCube using Graph Neural Networks\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://ar5iv.labs.arxiv.org/html/2107.12187/assets/graphics/architecture_small.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eIn [2107.12187], it\u0026rsquo;s stated that:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIn the simplest way, each pulse can be described by following quantities: the hit DOM, and therefore the position of the pulse, collected charge, and time recorded. \u0026hellip; We can then represent each event by a graph, with the nodes representing the pulses in an abstract 5-dimensional (or 12-dimensional for the Upgrade) space.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eTherefore, the event is an input matrix in the shape of \u003ccode\u003e[number_of_pulses, 5]\u003c/code\u003e, where \u003ccode\u003e5\u003c/code\u003e is x, y, z, time, charge.\u003c/p\u003e\n\u003ch4 id=\"322-dynedge\"\u003e§3.2.2 \u003ccode\u003eDynEdge\u003c/code\u003e\u003c/h4\u003e\n\u003ch5 id=\"3221-dynedgeconv\"\u003e§3.2.2.1 \u003ccode\u003eDynEdgeConv\u003c/code\u003e\u003c/h5\u003e\n\u003cp\u003eThe basic layer of \u003ccode\u003eDynEdge\u003c/code\u003e is \u003ca href=\"https://github.com/graphnet-team/graphnet/blob/main/src/graphnet/models/components/layers.py\"\u003e\u003ccode\u003egraphnet.models.components.layers.DynEdgeConv\u003c/code\u003e\u003c/a\u003e, which is based on \u003ca href=\"https://pytorch-geometric.readthedocs.io/en/latest/generated/torch_geometric.nn.conv.EdgeConv.html\"\u003e\u003ccode\u003etorch_geometric.nn.EdgeConv\u003c/code\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003ch5 id=\"3222-dynedge\"\u003e§3.2.2.2 \u003ccode\u003eDynEdge\u003c/code\u003e\u003c/h5\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/graphnet-team/graphnet/blob/main/src/graphnet/models/gnn/dynedge.py\"\u003e\u003ccode\u003egraphnet.models.gnn.DynEdge\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch5 id=\"3223-dynedgejinst\"\u003e§3.2.2.3 \u003ccode\u003eDynEdgeJINST\u003c/code\u003e\u003c/h5\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/graphnet-team/graphnet/blob/main/src/graphnet/models/gnn/dynedge_jinst.py\"\u003e\u003ccode\u003egraphnet.models.gnn.DynEdgeJINST\u003c/code\u003e\u003c/a\u003e is the model in Fig.2 of \u003ca href=\"https://arxiv.org/abs/2209.03042\"\u003e[2209.03042] \u003cem\u003eGraph Neural Networks for Low-Energy Event Classification \u0026amp; Reconstruction in IceCube\u003c/em\u003e\u003c/a\u003e. \u003ccode\u003e[n, 6]\u003c/code\u003e in the figure means the number of nodes is \u003ccode\u003en\u003c/code\u003e and the number of features is \u003ccode\u003e6\u003c/code\u003e, while \u003ccode\u003e[1, n_outputs]\u003c/code\u003e means the prediction of this event has \u003ccode\u003en_outputs\u003c/code\u003e features (azimuth, zenith, energy, etc.)\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://ar5iv.labs.arxiv.org/html/2209.03042/assets/x2.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ch5 id=\"3224-dynedgetito\"\u003e§3.2.2.4 \u003ccode\u003eDynEdgeTITO\u003c/code\u003e\u003c/h5\u003e\n\u003cp\u003eFrom \u003ca href=\"https://www.kaggle.com/competitions/icecube-neutrinos-in-deep-ice/discussion/402976\"\u003e1st Place Solution in the Kaggle Competition\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThe structure of this model is as follows:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/graphnet-team/graphnet/blob/main/src/graphnet/models/gnn/dynedge_kaggle_tito.py\"\u003e\u003ccode\u003egraphnet.models.gnn.DynEdgeTITO\u003c/code\u003e\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/graphnet-team/graphnet/blob/main/src/graphnet/models/components/layers.py#L115\"\u003e\u003ccode\u003egraphnet.models.components.layers.DynTrans\u003c/code\u003e\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/graphnet-team/graphnet/blob/main/src/graphnet/models/components/layers.py#L70\"\u003e\u003ccode\u003egraphnet.models.components.layers.EdgeConvTito\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.TransformerEncoder.html\"\u003e\u003ccode\u003etorch.nn.TransformerEncoder\u003c/code\u003e\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.TransformerEncoderLayer.html\"\u003e\u003ccode\u003etorch.nn.TransformerEncoderLayer\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egraphnet.models.components.layers.DynTrans\u003c/code\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003egraphnet.models.components.layers.EdgeConvTito\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etorch.nn.TransformerEncoder\u003c/code\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003etorch.nn.TransformerEncoderLayer\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egraphnet.models.components.layers.DynTrans\u003c/code\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003egraphnet.models.components.layers.EdgeConvTito\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etorch.nn.TransformerEncoder\u003c/code\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003etorch.nn.TransformerEncoderLayer\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003ePost-processing\u003c/li\u003e\n\u003cli\u003eGlobal pooling\u003c/li\u003e\n\u003cli\u003eRead-out\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFor \u003ccode\u003etorch.nn.TransformerEncoderLayer\u003c/code\u003e, \u003ccode\u003ed_model=256\u003c/code\u003e and \u003ccode\u003enhead=8\u003c/code\u003e, and by default \u003ccode\u003edim_feedforward=2048\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eOne of the layers \u003ca href=\"https://github.com/graphnet-team/graphnet/blob/main/src/graphnet/models/components/layers.py#L70\"\u003e\u003ccode\u003egraphnet.models.components.layers.EdgeConvTito\u003c/code\u003e\u003c/a\u003e is a modification on \u003ca href=\"https://pytorch-geometric.readthedocs.io/en/latest/generated/torch_geometric.nn.conv.EdgeConv.html\"\u003e\u003ccode\u003etorch_geometric.nn.EdgeConv\u003c/code\u003e\u003c/a\u003e (See §2.3.3): $$x_i^{\\prime} = \\sum_{j \\in \\mathcal{N}(i)} h_{\\mathbf{\\Theta}}(x_i , x_j - x_i , x_j)$$\u003c/p\u003e\n\u003cp\u003eHere we subclass \u003ccode\u003eMyMessagePassing\u003c/code\u003e to write it from scratch:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMyEdgeConvTito\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eMyMessagePassing\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;max\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eaggr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003emessage\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003erow\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e:]\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# both [batch_size, num_messages]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# torch do not support `x_i = x[row]` in this case, so here\u0026#39;s the alternative:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_i\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egather\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erow\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexpand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_messages, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egather\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecol\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexpand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]))\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_messages, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e([\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex_i\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_i\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, 3 * in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_j\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emy_edge_conv_tito\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMyEdgeConvTito\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSequential\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e48\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [3 * in_channels, hidden_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eReLU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [hidden_channels, out_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eReLU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, in_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_knn_graph\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ek\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, 2, num_nodes * k] = [batch_size, 2, num_messages]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emy_edge_conv_tito\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eedge_index\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, num_nodes, out_channels]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e3, 10, 128\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e",
      "url": "https://chenlinear.github.io/posts/20230910-machine-learning-notes-gnn-graphnet/",
      "date_published": "10096-10-09T90:1010:00+00:00",
      "date_modified": "10096-10-09T90:1010:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "596dbb42f797260852baf82f8759d22fc6ed8029",
      "title": "Machine Learning Notes: Mojonization",
      "summary": "",
      "content_text": "mojonization: n. the migration and translation from Python to Mojo, the superset of Python. (Yeah I made up this word, as far as I know. Cross Mojonization is a totally different thing.)\nPython is pesdo-code that works, and Mojo is pesdo-code that works high performantly.\nThis article summarizes this process and is my notes / cheat sheet. Note that Mojo is relatively new and some rules might be changing rapidly, thus this article can be outdated easily. So please always check the official documents.\nThe following content is based on what happened in a .ipynb file, to run a .mojo or .🔥 file, see Build and run Mojo source files.\n§1 Mojo Language Basics This is my notes from Mojo language basics and Mojo programming manual.\nMojo’s standard library has not yet grown a standard list or dictionary type and list or dict comprehensions is not supported. See Roadmap \u0026amp; sharp edges. See Mojo modules for all the APIs. You can use %%python at the top of a notebook cell and write normal Python code. Variables, functions, and imports defined in a Python cell are available for access in subsequent Mojo cells. §1.1 var \u0026amp; let You can declare variables with var to create a mutable value, or with let to create an immutable value. Although types aren\u0026rsquo;t required, it\u0026rsquo;s recommended to do so. You can check all the types in Mojo at Modular Docs - int or Modular Docs - dtype. For example:\nvar a = 1 var b: Int = 1 let c = 1 let d: Int = 1 let e: Float64 = 1.0 Always do these declaration at the beginning of code, because:\nRedefining implicit variables is not supported (variables without a let or var in front). If you’d like to redefine a variable across notebook cells, you must introduce the variable with var (let variables are immutable). You can’t use global variables inside functions—they’re only visible to other global variables. §1.2 fn fn is similar to def in Python. And Mojo supports def too. Types are required for arguments and return values for a fn function.\n§1.2.1 Immutable Arguments: borrowed If the arguments of the function are immutable: fn add(borrowed x: Int, borrowed y: Int) -\u0026gt; Int: return x + y c = add(1, 2) print(c) will get: 3 §1.2.2 Mutable Arguments: inout If the arguments are mutable: fn add_inout(inout x: Int, inout y: Int) -\u0026gt; Int: x += 1 y += 1 return x + y var a = 1 var b = 2 c = add_inout(a, b) print(a) print(b) print(c) will get (Note that a and b has changed): 2 3 5 §1.2.3 Transfer Arguments: owned \u0026amp; ^ If the arguments are immutable but you still want to modify it without affecting variables outside the function (This is normally what would happen in Python that global variables (variables outside the function) won\u0026rsquo;t change.)\nfn add_owned(owned x: Int, owned y: Int) -\u0026gt; Int: x += 1 y += 1 return x + y let a = 1 # or var a = 1 let b = 2 # or var b = 2 c = add_owned(a, b) print(a) print(b) print(c) will get:\n1 2 5 or\nfn add_owned(owned x: Int, owned y: Int) -\u0026gt; Int: x += 1 y += 1 return x + y c = add_owned(1, 2) print(c) will get:\n5 ^ will destroy local variable (variable inside the fn):\nfn add_owned(owned x: Int, owned y: Int) -\u0026gt; Int: x += 1 y += 1 return x+y fn main(): let a: Int = 1 # or var a = 1, this will get a warning to suggest using let because a is never mutated let b: Int = 2 let c: Int # late initialization c = add_owned(a^, b^) print(a) print(b) print(c) main() will get an error at print(a) because a has been destroyed. And\nfn add_owned(owned x: Int, owned y: Int) -\u0026gt; Int: x += 1 y += 1 return x+y fn main(): let a: Int = 1 # or var a = 1, this will get a warning to suggest using let because a is never mutated let b: Int = 2 let c: Int # late initialization c = add_owned(a^, b^) # print(a) # print(b) print(c) main() will get:\n5 In summary, in practice I will probably:\nuse Transfer Arguments (owned and ^) start by writing var and then change it into let according to the warning. §1.3 struct struct is similar to class in Python:\nstruct MyPair: var first: Int var second: Int fn __init__(inout self, first: Int, second: Int): self.first = first self.second = second fn dump(self): print(self.first, self.second) let mine = MyPair(2, 4) mine.dump() will get:\n2 4 §1.4 Python packages from python import Python let np = Python.import_module(\u0026#34;numpy\u0026#34;) let pd = Python.import_module(\u0026#34;pandas\u0026#34;) let plt = Python.import_module(\u0026#34;matplotlib.pyplot\u0026#34;) ar = np.arange(15).reshape(3, 5) print(ar) print(ar.shape) will get:\n[[ 0 1 2 3 4] [ 5 6 7 8 9] [10 11 12 13 14]] (3, 5) §2 Tensor I referred to Introduction to Tensors in Mojo🔥 - YouTube and Modular Docs - tensor.\nfrom tensor import Tensor from random import rand var t = rand[DType.float32](3,3) # or # alias type = DType.float32 # var t = rand[type](3,3) Print: .shape().__str__()\nprint(t.shape().__str__()) will get:\n3x3 .spec().__str__()\nprint(t.spec().__str__()) will get:\n3x3xfloat32 .num_elements()\nprint(t.num_elements()) will get:\n9 tensorprint() # https://github.com/modularml/mojo/blob/main/examples/blogs-videos/tensorutils/tensorutils.mojo from tensorutils import tensorprint tensorprint(t) will get:\n[[0.1315 0.4586 0.2189] [0.6788 0.9346 0.5194] [0.0345 0.5297 0.0076]] Tensor shape: 3x3 , Tensor rank: 2 , DType: float32 Do vectorized (faster) math: # https://docs.modular.com/mojo/stdlib/math/math.html from math import round # https://docs.modular.com/mojo/stdlib/algorithm/functional.html#vectorize from algorithm import vectorize # https://docs.modular.com/mojo/stdlib/sys/info.html#simdwidthof from sys.info import simdwidthof alias type = DType.float32 var t = rand[type](3,3) alias simd_width: Int = simdwidthof[type]() fn tensor_math_vectorized(t: Tensor[type])-\u0026gt;Tensor[type]: var t_new = Tensor[type](t.shape()) @parameter fn vecmath[simd_width: Int](idx: Int)-\u0026gt;None: t_new.simd_store[simd_width](idx, round(t.simd_load[simd_width](idx))) vectorize[simd_width,vecmath](t.num_elements()) return t_new tensorprint(t) tensorprint(tensor_math_vectorized(t)) will get:\n[[0.7564 0.3653 0.9825] [0.7533 0.0726 0.8847] [0.4364 0.4777 0.2749]] Tensor shape: 3x3 , Tensor rank: 2 , DType: float32 [[1.0 0.0 1.0] [1.0 0.0 1.0] [0.0 0.0 0.0]] Tensor shape: 3x3 , Tensor rank: 2 , DType: float32 §3 Conda \u0026amp; torch Cross Platform Mojo App with Conda, PyTorch and Matplotlib - YouTube explains how to install conda and torch with mojo.\n§4 Other Documents Mojo programming manual explains why Mojo is designed in this way. I will look it up when facing bugs. I learned C++ years ago and I haven\u0026rsquo;t really learned Rust. I\u0026rsquo;m not familiar with Lifetime, Pointer, etc.\nModular AI Engine is about Modular AI Engine, which is not publicly available yet.\n",
      "content_html": "\u003cp\u003e\u003cstrong\u003emojonization\u003c/strong\u003e: \u003cem\u003en.\u003c/em\u003e the migration and translation from Python to Mojo, the superset of Python. (Yeah I made up this word, as far as I know. \u003ca href=\"http://darkbluejacket.blogspot.com/2015/09/the-glory-of-cross-mojonization.html\"\u003e\u003cem\u003eCross Mojonization\u003c/em\u003e\u003c/a\u003e is a totally different thing.)\u003c/p\u003e\n\u003cp\u003ePython is pesdo-code that works, and Mojo is pesdo-code that works high performantly.\u003c/p\u003e\n\u003cp\u003eThis article summarizes this process and is my notes / cheat sheet. Note that Mojo is relatively new and some rules might be changing rapidly, thus this article can be outdated easily. So please always check the \u003ca href=\"https://docs.modular.com/\"\u003eofficial documents\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThe following content is based on what happened in a \u003ccode\u003e.ipynb\u003c/code\u003e file, to run a \u003ccode\u003e.mojo\u003c/code\u003e or \u003ccode\u003e.🔥\u003c/code\u003e file, see \u003ca href=\"https://docs.modular.com/mojo/manual/get-started/hello-world.html#build-and-run-mojo-source-files\"\u003e\u003cem\u003eBuild and run Mojo source files\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"1-mojo-language-basics\"\u003e§1 Mojo Language Basics\u003c/h2\u003e\n\u003cp\u003eThis is my notes from \u003ca href=\"https://docs.modular.com/mojo/manual/basics/\"\u003e\u003cem\u003eMojo language basics\u003c/em\u003e\u003c/a\u003e and \u003ca href=\"https://docs.modular.com/mojo/programming-manual.html\"\u003e\u003cem\u003eMojo programming manual\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMojo’s standard library has not yet grown a standard list or dictionary type and \u003ca href=\"https://docs.modular.com/mojo/roadmap.html#no-list-or-dict-comprehensions\"\u003elist or dict comprehensions is not supported\u003c/a\u003e. See \u003ca href=\"https://docs.modular.com/mojo/roadmap.html\"\u003e\u003cem\u003eRoadmap \u0026amp; sharp edges\u003c/em\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eSee \u003ca href=\"https://docs.modular.com/mojo/lib.html\"\u003e\u003cem\u003eMojo modules\u003c/em\u003e\u003c/a\u003e for all the APIs.\u003c/li\u003e\n\u003cli\u003eYou can use \u003ccode\u003e%%python\u003c/code\u003e at the top of a notebook cell and write normal Python code. Variables, functions, and imports defined in a Python cell are available for access in subsequent Mojo cells.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"11-var--let\"\u003e§1.1 \u003ccode\u003evar\u003c/code\u003e \u0026amp; \u003ccode\u003elet\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003eYou can declare variables with \u003ccode\u003evar\u003c/code\u003e to create a mutable value, or with \u003ccode\u003elet\u003c/code\u003e to create an immutable value. Although types aren\u0026rsquo;t required, it\u0026rsquo;s recommended to do so. You can check all the types in Mojo at \u003ca href=\"https://docs.modular.com/mojo/stdlib/builtin/int.html\"\u003eModular Docs - int\u003c/a\u003e or \u003ca href=\"https://docs.modular.com/mojo/stdlib/builtin/dtype.html\"\u003eModular Docs - dtype\u003c/a\u003e. For example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ed\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ee\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eFloat64\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAlways do these declaration at the beginning of code, because:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRedefining implicit variables is not supported (variables without a \u003ccode\u003elet\u003c/code\u003e or \u003ccode\u003evar\u003c/code\u003e in front). If you’d like to redefine a variable across notebook cells, you must introduce the variable with \u003ccode\u003evar\u003c/code\u003e (\u003ccode\u003elet\u003c/code\u003e variables are immutable).\u003c/li\u003e\n\u003cli\u003eYou can’t use global variables inside functions—they’re only visible to other global variables.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"12-fn\"\u003e§1.2 \u003ccode\u003efn\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003efn\u003c/code\u003e is similar to \u003ccode\u003edef\u003c/code\u003e in Python. And Mojo supports \u003ccode\u003edef\u003c/code\u003e too. Types are required for arguments and return values for a \u003ccode\u003efn\u003c/code\u003e function.\u003c/p\u003e\n\u003ch4 id=\"121-immutable-arguments-borrowed\"\u003e§1.2.1 Immutable Arguments: \u003ccode\u003eborrowed\u003c/code\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eIf the arguments of the function are immutable:\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eborrowed\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eborrowed\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003ewill get:\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"122-mutable-arguments-inout\"\u003e§1.2.2 Mutable Arguments: \u003ccode\u003einout\u003c/code\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eIf the arguments are mutable:\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd_inout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einout\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einout\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd_inout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003ewill get (\u003cstrong\u003eNote that \u003ccode\u003ea\u003c/code\u003e and \u003ccode\u003eb\u003c/code\u003e has changed\u003c/strong\u003e):\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"123-transfer-arguments-owned--\"\u003e§1.2.3 Transfer Arguments: \u003ccode\u003eowned\u003c/code\u003e \u0026amp; \u003ccode\u003e^\u003c/code\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eIf the arguments are immutable but you still want to modify it without affecting variables outside the function (\u003cstrong\u003eThis is normally what would happen in Python that global variables (variables outside the function) won\u0026rsquo;t change.\u003c/strong\u003e)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd_owned\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eowned\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eowned\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# or var a = 1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# or var b = 2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd_owned\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eor\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd_owned\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eowned\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eowned\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd_owned\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e^\u003c/code\u003e will destroy local variable (variable inside the \u003ccode\u003efn\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd_owned\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eowned\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eowned\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emain\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# or var a = 1, this will get a warning to suggest using let because a is never mutated\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# late initialization\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd_owned\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e^\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e^\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emain\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get an error at \u003ccode\u003eprint(a)\u003c/code\u003e because \u003ccode\u003ea\u003c/code\u003e has been destroyed. And\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd_owned\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eowned\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eowned\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emain\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# or var a = 1, this will get a warning to suggest using let because a is never mutated\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# late initialization\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eadd_owned\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e^\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e^\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# print(a)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# print(b)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emain\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn summary, in practice I will probably:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003euse Transfer Arguments (\u003ccode\u003eowned\u003c/code\u003e and \u003ccode\u003e^\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003estart by writing \u003ccode\u003evar\u003c/code\u003e and then change it into \u003ccode\u003elet\u003c/code\u003e according to the warning.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"13-struct\"\u003e§1.3 \u003ccode\u003estruct\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003estruct\u003c/code\u003e is similar to \u003ccode\u003eclass\u003c/code\u003e in Python:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003estruct\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMyPair\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efirst\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esecond\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einout\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efirst\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esecond\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efirst\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efirst\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esecond\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esecond\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edump\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efirst\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esecond\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emine\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMyPair\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emine\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edump\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"14-python-packages\"\u003e§1.4 Python packages\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epython\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ePython\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enp\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ePython\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eimport_module\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;numpy\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epd\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ePython\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eimport_module\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;pandas\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eplt\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ePython\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eimport_module\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;matplotlib.pyplot\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ear\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003earange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e15\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ereshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ear\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e  4\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e  9\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e11\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e13\u003c/span\u003e 14\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e3, 5\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"2-tensor\"\u003e§2 Tensor\u003c/h2\u003e\n\u003cp\u003eI referred to \u003ca href=\"https://www.youtube.com/watch?v=3OWkXNdkx8E\"\u003e\u003cem\u003eIntroduction to Tensors in Mojo🔥\u003c/em\u003e - YouTube\u003c/a\u003e and \u003ca href=\"https://docs.modular.com/mojo/stdlib/tensor/tensor.html\"\u003eModular Docs - tensor\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etensor\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eTensor\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erandom\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#111\"\u003et\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDType\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e](\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# alias type = DType.float32\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# var t = rand[type](3,3)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col\u003e\n\u003cli\u003ePrint:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"tabset\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e.shape().__str__()\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003et\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__str__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e3x3\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e.spec().__str__()\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003et\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003espec\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__str__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e3x3xfloat32\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e.num_elements()\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003et\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_elements\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e9\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003etensorprint()\u003c/code\u003e \u003c!--active--\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# https://github.com/modularml/mojo/blob/main/examples/blogs-videos/tensorutils/tensorutils.mojo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etensorutils\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etensorprint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etensorprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003et\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e0.1315   0.4586   0.2189\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.6788   0.9346   0.5194\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0345   0.5297   0.0076\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTensor shape: 3x3 , Tensor rank: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e , DType: float32\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eDo vectorized (faster) math:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# https://docs.modular.com/mojo/stdlib/math/math.html\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emath\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eround\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# https://docs.modular.com/mojo/stdlib/algorithm/functional.html#vectorize\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ealgorithm\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evectorize\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# https://docs.modular.com/mojo/stdlib/sys/info.html#simdwidthof\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esys.info\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esimdwidthof\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ealias\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eDType\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat32\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#111\"\u003et\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e](\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ealias\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esimd_width\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esimdwidthof\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etensor_math_vectorized\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003et\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eTensor\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTensor\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#111\"\u003et_new\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eTensor\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e](\u003c/span\u003e\u003cspan style=\"color:#111\"\u003et\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75af00\"\u003e@parameter\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evecmath\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esimd_width\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e](\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eidx\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eInt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003et_new\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esimd_store\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esimd_width\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e](\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eidx\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eround\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003et\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esimd_load\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esimd_width\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e](\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eidx\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003evectorize\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esimd_width\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003evecmath\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e](\u003c/span\u003e\u003cspan style=\"color:#111\"\u003et\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_elements\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003et_new\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etensorprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003et\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etensorprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etensor_math_vectorized\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003et\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e0.7564   0.3653   0.9825\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.7533   0.0726   0.8847\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.4364   0.4777   0.2749\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTensor shape: 3x3 , Tensor rank: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e , DType: float32\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e1.0   0.0   1.0\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1.0   0.0   1.0\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0.0   0.0   0.0\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTensor shape: 3x3 , Tensor rank: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e , DType: float32\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"3--conda--torch\"\u003e§3  Conda \u0026amp; \u003ccode\u003etorch\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.youtube.com/watch?v=bmpjT0T4IDY\"\u003e\u003cem\u003eCross Platform Mojo App with Conda, PyTorch and Matplotlib\u003c/em\u003e - YouTube\u003c/a\u003e explains how to install conda and \u003ccode\u003etorch\u003c/code\u003e with mojo.\u003c/p\u003e\n\u003ch2 id=\"4-other-documents\"\u003e§4 Other Documents\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://docs.modular.com/mojo/programming-manual.html\"\u003e\u003cem\u003eMojo programming manual\u003c/em\u003e\u003c/a\u003e explains why Mojo is designed in this way. I will look it up when facing bugs. I learned C++ years ago and I haven\u0026rsquo;t really learned Rust. I\u0026rsquo;m not familiar with Lifetime, Pointer, etc.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.modular.com/engine/\"\u003e\u003cem\u003eModular AI Engine\u003c/em\u003e\u003c/a\u003e is about Modular AI Engine, which is not publicly available yet.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230909-machine-learning-notes-mojonization/",
      "date_published": "9096-09-09T90:99:00+00:00",
      "date_modified": "9096-09-09T90:99:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "d61d7d9e1e3389118c42d0027b236e7bba4a177b",
      "title": "Machine Learning Notes: Jupyter Notebook 7, Torch 2.0, Mojo Locally",
      "summary": "",
      "content_text": "It\u0026rsquo;s wild all of these are happening so fast!\nOn my local computer:\nI updated Jupyter Notebook to v7.0.3, and my post Conda 101 is updated. On the server:\nCUDA version is now 11.7 and reaches the minimum requirement of torch 2.0. Mojo can be installed locally now, see Mojo 🔥 available for local download! Just imagine the speed! Installing process is gonna be hell, but I\u0026rsquo;m ready to go.\n",
      "content_html": "\u003cp\u003eIt\u0026rsquo;s wild all of these are happening so fast!\u003c/p\u003e\n\u003cp\u003eOn my local computer:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eI updated Jupyter Notebook to v7.0.3, and my post \u003ca href=\"https://chenlinear.github.io/posts/20230327-conda-101/\"\u003e\u003cem\u003eConda 101\u003c/em\u003e\u003c/a\u003e is updated.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOn the server:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCUDA version is now \u003ccode\u003e11.7\u003c/code\u003e and reaches the minimum requirement of \u003ccode\u003etorch 2.0\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eMojo\u003c/code\u003e can be installed locally now, see \u003ca href=\"https://github.com/modularml/mojo/discussions/568\"\u003eMojo 🔥 available for local download!\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eJust imagine the speed! Installing process is gonna be hell, but I\u0026rsquo;m ready to go.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230908-machine-learning-notes-jupyter-notebook-7-torch-20-mojo-locally/",
      "date_published": "8096-08-09T90:88:00+00:00",
      "date_modified": "8096-08-09T90:88:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "a70a43a7e82c73b1b71ae6d63ee22e9c00d767c4",
      "title": "XRISM \u0026 SLIM",
      "summary": "",
      "content_text": "X-Ray Imaging and Spectroscopy Mission (XRISM) is an X-ray space telescope. On the same rocket there\u0026rsquo;s also Smart Lander for Investigating Moon (SLIM), a moon landing project.\nXRISM\u0026rsquo;s predecessor Hitomi was launched on February 17 2016 and contact was lost on March 26 2016, due to malfunction of the attitude control system. (I always tell people to control their attitude btw.) After which, a lot changed. For example, this article explained the team management of XRISM, which is like an analogue of government system.\nAnd here\u0026rsquo;s a presentation from my group project last summer, which is a quick introduction to XRISM. I do (not) miss using Microsoft PPT, those were simpler times.\nIt\u0026rsquo;s a bit weird that writing about something makes you care about it more. I mean, I did not participate in the manufacturing process or anything. I guess this is also one of the meanings of this blog.\nXRISM, hang in there! Wow this is a pun. So, um \u0026hellip; SLIM, don\u0026rsquo;t?\nUpdate on Jan 25, 2024. Well, at least it landed.\nAnd this is the title screen of Kerbal Space Program by the way:\n",
      "content_html": "\u003cp\u003eX-Ray Imaging and Spectroscopy Mission (XRISM) is an X-ray space telescope. On the same rocket there\u0026rsquo;s also Smart Lander for Investigating Moon (SLIM), a moon landing project.\u003c/p\u003e\n\u003cp\u003eXRISM\u0026rsquo;s predecessor Hitomi was launched on February 17 2016 and contact was lost on March 26 2016, due to malfunction of the attitude control system. (I always tell people to control their attitude btw.) After which, a lot changed. For example, \u003ca href=\"https://arxiv.org/abs/2106.01611\"\u003ethis article\u003c/a\u003e explained the team management of XRISM, which is like an analogue of government system.\u003c/p\u003e\n\u003cp\u003eAnd here\u0026rsquo;s a \u003ca href=\"https://github.com/chenlinear/chenlinear/blob/main/presentations/20220815_G1Presentation_XRISM.pptx\"\u003epresentation\u003c/a\u003e from my group project last summer, which is a quick introduction to XRISM. I do (not) miss using Microsoft PPT, those were simpler times.\u003c/p\u003e\n\u003cp\u003eIt\u0026rsquo;s a bit weird that writing about something makes you care about it more. I mean, I did not participate in the manufacturing process or anything. I guess this is also one of the meanings of this blog.\u003c/p\u003e\n\u003cp\u003eXRISM, hang in there! Wow this is a pun. So, um \u0026hellip; SLIM, don\u0026rsquo;t?\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eUpdate on \u003ca href=\"https://twitter.com/ISAS_JAXA_EN/status/1750418819242426394\"\u003eJan 25, 2024\u003c/a\u003e. Well, at least it landed.\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://www.jaxa.jp/press/2024/01/images/20240125-4_01.jpg\"\r\n  alt=\"SLIM\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eAnd this is the title screen of \u003cem\u003eKerbal Space Program\u003c/em\u003e by the way:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://i.imgur.com/cFBFFAa.jpeg\"\r\n  alt=\"Kerbal_Space_Program\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230907-xrism-slim/",
      "date_published": "7096-07-09T90:77:00+00:00",
      "date_modified": "7096-07-09T90:77:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "b35afe860b76c6a6bbad7a9a282652678b0dd227",
      "title": "New Paper on arXiv \u0026 New Repository: ISeeCube",
      "summary": "",
      "content_text": "The arXiv link is 2308.13285v1 and the Repository is ISeeCube. Here\u0026rsquo;s what I learned and what to do next.\nWhat I Learned Test the code by print() everything. Input and output are the most important thing. Test these while reading the code. Read official package documentation for examples. ChatGPT is good at analyzing error report and giving examples, but not so much at writing code, especially when there\u0026rsquo;s already a lot of code. To Do Train the model with VMF Loss. So that the distribution of azimuthal and zenithal error is in better shape. Try different kinds of Embedding. In NLP, a random Embedding nn.Embedding will get nice results too. Because the structure is big enough. Learn the relationship between Graph and Sparse Matrix, see Matrices and graphs - by Tivadar Danka - The Palindrome. Learn GNN and GraphNeT. Learn why Transformers are CNNs, GNNs, RNNs. Clean the dataset. Why there are events with pulses nearly $110000$? model $\\rightarrow$ simulated data $\\rightarrow$ reconstruction, and then, real data $\\rightarrow$ reconstruction. This workflow probably can be improved by using self-supervised learning (see [2304.12210] A Cookbook of Self-Supervised Learning) directly on real data and then fine-tuning it on simulated data with labels. So that the model is closer to real data than simulated data. This is just an idea, which probably can be tested on the public dataset. ",
      "content_html": "\u003cp\u003eThe arXiv link is \u003ca href=\"https://arxiv.org/abs/2308.13285v1\"\u003e2308.13285v1\u003c/a\u003e and the Repository is \u003ca href=\"https://github.com/chenlinear/ISeeCube\"\u003eISeeCube\u003c/a\u003e. Here\u0026rsquo;s what I learned and what to do next.\u003c/p\u003e\n\u003ch2 id=\"what-i-learned\"\u003eWhat I Learned\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eTest the code by \u003ccode\u003eprint()\u003c/code\u003e everything.\u003c/li\u003e\n\u003cli\u003eInput and output are the most important thing. Test these while reading the code.\u003c/li\u003e\n\u003cli\u003eRead official package documentation for examples.\u003c/li\u003e\n\u003cli\u003eChatGPT is good at analyzing error report and giving examples, but not so much at writing code, especially when there\u0026rsquo;s already a lot of code.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"to-do\"\u003eTo Do\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eTrain the model with VMF Loss. So that the distribution of azimuthal and zenithal error is in better shape.\u003c/li\u003e\n\u003cli\u003eTry different kinds of Embedding. In NLP, a random Embedding \u003ccode\u003enn.Embedding\u003c/code\u003e will get nice results too. Because the structure is big enough.\u003c/li\u003e\n\u003cli\u003eLearn the relationship between Graph and \u003ca href=\"https://en.wikipedia.org/wiki/Sparse_matrix\"\u003eSparse Matrix\u003c/a\u003e, see \u003ca href=\"https://thepalindrome.org/p/matrices-and-graphs\"\u003e\u003cem\u003eMatrices and graphs\u003c/em\u003e - by Tivadar Danka - The Palindrome\u003c/a\u003e. Learn GNN and \u003ca href=\"https://github.com/graphnet-team/graphnet\"\u003e\u003ccode\u003eGraphNeT\u003c/code\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eLearn \u003ca href=\"https://arxiv.org/abs/1911.03584\"\u003ewhy Transformers are CNNs\u003c/a\u003e, \u003ca href=\"https://towardsdatascience.com/transformers-are-graph-neural-networks-bca9f75412aa\"\u003eGNNs\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/2006.16236\"\u003eRNNs\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eClean the dataset. Why there are events with pulses nearly $110000$?\u003c/li\u003e\n\u003cli\u003emodel $\\rightarrow$ simulated data $\\rightarrow$ reconstruction, and then, real data $\\rightarrow$ reconstruction. This workflow probably can be improved by using self-supervised learning (see \u003ca href=\"https://arxiv.org/abs/2304.12210\"\u003e[2304.12210] \u003cem\u003eA Cookbook of Self-Supervised Learning\u003c/em\u003e\u003c/a\u003e) directly on real data and then fine-tuning it on simulated data with labels. So that the model is closer to real data than simulated data. This is just an idea, which probably can be tested on the public dataset.\u003c/li\u003e\n\u003c/ul\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230828-new-paper-on-arxiv-new-repository-iseecube/",
      "date_published": "28086-28-09T80:2828:00+00:00",
      "date_modified": "28086-28-09T80:2828:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "e08c4968533d6c8ada7fe543c1a62e95b2aadb38",
      "title": "Gravity Spy 2.0",
      "summary": "",
      "content_text": "You can classify some patterns on Gravity Spy and it\u0026rsquo;s fun. Their GitHub repo is gravityspy-plus, and their Wiki is Gravity Spy 2.0 Wiki. The Kaggle dataset is Gravity Spy (Gravitational waves). Not to be confused with G2Net, the format of the data is quite different.\nI took a look of those patterns and I got the idea that we can use Transfer Learning from ordinary Machine Learning models for Computer Vision, because the format is RGB image and it\u0026rsquo;s a classic classification job. Then I looked it up on arXiv, there are some papers on this subject. The Fig. 10 of [2303.13917] Convolutional Neural Networks for the classification of glitches in gravitational-wave data streams is crazy, I have never seen so many \u0026ldquo;1\u0026quot;s in the diagonal line of a Confusion Matrix.\n",
      "content_html": "\u003cp\u003eYou can classify some patterns on \u003ca href=\"https://www.zooniverse.org/projects/zooniverse/gravity-spy\"\u003eGravity Spy\u003c/a\u003e and it\u0026rsquo;s fun. Their GitHub repo is \u003ca href=\"https://github.com/haorenzhi/gravityspy-plus/tree/main\"\u003egravityspy-plus\u003c/a\u003e, and their Wiki is \u003ca href=\"https://gswiki.ischool.syr.edu/\"\u003eGravity Spy 2.0 Wiki\u003c/a\u003e. The Kaggle dataset is \u003ca href=\"https://www.kaggle.com/datasets/tentotheminus9/gravity-spy-gravitational-waves\"\u003eGravity Spy (Gravitational waves)\u003c/a\u003e. Not to be confused with \u003ca href=\"https://www.kaggle.com/competitions/g2net-gravitational-wave-detection\"\u003eG2Net\u003c/a\u003e, the format of the data is quite different.\u003c/p\u003e\n\u003cp\u003eI took a look of those patterns and I got the idea that we can use Transfer Learning from ordinary Machine Learning models for Computer Vision, because the format is RGB image and it\u0026rsquo;s a classic classification job. Then I looked it up on arXiv, there are some papers on this subject. The Fig. 10 of \u003ca href=\"https://arxiv.org/abs/2303.13917\"\u003e[2303.13917] \u003cem\u003eConvolutional Neural Networks for the classification of glitches in gravitational-wave data streams\u003c/em\u003e\u003c/a\u003e is crazy, I have never seen so many \u0026ldquo;1\u0026quot;s in the diagonal line of a Confusion Matrix.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230810-gravity-spy-2.0/",
      "date_published": "10086-10-09T80:1010:00+00:00",
      "date_modified": "10086-10-09T80:1010:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "88cb6f24d3c3956054b12e680b6169227b3f7967",
      "title": "MillenniumTNG",
      "summary": "",
      "content_text": "This picture (from LGalaxiesPublicRelease.github.io) is iconic.\nMillenniumTNG is cosmological magnetohydrodynamical simulations of galaxy formation, which is the upgrade of IllustrisTNG combined with Millennium.\nIn Sec. 3.3 of [2304.12338] The MillenniumTNG Project: The impact of baryons and massive neutrinos on high-resolution weak gravitational lensing convergence maps, the simulation of massive neutrino is explained. This is the first time that neutrino is introduced to the simulation.\n",
      "content_html": "\u003cp\u003eThis picture (from \u003ca href=\"https://github.com/LGalaxiesPublicRelease/LGalaxiesPublicRelease.github.io\"\u003eLGalaxiesPublicRelease.github.io\u003c/a\u003e) is iconic.\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://lgalaxiespublicrelease.github.io/millennium_cut_new.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.mtng-project.org/\"\u003eMillenniumTNG\u003c/a\u003e is cosmological magnetohydrodynamical simulations of galaxy formation, which is the upgrade of IllustrisTNG combined with Millennium.\u003c/p\u003e\n\u003cp\u003eIn Sec. 3.3 of \u003ca href=\"https://arxiv.org/abs/2304.12338\"\u003e[2304.12338] \u003cem\u003eThe MillenniumTNG Project: The impact of baryons and massive neutrinos on high-resolution weak gravitational lensing convergence maps\u003c/em\u003e\u003c/a\u003e, the simulation of massive neutrino is explained. This is the first time that neutrino is introduced to the simulation.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230808-millenniumtng/",
      "date_published": "8086-08-09T80:88:00+00:00",
      "date_modified": "8086-08-09T80:88:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "1ad67b256495b10046d3cd3c0323438fb0b1338c",
      "title": "LK99",
      "summary": "",
      "content_text": "LK99 is supposed to be room-temperature, ambient-pressure superconductor.\nTo me, the big leap from room-temperature, super-high pressure superconductor to room-temperature, ambient-pressure superconductor is not plausible. Maybe I\u0026rsquo;m being conservative, but according to my understanding that\u0026rsquo;s not how these kind of things work.\nThis overview table is really helpful in tracking replications: Claims of Room Temperature and Ambient Pressure Superconductor | Page 13 | SpaceBattles.\nOn social media, this is really popular, because this is something everybody can understand. It\u0026rsquo;s like that \u0026ldquo;is Pluto a planet\u0026rdquo; thing again. There\u0026rsquo;s this meme where the supposed superconductor\u0026rsquo;s resistance is measured by an everyday electronic multimeter, which is really funny.\n",
      "content_html": "\u003cp\u003e\u003ca href=\"https://arxiv.org/abs/2307.12008\"\u003eLK99\u003c/a\u003e is supposed to be room-temperature, ambient-pressure superconductor.\u003c/p\u003e\n\u003cp\u003eTo me, the big leap from room-temperature, super-high pressure superconductor to room-temperature, ambient-pressure superconductor is not plausible. Maybe I\u0026rsquo;m being conservative, but according to my understanding that\u0026rsquo;s not how these kind of things work.\u003c/p\u003e\n\u003cp\u003eThis overview table is really helpful in tracking replications: \u003ca href=\"https://forums.spacebattles.com/threads/claims-of-room-temperature-and-ambient-pressure-superconductor.1106083/page-13\"\u003eClaims of Room Temperature and Ambient Pressure Superconductor | Page 13 | SpaceBattles\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eOn social media, this is really popular, because this is something everybody can understand. It\u0026rsquo;s like that \u0026ldquo;is Pluto a planet\u0026rdquo; thing again. There\u0026rsquo;s this meme where the supposed superconductor\u0026rsquo;s resistance is measured by an everyday electronic multimeter, which is really funny.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230731-lk99/",
      "date_published": "31076-31-09T70:3131:00+00:00",
      "date_modified": "31076-31-09T70:3131:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "4c8f64275fa130738a4456de4d019ff58ad526e6",
      "title": "JWST: Cosmic Question Mark",
      "summary": "",
      "content_text": "So there\u0026rsquo;s a question mark in the deep sky, see James Webb Space Telescope Feed Post (jwstfeed.com).\nHumans are pattern-finding CNNs. And sometimes it\u0026rsquo;s funny.\nSimilar to the face on Mars, see Cydonia, the magic and the hype would go away with higher resolution. But higher resolution provides a different kind of magic, see JWTS Uranus.\n",
      "content_html": "\u003cp\u003eSo there\u0026rsquo;s a question mark in the deep sky, see \u003ca href=\"https://jwstfeed.com/PostView/FeedPost?ci=1690584124_james-webb-space-telescope-question-mark-galaxy-photo\"\u003eJames Webb Space Telescope Feed Post (jwstfeed.com)\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eHumans are pattern-finding CNNs. And sometimes it\u0026rsquo;s funny.\u003c/p\u003e\n\u003cp\u003eSimilar to the face on Mars, see \u003ca href=\"https://en.wikipedia.org/wiki/Cydonia_(Mars)\"\u003eCydonia\u003c/a\u003e, the magic and the hype would go away with higher resolution. But higher resolution provides a different kind of magic, see \u003ca href=\"https://www.esa.int/Science_Exploration/Space_Science/Webb/Webb_scores_another_ringed_world_with_new_image_of_Uranus\"\u003eJWTS Uranus\u003c/a\u003e.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230728-jwst-cosmic-question-mark/",
      "date_published": "28076-28-09T70:2828:00+00:00",
      "date_modified": "28076-28-09T70:2828:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "f23e67f2d5aedf2c1b2b33b71e498fc31b729ad5",
      "title": "Machine Learning Notes: Mojo",
      "summary": "",
      "content_text": "Mojo🔥 is magic. Check out this interview with the founder of Mojo: Chris Lattner: Future of Programming and AI | Lex Fridman Podcast #381 - YouTube. Integrated with python and using multiple CPU/GPU/TPU is unbelievable.\nI think the name is actually kinda cool. Though I\u0026rsquo;m sure when it\u0026rsquo;s released (fingers crossed), someone will fork it and name it Dojo, or Casa, or House.1\nStarting from 8 Sep 2023, it\u0026rsquo;s available for local download!\nWow there\u0026rsquo;s already one: mojodojo.dev\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003e\u003ca href=\"https://docs.modular.com/mojo/\"\u003eMojo🔥\u003c/a\u003e is magic. Check out this interview with the founder of Mojo: \u003ca href=\"https://www.youtube.com/watch?v=pdJQ8iVTwj8\"\u003eChris Lattner: Future of Programming and AI | Lex Fridman Podcast #381 - YouTube\u003c/a\u003e. Integrated with python and using multiple CPU/GPU/TPU is unbelievable.\u003c/p\u003e\n\u003cp\u003eI think the name is actually kinda cool. Though I\u0026rsquo;m sure when it\u0026rsquo;s released (fingers crossed), someone will fork it and name it Dojo, or Casa, or House.\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eStarting from \u003ca href=\"https://www.modular.com/blog/mojo-its-finally-here\"\u003e8 Sep 2023\u003c/a\u003e, it\u0026rsquo;s available for local download!\u003c/p\u003e\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eWow there\u0026rsquo;s already one: \u003ca href=\"https://github.com/mojodojodev/mojodojo.dev\"\u003emojodojo.dev\u003c/a\u003e\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230721-machine-learning-notes-mojo/",
      "date_published": "21076-21-09T70:2121:00+00:00",
      "date_modified": "21076-21-09T70:2121:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "d93dfac856c6b2491e0a80330f8860d9d2a992ff",
      "title": "Book Review: Einstein's Dreams",
      "summary": "",
      "content_text": "This is a review of Einstein\u0026rsquo;s Dreams by Alan Lightman.\nIn my opinion, science progresses a little bit at a time. This video is an inspiration to me, and I also referred to The Mystery of the Einstein–Poincaré Connection, Albert Einstein | In the Dark, and Wikipedia on Relativity priority dispute and History of special relativity. The clue is: it\u0026rsquo;s called Lorentz transformation.\n1881, J. J. Thomson. Charged particles are harder to move. 1893, J. J. Thomson. The limit of speed is the speed of light. 1893, George Frederick Charles Searle. Equation for EM mass: $$m_L = \\frac{3}{4} m_{em} \\frac{1}{\\beta^2} [-\\frac{1}{\\beta}\\ln{(\\frac{1+\\beta}{1-\\beta})}+\\frac{2}{1-\\beta^2}] \\tag{1}$$where $\\beta = \\frac{v}{c}$. 1899, Lorentz. Length contraction. 1901, Kaufman and Abraham. Transverse mass: $$m_T = \\frac{3}{4} m_{em} \\frac{1}{\\beta^2} [(\\frac{1+\\beta^2}{2 \\beta})\\ln{(\\frac{1+\\beta}{1-\\beta})}-1]\\tag{2}$$longitudinal mass is the same as Eq. 1. 1902, Wein. Mass is electronic mass. There\u0026rsquo;s no gravitational mass. 1904, Lorentz. $$\\begin{aligned} x^{\\prime} \u0026amp;= \\gamma(x-vt) \\\\ y^{\\prime} \u0026amp;= y \\\\ z^{\\prime} \u0026amp;= z \\end{aligned}\\tag{3}$$where $\\gamma = \\frac{1}{\\sqrt{1-\\beta^2}}$. So that we have length contraction and time dilation$$l^{\\prime}=\\frac{l}{\\gamma}, t^{\\prime}=\\gamma t \\tag{4}$$And longitudinal mass and transverse mass$$\\begin{aligned} m_L \u0026amp;= \\gamma^3 m_{em} \\\\ m_T \u0026amp;= \\gamma m_{em} \\end{aligned} \\tag{5}$$ 1905, Abraham. Electromagnetism does not make all the forces. 1905, Poincaré. $$\\frac{E_\\text{tot}}{c^2}=\\frac{E_{\\text{em}}+E_{\\text{p}}}{c^2}=\\frac{E_{\\text{em}}+\\frac{E_{\\text{em}}}{3}}{c^2}=\\frac{4}{3}\\frac{E_{\\text{em}}}{c^2}=\\frac{4}{3}m_{\\text{es}}=m_{\\text{em}} \\tag{6}$$which is basically $E_0=mc^2$. He also summarized eq. 4-5 as the Lorentz transformation and brought up proper time $$ t^{\\prime} =\\gamma(t-\\frac{vx}{c^2})\\tag{7}$$The issue is that Poincare found out with Lorentz transformation, the Ether is inconsequential. 1905, Einstein. He did not use the concept of aether, instead started with two principles: The speed of light is constant and is the limit of speed. The laws of physics are obeyed in every single reference frame. From these two principles he derived the Lorentz transformation. From the memories of my childhood readings (in Chinese), when it comes to Special Relativity, the author would always romanticize it rather than show readers what really happened before Einstein published the paper about Special Relativity. And the joke about hot stove and girl is not funny. Don\u0026rsquo;t get me wrong, the dreams in the book are beautiful and I have nothing against it. Maybe it\u0026rsquo;s just not for me.\n",
      "content_html": "\u003cp\u003eThis is a review of \u003cem\u003eEinstein\u0026rsquo;s Dreams\u003c/em\u003e by Alan Lightman.\u003c/p\u003e\n\u003cp\u003eIn my opinion, science progresses a little bit at a time. \u003ca href=\"https://www.youtube.com/watch?v=6HlCfwEduqA\"\u003eThis video\u003c/a\u003e is an inspiration to me, and I also referred to \u003ca href=\"https://doi.org/10.1086/430652\"\u003e\u003cem\u003eThe Mystery of the Einstein–Poincaré Connection\u003c/em\u003e\u003c/a\u003e, \u003ca href=\"https://telescoper.blog/tag/albert-einstein/\"\u003e\u003cem\u003eAlbert Einstein\u003c/em\u003e | In the Dark\u003c/a\u003e, and Wikipedia on \u003ca href=\"https://en.wikipedia.org/wiki/Relativity_priority_dispute\"\u003eRelativity priority dispute\u003c/a\u003e and \u003ca href=\"https://en.wikipedia.org/wiki/History_of_special_relativity\"\u003eHistory of special relativity\u003c/a\u003e. The clue is: it\u0026rsquo;s called Lorentz transformation.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e1881, J. J. Thomson. Charged particles are harder to move.\u003c/li\u003e\n\u003cli\u003e1893, J. J. Thomson. The limit of speed is the speed of light.\u003c/li\u003e\n\u003cli\u003e1893, George Frederick Charles Searle. Equation for EM mass: $$m_L = \\frac{3}{4} m_{em} \\frac{1}{\\beta^2} [-\\frac{1}{\\beta}\\ln{(\\frac{1+\\beta}{1-\\beta})}+\\frac{2}{1-\\beta^2}] \\tag{1}$$where $\\beta = \\frac{v}{c}$.\u003c/li\u003e\n\u003cli\u003e1899, Lorentz. Length contraction.\u003c/li\u003e\n\u003cli\u003e1901, Kaufman and Abraham. Transverse mass: $$m_T = \\frac{3}{4} m_{em} \\frac{1}{\\beta^2} [(\\frac{1+\\beta^2}{2 \\beta})\\ln{(\\frac{1+\\beta}{1-\\beta})}-1]\\tag{2}$$longitudinal mass is the same as Eq. 1.\u003c/li\u003e\n\u003cli\u003e1902, Wein. Mass is electronic mass. There\u0026rsquo;s no gravitational mass.\u003c/li\u003e\n\u003cli\u003e1904, Lorentz. $$\\begin{aligned} x^{\\prime} \u0026amp;= \\gamma(x-vt) \\\\ y^{\\prime} \u0026amp;= y \\\\ z^{\\prime} \u0026amp;= z \\end{aligned}\\tag{3}$$where $\\gamma = \\frac{1}{\\sqrt{1-\\beta^2}}$. So that we have length contraction and time dilation$$l^{\\prime}=\\frac{l}{\\gamma}, t^{\\prime}=\\gamma t \\tag{4}$$And longitudinal mass and transverse mass$$\\begin{aligned} m_L \u0026amp;= \\gamma^3 m_{em} \\\\ m_T \u0026amp;= \\gamma m_{em} \\end{aligned} \\tag{5}$$\u003c/li\u003e\n\u003cli\u003e1905, Abraham. Electromagnetism does not make all the forces.\u003c/li\u003e\n\u003cli\u003e1905, Poincaré. $$\\frac{E_\\text{tot}}{c^2}=\\frac{E_{\\text{em}}+E_{\\text{p}}}{c^2}=\\frac{E_{\\text{em}}+\\frac{E_{\\text{em}}}{3}}{c^2}=\\frac{4}{3}\\frac{E_{\\text{em}}}{c^2}=\\frac{4}{3}m_{\\text{es}}=m_{\\text{em}} \\tag{6}$$which is basically $E_0=mc^2$. He also summarized eq. 4-5 as the Lorentz transformation and brought up proper time $$ t^{\\prime} =\\gamma(t-\\frac{vx}{c^2})\\tag{7}$$The issue is that Poincare found out with Lorentz transformation, the Ether is inconsequential.\u003c/li\u003e\n\u003cli\u003e1905, Einstein. He did not use the concept of aether, instead started with two principles:\n\u003col\u003e\n\u003cli\u003eThe speed of light is constant and is the limit of speed.\u003c/li\u003e\n\u003cli\u003eThe laws of physics are obeyed in every single reference frame.\nFrom these two principles he derived the Lorentz transformation.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFrom the memories of my childhood readings (in Chinese), when it comes to Special Relativity, the author would always romanticize it rather than show readers what really happened before Einstein published the paper about Special Relativity. And the joke about hot stove and girl is not funny. Don\u0026rsquo;t get me wrong, the dreams in the book are beautiful and I have nothing against it. Maybe it\u0026rsquo;s just not for me.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230711-book-review-einsteins-dreams/",
      "date_published": "11076-11-09T70:1111:00+00:00",
      "date_modified": "11076-11-09T70:1111:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "85f9fe833193748ab3216cdee41beca8e1eb0718",
      "title": "Machine Learning Notes: fastai",
      "summary": "",
      "content_text": "(Please refer to Wow It Fits! — Secondhand Machine Learning.)\nCompared with tensorflow, mxnet, paddle or pure numpy (just for the fun of it), torch is probably the easiest Machine Learning package, and to get it even easier, let\u0026rsquo;s take a look at fastai.\nBy the way, I subscribed GitHub Trending by RSS and the other day I got these two at the same time. Machine Learning in numpy is really cool, but the second one is like, why? \u0026hellip; these two target markets do NOT overlap.\nBack to the topic, here\u0026rsquo;s my notes from fastai, fastbook (github.com) and Practical Deep Learning for Coders. The main idea of fastai is to make Machine Learning accessible to every individual so that it can be applied to various subjects, and to do so:\nUse Google Colab, Kaggle, Paperspace, Hugging face. Only requires one GPU (or at least try to). fastai starts with higher architecture (see fastai - Quick start) and digs deeper so that it\u0026rsquo;s more customizable. Nonetheless, some higher architectures are useful that you will see it in almost any project that uses fastai, for example, DataLoaders and Learners. Tabular Data Random Forest is baseline, sometimes even the best method. See sklearn.ensemble.RandomForestClassifier — scikit-learn 1.3.0 documentation.\nTransfer Learning for CV See The best vision models for fine-tuning | Kaggle.\nTwo Categories Sometimes predicting two categories at the same time has these two advantages:\nParallel computing, which saves more time and computing sources. The categories might help each other. For example, predicting the fish and the boat may produce better results than only predicting the fish. Learners from fastai.vision.all import Learners learn = Learners(...) See fastai - Pytorch to fastai details. Here\u0026rsquo;s some useful tricks:\nTo find the best learning rate, see [1506.01186] Cyclical Learning Rates for Training Neural Networks:\nlearn.lr_find(suggest_funcs=(slide, valley)) To test the model with a dummy:\ntest_df = ... test_dl = learn.dls.test_dl(test_df) preds, _ = learn.get_preds(dl=test_dl) ",
      "content_html": "\u003cp\u003e(Please refer to \u003ca href=\"https://chenlinear.github.io/posts/20231011-wow-it-fits-secondhand-machine-learning/\"\u003e\u003cem\u003eWow It Fits! — Secondhand Machine Learning\u003c/em\u003e\u003c/a\u003e.)\u003c/p\u003e\n\u003cp\u003eCompared with \u003ccode\u003etensorflow\u003c/code\u003e, \u003ccode\u003emxnet\u003c/code\u003e, \u003ccode\u003epaddle\u003c/code\u003e or pure \u003ccode\u003enumpy\u003c/code\u003e (just for the fun of it), \u003ccode\u003etorch\u003c/code\u003e is probably the easiest Machine Learning package, and to get it even easier, let\u0026rsquo;s take a look at \u003ccode\u003efastai\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eBy the way, I subscribed GitHub Trending by RSS and the other day I got these two at the same time. Machine Learning in \u003ccode\u003enumpy\u003c/code\u003e is really cool, but the second one is like, why? \u0026hellip; these two target markets do NOT overlap.\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"20230706-machine-learning-notes-fastai-ml-np-py-excel.png\"\r\n  alt=\"ml-in-np-python-in-excel\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eBack to the topic, here\u0026rsquo;s my notes from \u003ca href=\"https://docs.fast.ai/\"\u003efastai\u003c/a\u003e, \u003ca href=\"https://github.com/fastai/fastbook\"\u003efastbook (github.com)\u003c/a\u003e and \u003ca href=\"https://course.fast.ai/\"\u003e\u003cem\u003ePractical Deep Learning for Coders\u003c/em\u003e\u003c/a\u003e. The main idea of \u003ccode\u003efastai\u003c/code\u003e is to make Machine Learning accessible to every individual so that it can be applied to various subjects, and to do so:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUse Google Colab, Kaggle, Paperspace, Hugging face.\u003c/li\u003e\n\u003cli\u003eOnly requires one GPU (or at least try to).\u003c/li\u003e\n\u003cli\u003efastai starts with higher architecture (see \u003ca href=\"https://docs.fast.ai/quick_start.html\"\u003efastai - \u003cem\u003eQuick start\u003c/em\u003e\u003c/a\u003e) and digs deeper so that it\u0026rsquo;s more customizable. Nonetheless, some higher architectures are useful that you will see it in almost any project that uses \u003ccode\u003efastai\u003c/code\u003e, for example, \u003ccode\u003eDataLoaders\u003c/code\u003e and \u003ccode\u003eLearners\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"tabular-data\"\u003eTabular Data\u003c/h2\u003e\n\u003cp\u003eRandom Forest is baseline, sometimes even the best method. See \u003ca href=\"https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html\"\u003esklearn.ensemble.RandomForestClassifier — scikit-learn 1.3.0 documentation\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"transfer-learning-for-cv\"\u003eTransfer Learning for CV\u003c/h2\u003e\n\u003cp\u003eSee \u003ca href=\"https://www.kaggle.com/code/jhoward/the-best-vision-models-for-fine-tuning\"\u003e\u003cem\u003eThe best vision models for fine-tuning\u003c/em\u003e | Kaggle\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"two-categories\"\u003eTwo Categories\u003c/h2\u003e\n\u003cp\u003eSometimes predicting two categories at the same time has these two advantages:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eParallel computing, which saves more time and computing sources.\u003c/li\u003e\n\u003cli\u003eThe categories might help each other. For example, predicting the fish and the boat may produce better results than only predicting the fish.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"learners\"\u003e\u003ccode\u003eLearners\u003c/code\u003e\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003efastai.vision.all\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eLearners\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eLearners\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eSee \u003ca href=\"https://docs.fast.ai/examples/migrating_pytorch_verbose.html\"\u003efastai - \u003cem\u003ePytorch to fastai details\u003c/em\u003e\u003c/a\u003e. Here\u0026rsquo;s some useful tricks:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eTo find the best learning rate, see \u003ca href=\"https://arxiv.org/abs/1506.01186\"\u003e[1506.01186] \u003cem\u003eCyclical Learning Rates for Training Neural Networks\u003c/em\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elr_find\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esuggest_funcs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eslide\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003evalley\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eTo test the model with a dummy:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etest_df\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etest_dl\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edls\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etest_dl\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etest_df\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003epreds\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elearn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eget_preds\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edl\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etest_dl\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230706-machine-learning-notes-fastai/",
      "date_published": "6076-06-09T70:66:00+00:00",
      "date_modified": "6076-06-09T70:66:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "691e30a0641d5d6f056324db58f90a68964336de",
      "title": "Euclid",
      "summary": "",
      "content_text": "See ESA - Euclid. Some of the stories are really exciting.\nIn general, this is a telescope observing visible light (530-920 nm) and near-infrared (920-2020 nm). And yes, the near-infrared is observed with CCD.\nGoal: light $\\rightarrow$ gravitational lensing $\\rightarrow$ dark matter distribution.\nBy the way, you can only launch 600 of these everyday.\nESA - Euclid\u0026rsquo;s first images: the dazzling edge of darkness shows a wide Field of View (FoV), compared with JWST. The advantage of a wide FoV is that the distance and location could be meausured more precisely, thus locate dark matter and dark energy more precisely.\n",
      "content_html": "\u003cp\u003eSee \u003ca href=\"https://www.esa.int/Science_Exploration/Space_Science/Euclid\"\u003eESA - Euclid\u003c/a\u003e. Some of the stories are really exciting.\u003c/p\u003e\n\u003cp\u003eIn general, this is a telescope observing visible light (530-920 nm) and near-infrared (920-2020 nm). And yes, the near-infrared is observed with CCD.\u003c/p\u003e\n\u003cp\u003eGoal: light $\\rightarrow$ gravitational lensing $\\rightarrow$ dark matter distribution.\u003c/p\u003e\n\u003cp\u003eBy the way, you can only launch 600 of these everyday.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.esa.int/Science_Exploration/Space_Science/Euclid/Euclid_s_first_images_the_dazzling_edge_of_darkness\"\u003eESA - \u003cem\u003eEuclid\u0026rsquo;s first images: the dazzling edge of darkness\u003c/em\u003e\u003c/a\u003e shows a wide Field of View (FoV), compared with JWST. The advantage of a wide FoV is that the distance and location could be meausured more precisely, thus locate dark matter and dark energy more precisely.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230701-euclid/",
      "date_published": "1076-01-09T70:11:00+00:00",
      "date_modified": "1076-01-09T70:11:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "7617212e05cb012ec7a08432ae26e7826f5eac1e",
      "title": "Machine Learning Notes: Workflow \u0026 Tips",
      "summary": "",
      "content_text": "(Please refer to Wow It Fits! — Secondhand Machine Learning.)\nHere are my notes from Zero to Mastery Learn PyTorch for Deep Learning. For cheatsheet, see PyTorch Cheatsheet - Zero to Mastery Learn PyTorch for Deep Learning or Create a training/testing loop or PyTorch documentation.\n§1 Workflow Most of the time it\u0026rsquo;s necessary to subclass the classes mentioned above, check PyTorch documentation.\n§2 Tensor Error See The Three Most Common Errors in PyTorch - Zero to Mastery Learn PyTorch for Deep Learning.\nShape, e.g. [H, W, C] (usually used in numpy or matplotlib.pyplot) or [C, H, W] (usually used in torch) or [batch_size, C, H, W]. Device\nType\n§3 Jupyter Notebook markdown. markdown titles. print the output of a function. §4 torchinfo \u0026amp; torch.utils.tensorboard To use torchinfo to check the structure of a model:\nfrom torchinfo import summary summary(model=VisionCNN) # or summary(model=VisionCNN, input_size=(32, 3, 224, 224), # (batch_size, C, H, W) col_names=[\u0026#34;input_size\u0026#34;, \u0026#34;output_size\u0026#34;, \u0026#34;num_params\u0026#34;], col_width=20,# column width row_settings=[\u0026#34;var_names\u0026#34;]) To use torch.nn.tensorboard, see 07. PyTorch Experiment Tracking - Zero to Mastery Learn PyTorch for Deep Learning. Here\u0026rsquo;s an example of train function, the log of which is like a simple version of torch.nn.tensorboard:\nfrom typing import Dict, List from tqdm.auto import tqdm # Add writer parameter to train() def train(model: torch.nn.Module, train_dataloader: torch.utils.data.DataLoader, test_dataloader: torch.utils.data.DataLoader, optimizer: torch.optim.Optimizer, loss_fn: torch.nn.Module, epochs: int, device: torch.device, writer: torch.utils.tensorboard.writer.SummaryWriter # new parameter to take in a writer ) -\u0026gt; Dict[str, List]: \u0026#34;\u0026#34;\u0026#34;Trains and tests a PyTorch model. Passes a target PyTorch models through train_step() and test_step() functions for a number of epochs, training and testing the model in the same epoch loop. Calculates, prints and stores evaluation metrics throughout. Stores metrics to specified writer log_dir if present. Args: model: A PyTorch model to be trained and tested. train_dataloader: A DataLoader instance for the model to be trained on. test_dataloader: A DataLoader instance for the model to be tested on. optimizer: A PyTorch optimizer to help minimize the loss function. loss_fn: A PyTorch loss function to calculate loss on both datasets. epochs: An integer indicating how many epochs to train for. device: A target device to compute on (e.g. \u0026#34;cuda\u0026#34; or \u0026#34;cpu\u0026#34;). writer: A SummaryWriter() instance to log model results to. Returns: A dictionary of training and testing loss as well as training and testing accuracy metrics. Each metric has a value in a list for each epoch. In the form: {train_loss: [...], train_acc: [...], test_loss: [...], test_acc: [...]} For example if training for epochs=2: {train_loss: [2.0616, 1.0537], train_acc: [0.3945, 0.3945], test_loss: [1.2641, 1.5706], test_acc: [0.3400, 0.2973]} \u0026#34;\u0026#34;\u0026#34; # Create empty results dictionary results = {\u0026#34;train_loss\u0026#34;: [], \u0026#34;train_acc\u0026#34;: [], \u0026#34;test_loss\u0026#34;: [], \u0026#34;test_acc\u0026#34;: [] } # Loop through training and testing steps for a number of epochs for epoch in tqdm(range(epochs)): train_loss, train_acc = train_step(model=model, dataloader=train_dataloader, loss_fn=loss_fn, optimizer=optimizer, device=device) test_loss, test_acc = test_step(model=model, dataloader=test_dataloader, loss_fn=loss_fn, device=device) # Print out what\u0026#39;s happening print( f\u0026#34;Epoch: {epoch+1} | \u0026#34; f\u0026#34;train_loss: {train_loss:.4f} | \u0026#34; f\u0026#34;train_acc: {train_acc:.4f} | \u0026#34; f\u0026#34;test_loss: {test_loss:.4f} | \u0026#34; f\u0026#34;test_acc: {test_acc:.4f}\u0026#34; ) # Update results dictionary results[\u0026#34;train_loss\u0026#34;].append(train_loss) results[\u0026#34;train_acc\u0026#34;].append(train_acc) results[\u0026#34;test_loss\u0026#34;].append(test_loss) results[\u0026#34;test_acc\u0026#34;].append(test_acc) ### New: Use the writer parameter to track experiments ### # See if there\u0026#39;s a writer, if so, log to it if writer: # Add results to SummaryWriter writer.add_scalars(main_tag=\u0026#34;Loss\u0026#34;, tag_scalar_dict={\u0026#34;train_loss\u0026#34;: train_loss, \u0026#34;test_loss\u0026#34;: test_loss}, global_step=epoch) writer.add_scalars(main_tag=\u0026#34;Accuracy\u0026#34;, tag_scalar_dict={\u0026#34;train_acc\u0026#34;: train_acc, \u0026#34;test_acc\u0026#34;: test_acc}, global_step=epoch) # Close the writer writer.close() else: pass ### End new ### # Return the filled results at the end of the epochs return results §5 More In terms of \u0026ldquo;vibe\u0026rdquo;, here\u0026rsquo;s what I find interesting in the course that I\u0026rsquo;ll try to take to my future communication and teaching (if possible):\nIt\u0026rsquo;s like a cooking show, try to keep it fun and interactive. The way to learn Machine Learning is to do different projects, and you will get better each time. Bugs are fun and valuable, deal with them with positivity. When facing a problem while programming, use search engines, Wikipedia and official documents (in this case PyTorch documentation). ",
      "content_html": "\u003cp\u003e(Please refer to \u003ca href=\"https://chenlinear.github.io/posts/20231011-wow-it-fits-secondhand-machine-learning/\"\u003e\u003cem\u003eWow It Fits! — Secondhand Machine Learning\u003c/em\u003e\u003c/a\u003e.)\u003c/p\u003e\n\u003cp\u003eHere are my notes from \u003ca href=\"https://www.learnpytorch.io/\"\u003eZero to Mastery Learn PyTorch for Deep Learning\u003c/a\u003e. For cheatsheet, see \u003ca href=\"https://www.learnpytorch.io/pytorch_cheatsheet/\"\u003e\u003cem\u003ePyTorch Cheatsheet\u003c/em\u003e - Zero to Mastery Learn PyTorch for Deep Learning\u003c/a\u003e or \u003ca href=\"https://www.learnpytorch.io/pytorch_cheatsheet/#create-a-trainingtesting-loop\"\u003e\u003cem\u003eCreate a training/testing loop\u003c/em\u003e\u003c/a\u003e or \u003ca href=\"https://pytorch.org/docs/stable/index.html\"\u003e\u003cem\u003ePyTorch documentation\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"1-workflow\"\u003e§1 Workflow\u003c/h2\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/03-pytorch-computer-vision-workflow.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eMost of the time it\u0026rsquo;s necessary to subclass the classes mentioned above, check \u003ca href=\"https://pytorch.org/docs/stable/index.html\"\u003e\u003cem\u003ePyTorch documentation\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"2-tensor-error\"\u003e§2 Tensor Error\u003c/h2\u003e\n\u003cp\u003eSee \u003ca href=\"https://www.learnpytorch.io/pytorch_most_common_errors/\"\u003e\u003cem\u003eThe Three Most Common Errors in PyTorch\u003c/em\u003e - Zero to Mastery Learn PyTorch for Deep Learning\u003c/a\u003e.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eShape\u003c/strong\u003e, e.g. [H, W, C] (usually used in \u003ccode\u003enumpy\u003c/code\u003e or \u003ccode\u003ematplotlib.pyplot\u003c/code\u003e) or [C, H, W] (usually used in \u003ccode\u003etorch\u003c/code\u003e) or [batch_size, C, H, W].\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/00-pytorch-different-tensor-dimensions.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eDevice\u003c/strong\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eType\u003c/strong\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"3-jupyter-notebook\"\u003e§3 Jupyter Notebook\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003emarkdown.\u003c/li\u003e\n\u003cli\u003emarkdown titles.\u003c/li\u003e\n\u003cli\u003eprint the output of a function.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"4-torchinfohttpsgithubcomtyleryeptorchinfo--torchutilstensorboardhttpspytorchorgdocsstabletensorboardhtml\"\u003e§4 \u003ca href=\"https://github.com/TylerYep/torchinfo\"\u003e\u003ccode\u003etorchinfo\u003c/code\u003e\u003c/a\u003e \u0026amp; \u003ca href=\"https://pytorch.org/docs/stable/tensorboard.html\"\u003e\u003ccode\u003etorch.utils.tensorboard\u003c/code\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eTo use \u003ccode\u003etorchinfo\u003c/code\u003e to check the structure of a model:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorchinfo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eVisionCNN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eVisionCNN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# (batch_size, C, H, W)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ecol_names\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;input_size\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;output_size\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;num_params\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ecol_width\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# column width\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003erow_settings\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;var_names\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eTo use \u003ccode\u003etorch.nn.tensorboard\u003c/code\u003e, see \u003ca href=\"https://www.learnpytorch.io/07_pytorch_experiment_tracking/\"\u003e\u003cem\u003e07. PyTorch Experiment Tracking\u003c/em\u003e - Zero to Mastery Learn PyTorch for Deep Learning\u003c/a\u003e. Here\u0026rsquo;s an example of \u003ccode\u003etrain\u003c/code\u003e function, the log of which is like a simple version of \u003ccode\u003etorch.nn.tensorboard\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etyping\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eDict\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eList\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etqdm.auto\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etqdm\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Add writer parameter to train()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003etrain\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#111\"\u003etrain_dataloader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eutils\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDataLoader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#111\"\u003etest_dataloader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eutils\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDataLoader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoptim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eOptimizer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#111\"\u003eloss_fn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#111\"\u003eepochs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#111\"\u003ewriter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eutils\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etensorboard\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ewriter\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSummaryWriter\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# new parameter to take in a writer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eDict\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eList\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u0026#34;\u0026#34;Trains and tests a PyTorch model.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    Passes a target PyTorch models through train_step() and test_step()\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    functions for a number of epochs, training and testing the model\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    in the same epoch loop.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    Calculates, prints and stores evaluation metrics throughout.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    Stores metrics to specified writer log_dir if present.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    Args:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      model: A PyTorch model to be trained and tested.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      train_dataloader: A DataLoader instance for the model to be trained on.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      test_dataloader: A DataLoader instance for the model to be tested on.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      optimizer: A PyTorch optimizer to help minimize the loss function.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      loss_fn: A PyTorch loss function to calculate loss on both datasets.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      epochs: An integer indicating how many epochs to train for.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      device: A target device to compute on (e.g. \u0026#34;cuda\u0026#34; or \u0026#34;cpu\u0026#34;).\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      writer: A SummaryWriter() instance to log model results to.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    Returns:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      A dictionary of training and testing loss as well as training and\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      testing accuracy metrics. Each metric has a value in a list for \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      each epoch.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      In the form: {train_loss: [...],\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e                train_acc: [...],\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e                test_loss: [...],\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e                test_acc: [...]} \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      For example if training for epochs=2: \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e              {train_loss: [2.0616, 1.0537],\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e                train_acc: [0.3945, 0.3945],\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e                test_loss: [1.2641, 1.5706],\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e                test_acc: [0.3400, 0.2973]} \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    \u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Create empty results dictionary\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eresults\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;train_loss\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e[],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e               \u003cspan style=\"color:#d88200\"\u003e\u0026#34;train_acc\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e[],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e               \u003cspan style=\"color:#d88200\"\u003e\u0026#34;test_loss\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e[],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e               \u003cspan style=\"color:#d88200\"\u003e\u0026#34;test_acc\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e[]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Loop through training and testing steps for a number of epochs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eepoch\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etqdm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eepochs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003etrain_loss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etrain_acc\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etrain_step\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                          \u003cspan style=\"color:#111\"\u003edataloader\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_dataloader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                          \u003cspan style=\"color:#111\"\u003eloss_fn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eloss_fn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                          \u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                          \u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003etest_loss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etest_acc\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etest_step\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#111\"\u003edataloader\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etest_dataloader\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#111\"\u003eloss_fn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eloss_fn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edevice\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Print out what\u0026#39;s happening\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Epoch: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eepoch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e | \u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;train_loss: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_loss\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e.4f\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e | \u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;train_acc: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_acc\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e.4f\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e | \u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;test_loss: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etest_loss\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e.4f\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e | \u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;test_acc: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etest_acc\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e.4f\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Update results dictionary\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresults\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;train_loss\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eappend\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_loss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresults\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;train_acc\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eappend\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etrain_acc\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresults\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;test_loss\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eappend\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etest_loss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eresults\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;test_acc\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eappend\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etest_acc\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e### New: Use the writer parameter to track experiments ###\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# See if there\u0026#39;s a writer, if so, log to it\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ewriter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# Add results to SummaryWriter\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ewriter\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eadd_scalars\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emain_tag\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Loss\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                               \u003cspan style=\"color:#111\"\u003etag_scalar_dict\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;train_loss\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etrain_loss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                \u003cspan style=\"color:#d88200\"\u003e\u0026#34;test_loss\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etest_loss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                               \u003cspan style=\"color:#111\"\u003eglobal_step\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eepoch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ewriter\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eadd_scalars\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emain_tag\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Accuracy\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                               \u003cspan style=\"color:#111\"\u003etag_scalar_dict\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;train_acc\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etrain_acc\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                \u003cspan style=\"color:#d88200\"\u003e\u0026#34;test_acc\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etest_acc\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e},\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                               \u003cspan style=\"color:#111\"\u003eglobal_step\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eepoch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# Close the writer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ewriter\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eclose\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#00a8c8\"\u003epass\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e### End new ###\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Return the filled results at the end of the epochs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eresults\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"5-more\"\u003e§5 More\u003c/h2\u003e\n\u003cp\u003eIn terms of \u0026ldquo;vibe\u0026rdquo;, here\u0026rsquo;s what I find interesting in the course that I\u0026rsquo;ll try to take to my future communication and teaching (if possible):\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIt\u0026rsquo;s like a cooking show, try to keep it fun and interactive. The way to learn Machine Learning is to do different projects, and you will get better each time.\u003c/li\u003e\n\u003cli\u003eBugs are fun and valuable, deal with them with positivity. When facing a problem while programming, use search engines, Wikipedia and official documents (in this case \u003ca href=\"https://pytorch.org/docs/stable/index.html\"\u003e\u003cem\u003ePyTorch documentation\u003c/em\u003e\u003c/a\u003e).\u003c/li\u003e\n\u003c/ul\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230701-machine-learning-notes-workflow-tips/",
      "date_published": "1076-01-09T70:11:00+00:00",
      "date_modified": "1076-01-09T70:11:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "f6a6069e42d69ff90f29280c83a5f86abdeb51b0",
      "title": "IceCube: First Detection of Neutrinos from the Milky Way",
      "summary": "",
      "content_text": "There\u0026rsquo;s a GW background and there are neutrinos emitted from the milky way! What a great day!\nSummary of links: their twitter with wonderful pictures, news on astrobites, news on IceCube\u0026rsquo;s official website, news conference on YouTube, the paper and data release. And later this paper about extended sources is published: [2307.07576] Search for Extended Sources of Neutrino Emission in the Galactic Plane with IceCube.\nAnd here\u0026rsquo;s my notes for the first detection paper.\n§1 Two Types of Events track cascade $\\mu$ from interaction of cosmic-rays and atmosphere; $\\mu$ from interaction of $\\nu_{\\mu}$ and nuclei (no muon accompanying) interaction of $\\nu_e$ and $\\nu_{\\tau}$ and nuclei; scattering interactions of all $3$ neutrino flavor clear path more spherical in shape easier to trace back to source harder to trace back to source harder to be distinguished from muons produced by cosmic rays in the atmosphere easier to be distinguished from atmospheric background energy is contained within the instrumented volume, which provides a more complete measure of the neutrino energy §2 Difficulties §2.1 Order of Magnitude number of events the ratio of astrophysical neutrinos and background (atmospheric muons/neutrinos) dataset $2.7 \\space \\text{kHz}$ $10^{-8}$ $59592$ events from May 2011 to May 2021 The result is $4.48 \\sigma$ level of significance on average, for different template see Table 1 of the paper.\n§2.2 Location, Location, Location Muons from the Southern Hemisphere (above IceCube can penetrate several kms deep into the ice, while the muons from the Northern Hemisphere (below IceCube) are absorbed during passage through Earth. Thus IceCube is the most sensitive to astrophysical sources in the Northern sky. However, the Galactic Center, as well as the bulk of the neutrino emission expected from the Galactic plane, is located in the Southern sky. This problem is solved by choosing cascade events instead of track events.\n§3 Method §3.1 Deep Learning CNN: choose the cascade event. It\u0026rsquo;s reasonable to use convolutional core to distinguish two different types of event. Which is generally use to detect cats (or a certain object) in a dataset of a lot of different pictures.\nNN with symmetries (that smoothly approximates a Monte Carlo simulation): refine event properties.\n§3.2 Template diffuse emission from the entire galaxy. Interactions between cosmic rays (high-energy protons and heavier nuclei) from the Milky Way and galactic gas/dust produce $\\pi$. An accelerated hadron will interact with other hadron or $\\gamma$-ray: $$N+N\u0026rsquo;,\\gamma \\rightarrow X+ \\begin{cases} \\pi^+ \\rightarrow \\mu^+ \\nu_{\\mu} \\rightarrow e^+ \\nu_{\\mu} \\nu_{\\mu} \\nu_e \\left( + \\text{c.c.} \\right) \\\\ \\pi^0 \\rightarrow \\gamma \\gamma \\end{cases} \\tag{1}$$ We expect both types to be produced together.\nTemplate: a background-only model for the expected flux of neutrinos over the entire Galactic plane, based on $\\gamma$-ray observation. $3$ template in total:\nOne made from extrapolating Fermi-LAT $\\gamma$-ray observations of the Milky Way (called $\\pi^0$. power law, $E^{-2.7}$). More evenly distributed along the Galactic plane.\nTwo alternative maps identified as KRA-gamma ($\\text{KRA}^5_{\\gamma}$, $\\text{KRA}_{\\gamma}^{50}$. Harder neutrino spectrum, roughly a $E^{-2.5}$ power law, include a spectral cutoff at the highest energies, $5$ and $50 \\space \\text{PeV}$ respectively). More concentrated from the Galactic Center.\nIndividual sources in our galaxy.\nStacking: stack the signals from all the possible sources, such as supernova remnants (SNR), pulsar wind nebula (PWN), unidentified (UNID) Galactic source.\n§4 Open Questions Why it\u0026rsquo;s diffuse? Which model is the best? Do individual sources exist? How to report cascade events live? ",
      "content_html": "\u003cp\u003eThere\u0026rsquo;s a GW background and there are neutrinos emitted from the milky way! What a great day!\u003c/p\u003e\n\u003cp\u003eSummary of links: \u003ca href=\"https://twitter.com/uw_icecube/status/1674478436038107136\"\u003etheir twitter with wonderful pictures\u003c/a\u003e, \u003ca href=\"https://astrobites.org/2023/06/29/neutrinos-from-our-backyard-icecube-sees-the-milky-way-in-neutrinos/\"\u003enews on astrobites\u003c/a\u003e, \u003ca href=\"https://icecube.wisc.edu/news/press-releases/2023/06/our-galaxy-seen-through-a-new-lens-neutrinos-detected-by-icecube/\"\u003enews on IceCube\u0026rsquo;s official website\u003c/a\u003e, \u003ca href=\"https://www.youtube.com/watch?v=35YUzuhadOs\"\u003enews conference on YouTube\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/2307.04427\"\u003ethe paper\u003c/a\u003e and \u003ca href=\"https://icecube.wisc.edu/data-releases/2023/06/observation-of-high-energy-neutrinos-from-the-galactic-plane/\"\u003edata release\u003c/a\u003e. And later this paper about extended sources is published: \u003ca href=\"https://arxiv.org/abs/2307.07576\"\u003e[2307.07576] \u003cem\u003eSearch for Extended Sources of Neutrino Emission in the Galactic Plane with IceCube\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eAnd here\u0026rsquo;s my notes for the first detection paper.\u003c/p\u003e\n\u003ch2 id=\"1-two-types-of-events\"\u003e§1 Two Types of Events\u003c/h2\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003etrack\u003c/th\u003e\n\u003cth\u003ecascade\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e$\\mu$ from interaction of cosmic-rays and atmosphere; $\\mu$ from interaction of $\\nu_{\\mu}$ and nuclei (no muon accompanying)\u003c/td\u003e\n\u003ctd\u003einteraction of $\\nu_e$ and $\\nu_{\\tau}$ and nuclei; scattering interactions of all $3$ neutrino flavor\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eclear path\u003c/td\u003e\n\u003ctd\u003emore spherical in shape\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eeasier to trace back to source\u003c/td\u003e\n\u003ctd\u003eharder to trace back to source\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eharder to be distinguished from muons produced by cosmic rays in the atmosphere\u003c/td\u003e\n\u003ctd\u003eeasier to be distinguished from atmospheric background\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003eenergy is contained within the instrumented volume, which provides a more complete measure of the neutrino energy\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"2-difficulties\"\u003e§2 Difficulties\u003c/h2\u003e\n\u003ch3 id=\"21-order-of-magnitude\"\u003e§2.1 Order of Magnitude\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003enumber of events\u003c/th\u003e\n\u003cth\u003ethe ratio of astrophysical neutrinos and background (atmospheric muons/neutrinos)\u003c/th\u003e\n\u003cth\u003edataset\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e$2.7 \\space \\text{kHz}$\u003c/td\u003e\n\u003ctd\u003e$10^{-8}$\u003c/td\u003e\n\u003ctd\u003e$59592$ events from May 2011 to May 2021\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eThe result is $4.48 \\sigma$ level of significance on average, for different template see Table 1 of the paper.\u003c/p\u003e\n\u003ch3 id=\"22-location-location-location\"\u003e§2.2 Location, Location, Location\u003c/h3\u003e\n\u003cp\u003eMuons from the Southern Hemisphere (above IceCube can penetrate several kms deep into the ice, while the muons from the Northern Hemisphere (below IceCube) are absorbed during passage through Earth. Thus IceCube is the most sensitive to astrophysical sources in the \u003cstrong\u003eNorthern sky\u003c/strong\u003e. However, the Galactic Center, as well as the bulk of the neutrino emission expected from the Galactic plane, is located in the Southern sky. This problem is solved by choosing cascade events instead of track events.\u003c/p\u003e\n\u003ch2 id=\"3-method\"\u003e§3 Method\u003c/h2\u003e\n\u003ch3 id=\"31-deep-learning\"\u003e§3.1 Deep Learning\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eCNN: choose the cascade event. \u003cstrong\u003eIt\u0026rsquo;s reasonable to use convolutional core to distinguish two different types of event\u003c/strong\u003e. Which is generally use to detect cats (or a certain object) in a dataset of a lot of different pictures.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNN with symmetries (that smoothly approximates a Monte Carlo simulation): refine event properties.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"32-template\"\u003e§3.2 Template\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003cem\u003ediffuse\u003c/em\u003e emission from the entire galaxy.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eInteractions between cosmic rays (high-energy protons and heavier nuclei) from the Milky Way and galactic gas/dust produce $\\pi$. An accelerated hadron will interact with other hadron or $\\gamma$-ray:\n$$N+N\u0026rsquo;,\\gamma \\rightarrow X+ \\begin{cases} \\pi^+ \\rightarrow \\mu^+ \\nu_{\\mu} \\rightarrow e^+ \\nu_{\\mu} \\nu_{\\mu} \\nu_e \\left( + \\text{c.c.} \\right) \\\\ \\pi^0 \\rightarrow \\gamma \\gamma \\end{cases} \\tag{1}$$\nWe expect both types to be produced together.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eTemplate: a background-only model for the expected flux of neutrinos over the entire Galactic plane, based on $\\gamma$-ray observation. $3$ template in total:\u003c/p\u003e\n\u003cp\u003eOne made from extrapolating Fermi-LAT $\\gamma$-ray observations of the Milky Way (called $\\pi^0$. power law, $E^{-2.7}$). More evenly distributed along the Galactic plane.\u003c/p\u003e\n\u003cp\u003eTwo alternative maps identified as KRA-gamma ($\\text{KRA}^5_{\\gamma}$, $\\text{KRA}_{\\gamma}^{50}$. Harder neutrino spectrum, roughly a $E^{-2.5}$ power law, include a spectral cutoff at the highest energies, $5$ and $50 \\space \\text{PeV}$ respectively). More concentrated from the Galactic Center.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003eIndividual\u003c/em\u003e sources in our galaxy.\u003c/p\u003e\n\u003cp\u003eStacking: stack the signals from all the possible sources, such as supernova remnants (SNR), pulsar wind nebula (PWN), unidentified (UNID) Galactic source.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"4-open-questions\"\u003e§4 Open Questions\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eWhy it\u0026rsquo;s diffuse?\u003c/li\u003e\n\u003cli\u003eWhich model is the best?\u003c/li\u003e\n\u003cli\u003eDo individual sources exist?\u003c/li\u003e\n\u003cli\u003eHow to report cascade events live?\u003c/li\u003e\n\u003c/ol\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230629-icecube-first-detection-of-neutrino-from-the-milky-way/",
      "date_published": "29066-29-09T60:2929:00+00:00",
      "date_modified": "29066-29-09T60:2929:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "ecb28a3f96ef40e84e6d23ef77f3cbe58e6f5d8d",
      "title": "NANOGrav: First Detection of Gravitational Wave Background",
      "summary": "",
      "content_text": "Are high frequency Gravitational Waves (GWs) drowned by noise?\nLinks: astrobites is always the first website I\u0026rsquo;ll go to get a general idea of what happened. These two YouTube videos are interesting: Gravitational Waves | Cosmic Symphony, NANOGrav - 15 Years of Gravitational Wave Research. Here\u0026rsquo;s some recommended review articles: [1901.06785] Probing supermassive black hole mergers and stalling with pulsar timing arrays, [2211.05148] Seeing the gravitational wave universe. Well, NANOGrav released a lot of papers on the same day: 2306.16223, 2306.16222, 2306.16221, 2306.16220, 2306.16219, 2306.16218, 2306.16217, 2306.16215, 2306.16213. The most important of which is probably [2306.16213] The NANOGrav 15-year Data Set: Evidence for a Gravitational-Wave Background, in which the dataset, method, validation are explained. I\u0026rsquo;ll charge into all the technical details when I have the time. And there\u0026rsquo;re more papers from different observatories, including Parkes Pulsar Timing Array, European Pulsar Timing Array (combined with Indian Pulsar Timing Array) and Chinese Pulsar Timing Array.\nThe general idea is:\nPulsars are accurate. The pulse delays (caused by GW) between two pulsars should be correlated according to their angular separation in the sky, which is called the Hellings and Downs correlation. LIGO observes Gravitational Wave (GW) with the wavelength of $30 \\text{Hz} - 7 \\text{kHz}$, caused by merges of Block Holes few times heavier than the sun, while NANOGrav observes GW with the wavelength of $10^{-9} \\text{Hz}$ (thus the name), caused by source unknown, probably merges of Supermassive Black Holes (SMBH). LIGO is few kilometers long, while pulsars can be few lightyears away, which is in accordance to the fact that GW can only be detected by things close to its magnitude of wavelength.\nIt could be a window to the early universe, earlier than Cosmic Microwave Background. Because the current SMBH theory does not explain it very well. The higher frequency region of Figure 1. (a) of [2306.16213] looks like system error.\nDetecting GW with radio telescope through the observation of Pulsars Timing Array (PTA) is like how pregnant women start to see other pregnant women everywhere — Different people see different aspects of the whole picture: GW people see GW, radio telescope people see radio telescope. (This is called attentional bias by the way.)\n",
      "content_html": "\u003cp\u003eAre high frequency Gravitational Waves (GWs) drowned by noise?\u003c/p\u003e\n\u003cp\u003eLinks: \u003ca href=\"https://astrobites.org/2023/06/28/drop-the-bass-evidence-for-a-gravitational-wave-background-from-a-galaxy-sized-detector/\"\u003eastrobites\u003c/a\u003e is always the first website I\u0026rsquo;ll go to get a general idea of what happened. These two YouTube videos are interesting: \u003ca href=\"https://www.youtube.com/watch?v=c2EKbvnee3o\"\u003eGravitational Waves | Cosmic Symphony\u003c/a\u003e, \u003ca href=\"https://www.youtube.com/watch?v=rkdyVA0xiVI\u0026amp;t=11s\"\u003eNANOGrav - 15 Years of Gravitational Wave Research\u003c/a\u003e. Here\u0026rsquo;s some recommended review articles: \u003ca href=\"https://arxiv.org/abs/1901.06785\"\u003e[1901.06785] \u003cem\u003eProbing supermassive black hole mergers and stalling with pulsar timing arrays\u003c/em\u003e\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/2211.05148\"\u003e[2211.05148] \u003cem\u003eSeeing the gravitational wave universe\u003c/em\u003e\u003c/a\u003e. Well, NANOGrav released a lot of papers on the same day: \u003ca href=\"https://arxiv.org/abs/2306.16223\"\u003e2306.16223\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/2306.16222\"\u003e2306.16222\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/2306.16221\"\u003e2306.16221\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/2306.16220\"\u003e2306.16220\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/2306.16219\"\u003e2306.16219\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/2306.16218\"\u003e2306.16218\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/2306.16217\"\u003e2306.16217\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/2306.16215\"\u003e2306.16215\u003c/a\u003e, \u003ca href=\"https://arxiv.org/abs/2306.16213\"\u003e2306.16213\u003c/a\u003e. The most important of which is probably \u003ca href=\"https://arxiv.org/abs/2306.16213\"\u003e[2306.16213] \u003cem\u003eThe NANOGrav 15-year Data Set: Evidence for a Gravitational-Wave Background\u003c/em\u003e\u003c/a\u003e, in which the dataset, method, validation are explained. I\u0026rsquo;ll charge into all the technical details when I have the time. And there\u0026rsquo;re more papers from \u003cstrong\u003edifferent observatories\u003c/strong\u003e, including Parkes Pulsar Timing Array, European Pulsar Timing Array (combined with Indian Pulsar Timing Array) and Chinese Pulsar Timing Array.\u003c/p\u003e\n\u003cp\u003eThe general idea is:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003ePulsars are accurate.\u003c/li\u003e\n\u003cli\u003eThe pulse delays (caused by GW) between two pulsars should be correlated according to their angular separation in the sky, which is called the Hellings and Downs correlation.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eLIGO observes Gravitational Wave (GW) with the wavelength of $30 \\text{Hz} - 7 \\text{kHz}$, caused by merges of Block Holes few times heavier than the sun, while NANOGrav observes GW with the wavelength of $10^{-9} \\text{Hz}$ (thus the name), caused by source unknown, probably merges of Supermassive Black Holes (SMBH). LIGO is few kilometers long, while pulsars can be few lightyears away, which is in accordance to the fact that GW can only be detected by things close to its magnitude of wavelength.\u003c/p\u003e\n\u003cp\u003eIt could be a window to the early universe, earlier than Cosmic Microwave Background. Because the current SMBH theory does not explain it very well. The higher frequency region of Figure 1. (a) of [2306.16213] looks like system error.\u003c/p\u003e\n\u003cp\u003eDetecting GW with radio telescope through the observation of Pulsars Timing Array (PTA) is like how pregnant women start to see other pregnant women everywhere — Different people see different aspects of the whole picture: GW people see GW, radio telescope people see radio telescope. (This is called \u003ca href=\"https://chenlinear.github.io/posts/20230304-book-review-lost-in-math/\"\u003eattentional bias\u003c/a\u003e by the way.)\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230629-nanograv-first-detection-of-gravitational-wave-background/",
      "date_published": "29066-29-09T60:2929:00+00:00",
      "date_modified": "29066-29-09T60:2929:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "98a4418035feae15c04d7d90f4c9108a2c877c43",
      "title": "Machine Learning Notes: Vision Transformer (ViT)",
      "summary": "",
      "content_text": "(Please refer to Wow It Fits! — Secondhand Machine Learning. There are a lot of pictures in this post so it might take a while to load.)\nOriginal paper is [2010.11929] An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale. Here\u0026rsquo;s some notes from 08. PyTorch Paper Replicating - Zero to Mastery Learn PyTorch for Deep Learning.\nThe relation between this structure and the equations:\nFirst import packages:\nimport torch import torch.nn as nn import torch.nn.functional as F from torchinfo import summary §1 Embedding This section is based on Eq. 1.\n§1.1 Patch Embedding For $\\mathbf{x} \\in \\mathbb{R}^{H \\times W \\times C} \\rightarrow \\mathbf{x}_{p} \\in \\mathbb{R}^{N \\times\\left(P^{2} \\cdot C\\right)}$, where $H$ is the height of the image, $W$ is the width of the image, $C$ is the color channel of the image (in this case the image is RGB, thus $C=3$), number of patches $N=H W / P^{2}$:\n# 1. Create a class which subclasses nn.Module class PatchEmbedding(nn.Module): \u0026#34;\u0026#34;\u0026#34;Turns a 2D input image into a 1D sequence learnable embedding vector. Args: in_channels (int): Number of color channels for the input images. Defaults to 3. patch_size (int): Size of patches to convert input image into. Defaults to 16. embedding_dim (int): Size of embedding to turn image into. Defaults to 768. \u0026#34;\u0026#34;\u0026#34; # 2. Initialize the class with appropriate variables def __init__(self, in_channels:int=3, patch_size:int=16, embedding_dim:int=768): super().__init__() # 3. Create a layer to turn an image into patches self.patcher = nn.Conv2d(in_channels=in_channels, out_channels=embedding_dim, kernel_size=patch_size, stride=patch_size,# which means stride = kernel_size padding=0) # 4. Create a layer to flatten the patch feature maps into a single dimension self.flatten = nn.Flatten(start_dim=2, # only flatten the feature map dimensions into a single vector end_dim=3) # 5. Define the forward method def forward(self, x): # Create assertion to check that inputs are the correct shape # image_resolution = x.shape[-1] # assert image_resolution % patch_size == 0, f\u0026#34;Input image size must be divisble by patch size, image shape: {image_resolution}, patch size: {patch_size}\u0026#34; # Perform the forward pass x_patched = self.patcher(x) x_flattened = self.flatten(x_patched) # 6. Make sure the output shape has the right order return x_flattened.permute(0, 2, 1) # adjust so the embedding is on the final dimension [batch_size, P^2•C, N] -\u0026gt; [batch_size, N, P^2•C] To use PatchEmbedding:\ndummy = torch.rand(1, 3, 224, 224) print(f\u0026#34;Input image with batch dimension shape: {dummy.shape}\u0026#34;)# [batch_size, C, W, H] # Create an instance of class PatchEmbedding patchify = PatchEmbedding(in_channels=3, patch_size=16, embedding_dim=768) print(f\u0026#34;Patching embedding shape: {patchify(dummy).shape}\u0026#34;)# [batch_size, N, P^2•C] will get:\nInput image with batch dimension shape: torch.Size([1, 3, 224, 224]) Patching embedding shape: torch.Size([1, 196, 768]) §1.2 Class Token Embedding, Position Embedding and Put them together image = torch.rand(3, 224, 224) # 1. Set patch size patch_size = 16 # 2. Print shape of original image tensor and get the image dimensions print(f\u0026#34;Image tensor shape: {image.shape}\u0026#34;) height, width = image.shape[1], image.shape[2] # 3. Get image tensor and add batch dimension x = image.unsqueeze(0) print(f\u0026#34;Input image with batch dimension shape: {x.shape}\u0026#34;) # 4. Create patch embedding layer patch_embedding_layer = PatchEmbedding(in_channels=3, patch_size=16, embedding_dim=768) # 5. Pass image through patch embedding layer patch_embedding = patch_embedding_layer(x) print(f\u0026#34;Patching embedding shape: {patch_embedding.shape}\u0026#34;) # 6. Create class token embedding batch_size = patch_embedding.shape[0] embedding_dimension = patch_embedding.shape[-1] class_token = nn.Parameter(torch.ones(batch_size, 1, embedding_dimension), requires_grad=True) # make sure it\u0026#39;s learnable print(f\u0026#34;Class token embedding shape: {class_token.shape}\u0026#34;) # 7. Prepend class token embedding to patch embedding patch_embedding_class_token = torch.cat((class_token, patch_embedding), dim=1) print(f\u0026#34;Patch embedding with class token shape: {patch_embedding_class_token.shape}\u0026#34;) # 8. Create position embedding number_of_patches = int((height * width) / patch_size**2) position_embedding = nn.Parameter(torch.ones(1, number_of_patches+1, embedding_dimension), requires_grad=True) # make sure it\u0026#39;s learnable print(f\u0026#34;Position embedding shape: {position_embedding.shape}\u0026#34;) # 9. Add position embedding to patch embedding with class token patch_and_position_embedding = patch_embedding_class_token + position_embedding print(f\u0026#34;Patch and position embedding shape: {patch_and_position_embedding.shape}\u0026#34;) will get:\nImage tensor shape: torch.Size([3, 224, 224]) Input image with batch dimension shape: torch.Size([1, 3, 224, 224]) Patching embedding shape: torch.Size([1, 196, 768]) Class token embedding shape: torch.Size([1, 1, 768]) Patch embedding with class token shape: torch.Size([1, 197, 768]) Position embedding shape: torch.Size([1, 197, 768]) Patch and position embedding shape: torch.Size([1, 197, 768]) §2 Multi-Head Self Attention (MSA) This section is based on Eq. 2.\n# 1. Create a class that inherits from nn.Module class MultiheadSelfAttentionBlock(nn.Module): \u0026#34;\u0026#34;\u0026#34;Creates a multi-head self-attention block (\u0026#34;MSA block\u0026#34; for short). \u0026#34;\u0026#34;\u0026#34; # 2. Initialize the class with hyperparameters from Table 1 def __init__(self, embedding_dim:int=768, # Hidden size D from Table 1 for ViT-Base num_heads:int=12, # Heads from Table 1 for ViT-Base attn_dropout:float=0): # doesn\u0026#39;t look like the paper uses any dropout in MSABlocks super().__init__() # 3. Create the Norm layer (LN) self.layer_norm = nn.LayerNorm(normalized_shape=embedding_dim) # 4. Create the Multi-Head Attention (MSA) layer self.multihead_attn = nn.MultiheadAttention(embed_dim=embedding_dim, num_heads=num_heads, dropout=attn_dropout, batch_first=True) # does our batch dimension come first? # 5. Create a forward() method to pass the data throguh the layers def forward(self, x): x = self.layer_norm(x) attn_output, _ = self.multihead_attn(query=x, # query embeddings key=x, # key embeddings value=x, # value embeddings need_weights=False) # do we need the weights or just the layer outputs? return attn_output To use MultiheadSelfAttentionBlock:\n# Create an instance of MSABlock, embedding_dim and num_heads are from Table 1 multihead_self_attention_block = MultiheadSelfAttentionBlock(embedding_dim=768, num_heads=12) # Pass patch and position image embedding through MSABlock patched_image_through_msa_block = multihead_self_attention_block(patch_and_position_embedding) # or # patched_image_through_msa_block = multihead_self_attention_block(torch.rand(1, 197, 768)) print(f\u0026#34;Input shape of MSA block: {patch_and_position_embedding.shape}\u0026#34;) print(f\u0026#34;Output shape MSA block: {patched_image_through_msa_block.shape}\u0026#34;) will get:\nInput shape of MSA block: torch.Size([1, 197, 768]) Output shape MSA block: torch.Size([1, 197, 768]) Note that input and output have the same shape, which is common for different kinds of AttentionBlock.\n§3 Multilayer Perception (MLP) This section is based on Eq. 3.\n# 1. Create a class that inherits from nn.Module class MLPBlock(nn.Module): \u0026#34;\u0026#34;\u0026#34;Creates a layer normalized multilayer perceptron block (\u0026#34;MLP block\u0026#34; for short).\u0026#34;\u0026#34;\u0026#34; # 2. Initialize the class with hyperparameters from Table 1 and Table 3 def __init__(self, embedding_dim:int=768, # Hidden Size D from Table 1 for ViT-Base mlp_size:int=3072, # MLP size from Table 1 for ViT-Base dropout:float=0.1): # Dropout from Table 3 for ViT-Base super().__init__() # 3. Create the Norm layer (LN) self.layer_norm = nn.LayerNorm(normalized_shape=embedding_dim) # 4. Create the Multilayer perceptron (MLP) layer(s) self.mlp = nn.Sequential( nn.Linear(in_features=embedding_dim, out_features=mlp_size), nn.GELU(), # \u0026#34;The MLP contains two layers with a GELU non-linearity (section 3.1).\u0026#34; nn.Dropout(p=dropout), nn.Linear(in_features=mlp_size, # needs to take same in_features as out_features of layer above out_features=embedding_dim), # take back to embedding_dim nn.Dropout(p=dropout) # \u0026#34;Dropout, when used, is applied after every dense layer..\u0026#34; ) # 5. Create a forward() method to pass the data throguh the layers def forward(self, x): x = self.layer_norm(x) x = self.mlp(x) return x To use MLPBlock:\n# Create an instance of MLPBlock mlp_block = MLPBlock(embedding_dim=768, # from Table 1 mlp_size=3072, # from Table 1 dropout=0.1) # from Table 3 # Pass output of MSABlock through MLPBlock patched_image_through_mlp_block = mlp_block(patched_image_through_msa_block) # or # patched_image_through_msa_block = mlp_block(torch.rand(1, 197, 768)) print(f\u0026#34;Input shape of MLP block: {patched_image_through_mlp_block.shape}\u0026#34;) print(f\u0026#34;Output shape MLP block: {patched_image_through_mlp_block.shape}\u0026#34;) will get:\nInput shape of MLP block: torch.Size([1, 197, 768]) Output shape MLP block: torch.Size([1, 197, 768]) Note that, again, input and output have the same shape.\n§4 Transformer Encoder §4.1 Put Blocks Above Together # 1. Create a class that inherits from nn.Module class TransformerEncoderBlock(nn.Module): \u0026#34;\u0026#34;\u0026#34;Creates a Transformer Encoder block.\u0026#34;\u0026#34;\u0026#34; # 2. Initialize the class with hyperparameters from Table 1 and Table 3 def __init__(self, embedding_dim:int=768, # Hidden size D from Table 1 for ViT-Base num_heads:int=12, # Heads from Table 1 for ViT-Base mlp_size:int=3072, # MLP size from Table 1 for ViT-Base mlp_dropout:float=0.1, # Amount of dropout for dense layers from Table 3 for ViT-Base attn_dropout:float=0): # Amount of dropout for attention layers super().__init__() # 3. Create MSA block (equation 2) self.msa_block = MultiheadSelfAttentionBlock(embedding_dim=embedding_dim, num_heads=num_heads, attn_dropout=attn_dropout) # 4. Create MLP block (equation 3) self.mlp_block = MLPBlock(embedding_dim=embedding_dim, mlp_size=mlp_size, dropout=mlp_dropout) # 5. Create a forward() method def forward(self, x): # 6. Create residual connection for MSA block (add the input to the output) x = self.msa_block(x) + x # 7. Create residual connection for MLP block (add the input to the output) x = self.mlp_block(x) + x return x Use torchinfo.summary to get the information about transformer_encoder_block:\n# Create an instance of TransformerEncoderBlock transformer_encoder_block = TransformerEncoderBlock() # Print an input and output summary of our Transformer Encoder (uncomment for full output) summary(model=transformer_encoder_block, input_size=(1, 197, 768), # (batch_size, num_patches, embedding_dimension) col_names=[\u0026#34;input_size\u0026#34;, \u0026#34;output_size\u0026#34;, \u0026#34;num_params\u0026#34;], col_width=20, row_settings=[\u0026#34;var_names\u0026#34;]) will get:\n§4.2 Build Encoder with torch.nn.TransformerEncoderLayer(): # Create the same as above with torch.nn.TransformerEncoderLayer() torch_transformer_encoder_layer = nn.TransformerEncoderLayer(d_model=768, # Hidden size D from Table 1 for ViT-Base nhead=12, # Heads from Table 1 for ViT-Base dim_feedforward=3072, # MLP size from Table 1 for ViT-Base dropout=0.1, # Amount of dropout for dense layers from Table 3 for ViT-Base activation=\u0026#34;gelu\u0026#34;, # GELU non-linear activation batch_first=True, # Do our batches come first? norm_first=True) # Normalize first or after MSA/MLP layers? Use torchinfo.summary to get the information about torch_transformer_encoder_layer:\n# Get the output of PyTorch\u0026#39;s version of the Transformer Encoder (uncomment for full output) summary(model=torch_transformer_encoder_layer, input_size=(1, 197, 768), # (batch_size, num_patches, embedding_dimension) col_names=[\u0026#34;input_size\u0026#34;, \u0026#34;output_size\u0026#34;, \u0026#34;num_params\u0026#34;, \u0026#34;trainable\u0026#34;], col_width=10, row_settings=[\u0026#34;var_names\u0026#34;]) will get:\nUsing torch.nn will be slightly different, they have $\\mathrm{3}$ advantages in general:\nFaster. More robust. Easier to build. §5 ViT Eq. 4 is the final torch.nn.LayerNorm() and torch.nn.Linear.\n# 1. Create a ViT class that inherits from nn.Module class ViT(nn.Module): \u0026#34;\u0026#34;\u0026#34;Creates a Vision Transformer architecture with ViT-Base hyperparameters by default.\u0026#34;\u0026#34;\u0026#34; # 2. Initialize the class with hyperparameters from Table 1 and Table 3 def __init__(self, img_size:int=224, # Training resolution from Table 3 in ViT paper in_channels:int=3, # Number of channels in input image patch_size:int=16, # Patch size num_transformer_layers:int=12, # Layers from Table 1 for ViT-Base embedding_dim:int=768, # Hidden size D from Table 1 for ViT-Base mlp_size:int=3072, # MLP size from Table 1 for ViT-Base num_heads:int=12, # Heads from Table 1 for ViT-Base attn_dropout:float=0, # Dropout for attention projection mlp_dropout:float=0.1, # Dropout for dense/MLP layers embedding_dropout:float=0.1, # Dropout for patch and position embeddings num_classes:int=1000): # Default for ImageNet but can customize this super().__init__() # don\u0026#39;t forget the super().__init__()! # 3. Make the image size is divisble by the patch size assert img_size % patch_size == 0, f\u0026#34;Image size must be divisible by patch size, image size: {img_size}, patch size: {patch_size}.\u0026#34; # 4. Calculate number of patches (height * width/patch^2) self.num_patches = (img_size * img_size) // patch_size**2 # 5. Create learnable class embedding (needs to go at front of sequence of patch embeddings) self.class_embedding = nn.Parameter(data=torch.randn(1, 1, embedding_dim), requires_grad=True) # 6. Create learnable position embedding self.position_embedding = nn.Parameter(data=torch.randn(1, self.num_patches+1, embedding_dim), requires_grad=True) # 7. Create embedding dropout value self.embedding_dropout = nn.Dropout(p=embedding_dropout) # 8. Create patch embedding layer self.patch_embedding = PatchEmbedding(in_channels=in_channels, patch_size=patch_size, embedding_dim=embedding_dim) # 9. Create Transformer Encoder blocks (we can stack Transformer Encoder blocks using nn.Sequential()) # Note: The \u0026#34;*\u0026#34; means \u0026#34;all\u0026#34; self.transformer_encoder = nn.Sequential(*[TransformerEncoderBlock(embedding_dim=embedding_dim, num_heads=num_heads, mlp_size=mlp_size, mlp_dropout=mlp_dropout) for _ in range(num_transformer_layers)]) # 10. Create classifier head self.classifier = nn.Sequential( nn.LayerNorm(normalized_shape=embedding_dim), nn.Linear(in_features=embedding_dim, out_features=num_classes) ) # 11. Create a forward() method def forward(self, x): # 12. Get batch size batch_size = x.shape[0] # 13. Create class token embedding and expand it to match the batch size (equation 1) class_token = self.class_embedding.expand(batch_size, -1, -1) # \u0026#34;-1\u0026#34; means to infer the dimension (try this line on its own) # 14. Create patch embedding (equation 1) x = self.patch_embedding(x) # 15. Concat class embedding and patch embedding (equation 1) x = torch.cat((class_token, x), dim=1) # 16. Add position embedding to patch embedding (equation 1) x = self.position_embedding + x # 17. Run embedding dropout (Appendix B.1) x = self.embedding_dropout(x) # 18. Pass patch, position and class embedding through transformer encoder layers (equations 2 \u0026amp; 3) x = self.transformer_encoder(x) # 19. Put 0 index logit through classifier (equation 4) x = self.classifier(x[:, 0]) # run on each sample in a batch at 0 index return x Use torchinfo.summary to get the information about torch_transformer_encoder_layer:\n# Create a random tensor with same shape as a single image random_image_tensor = torch.randn(1, 3, 224, 224) # (batch_size, color_channels, height, width) # Create an instance of ViT with the number of classes we\u0026#39;re working with (pizza, steak, sushi) # vit = ViT(num_classes=len(class_names)) vit = ViT(num_classes=3) # Print a summary of our custom ViT model using torchinfo (uncomment for actual output) summary(model=vit, input_size=(32, 3, 224, 224), # (batch_size, color_channels, height, width) # col_names=[\u0026#34;input_size\u0026#34;], # uncomment for smaller output col_names=[\u0026#34;input_size\u0026#34;, \u0026#34;output_size\u0026#34;, \u0026#34;num_params\u0026#34;, \u0026#34;trainable\u0026#34;], col_width=20, row_settings=[\u0026#34;var_names\u0026#34;] ) will get:\n§6 Optimizer, Loss Function Generally these two will be different in different model, I\u0026rsquo;ll write about them later.\nIn ViT they are torch.optim.Adam() and torch.nn.CrossEntropyLoss(), see Section 9. Setting up training code for our ViT model.\n§7 Use Pretrained model (Transfer Learning) See Section 10. Using a pretrained ViT from torchvision.models on the same dataset.\nFor more information on Transfer Learning, see 06. PyTorch Transfer Learning. Freeze part of the model and train the rest of the model is fun. I will get to this some day, but since in physics we are dealing with quite different dataset than Natural Language Processing (NLP) or Computer Vision (CV), it\u0026rsquo;s probably not gonna be really helpful. Except classification for Galaxies or Gravitational Wave, which are close to traditional CV classification missions.\n§8 CNN or Transformer The comparison of CNN and Transformer in Section 10.6 Save feature extractor ViT model and check file size is interesting.\nBut transformer is better than CNN in $\\mathrm{2}$ ways:\nMultimodal. Embedding then torch.cat is surprisingly useful. No signs of overfitting yet. At scale, they tend to have same performance, see [2310.16764] ConvNets Match Vision Transformers at Scale.\n",
      "content_html": "\u003cp\u003e(Please refer to \u003ca href=\"https://chenlinear.github.io/posts/20231011-wow-it-fits-secondhand-machine-learning/\"\u003e\u003cem\u003eWow It Fits! — Secondhand Machine Learning\u003c/em\u003e\u003c/a\u003e. There are a lot of pictures in this post so it might take a while to load.)\u003c/p\u003e\n\u003cp\u003eOriginal paper is \u003ca href=\"https://arxiv.org/abs/2010.11929\"\u003e[2010.11929] \u003cem\u003eAn Image is Worth 16x16 Words: Transformers for Image Recognition at Scale\u003c/em\u003e\u003c/a\u003e. Here\u0026rsquo;s some notes from \u003ca href=\"https://www.learnpytorch.io/08_pytorch_paper_replicating/\"\u003e\u003cem\u003e08. PyTorch Paper Replicating\u003c/em\u003e - Zero to Mastery Learn PyTorch for Deep Learning\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThe relation between this structure and the equations:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/08-vit-paper-mapping-the-four-equations-to-figure-1.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eFirst import packages:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch.nn\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch.nn.functional\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorchinfo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"1-embedding\"\u003e§1 Embedding\u003c/h2\u003e\n\u003cp\u003eThis section is based on Eq. 1.\u003c/p\u003e\n\u003ch3 id=\"11-patch-embedding\"\u003e§1.1 Patch Embedding\u003c/h3\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/08-vit-paper-replicating-the-patch-embedding-layer.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eFor $\\mathbf{x} \\in \\mathbb{R}^{H \\times W \\times C} \\rightarrow \\mathbf{x}_{p} \\in \\mathbb{R}^{N \\times\\left(P^{2} \\cdot C\\right)}$, where $H$ is the height of the image, $W$ is the width of the image, $C$ is the color channel of the image (in this case the image is RGB, thus $C=3$), number of patches $N=H W / P^{2}$:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 1. Create a class which subclasses nn.Module\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003ePatchEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u0026#34;\u0026#34;Turns a 2D input image into a 1D sequence learnable embedding vector.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    Args:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e        in_channels (int): Number of color channels for the input images. Defaults to 3.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e        patch_size (int): Size of patches to convert input image into. Defaults to 16.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e        embedding_dim (int): Size of embedding to turn image into. Defaults to 768.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    \u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 2. Initialize the class with appropriate variables\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 3. Create a layer to turn an image into patches\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatcher\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                 \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                 \u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                 \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# which means stride = kernel_size\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                 \u003cspan style=\"color:#111\"\u003epadding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 4. Create a layer to flatten the patch feature maps into a single dimension\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eflatten\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eFlatten\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estart_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# only flatten the feature map dimensions into a single vector\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                  \u003cspan style=\"color:#111\"\u003eend_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 5. Define the forward method \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Create assertion to check that inputs are the correct shape\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# image_resolution = x.shape[-1]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# assert image_resolution % patch_size == 0, f\u0026#34;Input image size must be divisble by patch size, image shape: {image_resolution}, patch size: {patch_size}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Perform the forward pass\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_patched\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatcher\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex_flattened\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eflatten\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex_patched\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 6. Make sure the output shape has the right order \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex_flattened\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epermute\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# adjust so the embedding is on the final dimension [batch_size, P^2•C, N] -\u0026gt; [batch_size, N, P^2•C]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eTo use \u003ccode\u003ePatchEmbedding\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Input image with batch dimension shape: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, C, W, H]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Create an instance of class PatchEmbedding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003epatchify\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ePatchEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Patching embedding shape: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatchify\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edummy\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# [batch_size, N, P^2•C]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInput image with batch dimension shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 3, 224, 224\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePatching embedding shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"12-class-token-embedding-position-embedding-and-put-them-together\"\u003e§1.2 Class Token Embedding, Position Embedding and Put them together\u003c/h3\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/08-vit-paper-equation-1-putting-it-all-together.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eimage\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 1. Set patch size\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 2. Print shape of original image tensor and get the image dimensions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Image tensor shape: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eimage\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eheight\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ewidth\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eimage\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eimage\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 3. Get image tensor and add batch dimension\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eimage\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eunsqueeze\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Input image with batch dimension shape: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 4. Create patch embedding layer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003epatch_embedding_layer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ePatchEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                       \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                       \u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 5. Pass image through patch embedding layer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003epatch_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_embedding_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Patching embedding shape: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_embedding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 6. Create class token embedding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_embedding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eembedding_dimension\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_embedding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eclass_token\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eParameter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eones\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eembedding_dimension\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                           \u003cspan style=\"color:#111\"\u003erequires_grad\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# make sure it\u0026#39;s learnable\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Class token embedding shape: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eclass_token\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 7. Prepend class token embedding to patch embedding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003epatch_embedding_class_token\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eclass_token\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_embedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Patch embedding with class token shape: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_embedding_class_token\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 8. Create position embedding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003enumber_of_patches\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eheight\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ewidth\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eposition_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eParameter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eones\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enumber_of_patches\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eembedding_dimension\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                  \u003cspan style=\"color:#111\"\u003erequires_grad\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# make sure it\u0026#39;s learnable\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Position embedding shape: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eposition_embedding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 9. Add position embedding to patch embedding with class token\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003epatch_and_position_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_embedding_class_token\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eposition_embedding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Patch and position embedding shape: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_and_position_embedding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eImage tensor shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e3, 224, 224\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInput image with batch dimension shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 3, 224, 224\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePatching embedding shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 196, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass token embedding shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 1, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePatch embedding with class token shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 197, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePosition embedding shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 197, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePatch and position embedding shape: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 197, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"2-multi-head-self-attention-msa\"\u003e§2 Multi-Head Self Attention (MSA)\u003c/h2\u003e\n\u003cp\u003eThis section is based on Eq. 2.\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/08-vit-paper-equation-2-appendix-A.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/08-vit-paper-equation-2-in-code.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 1. Create a class that inherits from nn.Module\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMultiheadSelfAttentionBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u0026#34;\u0026#34;Creates a multi-head self-attention block (\u0026#34;MSA block\u0026#34; for short).\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    \u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 2. Initialize the class with hyperparameters from Table 1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Hidden size D from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Heads from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003eattn_dropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# doesn\u0026#39;t look like the paper uses any dropout in MSABlocks\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 3. Create the Norm layer (LN)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLayerNorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enormalized_shape\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 4. Create the Multi-Head Attention (MSA) layer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emultihead_attn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eMultiheadAttention\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembed_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                    \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                    \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn_dropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                    \u003cspan style=\"color:#111\"\u003ebatch_first\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# does our batch dimension come first?\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 5. Create a forward() method to pass the data throguh the layers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eattn_output\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emultihead_attn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003equery\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# query embeddings \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                             \u003cspan style=\"color:#111\"\u003ekey\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# key embeddings\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                             \u003cspan style=\"color:#111\"\u003evalue\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# value embeddings\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                             \u003cspan style=\"color:#111\"\u003eneed_weights\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# do we need the weights or just the layer outputs?\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eattn_output\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eTo use \u003ccode\u003eMultiheadSelfAttentionBlock\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Create an instance of MSABlock, embedding_dim and num_heads are from Table 1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emultihead_self_attention_block\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMultiheadSelfAttentionBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                             \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Pass patch and position image embedding through MSABlock\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003epatched_image_through_msa_block\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emultihead_self_attention_block\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_and_position_embedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# patched_image_through_msa_block = multihead_self_attention_block(torch.rand(1, 197, 768))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Input shape of MSA block: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_and_position_embedding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Output shape MSA block: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatched_image_through_msa_block\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInput shape of MSA block: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 197, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eOutput shape MSA block: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 197, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote that input and output have the same shape, which is common for different kinds of \u003ccode\u003eAttentionBlock\u003c/code\u003e.\u003c/p\u003e\n\u003ch2 id=\"3-multilayer-perception-mlp\"\u003e§3 Multilayer Perception (MLP)\u003c/h2\u003e\n\u003cp\u003eThis section is based on Eq. 3.\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://github.com/mrdbourke/pytorch-deep-learning/raw/main/images/08-vit-paper-equation-3-annotated.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/08-vit-paper-equation-3-mapped-to-code.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 1. Create a class that inherits from nn.Module\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMLPBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u0026#34;\u0026#34;Creates a layer normalized multilayer perceptron block (\u0026#34;MLP block\u0026#34; for short).\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 2. Initialize the class with hyperparameters from Table 1 and Table 3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Hidden Size D from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003emlp_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# MLP size from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Dropout from Table 3 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 3. Create the Norm layer (LN)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLayerNorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enormalized_shape\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 4. Create the Multilayer perceptron (MLP) layer(s)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emlp\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSequential\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                      \u003cspan style=\"color:#111\"\u003eout_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emlp_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eGELU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# \u0026#34;The MLP contains two layers with a GELU non-linearity (section 3.1).\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ep\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emlp_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# needs to take same in_features as out_features of layer above\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                      \u003cspan style=\"color:#111\"\u003eout_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# take back to embedding_dim\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ep\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# \u0026#34;Dropout, when used, is applied after every dense layer..\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 5. Create a forward() method to pass the data throguh the layers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003elayer_norm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emlp\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eTo use \u003ccode\u003eMLPBlock\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Create an instance of MLPBlock\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emlp_block\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMLPBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# from Table 1 \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                     \u003cspan style=\"color:#111\"\u003emlp_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# from Table 1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                     \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# from Table 3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Pass output of MSABlock through MLPBlock\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003epatched_image_through_mlp_block\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emlp_block\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatched_image_through_msa_block\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# patched_image_through_msa_block = mlp_block(torch.rand(1, 197, 768))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Input shape of MLP block: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatched_image_through_mlp_block\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Output shape MLP block: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatched_image_through_mlp_block\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInput shape of MLP block: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 197, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eOutput shape MLP block: torch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 197, 768\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote that, again, input and output have the same shape.\u003c/p\u003e\n\u003ch2 id=\"4-transformer-encoder\"\u003e§4 Transformer Encoder\u003c/h2\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://github.com/mrdbourke/pytorch-deep-learning/raw/main/images/08-vit-paper-transformer-encoder-highlighted.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\n\u003cimg\r\n  src=\"https://github.com/mrdbourke/pytorch-deep-learning/raw/main/images/08-vit-paper-transformer-encoder-mapped-to-code.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ch3 id=\"41-put-blocks-above-together\"\u003e§4.1 Put Blocks Above Together\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 1. Create a class that inherits from nn.Module\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eTransformerEncoderBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u0026#34;\u0026#34;Creates a Transformer Encoder block.\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 2. Initialize the class with hyperparameters from Table 1 and Table 3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Hidden size D from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Heads from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003emlp_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# MLP size from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003emlp_dropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Amount of dropout for dense layers from Table 3 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003eattn_dropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Amount of dropout for attention layers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 3. Create MSA block (equation 2)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emsa_block\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMultiheadSelfAttentionBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                     \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                     \u003cspan style=\"color:#111\"\u003eattn_dropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eattn_dropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 4. Create MLP block (equation 3)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emlp_block\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e  \u003cspan style=\"color:#111\"\u003eMLPBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                   \u003cspan style=\"color:#111\"\u003emlp_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emlp_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                   \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emlp_dropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 5. Create a forward() method  \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 6. Create residual connection for MSA block (add the input to the output)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e  \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emsa_block\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 7. Create residual connection for MLP block (add the input to the output)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emlp_block\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUse \u003ccode\u003etorchinfo.summary\u003c/code\u003e to get the information about \u003ccode\u003etransformer_encoder_block\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Create an instance of TransformerEncoderBlock\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etransformer_encoder_block\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eTransformerEncoderBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Print an input and output summary of our Transformer Encoder (uncomment for full output)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_encoder_block\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e197\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# (batch_size, num_patches, embedding_dimension)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ecol_names\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;input_size\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;output_size\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;num_params\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ecol_width\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003erow_settings\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;var_names\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://github.com/mrdbourke/pytorch-deep-learning/raw/main/images/08-vit-paper-summary-output-transformer-encoder.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ch3 id=\"42-build-encoder-with-torchnntransformerencoderlayerhttpspytorchorgdocsstablegeneratedtorchnntransformerencoderlayerhtmltorchnntransformerencoderlayer\"\u003e§4.2 Build Encoder with \u003ca href=\"https://pytorch.org/docs/stable/generated/torch.nn.TransformerEncoderLayer.html#torch.nn.TransformerEncoderLayer\"\u003e\u003ccode\u003etorch.nn.TransformerEncoderLayer()\u003c/code\u003e\u003c/a\u003e:\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Create the same as above with torch.nn.TransformerEncoderLayer()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003etorch_transformer_encoder_layer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTransformerEncoderLayer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ed_model\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Hidden size D from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                             \u003cspan style=\"color:#111\"\u003enhead\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Heads from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                             \u003cspan style=\"color:#111\"\u003edim_feedforward\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# MLP size from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                             \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Amount of dropout for dense layers from Table 3 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                             \u003cspan style=\"color:#111\"\u003eactivation\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;gelu\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# GELU non-linear activation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                             \u003cspan style=\"color:#111\"\u003ebatch_first\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Do our batches come first?\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                             \u003cspan style=\"color:#111\"\u003enorm_first\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Normalize first or after MSA/MLP layers?\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUse \u003ccode\u003etorchinfo.summary\u003c/code\u003e to get the information about \u003ccode\u003etorch_transformer_encoder_layer\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Get the output of PyTorch\u0026#39;s version of the Transformer Encoder (uncomment for full output)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch_transformer_encoder_layer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e197\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# (batch_size, num_patches, embedding_dimension)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ecol_names\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;input_size\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;output_size\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;num_params\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;trainable\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ecol_width\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003erow_settings\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;var_names\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://github.com/mrdbourke/pytorch-deep-learning/raw/main/images/08-vit-paper-summary-output-pytorch-transformer-encoder.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eUsing \u003ccode\u003etorch.nn\u003c/code\u003e will be slightly different, they have $\\mathrm{3}$ advantages in general:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eFaster.\u003c/li\u003e\n\u003cli\u003eMore robust.\u003c/li\u003e\n\u003cli\u003eEasier to build.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"5-vit\"\u003e§5 ViT\u003c/h2\u003e\n\u003cp\u003eEq. 4 is the final \u003ccode\u003etorch.nn.LayerNorm()\u003c/code\u003e and \u003ccode\u003etorch.nn.Linear\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 1. Create a ViT class that inherits from nn.Module\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eViT\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u0026#34;\u0026#34;Creates a Vision Transformer architecture with ViT-Base hyperparameters by default.\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 2. Initialize the class with hyperparameters from Table 1 and Table 3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003eimg_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Training resolution from Table 3 in ViT paper\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Number of channels in input image\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Patch size\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003enum_transformer_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Layers from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Hidden size D from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003emlp_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3072\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# MLP size from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Heads from Table 1 for ViT-Base\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003eattn_dropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Dropout for attention projection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003emlp_dropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Dropout for dense/MLP layers \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003eembedding_dropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efloat\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Dropout for patch and position embeddings\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \u003cspan style=\"color:#111\"\u003enum_classes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1000\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Default for ImageNet but can customize this\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# don\u0026#39;t forget the super().__init__()!\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 3. Make the image size is divisble by the patch size \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eassert\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eimg_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Image size must be divisible by patch size, image size: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eimg_size\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e, patch size: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e.\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 4. Calculate number of patches (height * width/patch^2)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_patches\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eimg_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eimg_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                 \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 5. Create learnable class embedding (needs to go at front of sequence of patch embeddings)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eclass_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eParameter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                            \u003cspan style=\"color:#111\"\u003erequires_grad\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 6. Create learnable position embedding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eposition_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eParameter\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_patches\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                               \u003cspan style=\"color:#111\"\u003erequires_grad\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 7. Create embedding dropout value\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ep\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 8. Create patch embedding layer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ePatchEmbedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                              \u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                              \u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 9. Create Transformer Encoder blocks (we can stack Transformer Encoder blocks using nn.Sequential()) \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Note: The \u0026#34;*\u0026#34; means \u0026#34;all\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_encoder\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSequential\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eTransformerEncoderBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                                            \u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_heads\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                                            \u003cspan style=\"color:#111\"\u003emlp_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emlp_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                                                                            \u003cspan style=\"color:#111\"\u003emlp_dropout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emlp_dropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_transformer_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 10. Create classifier head\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eclassifier\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSequential\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLayerNorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enormalized_shape\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dim\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                      \u003cspan style=\"color:#111\"\u003eout_features\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_classes\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 11. Create a forward() method\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 12. Get batch size\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 13. Create class token embedding and expand it to match the batch size (equation 1)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eclass_token\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eclass_embedding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eexpand\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# \u0026#34;-1\u0026#34; means to infer the dimension (try this line on its own)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 14. Create patch embedding (equation 1)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003epatch_embedding\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 15. Concat class embedding and patch embedding (equation 1)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ecat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eclass_token\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 16. Add position embedding to patch embedding (equation 1) \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eposition_embedding\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 17. Run embedding dropout (Appendix B.1)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eembedding_dropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 18. Pass patch, position and class embedding through transformer encoder layers (equations 2 \u0026amp; 3)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003etransformer_encoder\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 19. Put 0 index logit through classifier (equation 4)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eclassifier\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[:,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e])\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# run on each sample in a batch at 0 index\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e       \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUse \u003ccode\u003etorchinfo.summary\u003c/code\u003e to get the information about \u003ccode\u003etorch_transformer_encoder_layer\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Create a random tensor with same shape as a single image\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003erandom_image_tensor\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# (batch_size, color_channels, height, width)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Create an instance of ViT with the number of classes we\u0026#39;re working with (pizza, steak, sushi)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# vit = ViT(num_classes=len(class_names))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003evit\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eViT\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_classes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Print a summary of our custom ViT model using torchinfo (uncomment for actual output)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esummary\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003evit\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e224\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# (batch_size, color_channels, height, width)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# col_names=[\u0026#34;input_size\u0026#34;], # uncomment for smaller output\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ecol_names\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;input_size\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;output_size\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;num_params\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;trainable\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ecol_width\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003erow_settings\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;var_names\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/08-vit-paper-summary-output-custom-vit-model.png\"\r\n  alt=\"\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ch2 id=\"6-optimizer-loss-function\"\u003e§6 Optimizer, Loss Function\u003c/h2\u003e\n\u003cp\u003eGenerally these two will be different in different model, I\u0026rsquo;ll write about them later.\u003c/p\u003e\n\u003cp\u003eIn ViT they are \u003ccode\u003etorch.optim.Adam()\u003c/code\u003e and \u003ccode\u003etorch.nn.CrossEntropyLoss()\u003c/code\u003e, see \u003ca href=\"https://www.learnpytorch.io/08_pytorch_paper_replicating/#9-setting-up-training-code-for-our-vit-model\"\u003eSection 9. Setting up training code for our ViT model\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"7-use-pretrained-model-transfer-learning\"\u003e§7 Use Pretrained model (Transfer Learning)\u003c/h2\u003e\n\u003cp\u003eSee \u003ca href=\"https://www.learnpytorch.io/08_pytorch_paper_replicating/#10-using-a-pretrained-vit-from-torchvisionmodels-on-the-same-dataset\"\u003eSection 10. Using a pretrained ViT from \u003ccode\u003etorchvision.models\u003c/code\u003e on the same dataset\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eFor more information on Transfer Learning, see \u003ca href=\"https://www.learnpytorch.io/06_pytorch_transfer_learning/\"\u003e06. PyTorch Transfer Learning\u003c/a\u003e. Freeze part of the model and train the rest of the model is fun. I will get to this some day, but since in physics we are dealing with quite different dataset than Natural Language Processing (NLP) or Computer Vision (CV), it\u0026rsquo;s probably not gonna be really helpful. Except classification for Galaxies or Gravitational Wave, which are close to traditional CV classification missions.\u003c/p\u003e\n\u003ch2 id=\"8-cnn-or-transformer\"\u003e§8 CNN or Transformer\u003c/h2\u003e\n\u003cp\u003eThe comparison of CNN and Transformer in \u003ca href=\"https://www.learnpytorch.io/08_pytorch_paper_replicating/#106-save-feature-extractor-vit-model-and-check-file-size\"\u003eSection 10.6 Save feature extractor ViT model and check file size\u003c/a\u003e is interesting.\u003c/p\u003e\n\u003cp\u003eBut transformer is better than CNN in $\\mathrm{2}$ ways:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMultimodal. Embedding then \u003ccode\u003etorch.cat\u003c/code\u003e is surprisingly useful.\u003c/li\u003e\n\u003cli\u003eNo signs of \u003ca href=\"https://en.wikipedia.org/wiki/Overfitting#Machine_learning\"\u003eoverfitting\u003c/a\u003e yet.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAt scale, they tend to have same performance, see \u003ca href=\"https://arxiv.org/abs/2310.16764\"\u003e[2310.16764] \u003cem\u003eConvNets Match Vision Transformers at Scale\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230624-machine-learning-notes-vision-transformer/",
      "date_published": "24066-24-09T60:2424:00+00:00",
      "date_modified": "24066-24-09T60:2424:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "6f17bbff588b20f89c3ec3dd3124f1b306ec8660",
      "title": "Group Theory Calculations",
      "summary": "",
      "content_text": "In this article I will summarize some simple examples as a quick introduction to Group Theory.\n§1 Finite Group If you wanna know about the full finite group, see Classification of finite simple groups. The FULL list is one of the greatest human achievements.\nI think the best way to learn finite group is to start from various examples.\nHere\u0026rsquo;s some general rules:\nSome rules to calculate permutations: $(12)=(21)$, $(123)=(231)=(312)$ $(12)(23)=(123)$ $(12)^{-1}=(21)=(12)$, $(123)^{-1}=(321)$, $((12)(34))^{-1}=(43)(21)$, $((123)(45))^{-1}=(54)(321)$. The structure of the permutation is the same, the numbers in the permutation goes backwards. $(12)(12)=e$ To calculate $((12)(34))(123)((12)(34))^{-1}$, first exchange $1$ and $2$ for $(123)$, than exchange $3$ and $4$. $(123)\\xrightarrow{\\text{exchange 1 and 2}}(213)\\xrightarrow{\\text{exchange 3 and 4}}(214)$ For a $S_n$ group, permutations with the same structure form a conjugate class. The number of elements in a conjugate class is a factor of the order of the group. The order of the subgroup is a factor of the order of the group. An invariant subgroup must consist of several complete conjugate classes. §1.1 C2 In the notation of permutation, $$C_2 = \\lbrace e, (12) \\rbrace \\tag{1.1.1}$$It has $2$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (12) \\rbrace \\end{aligned} \\tag{1.1.2}$$thus only has $2$ trivial invariant subgroups: $$\\begin{aligned} H_1 \u0026amp;= \\lbrace e\\rbrace \\\\ H_2\u0026amp;=\\lbrace e, (12) \\rbrace (C_2 \\space \\text{itself}) \\end{aligned} \\tag{1.1.3}$$thus has $2$ quotient groups, which are trivial: $$\\begin{aligned} C_2 / H_1 \u0026amp;= \\lbrace H_1, (12)H_1 \\rbrace \\cong C_2 \\\\ C_2 / H_2 \u0026amp;= \\lbrace H_2\\rbrace \\end{aligned} \\tag{1.1.4}$$\nIn the character table, the first row is always all $1$, and the first column is always the dimension $n_{\\mu}$ of the irreducible representation (irr. rep.) of the group, which satisfies $$n_G = \\sum n_{\\mu}^2 \\tag{1.1.5}$$where $n_G$ is the order of original group, in this case $C_2$. So the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ 1 $1$ $1$ 2 $1$ $x$ According to orthonormality, the $1^{\\text{st}}$ row and the $2^{\\text{nd}}$ row satisfy (the coefficient ahead is $\\sqrt{\\frac{\\text{the number of elements in the conjugate class}}{n_G}}$ that each column has the same value):$$\\begin{pmatrix} \\sqrt{\\frac{1}{2}}\\cdot1 \u0026amp; \\sqrt{\\frac{1}{2}}\\cdot1 \\end{pmatrix} \\begin{pmatrix} \\sqrt{\\frac{1}{2}}\\cdot1 \\\\ \\sqrt{\\frac{1}{2}}\\cdot x \\end{pmatrix} = 0 \\tag{1.1.6}$$so $x=-1$, thus complete the character table:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ 1 $1$ $1$ 2 $1$ $-1$ §1.2 C3 $$C_3 = \\lbrace e, (123), (321) \\rbrace \\tag{1.2.1}$$It has $3$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (123) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (321) \\rbrace \\end{aligned} \\tag{1.2.2}$$thus only has $2$ trivial invariant subgroups: $$\\begin{aligned} H_1 \u0026amp;= \\lbrace e\\rbrace \\\\ H_2\u0026amp;=\\lbrace e, (123), (321) \\rbrace (C_3 \\space \\text{itself}) \\end{aligned} \\tag{1.2.3}$$thus has $2$ quotient groups, which are trivial: $$\\begin{aligned} C_3 / H_1 \u0026amp;= \\lbrace H_1, (123)H_1, (321)H_1 \\rbrace \\cong C_3 \\\\ C_3 / H_2 \u0026amp;= \\lbrace H_2\\rbrace \\end{aligned} \\tag{1.2.4}$$\nAccording to Eq. (1.1.5), the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ 1 $1$ $1$ $1$ 2 $1$ $x$ $y$ 3 $1$ $z$ $w$ According to orthonormality, the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ 1 $1$ $1$ $1$ 2 $1$ $e^{i \\frac{2 \\pi}{3}}$ $e^{i \\frac{4 \\pi}{3}}$ 3 $1$ $e^{i \\frac{4 \\pi}{3}}$ $e^{i \\frac{2 \\pi}{3}}$ §1.3 S3 $$S_3 = \\lbrace e, (12), (13), (23), (123), (321) \\rbrace \\tag{1.3.1}$$It has $3$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (12), (13), (23) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (123), (321) \\rbrace \\end{aligned} \\tag{1.3.2}$$thus only has $1$ nontrivial invariant subgroup, composed of $\\zeta_1$ and $\\zeta_3$: $$H_1 = \\lbrace e, (123), (321) \\rbrace \\tag{1.3.3}$$thus has $1$ quotient group: $$S_3 / H_1 = \\lbrace H_1, (12)H_1 \\rbrace \\cong C_2 \\tag{1.3.4}$$\nAccording to Eq. (1.1.5), the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ 1 $1$ $1$ $1$ 2 $1$ $x$ $y$ 3 $2$ $z$ $w$ Because $H_1$ is composed of $\\zeta_1$ and $\\zeta_3$, and $S_3 / H_1 \\cong C_2$, the column of $\\zeta_1$ and $\\zeta_3$ is the same as the column of $\\zeta_1$ in the character table of $C_2$, when having the same dimension of irr. rep.; the column of $\\zeta_2$ is the same as the column of $\\zeta_2$ in the character table of $C_2$, when having the same dimension of irr. rep. Thus the character table is :\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ 1 $1$ $1$ $1$ 2 $1$ $-1$ $1$ 3 $2$ $z$ $w$ According to orthonormality, the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ 1 $1$ $1$ $1$ 2 $1$ $-1$ $1$ 3 $2$ $0$ $-1$ §1.4 S4 $$\\begin{aligned}S_4 = \\lbrace \u0026amp;e, \\\\ \u0026amp;(12), (13), (14), (23), (24), (34), \\\\ \u0026amp;(12)(34), (13)(24), (14)(23), \\\\ \u0026amp;(123), (124), (132), (134), (142), (143), (234), (243), \\\\ \u0026amp;(1234), (1243), (1324), (1342), (1423), (1432) \\rbrace \\end{aligned}\\tag{1.4.1}$$It has $5$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (12), (13), (14), (23), (24), (34) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (12)(34), (13)(24), (14)(23) \\rbrace \\\\ \\zeta_4\u0026amp;=\\lbrace (123), (124), (132), (134), (142), (143), (234), (243) \\rbrace \\\\ \\zeta_5\u0026amp;=\\lbrace (1234), (1243), (1324), (1342), (1423), (1432) \\rbrace \\end{aligned} \\tag{1.4.2}$$thus has $2$ nontrivial invariant subgroups: $$\\begin{aligned} H_1 = \\lbrace \u0026amp;e, (12)(34), (13)(24), (14)(23) \\rbrace \\cong V_4\\\\ H_2=\\lbrace \u0026amp;e, \\\\ \u0026amp;(123), (321), (124), (421), (234), (432), \\\\ \u0026amp;(12)(34), (13)(24), (14)(23) \\rbrace \\cong A_4 \\end{aligned} \\tag{1.4.3}$$thus has $2$ quotient groups: $$\\begin{aligned} S_4 / V_4 \u0026amp;= \\lbrace V_4, (12)V_4, (13)V_4, (23)V_4, (123)V_4, (321)V_4 \\rbrace \\cong S_3 \\\\ S_4 / A_4 \u0026amp;\\cong C_2 \\end{aligned} \\tag{1.4.4}$$\nAccording to Eq. (1.1.5) and quotient group, the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ $\\zeta_4$ $\\zeta_5$ 1 $1$ $1$ $1$ $1$ $1$ 2 $1$ $-1$ $1$ $1$ $x$ 3 $2$ $0$ $2$ $-1$ $y$ 4 $3$ 5 $3$ According to orthonormality, the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ $\\zeta_4$ $\\zeta_5$ 1 $1$ $1$ $1$ $1$ $1$ 2 $1$ $-1$ $1$ $1$ $-1$ 3 $2$ $0$ $2$ $-1$ $0$ 4 $3$ 5 $3$ According to orthonormality, the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ $\\zeta_4$ $\\zeta_5$ 1 $1$ $1$ $1$ $1$ $1$ 2 $1$ $-1$ $1$ $1$ $-1$ 3 $2$ $0$ $2$ $-1$ $0$ 4 $3$ $1$ $-1$ $0$ $-1$ 5 $3$ $-1$ $-1$ $0$ $1$ §1.5 D2 $$D_2 = \\lbrace e, (13), (24), (13)(24) \\rbrace \\tag{1.5.1}$$It has $4$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (13) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (24) \\rbrace \\\\ \\zeta_4\u0026amp;=\\lbrace (13)(24) \\rbrace\\end{aligned} \\tag{1.5.2}$$thus has $3$ nontrivial invariant subgroups: $$\\begin{aligned} H_1 \u0026amp;= \\lbrace e, (13)\\rbrace \\\\ H_2\u0026amp;=\\lbrace e, (24) \\rbrace \\\\ H_3\u0026amp;=\\lbrace e, (13)(24) \\rbrace \\end{aligned} \\tag{1.5.3}$$thus has $3$ quotient groups: $$\\begin{aligned} D_2 / H_1 \u0026amp;= \\lbrace H_1, (13)H_1 \\rbrace \\cong C_2 \\\\ D_2 / H_2 \u0026amp;= \\lbrace H_2, (24)H_2 \\rbrace \\cong C_2 \\\\ D_2 / H_3 \u0026amp;= \\lbrace H_3, (13)(24)H_3 \\rbrace \\cong C_2\\end{aligned} \\tag{1.5.4}$$\nAccording to Eq. (1.1.5) and quotient groups, the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ $\\zeta_4$ 1 $1$ $1$ $1$ $1$ 2 $1$ $1$ $-1$ $-1$ 3 $1$ $-1$ $1$ $-1$ 4 $1$ $-1$ $-1$ $1$ §1.6 D3 $D_3 \\cong S_3$, see §1.3.\n§1.7 D4 $$\\begin{aligned}D_4 = \\lbrace \u0026amp;e, \\\\ \u0026amp;(13), (24), \\\\ \u0026amp;(12)(34), (14)(23), \\\\ \u0026amp;(1234), (13)(24), (4321) \\rbrace \\end{aligned}\\tag{1.7.1}$$where $(13)(24)=(1234)^2$, $(4321)=(1234)^3$. It has $5$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (13)(24) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (13), (24) \\rbrace \\\\ \\zeta_4\u0026amp;=\\lbrace (12)(34), (14)(23) \\rbrace \\\\ \\zeta_5\u0026amp;=\\lbrace (1234), (4321) \\rbrace \\end{aligned} \\tag{1.7.2}$$thus has $4$ nontrivial invariant subgroups: $$\\begin{aligned} H_1 \u0026amp;= \\lbrace e, (13)(24)\\rbrace \\\\ H_2\u0026amp;=\\lbrace e, (13), (24), (13)(24) \\rbrace \\\\ H_3\u0026amp;=\\lbrace e, (12)(34), (14)(23), (13)(24) \\rbrace \\\\ H_4\u0026amp;=\\lbrace e, (1234), (4321), (13)(24) \\rbrace \\end{aligned} \\tag{1.7.3}$$thus has $4$ quotient groups: $$\\begin{aligned} D_4 / H_1 \u0026amp;= \\lbrace H_1, (13)H_1, (12)(34)H_1, (1234)H_1 \\rbrace \\cong D_2 \\\\ D_4 / H_2 \u0026amp;= \\lbrace H_2, (12)(34)H_2\\rbrace \\cong C_2 \\\\ D_4 / H_3 \u0026amp;= \\lbrace H_3, (13)H_3\\rbrace \\cong C_2 \\\\ D_4 / H_4 \u0026amp;= \\lbrace H_4, (13)H_4\\rbrace \\cong C_2 \\end{aligned} \\tag{1.7.4}$$\nAccording to Eq. (1.1.5) and quotient groups, the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ $\\zeta_4$ $\\zeta_5$ 1 $1$ $1$ $1$ $1$ $1$ 2 $1$ $1$ $1$ $-1$ $-1$ 3 $1$ $1$ $-1$ $1$ $-1$ 4 $1$ $1$ $-1$ $-1$ $1$ 5 $2$ $x$ $y$ $z$ $w$ According to orthonormality, the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ $\\zeta_4$ $\\zeta_5$ 1 $1$ $1$ $1$ $1$ $1$ 2 $1$ $1$ $1$ $-1$ $-1$ 3 $1$ $1$ $-1$ $1$ $-1$ 4 $1$ $1$ $-1$ $-1$ $1$ 5 $2$ $-2$ $0$ $0$ $0$ §1.8 D5 $$\\begin{aligned} D_5 = \\lbrace \u0026amp;e, \\\\ \u0026amp;(12345), (13524), (42531), (54321), \\\\ \u0026amp;(25)(34), (13)(45), (15)(24), (12)(35), (14)(23) \\rbrace \\end{aligned} \\tag{1.8.1}$$where $(13524)=(12345)^2$, $(42531)=(12345)^3$, $(54321)=(12345)^4$. It has $4$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (25)(34), (13)(45), (15)(24), (12)(35), (14)(23) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (12345), (54321) \\rbrace \\\\ \\zeta_4\u0026amp;=\\lbrace (13524), (42531) \\rbrace \\end{aligned} \\tag{1.8.2}$$thus has $1$ nontrivial invariant subgroup: $$ H_1 = \\lbrace e, (12345), (13524), (42531), (54321)\\rbrace \\cong C_5\\tag{1.8.3}$$thus has $1$ quotient group: $$D_5 / C_5 = \\lbrace C_5, (25)(34)C_5 \\rbrace \\cong C_2\\tag{1.8.4}$$\nAccording to Eq. (1.1.5) and quotient groups, the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ $\\zeta_4$ 1 $1$ $1$ $1$ $1$ 2 $1$ $-1$ $1$ $1$ 3 $2$ $x$ $y$ $z$ 4 $2$ $r$ $s$ $t$ According to orthonormality, the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ $\\zeta_4$ 1 $1$ $1$ $1$ $1$ 2 $1$ $-1$ $1$ $1$ 3 $2$ $0$ $2\\cos(\\frac{2 \\pi}{5})$ $2\\cos(\\frac{4 \\pi}{5})$ 4 $2$ $0$ $2\\cos(\\frac{4 \\pi}{5})$ $2\\cos(\\frac{2 \\pi}{5})$ By the way, $2\\cos(\\frac{2 \\pi}{5}) \\approx 0.618$, is the Golden Ratio.\n§1.9 A4 $$\\begin{aligned}A_4 = \\lbrace \u0026amp;e, \\\\ \u0026amp;(123), (321), (124), (421), (134), (431), (234), (432), \\\\ \u0026amp;(12)(34), (13)(24), (14)(23) \\rbrace \\end{aligned} \\tag{1.9.1}$$It has $4$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (12)(34), (13)(24), (14)(23) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (123), (421), (134), (432) \\rbrace \\\\ \\zeta_4\u0026amp;=\\lbrace (321), (124), (431), (234) \\rbrace \\end{aligned} \\tag{1.9.2}$$thus has $1$ nontrivial invariant subgroup: $$H_1 = \\lbrace e, (12)(34), (13)(24), (14)(23)\\rbrace \\cong V_4\\tag{1.9.3}$$thus has $1$ quotient group: $$A_4 / V_4 = \\lbrace V_4, (123)V_4, (321)V_4 \\rbrace \\cong C_3 \\tag{1.9.4}$$\nAccording to Eq. (1.1.5) and quotient groups, the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ $\\zeta_4$ 1 $1$ $1$ $1$ $1$ 2 $1$ $x$ $e^{i \\frac{2 \\pi}{3}}$ $e^{i \\frac{4 \\pi}{3}}$ 3 $1$ $y$ $e^{i \\frac{4 \\pi}{3}}$ $e^{i \\frac{2 \\pi}{3}}$ 4 $3$ According to orthonormality, the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ $\\zeta_4$ 1 $1$ $1$ $1$ $1$ 2 $1$ $1$ $e^{i \\frac{2 \\pi}{3}}$ $e^{i \\frac{4 \\pi}{3}}$ 3 $1$ $1$ $e^{i \\frac{4 \\pi}{3}}$ $e^{i \\frac{2 \\pi}{3}}$ 4 $3$ $x$ $y$ $z$ According to orthonormality, the character table is:\nConjugate Class: $\\zeta_1$ $\\zeta_2$ $\\zeta_3$ $\\zeta_4$ 1 $1$ $1$ $1$ $1$ 2 $1$ $1$ $e^{i \\frac{2 \\pi}{3}}$ $e^{i \\frac{4 \\pi}{3}}$ 3 $1$ $1$ $e^{i \\frac{4 \\pi}{3}}$ $e^{i \\frac{2 \\pi}{3}}$ 4 $3$ $-1$ $0$ $0$ §2 Yang Tableaux of S3 Drawing the Yang Tableaux with html is so simple and elegant:\n\u0026lt;table\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;1\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;2\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;3\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/table\u0026gt; In this section we use normal Yang Tableaux to construct the Irr. Rep. matrices of S3.\nnormal Yang tableaux $\\Theta_1$: 1 2 3 According to Hook length formula, the irr. rep. is one-dimensional.\nWe have$$\\begin{aligned} s_1 \u0026amp;= e+(12)+(23)+(13)+(123)+(321) \\\\ a_1 \u0026amp;= e \\\\ e_1 \u0026amp;= e+(12)+(23)+(13)+(123)+(321) \\end{aligned} \\tag{2.1}$$Define $$\\ket{\\nu} = \\ket{e}+\\ket{(12)}+\\ket{(23)}+\\ket{(13)}+\\ket{(123)}+\\ket{(321)} \\tag{2.2}$$Thus we have $$p\\ket{\\nu}=\\ket{\\nu}\\tag{2.3}$$where $p=e, (12), (23), (13), (123), (321)$. So $$p=1 \\tag{2.4}$$\nnormal Yang tableaux $\\Theta_2$: 1 2 3 According to Hook length formula, the irr. rep. is one-dimensional.\nWe have$$\\begin{aligned} s_2 \u0026amp;= e \\\\ a_2 \u0026amp;= e-(12)-(23)-(13)+(123)+(321) \\\\ e_2 \u0026amp;= e-(12)-(23)-(13)+(123)+(321) \\end{aligned} \\tag{2.5}$$Define $$\\ket{\\nu} = \\ket{e}-\\ket{(12)}-\\ket{(23)}-\\ket{(13)}+\\ket{(123)}+\\ket{(321)} \\tag{2.6}$$Thus when $p$ is an odd permutation, $$p\\ket{\\nu}=(12)\\ket{\\nu}=(23)\\ket{\\nu}=(13)\\ket{\\nu}=-\\ket{\\nu} \\tag{2.7}$$when $p$ is a even permutation, $$p\\ket{\\nu}=e\\ket{\\nu}=(123)\\ket{\\nu}=(321)\\ket{\\nu}=\\ket{\\nu} \\tag{2.8}$$So $$p=(-1)^p \\tag{2.9}$$\nnormal Yang tableaux $\\Theta_3$: 1 2 3 According to Hook length formula, the irr. rep. is two-dimensional.\nWe have$$\\begin{aligned} s_3 \u0026amp;= e+(12) \\\\ a_3 \u0026amp;= e-(13) \\\\ e_3 \u0026amp;= e+(12)-(13)-(12)(13) \\\\ \u0026amp;=e+(12)-(13)-(321) \\end{aligned} \\tag{2.10}$$ Define $$\\ket{\\nu_1} = \\ket{e}+\\ket{(12)}-\\ket{(13)}-\\ket{(321)} \\tag{2.11}$$Thus$$\\begin{aligned} e\\ket{\\nu_1}\u0026amp;=\\ket{\\nu_1} \\\\ (12)\\ket{\\nu_1}\u0026amp;=\\ket{(12)}+\\ket{e}-\\ket{(321)}-\\ket{(13)}\u0026amp;=\\ket{\\nu_1}\\\\ (23)\\ket{\\nu_1}\u0026amp;=\\ket{(23)}+\\ket{(321)}-\\ket{(123)}-\\ket{(12)}\u0026amp;=\\ket{\\nu_2}\\\\ (13)\\ket{\\nu_1}\u0026amp;=\\ket{(13)}+\\ket{(123)}-\\ket{e}-\\ket{(23)}\u0026amp;=-\\ket{\\nu_1}-\\ket{\\nu_2}\\\\ (123)\\ket{\\nu_1}\u0026amp;=\\ket{(123)}+\\ket{(13)}-\\ket{(23)}-\\ket{e}\u0026amp;=-\\ket{\\nu_1}-\\ket{\\nu_2}\\\\ (321)\\ket{\\nu_1}\u0026amp;=\\ket{(321)}+\\ket{(23)}-\\ket{(12)}-\\ket{(123)}\u0026amp;=\\ket{\\nu_2}\\\\ e\\ket{\\nu_2}\u0026amp;=\\ket{\\nu_2}\\\\ (12)\\ket{\\nu_2}\u0026amp;=\\ket{(123)}+\\ket{(13)}-\\ket{(23)}-\\ket{e}\u0026amp;=-\\ket{\\nu_1}-\\ket{\\nu_2}\\\\ (23)\\ket{\\nu_2}\u0026amp;=\\ket{e}+\\ket{(12)}-\\ket{(13)}-\\ket{(321)}\u0026amp;=\\ket{\\nu_1}\\\\ (13)\\ket{\\nu_2}\u0026amp;=\\ket{(321)}+\\ket{(23)}-\\ket{(12)}-\\ket{(123)}\u0026amp;=\\ket{\\nu_2}\\\\ (123)\\ket{\\nu_2}\u0026amp;=\\ket{(12)}+\\ket{e}-\\ket{(321)}-\\ket{(13)}\u0026amp;=\\ket{\\nu_1}\\\\ (321)\\ket{\\nu_2}\u0026amp;=\\ket{(13)}+\\ket{(123)}-\\ket{e}-\\ket{(23)}\u0026amp;=-\\ket{\\nu_1}-\\ket{\\nu_2} \\end{aligned} \\tag{2.12}$$So $$\\begin{aligned} D(e) \u0026amp;= \\begin{pmatrix} 1 \u0026amp; 0 \\\\ 0 \u0026amp; 1 \\end{pmatrix} \\\\ D(12) \u0026amp;= \\begin{pmatrix} 1 \u0026amp; -1 \\\\ 0 \u0026amp; -1 \\end{pmatrix}, D(23) = \\begin{pmatrix} 0 \u0026amp; 1 \\\\ 1 \u0026amp; 0 \\end{pmatrix}, D(13) = \\begin{pmatrix} -1 \u0026amp; 0 \\\\ -1 \u0026amp; 1 \\end{pmatrix} \\\\ D(123) \u0026amp;= \\begin{pmatrix} -1 \u0026amp; 1 \\\\ -1 \u0026amp; 0 \\end{pmatrix}, D(321) = \\begin{pmatrix} 0 \u0026amp; -1 \\\\ 1 \u0026amp; -1 \\end{pmatrix} \\\\ \\end{aligned} \\tag{2.13}$$\n§3 Matrix Multiplication \u0026amp; Identity Matrix Let\u0026rsquo;s say we multiply two matrices $A$ and $B$ to get matrix $C$: $$C=AB \\tag{3.1}$$, then (note that the superscript is for row, and the subscript is for column) $$\\begin{pmatrix} C^1_1 \u0026amp; C^1_2 \\\\ C^2_1 \u0026amp; C^2_2 \\end{pmatrix} = \\begin{pmatrix} A^1_1 \u0026amp; A^1_2 \\\\ A^2_1 \u0026amp; A^2_2 \\end{pmatrix} \\begin{pmatrix} B^1_1 \u0026amp; B^1_2 \\\\ B^2_1 \u0026amp; B^2_2 \\end{pmatrix} \\tag{3.2}$$ , then $$C^1_1 = A^1_1 B^1_2 + A^1_2 B^2_2 \\tag{3.3}$$ , which can be generalized to matrices with any shape $C^i_j = (AB)^i_j = \\sum_\\alpha A^i_\\alpha B^\\alpha_j$ or, in Einstein notation: $$C^i_j = (AB)^i_j = A^i_\\alpha B^\\alpha_j \\tag{3.4}$$\nFor identity matrix $\\mathbb{I}$: $$\\mathbb{I}^i_j = \\delta^i_j \\tag{3.5}$$\nSo when we multiply two matrices $A$ and $B$ to get an identity matrix $\\mathbb{I}$: $$AB = \\mathbb{I} \\tag{3.6}$$, it means that: $$(AB)^i_j = A^i_\\alpha B^\\alpha_j = \\delta^i_j \\tag{3.7}$$, and in U(n) groups we have $$U^{\\dagger} U = \\mathbb{I} \\tag{3.8}$$\n§4 Irr. Rep. of SO(3) Lie Algebra §4.1 j=1/2 When $j = \\frac{1}{2}$, $\\frac{3}{2}$, $\\frac{5}{2}$, …, it\u0026rsquo;s a double-valued representation. Let\u0026rsquo;s take $j=\\frac{1}{2}$ for example.\nDefine $$\\ket{\\frac{1}{2},\\frac{1}{2}}=\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\ket{\\frac{1}{2},-\\frac{1}{2}}=\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\tag{4.1.1}$$According to $$\\begin{aligned} J_3 \\ket{j,m} \u0026amp;= m \\ket{j,m} \\\\ J_{\\pm} \\ket{j,m} \u0026amp;= \\sqrt{j(j+1)-m(m \\pm 1)} \\ket{j,m \\pm 1}\\end{aligned} \\tag{4.1.2}$$we have $$J_3=\\begin{pmatrix} \\frac{1}{2} \u0026amp; 0 \\\\ 0 \u0026amp; -\\frac{1}{2} \\end{pmatrix}, J_+=\\begin{pmatrix} 0 \u0026amp; 1 \\\\ 0 \u0026amp; 0 \\end{pmatrix}, J_-=\\begin{pmatrix} 0 \u0026amp; 0 \\\\ 1 \u0026amp; 0 \\end{pmatrix} \\tag{4.1.3}$$According to $$J_{\\pm}=J_1 \\pm i J_2 \\tag{4.1.4}$$we have $$J_1=\\begin{pmatrix} 0 \u0026amp; \\frac{1}{2} \\\\ \\frac{1}{2} \u0026amp; 0 \\end{pmatrix}, J_2=\\begin{pmatrix} 0 \u0026amp; -\\frac{i}{2} \\\\ \\frac{i}{2} \u0026amp; 0 \\end{pmatrix}, J_3=\\begin{pmatrix} \\frac{1}{2} \u0026amp; 0 \\\\ 0 \u0026amp; -\\frac{1}{2} \\end{pmatrix} \\tag{4.1.5}$$According to $$J_k=\\frac{\\sigma_k}{2}, k=1,2,3 \\tag{4.1.6}$$we have $$\\sigma_1=\\begin{pmatrix} 0 \u0026amp; 1 \\\\ 1 \u0026amp; 0 \\end{pmatrix}, \\sigma_2=\\begin{pmatrix} 0 \u0026amp; -i \\\\ i \u0026amp; 0 \\end{pmatrix}, \\sigma_3=\\begin{pmatrix} 1 \u0026amp; 0 \\\\ 0 \u0026amp; 1 \\end{pmatrix} \\tag{4.1.7}$$So $$\\begin{aligned} d^{\\frac{1}{2}}(\\beta) \u0026amp;=e^{-i \\beta J_2} \\\\ \u0026amp;= e^{-\\frac{i \\beta \\sigma_2}{2}} \\\\ \u0026amp;=E+(-\\frac{i \\beta}{2})\\sigma_2+\\frac{1}{2!}(-\\frac{i \\beta}{2})^{2}\\sigma_2^2+\\frac{1}{3!}(-\\frac{i \\beta}{2})^{3}\\sigma_2^3+ \\cdots \\\\ \u0026amp;=E\\cos{\\frac{\\beta}{2}}-i \\sigma_2 \\sin{\\frac{\\beta}{2}} \\\\ \u0026amp;= \\begin{pmatrix} \\cos{\\frac{\\beta}{2}} \u0026amp; -\\sin{\\frac{\\beta}{2}} \\\\ \\sin{\\frac{\\beta}{2}} \u0026amp; \\cos{\\frac{\\beta}{2}} \\end{pmatrix}\\end{aligned} \\tag{4.1.8}$$So $$D^{\\frac{1}{2}}(\\alpha, \\beta, \\gamma)=\\begin{pmatrix} e^{-\\frac{i\\alpha}{2}}\\cos{\\frac{\\beta}{2}}e^{-\\frac{i\\gamma}{2}} \u0026amp; -e^{-\\frac{i\\alpha}{2}}\\sin{\\frac{\\beta}{2}}e^{\\frac{i\\gamma}{2}} \\\\ e^{\\frac{i\\alpha}{2}}\\sin{\\frac{\\beta}{2}}e^{-\\frac{i\\gamma}{2}} \u0026amp; e^{\\frac{i\\alpha}{2}}\\cos{\\frac{\\beta}{2}}e^{\\frac{i\\gamma}{2}}\\end{pmatrix} \\tag{4.1.9}$$So $$\\begin{aligned} D[R_n(2n \\pi)] \u0026amp;= D[R] e^{in \\pi \\sigma_2} D[R]^{-1} \\\\ \u0026amp;= D[R] (-E)^n D[R]^{-1} \\\\ \u0026amp;=(-1)^n E \\end{aligned} \\tag{4.1.10}$$Thus it\u0026rsquo;s a double-valued representation.\n§4.2 j=1 When $j = 0$, $1$, $2$, …, it\u0026rsquo;s a irreducible representation. Let\u0026rsquo;s take $j=1$ for example.\n$$J_3=\\begin{pmatrix} 1 \u0026amp; 0 \u0026amp; 0 \\\\ 0 \u0026amp; 0 \u0026amp; 0 \\\\ 0 \u0026amp; 0 \u0026amp; -1 \\end{pmatrix}, J_+=\\begin{pmatrix} 0 \u0026amp; \\sqrt{2} \u0026amp; 0 \\\\ 0 \u0026amp; 0 \u0026amp; \\sqrt{2} \\\\ 0 \u0026amp; 0 \u0026amp; 0 \\end{pmatrix}, J_-=\\begin{pmatrix} 0 \u0026amp; 0 \u0026amp; 0 \\\\ \\sqrt{2} \u0026amp; 0 \u0026amp; 0 \\\\ 0 \u0026amp; \\sqrt{2} \u0026amp; 0 \\end{pmatrix} \\tag{4.2.1}$$And$$e^{-i \\beta J_2} = e^{\\beta K} =E+\\sin{\\beta} K+(1-\\cos{\\beta})K^2 \\tag{4.2.2}$$\nThe rest is left as an exercise for the reader.\nEventually, $$d^1(\\beta)= \\begin{pmatrix} \\frac{1+\\cos{\\beta}}{2} \u0026amp; -\\frac{\\sin{\\beta}}{\\sqrt{2}} \u0026amp; \\frac{1-\\cos{\\beta}}{2} \\\\ \\frac{\\sin{\\beta}}{\\sqrt{2}} \u0026amp; \\cos{\\beta} \u0026amp; -\\frac{\\sin{\\beta}}{\\sqrt{2}} \\\\ \\frac{1-\\cos{\\beta}}{2} \u0026amp; \\frac{\\sin{\\beta}}{\\sqrt{2}} \u0026amp; \\frac{1+\\cos{\\beta}}{2} \\end{pmatrix} \\tag{4.2.3}$$\n§5 Clebsch–Gordan Coefficients In this section we decompose the direct product of Irr. Rep. of SU(2) into the direct sum of Irr. Rep. Here\u0026rsquo;s an example of $j_1 = \\frac{1}{2}$, $j_2=1$. You can check Table of Clebsch–Gordan coefficients to make sure it\u0026rsquo;s right.\n$$\\ket{\\frac{3}{2}, \\frac{3}{2}}=\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, 1} \\tag{5.1}$$\n$$J_-\\ket{\\frac{3}{2}, \\frac{3}{2}}=\\sqrt{\\frac{3}{2}(\\frac{3}{2}+1)-\\frac{3}{2}(\\frac{3}{2}-1)}\\ket{\\frac{3}{2}, \\frac{1}{2}}=\\sqrt{3}\\ket{\\frac{3}{2}, \\frac{1}{2}} \\tag{5.2}$$ $$\\begin{aligned}J_-(\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, 1})\u0026amp;=(J_-\\ket{\\frac{1}{2}, \\frac{1}{2}})\\otimes\\ket{1, 1}+\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes J_-(\\ket{1, 1}) \\\\ \u0026amp;=\\ket{\\frac{1}{2}, -\\frac{1}{2}} \\otimes \\ket{1, 1}+\\sqrt{2}\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, 0} \\end{aligned} \\tag{5.3}$$ So $$\\ket{\\frac{3}{2}, \\frac{1}{2}}=\\sqrt{\\frac{1}{3}}\\ket{\\frac{1}{2}, -\\frac{1}{2}} \\otimes \\ket{1, 1}+\\sqrt{\\frac{2}{3}}\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, 0} \\tag{5.4}$$\nSimilarly, $$\\ket{\\frac{3}{2}, -\\frac{1}{2}}=\\sqrt{\\frac{2}{3}}\\ket{\\frac{1}{2}, -\\frac{1}{2}} \\otimes \\ket{1, 0}+\\sqrt{\\frac{1}{3}}\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, -1} \\tag{5.5}$$\nSimilarly, $$\\ket{\\frac{3}{2}, -\\frac{3}{2}}=\\ket{\\frac{1}{2}, -\\frac{1}{2}} \\otimes \\ket{1, -1} \\tag{5.6}$$\nBecause $\\ket{\\frac{3}{2}, \\frac{1}{2}}$ and $\\ket{\\frac{1}{2}, \\frac{1}{2}}$ are orthogonal, and by normalization, we have $$\\ket{\\frac{1}{2}, \\frac{1}{2}} = \\sqrt{\\frac{2}{3}}\\ket{\\frac{1}{2}, -\\frac{1}{2}} \\otimes \\ket{1, 1}-\\sqrt{\\frac{1}{3}}\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, 0} \\tag{5.7}$$\nSimilarly, $$\\ket{\\frac{1}{2}, -\\frac{1}{2}} = \\sqrt{\\frac{1}{3}}\\ket{\\frac{1}{2}, -\\frac{1}{2}} \\otimes \\ket{1, 0}-\\sqrt{\\frac{2}{3}}\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, -1} \\tag{5.8}$$\nThus complete the Clebsch–Gordan coefficients for $j_1 = \\frac{1}{2}$, $j_2=1$.\n§6 Box-Weight Diagram of SU(3) Irr. Rep. §6.1 Box-Weight Diagram We have $$\\begin{cases} \\vec{\\alpha^1} = (\\frac{1}{2},\\frac{\\sqrt{3}}{2}) \\\\ \\vec{\\alpha^2} = (\\frac{1}{2},-\\frac{\\sqrt{3}}{2}) \\end{cases} \\tag{6.1.1}$$and according to the definition of Cartan matrix $$A_{ij} = \\frac{2 \\vec{\\alpha^i} \\cdot \\vec{\\alpha^j}}{|\\vec{\\alpha^j}|^2} \\tag{6.1.2}$$we have:$$A = \\begin{pmatrix} 2 \u0026amp; -1 \\\\ -1 \u0026amp; 2 \\end{pmatrix} \\tag{6.1.3}$$\nWhen drawing the box-weight diagram, there are some rules to follow:\nWhen minus the number on the left of $\\boxed{x \\space y}$, the $x$, minus the $1^{\\text{st}}$ row of eq. (5.1.3); draw a line down-right from $x$ to the $x\u0026rsquo;$ in the next box; until it\u0026rsquo;s $-x$. When minus the number on the right of $\\boxed{x \\space y}$, the $y$, minus the $2^{\\text{nd}}$ row of eq. (5.1.3); draw a line down-left from $y$ to the $y\u0026rsquo;$ in the next box; until it\u0026rsquo;s $-y$. If you start from $\\boxed{a \\space b}$ on the top, the final result should be $\\boxed{-b \\space -a}$ in the bottom. For example, when the highest weight is $3$ and $0$, or $\\boxed{3 \\space 0}$, the box-weight diagram should look like this:\n§6.2 All Possible Roots According to $$\\frac{2 \\vec{\\alpha^j} \\cdot \\vec{\\mu^k}}{|\\vec{\\alpha^j}|^2}=\\delta_{jk} \\tag{6.2.1}$$we have $$\\begin{cases} \\vec{\\mu^1}=(\\frac{1}{2}, \\frac{\\sqrt{3}}{6}) \\\\ \\vec{\\mu^2}=(\\frac{1}{2}, -\\frac{\\sqrt{3}}{6}) \\end{cases} \\tag{6.2.2}$$\nStarting from $3 \\vec{\\mu^1}$, from box-weight diagram, we have $$\\begin{aligned} \u0026amp;3 \\vec{\\mu^1}-\\vec{\\alpha^1}, \\\\ \u0026amp;3 \\vec{\\mu^1}-\\vec{\\alpha^1}-\\vec{\\alpha^2}, 3 \\vec{\\mu^1}-2\\vec{\\alpha^1}, \\\\ \u0026amp;3 \\vec{\\mu^1}-2\\vec{\\alpha^1}-\\vec{\\alpha^2}, 3 \\vec{\\mu^1}-3\\vec{\\alpha^1}, \\\\ \u0026amp;3 \\vec{\\mu^1}-2\\vec{\\alpha^1}-2\\vec{\\alpha^2}, 3 \\vec{\\mu^1}-3\\vec{\\alpha^1}-\\vec{\\alpha^2}, \\\\ \u0026amp; 3 \\vec{\\mu^1}-3\\vec{\\alpha^1}-2\\vec{\\alpha^2}, \\\\ \u0026amp;3 \\vec{\\mu^1}-3\\vec{\\alpha^1}-3\\vec{\\alpha^2} \\end{aligned} \\tag{6.2.3}$$ (Or you can do it more easily by using the fact that the figure below is symmetric with respect to $H_2$ axis.)\nDrawing on the $H_1 - H_2$ plane, we have:\n",
      "content_html": "\u003cp\u003eIn this article I will summarize some simple examples as a quick introduction to Group Theory.\u003c/p\u003e\n\u003ch2 id=\"1-finite-group\"\u003e§1 Finite Group\u003c/h2\u003e\n\u003cp\u003eIf you wanna know about the full finite group, see \u003ca href=\"https://en.wikipedia.org/wiki/Classification_of_finite_simple_groups\"\u003eClassification of finite simple groups\u003c/a\u003e. The \u003cstrong\u003eFULL\u003c/strong\u003e list is one of the greatest human achievements.\u003c/p\u003e\n\u003cp\u003eI think the best way to learn finite group is to start from various examples.\u003c/p\u003e\n\u003cp\u003eHere\u0026rsquo;s some general rules:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSome rules to calculate permutations:\n\u003cul\u003e\n\u003cli\u003e$(12)=(21)$, $(123)=(231)=(312)$\u003c/li\u003e\n\u003cli\u003e$(12)(23)=(123)$\u003c/li\u003e\n\u003cli\u003e$(12)^{-1}=(21)=(12)$, $(123)^{-1}=(321)$, $((12)(34))^{-1}=(43)(21)$, $((123)(45))^{-1}=(54)(321)$. The structure of the permutation is the same, the numbers in the permutation goes backwards.\u003c/li\u003e\n\u003cli\u003e$(12)(12)=e$\u003c/li\u003e\n\u003cli\u003eTo calculate $((12)(34))(123)((12)(34))^{-1}$, first exchange $1$ and $2$ for $(123)$, than exchange $3$ and $4$. $(123)\\xrightarrow{\\text{exchange 1 and 2}}(213)\\xrightarrow{\\text{exchange 3 and 4}}(214)$\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eFor a $S_n$ group, permutations with the same structure form a conjugate class.\u003c/li\u003e\n\u003cli\u003eThe number of elements in a conjugate class is a factor of the order of the group.\u003c/li\u003e\n\u003cli\u003eThe order of the subgroup is a factor of the order of the group.\u003c/li\u003e\n\u003cli\u003eAn invariant subgroup must consist of several complete conjugate classes.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"11-c2\"\u003e§1.1 C2\u003c/h3\u003e\n\u003cp\u003eIn the notation of permutation, $$C_2 = \\lbrace e, (12) \\rbrace \\tag{1.1.1}$$It has $2$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (12) \\rbrace \\end{aligned} \\tag{1.1.2}$$thus only has $2$ trivial invariant subgroups: $$\\begin{aligned} H_1 \u0026amp;= \\lbrace e\\rbrace \\\\ H_2\u0026amp;=\\lbrace e, (12) \\rbrace (C_2 \\space \\text{itself}) \\end{aligned} \\tag{1.1.3}$$thus has $2$ quotient groups, which are trivial: $$\\begin{aligned} C_2 / H_1 \u0026amp;= \\lbrace H_1, (12)H_1 \\rbrace \\cong C_2 \\\\ C_2 / H_2 \u0026amp;= \\lbrace H_2\\rbrace \\end{aligned}  \\tag{1.1.4}$$\u003c/p\u003e\n\u003cp\u003eIn the character table, the first row is always all $1$, and the first column is always the dimension $n_{\\mu}$ of the irreducible representation (irr. rep.) of the group, which satisfies $$n_G = \\sum n_{\\mu}^2 \\tag{1.1.5}$$where $n_G$ is the order of original group, in this case $C_2$. So the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$x$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eAccording to orthonormality, the $1^{\\text{st}}$ row and the $2^{\\text{nd}}$ row satisfy (the coefficient ahead is $\\sqrt{\\frac{\\text{the number of elements in the conjugate class}}{n_G}}$ that each column has the same value):$$\\begin{pmatrix} \\sqrt{\\frac{1}{2}}\\cdot1 \u0026amp; \\sqrt{\\frac{1}{2}}\\cdot1 \\end{pmatrix} \\begin{pmatrix} \\sqrt{\\frac{1}{2}}\\cdot1 \\\\ \\sqrt{\\frac{1}{2}}\\cdot x \\end{pmatrix} = 0 \\tag{1.1.6}$$so $x=-1$, thus complete the character table:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"12-c3\"\u003e§1.2 C3\u003c/h3\u003e\n\u003cp\u003e$$C_3 = \\lbrace e, (123), (321) \\rbrace \\tag{1.2.1}$$It has $3$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (123) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (321) \\rbrace \\end{aligned} \\tag{1.2.2}$$thus only has $2$ trivial invariant subgroups: $$\\begin{aligned} H_1 \u0026amp;= \\lbrace e\\rbrace \\\\ H_2\u0026amp;=\\lbrace e, (123), (321) \\rbrace (C_3 \\space \\text{itself}) \\end{aligned} \\tag{1.2.3}$$thus has $2$ quotient groups, which are trivial: $$\\begin{aligned} C_3 / H_1 \u0026amp;= \\lbrace H_1, (123)H_1, (321)H_1 \\rbrace \\cong C_3 \\\\ C_3 / H_2 \u0026amp;= \\lbrace H_2\\rbrace \\end{aligned}  \\tag{1.2.4}$$\u003c/p\u003e\n\u003cp\u003eAccording to Eq. (1.1.5), the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$x$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$y$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$z$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$w$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eAccording to orthonormality, the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{2 \\pi}{3}}$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{4 \\pi}{3}}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{4 \\pi}{3}}$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{2 \\pi}{3}}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"13-s3\"\u003e§1.3 S3\u003c/h3\u003e\n\u003cp\u003e$$S_3 = \\lbrace e, (12), (13), (23), (123), (321) \\rbrace \\tag{1.3.1}$$It has $3$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (12), (13), (23) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (123), (321) \\rbrace \\end{aligned} \\tag{1.3.2}$$thus only has $1$ nontrivial invariant subgroup, composed of $\\zeta_1$ and $\\zeta_3$: $$H_1 = \\lbrace e, (123), (321) \\rbrace \\tag{1.3.3}$$thus has $1$ quotient group: $$S_3 / H_1 = \\lbrace H_1, (12)H_1 \\rbrace \\cong C_2 \\tag{1.3.4}$$\u003c/p\u003e\n\u003cp\u003eAccording to Eq. (1.1.5), the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$x$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$y$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$z$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$w$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eBecause $H_1$ is composed of $\\zeta_1$ and $\\zeta_3$, and $S_3 / H_1 \\cong C_2$, the column of $\\zeta_1$ and $\\zeta_3$ is the same as the column of $\\zeta_1$ in the character table of $C_2$, when having the same dimension of irr. rep.; the column of $\\zeta_2$ is the same as the column of $\\zeta_2$ in the character table of $C_2$, when having the same dimension of irr. rep. Thus the character table is :\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$z$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$w$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eAccording to orthonormality, the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"14-s4\"\u003e§1.4 S4\u003c/h3\u003e\n\u003cp\u003e$$\\begin{aligned}S_4 = \\lbrace \u0026amp;e, \\\\ \u0026amp;(12), (13), (14), (23), (24), (34), \\\\ \u0026amp;(12)(34), (13)(24), (14)(23), \\\\ \u0026amp;(123), (124), (132), (134), (142), (143), (234), (243), \\\\ \u0026amp;(1234), (1243), (1324), (1342), (1423), (1432) \\rbrace \\end{aligned}\\tag{1.4.1}$$It has $5$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (12), (13), (14), (23), (24), (34) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (12)(34), (13)(24), (14)(23) \\rbrace \\\\ \\zeta_4\u0026amp;=\\lbrace (123), (124), (132), (134), (142), (143), (234), (243) \\rbrace \\\\ \\zeta_5\u0026amp;=\\lbrace (1234), (1243), (1324), (1342), (1423), (1432) \\rbrace\n\\end{aligned} \\tag{1.4.2}$$thus has $2$ nontrivial invariant subgroups: $$\\begin{aligned} H_1 = \\lbrace \u0026amp;e, (12)(34), (13)(24), (14)(23) \\rbrace \\cong V_4\\\\ H_2=\\lbrace \u0026amp;e, \\\\ \u0026amp;(123), (321), (124), (421), (234), (432), \\\\ \u0026amp;(12)(34), (13)(24), (14)(23) \\rbrace \\cong A_4 \\end{aligned} \\tag{1.4.3}$$thus has $2$ quotient groups: $$\\begin{aligned} S_4 / V_4 \u0026amp;= \\lbrace V_4, (12)V_4, (13)V_4, (23)V_4, (123)V_4, (321)V_4 \\rbrace \\cong S_3 \\\\ S_4 / A_4 \u0026amp;\\cong C_2 \\end{aligned}  \\tag{1.4.4}$$\u003c/p\u003e\n\u003cp\u003eAccording to Eq. (1.1.5) and quotient group, the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_4$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_5$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$x$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$y$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$3$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$3$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eAccording to orthonormality, the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_4$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_5$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$3$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$3$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eAccording to orthonormality, the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_4$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_5$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$3$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$3$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"15-d2\"\u003e§1.5 D2\u003c/h3\u003e\n\u003cp\u003e$$D_2 = \\lbrace e, (13), (24), (13)(24) \\rbrace \\tag{1.5.1}$$It has $4$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (13) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (24) \\rbrace \\\\ \\zeta_4\u0026amp;=\\lbrace (13)(24) \\rbrace\\end{aligned} \\tag{1.5.2}$$thus has $3$ nontrivial invariant subgroups: $$\\begin{aligned} H_1 \u0026amp;= \\lbrace e, (13)\\rbrace \\\\ H_2\u0026amp;=\\lbrace e, (24) \\rbrace \\\\ H_3\u0026amp;=\\lbrace e, (13)(24) \\rbrace \\end{aligned} \\tag{1.5.3}$$thus has $3$ quotient groups: $$\\begin{aligned} D_2 / H_1 \u0026amp;= \\lbrace H_1, (13)H_1 \\rbrace \\cong C_2 \\\\ D_2 / H_2 \u0026amp;= \\lbrace H_2, (24)H_2 \\rbrace \\cong C_2 \\\\ D_2 / H_3 \u0026amp;= \\lbrace H_3, (13)(24)H_3 \\rbrace \\cong C_2\\end{aligned}  \\tag{1.5.4}$$\u003c/p\u003e\n\u003cp\u003eAccording to Eq. (1.1.5) and quotient groups, the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_4$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"16-d3\"\u003e§1.6 D3\u003c/h3\u003e\n\u003cp\u003e$D_3 \\cong S_3$, see §1.3.\u003c/p\u003e\n\u003ch3 id=\"17-d4\"\u003e§1.7 D4\u003c/h3\u003e\n\u003cp\u003e$$\\begin{aligned}D_4 = \\lbrace \u0026amp;e, \\\\ \u0026amp;(13), (24), \\\\ \u0026amp;(12)(34), (14)(23), \\\\ \u0026amp;(1234), (13)(24), (4321) \\rbrace \\end{aligned}\\tag{1.7.1}$$where $(13)(24)=(1234)^2$, $(4321)=(1234)^3$. It has $5$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (13)(24) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (13), (24) \\rbrace \\\\ \\zeta_4\u0026amp;=\\lbrace (12)(34), (14)(23) \\rbrace \\\\ \\zeta_5\u0026amp;=\\lbrace (1234), (4321) \\rbrace \\end{aligned} \\tag{1.7.2}$$thus has $4$ nontrivial invariant subgroups: $$\\begin{aligned} H_1 \u0026amp;= \\lbrace e, (13)(24)\\rbrace \\\\ H_2\u0026amp;=\\lbrace e, (13), (24), (13)(24) \\rbrace \\\\ H_3\u0026amp;=\\lbrace e, (12)(34), (14)(23), (13)(24) \\rbrace \\\\ H_4\u0026amp;=\\lbrace e, (1234), (4321), (13)(24) \\rbrace \\end{aligned} \\tag{1.7.3}$$thus has $4$ quotient groups: $$\\begin{aligned} D_4 / H_1 \u0026amp;= \\lbrace H_1, (13)H_1, (12)(34)H_1, (1234)H_1 \\rbrace \\cong D_2 \\\\ D_4 / H_2 \u0026amp;= \\lbrace H_2, (12)(34)H_2\\rbrace \\cong C_2 \\\\ D_4 / H_3 \u0026amp;= \\lbrace H_3, (13)H_3\\rbrace \\cong C_2 \\\\ D_4 / H_4 \u0026amp;= \\lbrace H_4, (13)H_4\\rbrace \\cong C_2 \\end{aligned}  \\tag{1.7.4}$$\u003c/p\u003e\n\u003cp\u003eAccording to Eq. (1.1.5) and quotient groups, the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_4$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_5$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$x$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$y$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$z$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$w$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eAccording to orthonormality, the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_4$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_5$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"18-d5\"\u003e§1.8 D5\u003c/h3\u003e\n\u003cp\u003e$$\\begin{aligned} D_5 = \\lbrace \u0026amp;e, \\\\ \u0026amp;(12345), (13524), (42531), (54321), \\\\ \u0026amp;(25)(34), (13)(45), (15)(24), (12)(35), (14)(23) \\rbrace \\end{aligned} \\tag{1.8.1}$$where $(13524)=(12345)^2$, $(42531)=(12345)^3$, $(54321)=(12345)^4$. It has $4$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (25)(34), (13)(45), (15)(24), (12)(35), (14)(23) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (12345), (54321) \\rbrace \\\\ \\zeta_4\u0026amp;=\\lbrace (13524), (42531) \\rbrace \\end{aligned} \\tag{1.8.2}$$thus has $1$ nontrivial invariant subgroup: $$ H_1 = \\lbrace e, (12345), (13524), (42531), (54321)\\rbrace \\cong C_5\\tag{1.8.3}$$thus has $1$ quotient group: $$D_5 / C_5 = \\lbrace C_5, (25)(34)C_5 \\rbrace \\cong C_2\\tag{1.8.4}$$\u003c/p\u003e\n\u003cp\u003eAccording to Eq. (1.1.5) and quotient groups, the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_4$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$x$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$y$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$z$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$r$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$s$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$t$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eAccording to orthonormality, the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_4$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2\\cos(\\frac{2 \\pi}{5})$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2\\cos(\\frac{4 \\pi}{5})$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2\\cos(\\frac{4 \\pi}{5})$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$2\\cos(\\frac{2 \\pi}{5})$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eBy the way, $2\\cos(\\frac{2 \\pi}{5}) \\approx 0.618$, is the Golden Ratio.\u003c/p\u003e\n\u003ch3 id=\"19-a4\"\u003e§1.9 A4\u003c/h3\u003e\n\u003cp\u003e$$\\begin{aligned}A_4 = \\lbrace \u0026amp;e, \\\\ \u0026amp;(123), (321), (124), (421), (134), (431), (234), (432), \\\\ \u0026amp;(12)(34), (13)(24), (14)(23) \\rbrace \\end{aligned} \\tag{1.9.1}$$It has $4$ conjugate classes: $$\\begin{aligned} \\zeta_1\u0026amp;=\\lbrace e \\rbrace \\\\ \\zeta_2\u0026amp;=\\lbrace (12)(34), (13)(24), (14)(23) \\rbrace \\\\ \\zeta_3\u0026amp;=\\lbrace (123), (421), (134), (432) \\rbrace \\\\ \\zeta_4\u0026amp;=\\lbrace (321), (124), (431), (234) \\rbrace \\end{aligned} \\tag{1.9.2}$$thus has $1$ nontrivial invariant subgroup: $$H_1 = \\lbrace e, (12)(34), (13)(24), (14)(23)\\rbrace \\cong V_4\\tag{1.9.3}$$thus has $1$ quotient group: $$A_4 / V_4 = \\lbrace V_4, (123)V_4, (321)V_4 \\rbrace \\cong C_3 \\tag{1.9.4}$$\u003c/p\u003e\n\u003cp\u003eAccording to Eq. (1.1.5) and quotient groups, the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_4$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$x$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{2 \\pi}{3}}$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{4 \\pi}{3}}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$y$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{4 \\pi}{3}}$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{2 \\pi}{3}}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$3$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eAccording to orthonormality, the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_4$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{2 \\pi}{3}}$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{4 \\pi}{3}}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{4 \\pi}{3}}$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{2 \\pi}{3}}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$3$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$x$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$y$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$z$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eAccording to orthonormality, the character table is:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConjugate Class:\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_1$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_2$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_3$\u003c/th\u003e\n\u003cth style=\"text-align:right\"\u003e$\\zeta_4$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{2 \\pi}{3}}$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{4 \\pi}{3}}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{4 \\pi}{3}}$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$e^{i \\frac{2 \\pi}{3}}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$3$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$-1$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003ctd style=\"text-align:right\"\u003e$0$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"2-yang-tableaux-of-s3\"\u003e§2 Yang Tableaux of S3\u003c/h2\u003e\n\u003cp\u003eDrawing the Yang Tableaux with html is so simple and elegant:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003etable\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003etr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003etd\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e1\u003cspan style=\"color:#111\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003etd\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003etd\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e2\u003cspan style=\"color:#111\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003etd\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003etr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003etr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003etd\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e3\u003cspan style=\"color:#111\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003etd\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003etr\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003etable\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn this section we use normal Yang Tableaux to construct the Irr. Rep. matrices of S3.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003enormal Yang tableaux $\\Theta_1$:\u003c/li\u003e\n\u003c/ol\u003e\n\u003ctable\u003e\n    \u003ctr\u003e\n        \u003ctd\u003e1\u003c/td\u003e\n        \u003ctd\u003e2\u003c/td\u003e\n        \u003ctd\u003e3\u003c/td\u003e\n    \u003c/tr\u003e\n\u003c/table\u003e\n\u003cp\u003eAccording to \u003ca href=\"https://en.wikipedia.org/wiki/Hook_length_formula\"\u003eHook length formula\u003c/a\u003e, the irr. rep. is one-dimensional.\u003c/p\u003e\n\u003cp\u003eWe have$$\\begin{aligned} s_1 \u0026amp;= e+(12)+(23)+(13)+(123)+(321) \\\\ a_1 \u0026amp;= e \\\\ e_1 \u0026amp;= e+(12)+(23)+(13)+(123)+(321) \\end{aligned} \\tag{2.1}$$Define $$\\ket{\\nu} = \\ket{e}+\\ket{(12)}+\\ket{(23)}+\\ket{(13)}+\\ket{(123)}+\\ket{(321)} \\tag{2.2}$$Thus we have $$p\\ket{\\nu}=\\ket{\\nu}\\tag{2.3}$$where $p=e, (12), (23), (13), (123), (321)$. So $$p=1 \\tag{2.4}$$\u003c/p\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003enormal Yang tableaux $\\Theta_2$:\u003c/li\u003e\n\u003c/ol\u003e\n\u003ctable\u003e\n    \u003ctr\u003e\n        \u003ctd\u003e1\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n        \u003ctd\u003e2\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n        \u003ctd\u003e3\u003c/td\u003e\n    \u003c/tr\u003e\n\u003c/table\u003e\n\u003cp\u003eAccording to \u003ca href=\"https://en.wikipedia.org/wiki/Hook_length_formula\"\u003eHook length formula\u003c/a\u003e, the irr. rep. is one-dimensional.\u003c/p\u003e\n\u003cp\u003eWe have$$\\begin{aligned} s_2 \u0026amp;= e \\\\ a_2 \u0026amp;= e-(12)-(23)-(13)+(123)+(321) \\\\ e_2 \u0026amp;= e-(12)-(23)-(13)+(123)+(321) \\end{aligned} \\tag{2.5}$$Define $$\\ket{\\nu} = \\ket{e}-\\ket{(12)}-\\ket{(23)}-\\ket{(13)}+\\ket{(123)}+\\ket{(321)} \\tag{2.6}$$Thus when $p$ is an odd permutation, $$p\\ket{\\nu}=(12)\\ket{\\nu}=(23)\\ket{\\nu}=(13)\\ket{\\nu}=-\\ket{\\nu} \\tag{2.7}$$when $p$ is a even permutation, $$p\\ket{\\nu}=e\\ket{\\nu}=(123)\\ket{\\nu}=(321)\\ket{\\nu}=\\ket{\\nu} \\tag{2.8}$$So $$p=(-1)^p \\tag{2.9}$$\u003c/p\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003enormal Yang tableaux $\\Theta_3$:\u003c/li\u003e\n\u003c/ol\u003e\n\u003ctable\u003e\n    \u003ctr\u003e\n        \u003ctd\u003e1\u003c/td\u003e\n        \u003ctd\u003e2\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n        \u003ctd\u003e3\u003c/td\u003e\n    \u003c/tr\u003e\n\u003c/table\u003e\n\u003cp\u003eAccording to \u003ca href=\"https://en.wikipedia.org/wiki/Hook_length_formula\"\u003eHook length formula\u003c/a\u003e, the irr. rep. is two-dimensional.\u003c/p\u003e\n\u003cp\u003eWe have$$\\begin{aligned} s_3 \u0026amp;= e+(12) \\\\ a_3 \u0026amp;= e-(13) \\\\ e_3 \u0026amp;= e+(12)-(13)-(12)(13) \\\\ \u0026amp;=e+(12)-(13)-(321) \\end{aligned} \\tag{2.10}$$\nDefine $$\\ket{\\nu_1} = \\ket{e}+\\ket{(12)}-\\ket{(13)}-\\ket{(321)} \\tag{2.11}$$Thus$$\\begin{aligned} e\\ket{\\nu_1}\u0026amp;=\\ket{\\nu_1} \\\\ (12)\\ket{\\nu_1}\u0026amp;=\\ket{(12)}+\\ket{e}-\\ket{(321)}-\\ket{(13)}\u0026amp;=\\ket{\\nu_1}\\\\ (23)\\ket{\\nu_1}\u0026amp;=\\ket{(23)}+\\ket{(321)}-\\ket{(123)}-\\ket{(12)}\u0026amp;=\\ket{\\nu_2}\\\\ (13)\\ket{\\nu_1}\u0026amp;=\\ket{(13)}+\\ket{(123)}-\\ket{e}-\\ket{(23)}\u0026amp;=-\\ket{\\nu_1}-\\ket{\\nu_2}\\\\ (123)\\ket{\\nu_1}\u0026amp;=\\ket{(123)}+\\ket{(13)}-\\ket{(23)}-\\ket{e}\u0026amp;=-\\ket{\\nu_1}-\\ket{\\nu_2}\\\\ (321)\\ket{\\nu_1}\u0026amp;=\\ket{(321)}+\\ket{(23)}-\\ket{(12)}-\\ket{(123)}\u0026amp;=\\ket{\\nu_2}\\\\ e\\ket{\\nu_2}\u0026amp;=\\ket{\\nu_2}\\\\ (12)\\ket{\\nu_2}\u0026amp;=\\ket{(123)}+\\ket{(13)}-\\ket{(23)}-\\ket{e}\u0026amp;=-\\ket{\\nu_1}-\\ket{\\nu_2}\\\\ (23)\\ket{\\nu_2}\u0026amp;=\\ket{e}+\\ket{(12)}-\\ket{(13)}-\\ket{(321)}\u0026amp;=\\ket{\\nu_1}\\\\ (13)\\ket{\\nu_2}\u0026amp;=\\ket{(321)}+\\ket{(23)}-\\ket{(12)}-\\ket{(123)}\u0026amp;=\\ket{\\nu_2}\\\\ (123)\\ket{\\nu_2}\u0026amp;=\\ket{(12)}+\\ket{e}-\\ket{(321)}-\\ket{(13)}\u0026amp;=\\ket{\\nu_1}\\\\ (321)\\ket{\\nu_2}\u0026amp;=\\ket{(13)}+\\ket{(123)}-\\ket{e}-\\ket{(23)}\u0026amp;=-\\ket{\\nu_1}-\\ket{\\nu_2} \\end{aligned} \\tag{2.12}$$So $$\\begin{aligned} D(e) \u0026amp;= \\begin{pmatrix} 1 \u0026amp; 0 \\\\ 0 \u0026amp; 1 \\end{pmatrix} \\\\ D(12) \u0026amp;= \\begin{pmatrix} 1 \u0026amp; -1 \\\\ 0 \u0026amp; -1 \\end{pmatrix}, D(23) = \\begin{pmatrix} 0 \u0026amp; 1 \\\\ 1 \u0026amp; 0 \\end{pmatrix}, D(13) = \\begin{pmatrix} -1 \u0026amp; 0 \\\\ -1 \u0026amp; 1 \\end{pmatrix} \\\\ D(123) \u0026amp;= \\begin{pmatrix} -1 \u0026amp; 1 \\\\ -1 \u0026amp; 0 \\end{pmatrix}, D(321) = \\begin{pmatrix} 0 \u0026amp; -1 \\\\ 1 \u0026amp; -1 \\end{pmatrix} \\\\ \\end{aligned} \\tag{2.13}$$\u003c/p\u003e\n\u003ch2 id=\"3-matrix-multiplication--identity-matrix\"\u003e§3 Matrix Multiplication \u0026amp; Identity Matrix\u003c/h2\u003e\n\u003cp\u003eLet\u0026rsquo;s say we multiply two matrices $A$ and $B$ to get matrix $C$: $$C=AB \\tag{3.1}$$, then (note that the superscript is for row, and the subscript is for column) $$\\begin{pmatrix} C^1_1 \u0026amp; C^1_2 \\\\ C^2_1 \u0026amp; C^2_2 \\end{pmatrix} = \\begin{pmatrix} A^1_1 \u0026amp; A^1_2 \\\\ A^2_1 \u0026amp; A^2_2 \\end{pmatrix} \\begin{pmatrix} B^1_1 \u0026amp; B^1_2 \\\\ B^2_1 \u0026amp; B^2_2 \\end{pmatrix} \\tag{3.2}$$\n, then $$C^1_1 = A^1_1 B^1_2 + A^1_2 B^2_2 \\tag{3.3}$$\n, which can be generalized to matrices with any shape $C^i_j = (AB)^i_j = \\sum_\\alpha A^i_\\alpha B^\\alpha_j$ or, in Einstein notation: $$C^i_j = (AB)^i_j = A^i_\\alpha B^\\alpha_j \\tag{3.4}$$\u003c/p\u003e\n\u003cp\u003eFor identity matrix $\\mathbb{I}$: $$\\mathbb{I}^i_j = \\delta^i_j \\tag{3.5}$$\u003c/p\u003e\n\u003cp\u003eSo when we multiply two matrices $A$ and $B$ to get an identity matrix $\\mathbb{I}$: $$AB = \\mathbb{I} \\tag{3.6}$$, it means that: $$(AB)^i_j = A^i_\\alpha B^\\alpha_j = \\delta^i_j \\tag{3.7}$$, and in U(n) groups we have $$U^{\\dagger} U = \\mathbb{I} \\tag{3.8}$$\u003c/p\u003e\n\u003ch2 id=\"4-irr-rep-of-so3-lie-algebra\"\u003e§4 Irr. Rep. of SO(3) Lie Algebra\u003c/h2\u003e\n\u003ch3 id=\"41-j12\"\u003e§4.1 j=1/2\u003c/h3\u003e\n\u003cp\u003eWhen $j = \\frac{1}{2}$, $\\frac{3}{2}$, $\\frac{5}{2}$, …, it\u0026rsquo;s a double-valued representation. Let\u0026rsquo;s take $j=\\frac{1}{2}$ for example.\u003c/p\u003e\n\u003cp\u003eDefine $$\\ket{\\frac{1}{2},\\frac{1}{2}}=\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\ket{\\frac{1}{2},-\\frac{1}{2}}=\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\tag{4.1.1}$$According to $$\\begin{aligned} J_3 \\ket{j,m} \u0026amp;= m \\ket{j,m} \\\\ J_{\\pm} \\ket{j,m} \u0026amp;= \\sqrt{j(j+1)-m(m \\pm 1)} \\ket{j,m \\pm 1}\\end{aligned} \\tag{4.1.2}$$we have $$J_3=\\begin{pmatrix} \\frac{1}{2} \u0026amp; 0 \\\\ 0 \u0026amp; -\\frac{1}{2} \\end{pmatrix}, J_+=\\begin{pmatrix} 0 \u0026amp; 1 \\\\ 0 \u0026amp; 0 \\end{pmatrix}, J_-=\\begin{pmatrix} 0 \u0026amp; 0 \\\\ 1 \u0026amp; 0 \\end{pmatrix} \\tag{4.1.3}$$According to $$J_{\\pm}=J_1 \\pm i J_2 \\tag{4.1.4}$$we have $$J_1=\\begin{pmatrix} 0 \u0026amp; \\frac{1}{2} \\\\ \\frac{1}{2} \u0026amp; 0 \\end{pmatrix}, J_2=\\begin{pmatrix} 0 \u0026amp; -\\frac{i}{2} \\\\ \\frac{i}{2} \u0026amp; 0 \\end{pmatrix}, J_3=\\begin{pmatrix} \\frac{1}{2} \u0026amp; 0 \\\\ 0 \u0026amp; -\\frac{1}{2} \\end{pmatrix} \\tag{4.1.5}$$According to $$J_k=\\frac{\\sigma_k}{2}, k=1,2,3 \\tag{4.1.6}$$we have $$\\sigma_1=\\begin{pmatrix} 0 \u0026amp; 1 \\\\ 1 \u0026amp; 0 \\end{pmatrix}, \\sigma_2=\\begin{pmatrix} 0 \u0026amp; -i \\\\ i \u0026amp; 0 \\end{pmatrix}, \\sigma_3=\\begin{pmatrix} 1 \u0026amp; 0 \\\\ 0 \u0026amp; 1 \\end{pmatrix} \\tag{4.1.7}$$So $$\\begin{aligned} d^{\\frac{1}{2}}(\\beta) \u0026amp;=e^{-i \\beta J_2} \\\\ \u0026amp;= e^{-\\frac{i \\beta \\sigma_2}{2}} \\\\ \u0026amp;=E+(-\\frac{i \\beta}{2})\\sigma_2+\\frac{1}{2!}(-\\frac{i \\beta}{2})^{2}\\sigma_2^2+\\frac{1}{3!}(-\\frac{i \\beta}{2})^{3}\\sigma_2^3+ \\cdots \\\\ \u0026amp;=E\\cos{\\frac{\\beta}{2}}-i \\sigma_2 \\sin{\\frac{\\beta}{2}} \\\\ \u0026amp;= \\begin{pmatrix} \\cos{\\frac{\\beta}{2}} \u0026amp; -\\sin{\\frac{\\beta}{2}} \\\\ \\sin{\\frac{\\beta}{2}} \u0026amp; \\cos{\\frac{\\beta}{2}} \\end{pmatrix}\\end{aligned} \\tag{4.1.8}$$So $$D^{\\frac{1}{2}}(\\alpha, \\beta, \\gamma)=\\begin{pmatrix} e^{-\\frac{i\\alpha}{2}}\\cos{\\frac{\\beta}{2}}e^{-\\frac{i\\gamma}{2}} \u0026amp; -e^{-\\frac{i\\alpha}{2}}\\sin{\\frac{\\beta}{2}}e^{\\frac{i\\gamma}{2}} \\\\ e^{\\frac{i\\alpha}{2}}\\sin{\\frac{\\beta}{2}}e^{-\\frac{i\\gamma}{2}} \u0026amp; e^{\\frac{i\\alpha}{2}}\\cos{\\frac{\\beta}{2}}e^{\\frac{i\\gamma}{2}}\\end{pmatrix} \\tag{4.1.9}$$So $$\\begin{aligned} D[R_n(2n \\pi)] \u0026amp;= D[R] e^{in \\pi \\sigma_2} D[R]^{-1} \\\\ \u0026amp;= D[R] (-E)^n D[R]^{-1} \\\\ \u0026amp;=(-1)^n E \\end{aligned} \\tag{4.1.10}$$Thus it\u0026rsquo;s a double-valued representation.\u003c/p\u003e\n\u003ch3 id=\"42-j1\"\u003e§4.2 j=1\u003c/h3\u003e\n\u003cp\u003eWhen $j = 0$, $1$, $2$, …, it\u0026rsquo;s a irreducible representation. Let\u0026rsquo;s take $j=1$ for example.\u003c/p\u003e\n\u003cp\u003e$$J_3=\\begin{pmatrix} 1 \u0026amp; 0 \u0026amp; 0 \\\\ 0 \u0026amp; 0 \u0026amp; 0 \\\\ 0 \u0026amp; 0 \u0026amp; -1 \\end{pmatrix}, J_+=\\begin{pmatrix} 0 \u0026amp; \\sqrt{2} \u0026amp; 0 \\\\ 0 \u0026amp; 0 \u0026amp; \\sqrt{2} \\\\ 0 \u0026amp; 0 \u0026amp; 0 \\end{pmatrix}, J_-=\\begin{pmatrix} 0 \u0026amp; 0 \u0026amp; 0 \\\\ \\sqrt{2} \u0026amp; 0 \u0026amp; 0 \\\\ 0 \u0026amp; \\sqrt{2} \u0026amp; 0 \\end{pmatrix} \\tag{4.2.1}$$And$$e^{-i \\beta J_2} = e^{\\beta K} =E+\\sin{\\beta} K+(1-\\cos{\\beta})K^2 \\tag{4.2.2}$$\u003c/p\u003e\n\u003cp\u003eThe rest is left as an exercise for the reader.\u003c/p\u003e\n\u003cp\u003eEventually, $$d^1(\\beta)= \\begin{pmatrix} \\frac{1+\\cos{\\beta}}{2} \u0026amp; -\\frac{\\sin{\\beta}}{\\sqrt{2}} \u0026amp; \\frac{1-\\cos{\\beta}}{2} \\\\ \\frac{\\sin{\\beta}}{\\sqrt{2}} \u0026amp; \\cos{\\beta} \u0026amp; -\\frac{\\sin{\\beta}}{\\sqrt{2}} \\\\ \\frac{1-\\cos{\\beta}}{2} \u0026amp; \\frac{\\sin{\\beta}}{\\sqrt{2}} \u0026amp; \\frac{1+\\cos{\\beta}}{2}  \\end{pmatrix} \\tag{4.2.3}$$\u003c/p\u003e\n\u003ch2 id=\"5-clebschgordan-coefficients\"\u003e§5 Clebsch–Gordan Coefficients\u003c/h2\u003e\n\u003cp\u003eIn this section we decompose the direct product of Irr. Rep. of SU(2) into the direct sum of Irr. Rep. Here\u0026rsquo;s an example of $j_1 = \\frac{1}{2}$, $j_2=1$. You can check \u003ca href=\"https://en.wikipedia.org/wiki/Table_of_Clebsch%E2%80%93Gordan_coefficients\"\u003eTable of Clebsch–Gordan coefficients\u003c/a\u003e to make sure it\u0026rsquo;s right.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e$$\\ket{\\frac{3}{2}, \\frac{3}{2}}=\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, 1} \\tag{5.1}$$\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e$$J_-\\ket{\\frac{3}{2}, \\frac{3}{2}}=\\sqrt{\\frac{3}{2}(\\frac{3}{2}+1)-\\frac{3}{2}(\\frac{3}{2}-1)}\\ket{\\frac{3}{2}, \\frac{1}{2}}=\\sqrt{3}\\ket{\\frac{3}{2}, \\frac{1}{2}} \\tag{5.2}$$\n$$\\begin{aligned}J_-(\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, 1})\u0026amp;=(J_-\\ket{\\frac{1}{2}, \\frac{1}{2}})\\otimes\\ket{1, 1}+\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes J_-(\\ket{1, 1}) \\\\ \u0026amp;=\\ket{\\frac{1}{2}, -\\frac{1}{2}} \\otimes \\ket{1, 1}+\\sqrt{2}\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, 0} \\end{aligned} \\tag{5.3}$$\nSo $$\\ket{\\frac{3}{2}, \\frac{1}{2}}=\\sqrt{\\frac{1}{3}}\\ket{\\frac{1}{2}, -\\frac{1}{2}} \\otimes \\ket{1, 1}+\\sqrt{\\frac{2}{3}}\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, 0} \\tag{5.4}$$\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSimilarly, $$\\ket{\\frac{3}{2}, -\\frac{1}{2}}=\\sqrt{\\frac{2}{3}}\\ket{\\frac{1}{2}, -\\frac{1}{2}} \\otimes \\ket{1, 0}+\\sqrt{\\frac{1}{3}}\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, -1} \\tag{5.5}$$\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSimilarly, $$\\ket{\\frac{3}{2}, -\\frac{3}{2}}=\\ket{\\frac{1}{2}, -\\frac{1}{2}} \\otimes \\ket{1, -1} \\tag{5.6}$$\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBecause $\\ket{\\frac{3}{2}, \\frac{1}{2}}$ and $\\ket{\\frac{1}{2}, \\frac{1}{2}}$ are orthogonal, and by normalization, we have $$\\ket{\\frac{1}{2}, \\frac{1}{2}} = \\sqrt{\\frac{2}{3}}\\ket{\\frac{1}{2}, -\\frac{1}{2}} \\otimes \\ket{1, 1}-\\sqrt{\\frac{1}{3}}\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, 0} \\tag{5.7}$$\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSimilarly, $$\\ket{\\frac{1}{2}, -\\frac{1}{2}} = \\sqrt{\\frac{1}{3}}\\ket{\\frac{1}{2}, -\\frac{1}{2}} \\otimes \\ket{1, 0}-\\sqrt{\\frac{2}{3}}\\ket{\\frac{1}{2}, \\frac{1}{2}} \\otimes \\ket{1, -1} \\tag{5.8}$$\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThus complete the Clebsch–Gordan coefficients for $j_1 = \\frac{1}{2}$, $j_2=1$.\u003c/p\u003e\n\u003ch2 id=\"6-box-weight-diagram-of-su3-irr-rep\"\u003e§6 Box-Weight Diagram of SU(3) Irr. Rep.\u003c/h2\u003e\n\u003ch3 id=\"61-box-weight-diagram\"\u003e§6.1 Box-Weight Diagram\u003c/h3\u003e\n\u003cp\u003eWe have $$\\begin{cases} \\vec{\\alpha^1} = (\\frac{1}{2},\\frac{\\sqrt{3}}{2}) \\\\ \\vec{\\alpha^2} = (\\frac{1}{2},-\\frac{\\sqrt{3}}{2}) \\end{cases} \\tag{6.1.1}$$and according to the definition of Cartan matrix $$A_{ij} = \\frac{2 \\vec{\\alpha^i} \\cdot \\vec{\\alpha^j}}{|\\vec{\\alpha^j}|^2} \\tag{6.1.2}$$we have:$$A = \\begin{pmatrix} 2 \u0026amp; -1 \\\\ -1 \u0026amp; 2 \\end{pmatrix} \\tag{6.1.3}$$\u003c/p\u003e\n\u003cp\u003eWhen drawing the box-weight diagram, there are some rules to follow:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWhen minus the number on the left of $\\boxed{x \\space y}$, the $x$,\n\u003col\u003e\n\u003cli\u003eminus the $1^{\\text{st}}$ row of eq. (5.1.3);\u003c/li\u003e\n\u003cli\u003edraw a line down-right from $x$ to the $x\u0026rsquo;$ in the next box;\u003c/li\u003e\n\u003cli\u003euntil it\u0026rsquo;s $-x$.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eWhen minus the number on the right of $\\boxed{x \\space y}$, the $y$,\n\u003col\u003e\n\u003cli\u003eminus the $2^{\\text{nd}}$ row of eq. (5.1.3);\u003c/li\u003e\n\u003cli\u003edraw a line down-left from $y$ to the $y\u0026rsquo;$ in the next box;\u003c/li\u003e\n\u003cli\u003euntil it\u0026rsquo;s $-y$.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eIf you start from $\\boxed{a \\space b}$ on the top, the final result should be $\\boxed{-b \\space -a}$ in the bottom.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFor example, when the highest weight is $3$ and $0$, or $\\boxed{3 \\space 0}$, the box-weight diagram should look like this:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"20230615-group-theory-calculations-highest-weight-3-and-0.jpg\"\r\n  alt=\"20230615-group-theory-calculations-highest-weight-3-and-0\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ch3 id=\"62-all-possible-roots\"\u003e§6.2 All Possible Roots\u003c/h3\u003e\n\u003cp\u003eAccording to $$\\frac{2 \\vec{\\alpha^j} \\cdot \\vec{\\mu^k}}{|\\vec{\\alpha^j}|^2}=\\delta_{jk} \\tag{6.2.1}$$we have $$\\begin{cases} \\vec{\\mu^1}=(\\frac{1}{2}, \\frac{\\sqrt{3}}{6}) \\\\ \\vec{\\mu^2}=(\\frac{1}{2}, -\\frac{\\sqrt{3}}{6}) \\end{cases} \\tag{6.2.2}$$\u003c/p\u003e\n\u003cp\u003eStarting from $3 \\vec{\\mu^1}$, from box-weight diagram, we have $$\\begin{aligned} \u0026amp;3 \\vec{\\mu^1}-\\vec{\\alpha^1}, \\\\ \u0026amp;3 \\vec{\\mu^1}-\\vec{\\alpha^1}-\\vec{\\alpha^2}, 3 \\vec{\\mu^1}-2\\vec{\\alpha^1}, \\\\ \u0026amp;3 \\vec{\\mu^1}-2\\vec{\\alpha^1}-\\vec{\\alpha^2}, 3 \\vec{\\mu^1}-3\\vec{\\alpha^1}, \\\\ \u0026amp;3 \\vec{\\mu^1}-2\\vec{\\alpha^1}-2\\vec{\\alpha^2}, 3 \\vec{\\mu^1}-3\\vec{\\alpha^1}-\\vec{\\alpha^2}, \\\\ \u0026amp; 3 \\vec{\\mu^1}-3\\vec{\\alpha^1}-2\\vec{\\alpha^2}, \\\\ \u0026amp;3 \\vec{\\mu^1}-3\\vec{\\alpha^1}-3\\vec{\\alpha^2} \\end{aligned} \\tag{6.2.3}$$\n(Or you can do it more easily by using the fact that the figure below is symmetric with respect to $H_2$ axis.)\u003c/p\u003e\n\u003cp\u003eDrawing on the $H_1 - H_2$ plane, we have:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"20230615-group-theory-calculations-highest-weight-3-and-0-H_1-H_2.png\"\r\n  alt=\"20230615-group-theory-calculations-highest-weight-3-and-0-H_1-H_2\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230615-group-theory-calculations/",
      "date_published": "15066-15-09T60:1515:00+00:00",
      "date_modified": "15066-15-09T60:1515:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "b1a28ac362f673423932feccaae4cef2f8dc7699",
      "title": "Machine Learning Notes: Attention Please",
      "summary": "",
      "content_text": "(Please refer to Wow It Fits! — Secondhand Machine Learning.)\nThis is my notes from [1706.03762] Attention Is All You Need and The Annotated Transformer and The Illustrated Transformer. This is an outline, I\u0026rsquo;m trying to keep it as simple as possible. You can import these layers and blocks from torch.nn, see Transformer Layers. And I will focus more on structure rather than code itself, because building this model on torch.nn is much simpler, see Language Modeling with nn.Transformer and torchtext.\nIn this work we propose the Transformer, a model architecture eschewing recurrence and instead relying entirely on an attention mechanism to draw global dependencies between input and output \u0026hellip; the Transformer is the first transduction model relying entirely on self-attention to compute representations of its input and output without using sequence-aligned RNNs or convolution.\nRecurrent neural networks (RNN), long short-term memory networks (LSTM) and gated RNNs have these shortages:\nThey handle sequence word-by-word, which is hard to be parallelized. They are easy to forget a long sequence or mix previous content up with following content. Attention mechanism has been used before, but Transformer is a pure attention architecture, that\u0026rsquo;s why \u0026ldquo;Attention is All You Need\u0026rdquo;.\n§1 Self-Attention $$\\text{Attention}(Q, K, V) = \\text{Softmax}(\\frac{QK^\\top}{\\sqrt{d_{k}}})V \\tag{1}$$where for a vector $\\vec{z_i}$, $$\\text{Softmax}(\\vec{z_i}) = \\frac{e^{\\vec{z_i}}}{\\sum_{i=0}^N e^{\\vec{z_i}}} \\tag{2}$$\nFor input $X$, to get $Q$ (Query), $K$ (Key), $V$ (Value), $$\\begin{aligned} Q \u0026amp;= XW^Q \\\\ K \u0026amp;= XW^K \\\\ V \u0026amp;= XW^V \\end{aligned} \\tag{3}$$where $W^Q$, $W^K$, $W^V$ are training parameters.\n§2 Multi-Head Attention For the same input $X$, define different $W^Q_i$, $W^K_i$, $W^V_i$, we will get different $$\\text{head}_i = \\text{Attention} (QW^Q_i, KW^K_i, VW^V_i) \\tag{4}$$$i =1, \\cdots, h$. And concat them together, multiply with training parameter $W^0$, we will get $$\\text{MultiHead} (Q, K, V) = \\text{Concat}(\\text{head}_1, \\cdots, \\text{head}_h) W^0 \\tag{5}$$see this picture:\nThis is the explanation for Figure 2 in Attention Is All You Need.\nAttention is Encoder-Decoder structure:\nFor a sentence with different $pos$ (up to $seq_{length}$, the maximum length of a sentence), and $j \\in [0,d_{model}]$, where $d_{model}$ is the length of the representation vector (in this case $4$, see the picture below). The Positional Embedding is $$\\begin{aligned} PE_{(pos, 2j)} \u0026amp;= \\sin(\\frac{pos}{ 10000^{2j/{d_{model}}}}) \\\\ PE_{(pos, 2j + 1)} \u0026amp;= \\cos(\\frac{pos}{10000^{2j/{d_{model}}}}) \\end{aligned} \\tag{6}$$Embedding is representation of discrete variables (in this case words or sub-words) by continuous (at least more continuous) vectors. Using $\\sin$ and $\\cos$ fits with Add \u0026amp; Norm layer where the inputs are normalized to $1$.\nThe Encoder will add the Embedding and Positional Embedding to get the input $X$, see picture below:\n§3 Transformer The structure of the full Transformer is:\n§3.1 Add \u0026amp; Norm Add is similar to residual connections in ResNet. By introducing \u0026ldquo;shortcut\u0026rdquo; or \u0026ldquo;identity mapping\u0026rdquo;, the transformed input is added together with input. Norm is normalization layer. §3.2 Feed Forward Composed of two Linear Layers and an activation function. The $1^\\text{st}$ layer is $$\\text{Linear}(X) = XW_1+b_1 \\tag{7}$$ Then is activation function ReLU$$\\text{ReLU}(x)=\\max{(0,x)} \\tag{8}$$ The $2^\\text{nd}$ layer is $$\\text{Linear}(X) = XW_2+b_2 \\tag{9}$$ So that we will get $$\\text{FFN}(X)=(\\max{(0,XW_1+b_1)})W_2+b_2 \\tag{10}$$The output of Feed Forward will have the same dimension with input $X$ due to the selection of hyper-parameters. ",
      "content_html": "\u003cp\u003e(Please refer to \u003ca href=\"https://chenlinear.github.io/posts/20231011-wow-it-fits-secondhand-machine-learning/\"\u003e\u003cem\u003eWow It Fits! — Secondhand Machine Learning\u003c/em\u003e\u003c/a\u003e.)\u003c/p\u003e\n\u003cp\u003eThis is my notes from \u003ca href=\"https://arxiv.org/abs/1706.03762\"\u003e[1706.03762] \u003cem\u003eAttention Is All You Need\u003c/em\u003e\u003c/a\u003e and \u003ca href=\"http://nlp.seas.harvard.edu/annotated-transformer/\"\u003e\u003cem\u003eThe Annotated Transformer\u003c/em\u003e\u003c/a\u003e and \u003ca href=\"http://jalammar.github.io/illustrated-transformer/\"\u003e\u003cem\u003eThe Illustrated Transformer\u003c/em\u003e\u003c/a\u003e. This is an outline, I\u0026rsquo;m trying to keep it as simple as possible. You can import these layers and blocks from \u003ccode\u003etorch.nn\u003c/code\u003e, see \u003ca href=\"https://pytorch.org/docs/stable/nn.html#transformer-layers\"\u003e\u003cem\u003eTransformer Layers\u003c/em\u003e\u003c/a\u003e. And I will focus more on structure rather than code itself, because building this model on \u003ccode\u003etorch.nn\u003c/code\u003e is much simpler, see \u003ca href=\"https://pytorch.org/tutorials/beginner/transformer_tutorial.html\"\u003e\u003cem\u003eLanguage Modeling with nn.Transformer and torchtext\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIn this work we propose the Transformer, a model architecture eschewing recurrence and instead relying entirely on an attention mechanism to draw global dependencies between input and output \u0026hellip; the Transformer is the first transduction model relying entirely on self-attention to compute representations of its input and output without using sequence-aligned RNNs or convolution.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eRecurrent neural networks (RNN), long short-term memory networks (LSTM) and gated RNNs have these shortages:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThey handle sequence word-by-word, which is hard to be parallelized.\u003c/li\u003e\n\u003cli\u003eThey are easy to forget a long sequence or mix previous content up with following content.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eAttention mechanism has been used before, but Transformer is a pure attention architecture, that\u0026rsquo;s why \u0026ldquo;Attention is \u003cstrong\u003eAll\u003c/strong\u003e You Need\u0026rdquo;.\u003c/p\u003e\n\u003ch2 id=\"1-self-attention\"\u003e§1 Self-Attention\u003c/h2\u003e\n\u003cp\u003e$$\\text{Attention}(Q, K, V) = \\text{Softmax}(\\frac{QK^\\top}{\\sqrt{d_{k}}})V \\tag{1}$$where for a vector $\\vec{z_i}$, $$\\text{Softmax}(\\vec{z_i}) = \\frac{e^{\\vec{z_i}}}{\\sum_{i=0}^N e^{\\vec{z_i}}} \\tag{2}$$\u003c/p\u003e\n\u003cp\u003eFor input $X$, to get $Q$ (Query), $K$ (Key), $V$ (Value), $$\\begin{aligned} Q \u0026amp;= XW^Q \\\\ K \u0026amp;= XW^K \\\\ V \u0026amp;= XW^V \\end{aligned} \\tag{3}$$where $W^Q$, $W^K$, $W^V$ are training parameters.\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"http://jalammar.github.io/images/t/self-attention-matrix-calculation.png\"\r\n  alt=\"self-attention\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ch2 id=\"2-multi-head-attention\"\u003e§2 Multi-Head Attention\u003c/h2\u003e\n\u003cp\u003eFor the same input $X$, define different $W^Q_i$, $W^K_i$, $W^V_i$, we will get different $$\\text{head}_i = \\text{Attention} (QW^Q_i, KW^K_i, VW^V_i) \\tag{4}$$$i =1, \\cdots, h$. And concat them together, multiply with training parameter $W^0$, we will get $$\\text{MultiHead} (Q, K, V) = \\text{Concat}(\\text{head}_1, \\cdots, \\text{head}_h) W^0 \\tag{5}$$see this picture:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"http://jalammar.github.io/images/t/transformer_attention_heads_weight_matrix_o.png\"\r\n  alt=\"multi-head\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eThis is the explanation for Figure 2 in \u003cem\u003eAttention Is All You Need\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eAttention is Encoder-Decoder structure:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"http://jalammar.github.io/images/t/The_transformer_encoder_decoder_stack.png\"\r\n  alt=\"attention\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eFor a sentence with different $pos$ (up to $seq_{length}$, the maximum length of a sentence), and $j \\in [0,d_{model}]$, where $d_{model}$ is the length of the representation vector (in this case $4$, see the picture below). The Positional Embedding is $$\\begin{aligned} PE_{(pos, 2j)} \u0026amp;= \\sin(\\frac{pos}{ 10000^{2j/{d_{model}}}}) \\\\ PE_{(pos, 2j + 1)} \u0026amp;= \\cos(\\frac{pos}{10000^{2j/{d_{model}}}}) \\end{aligned} \\tag{6}$$Embedding is \u003cstrong\u003erepresentation\u003c/strong\u003e of discrete variables (in this case words or sub-words) by continuous (at least more continuous) vectors. Using $\\sin$ and $\\cos$ fits with \u003ccode\u003eAdd \u0026amp; Norm\u003c/code\u003e layer where the inputs are normalized to $1$.\u003c/p\u003e\n\u003cp\u003eThe Encoder will add the Embedding and Positional Embedding to get the input $X$, see picture below:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"http://jalammar.github.io/images/t/transformer_positional_encoding_example.png\"\r\n  alt=\"input\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ch2 id=\"3-transformer\"\u003e§3 Transformer\u003c/h2\u003e\n\u003cp\u003eThe structure of the full Transformer is:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXwAAAIwCAYAAACFldBAAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP\u0026#43;gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4gQEDx8hZ9V4QwAAgABJREFUeNrsnXV8XMe5v585yytmsiRLssDMzLETcxxmbhpokkLappD\u0026#43;2qa3t2mbe285haTBhtkMMcfMjJJsCy3m1Wp3z/n9cXYFtuwYZGklz5PPxtoDc\u0026#43;ac3f3OO\u0026#43;\u0026#43;88w5IJBKJ5JpAdHUFJBLJJaMAIUCY930lUA2oXV0xiX8jBV8i6V5EAncDU4Ag77YaYB3wLlB\u0026#43;CWVlojcSxzuwfkZgEFAAnOniZyU5C0NXV0AikVw0UcCvgcHAe8DbwHKgFLgZGAFsBRousrzHgQxgUwfW0Q78HKgATnT1A5O0xdjVFZBIJBeFAO4FegHfAbJb7TsI7Ab\u0026#43;BNwD/AXdmDMAzrPKMAMe77/BQBMQADR6j1fRXUYxgAUoQ3cXad4yzN6/Xa3KVbzbXUCg9xXkPb\u0026#43;p1bmSLkZa\u0026#43;BJJ9yAG\u0026#43;AG6Vb\u0026#43;hnf0V6MJ6M7rVPwaYCuylxbcfCDztfT8fuBFIAeKAHGAmupvnOmAuMA64AV20c9D14iF0t1Jr6z0FeBS9Z/ENYDKQCIQCB2jbOEi6EGnhSyTdg1TACmy/wDHbgW8CyUASuuun9TidGb0h2AN8BKShi/Eb6G6hIcBI4N/oLqMmYBLwLfQGZTe6f/5s3QgFxgIfAv8B\u0026#43;gKLgUXoPQeJnyAFXyLpHoQBDvQB2vNR7T0mHN2Kby9qRwXcQD66yLvQrXcFMAGFwCe0jAMsBIai9wj2e88/20Wjebc7gGJvHfPRB24lfoTS1RWQSCQXRRO6S\u0026#43;VCRprJu7\u0026#43;J80fgtRZrcdZxHmAfbQd9VXS3UCr6gOzF\u0026#43;uNlBKAfIgVfIukeFKC7dJIucEwy\u0026#43;kBpIe0LrkD/zZ9PtDXaDvL6aER3B51vzE9BCny3QAq\u0026#43;RNI9OIUemTMf3ZI/GxP6IOxx77EaurXf\u0026#43;jceiO7uaU1r8TegNxpnC3s8uruosdW1WhPJuda/jMzxQ6TgSyTdgwb0wdUJ6JEyobS4ZELRo2PGeY9pAkrQhTq0VRnj0MM6fb59Db3XQKv344D\u0026#43;rbZFoU/y2gzUofv9\u0026#43;6Bb/KD3KCajNya\u0026#43;MoR3u8TPkGGZEkn3IQ99Ju0D6OGSQ4FpwIPo0TN/Alaji24NuhAPQ4\u0026#43;zn4Aecgn6RKvT6KGes4EI7/sR6GKdhh6qmeEtux54Bb3RcQC3AAnolv0N6APKCrDUe90B6I2EGT18093VD06iI/1uEkn3QqC7XcajW9qgi\u0026#43;pGWlw5PnoD09HdOKe8x0SiR9CUobthRqA3CNuAH6GPFaxCbyCC0d1Ia9DDMkEX9iHARHSX0UH0MM9e6DH3jd5rjEBvHDaj9zgkEolE4icYgJeAb3d1RSRXD\u0026#43;nDl0gkPpqQs2IlEomkxyPQB2tTu7oiEolEIpFIJBKJRCKRSCQSiaQZGZYpkVx9zOhZKCNbbRPoaQyOA7noeWwuhxAgnZaQyKtVRgh6XP4\u0026#43;732EA4e82xq99\u0026#43;DLi\u0026#43;9EDw/1nbP/CuomkUgk3Yoo9ElJX6IvQ/ie97UQPcb9fi5/EuRg4H30WbWXy8WUMQh4B4gG7kSf5GUHXkBfOQvv\u0026#43;f8PfUJX63PirtqTlVwSMj2yRHL1UdAt\u0026#43;L8Aa2kRdwt6bpzH0DNS7ruMsg2AjSvrrV9MGQXoaRtq0K14K3qKhsXoM3FBn8A1Fj0n/tnnSPwAKfgSSeegoacmaJ16uBb4FD3pWSZ6/psQdKEcgD5TdR96PpzJ6CkPGtEXOtmNHjPvy0UfjD4DNtN7jU3oLhpf3pwQ9Nmx6egNUDZ641N1kWW40Gfb\u0026#43;lxPvhm9vqRqyegrZUUD16PP6s0/6xwTMBx9Fq4ZOIy\u0026#43;eledd38s\u0026#43;gzfZG\u0026#43;ZW733ebnuLslZyIlXEknXYka39J3oYvct4HngF\u0026#43;h\u0026#43;/wTgl\u0026#43;jLFRag56X5LnAfukWuoScuexw9b04euvX9M3ThBd16/z56w3IGPX3yHPRZtcaLLCMF\u0026#43;CF63hyf2Cvo7qiZ6I1SmrecdHS3TmqrcwRwF/AseuNxBrgVfX1eK3pD8TN0N9BJ7zP5BXpqCEkHIS18iaRzUNDFOwXdhaKhW9R3efftRhf8aehW/1NAkfdfC/AToNJb1j50cdyLLp6JwDrgf2gZHC1EX2d2F/ogax/0huOYd/9h4L/R/e6eiyhDoDccZxuJvgZrL3qPpD/wd/RVtIZ5zwG913An8L/o4xYAXwG/R\u0026#43;954K3DC\u0026#43;gZOYW3HqPQc/vIBGwdgBR8ieTqo6H7t59Fzz7p85Ur6Jbur9GtagO6W\u0026#43;df6O6QcPQ1aP9Ni9iD7tI5gZ6RcpV33xLaRsKsAe5Gdw1tQ7eW89Gt7QB0AfblsRdfU0Y/7/5LzXGvtXqNRnfvHEDvBQj0BG4H0QV/CXrWzlvQF2EvAd7y1k\u0026#43;6dDoIKfgSydVHoPvE/w1socVKdqMLW22r43LQhRD0HoANPXVxa9zobo8EdAu7DN0qbk09un89Ft3yTgOeRm9EBLobxUxL/vryrymjkstHeMvIQndX\u0026#43;dDQezyH0EM3XwZuA27y1mUn8AFyMZUOQwq\u0026#43;RNI5eNCt\u0026#43;ONfc5ybFoHzDcra2jkuAN3vr6K7VM5ehcoXE\u0026#43;9AdxP9CFiAHg5aiG7p/56WxudCZbS37OGl4kQX9X956\u0026#43;zr5RjQo3hcwIfAMvS0zoPQrf1UdHdWw6VdTtIeUvAlEv\u0026#43;lAihG92PvaLU9HN1V8zl6hss47/ucVsckog\u0026#43;k5gJz0a3lP9EStdMLvQehel\u0026#43;xFygjm0sL8NDaeX8cPWTzDHpvAm\u0026#43;Z96A3SgBB6G6cXd7XUeBX6K6n00iuGBmlI5F0Dhez0LdvkXEfDuBj9CiYG9BDK2PR4/ab0P33Crr1fAt6uGMQeljjY\u0026#43;iDu4fRLfoU9IHbIHRhvxG95\u0026#43;BbrrDxAmUc8V7H0E49W9\u0026#43;XE72XMISWVbB8ry3e/Y\u0026#43;hR/AEo/c87kJ3a9WhD\u0026#43;r6Fl6JRA/hzEfG8XcY0sKXSK4\u0026#43;TvSB0/KvOS4fXWDVVtu\u0026#43;RHe33Iou0kZ0v/pv0P3cweh\u0026#43;7lPoIZICfaDzNPqyhE3AInQf/vPec5uAlei\u0026#43;/5HAF94yTp\u0026#43;nDBe66G7z3ks\u0026#43;elSOB93/7htzKEZvoGaji/y\u0026#43;VueUA79Fj/p5Ad11ZUWfmLUJvaFIAB5GHzvwpZ74I/pcAUkHIHPpSCRXH98gaRMXjjgx0WKxn31\u0026#43;GHqKhib0cE1fNI3Pz97U6hiH95jWSwta0F0/FvSGohK98fD56I1fU0Zrf77B\u0026#43;3J6y/NNzMK73Y4u6E3ee/Ll1sG7L9a7vQzdbdU6rj/C\u0026#43;3KiW/6\u0026#43;WbwSiUQikUgkEonkYlDQrXTJNYActJVIrm0y0CdXma60IIlEIpH4N99Fn7kr17KVSCSSHkwkerROE/CNrq6MRCKRSK4es2mJklmAHucvkUgkkh6GBfgnLcnNStDz2UskEomkhzEIPeNm64yWf0ROxuzRyCgdieTaQ6CnNahCT7ugoic2G4ieakEikUgkPQQrem6e4bQsLvIdYBJ67ntJD0V23ySSaw8nsAJ9kNaXD98BrEf2\u0026#43;ns08sOVSK49fLlr2sulpV5KQZLuhRR8iUQiuUaQgi\u0026#43;RSCTXCFLwJRKJ5BpBCr5EIpFcI0jBl0gkkmsEGZYpkVw9/HlFOV84Zneqs6/ekstECr5E0rH4FvGeAER3dWW\u0026#43;Biv6zFoB3Az0xn8FX6Bn9TwMrEVfflEikUi6DAvwNJCLvnatJl8d/moAFqPnApJcIv7amksk3ZF5wKuKQYlOTU8lNT0Ns8WC9EJ0DBVlFRzad4iqikqAT4HHgPKurld3Qrp0JJKOwQLcAkQPGz2c537zYxJ790IoHRsXIUSLjaZpV9CQnM\u0026#43;D78c0OZtY/tky/vRff6Cutm4KMBT4sqvr1Z2Qgi\u0026#43;RdAxWoJeiKEyYPpH0fumoqoqGhrhCZfWVoakaVRVV1NfXY7fbCQ0PxWA0oGrqBa/hO9/jduP2qJjNJhSDgqZqHVK/zkBDw2w1M2nGZD77z6cc2ncwEEju6np1N6TgSyQdgwCEoijY7XY0TWu2wLUrdOkIIaivrefLL1Zw4kg2quYBTRAdF83s2\u0026#43;cQFRt1QWtfCMGZwjMs\u0026#43;mABgcHBzLxlJpVlFcQnJ2Ayma64fp2FpmqYTCZsdpvveRu6uk7dDRmHL5F0MFfkajkPa5as4VTOae765t08\u0026#43;eOnuO/J\u0026#43;3A0OHj/1fdodDQ2u3oURcFgMKAYlDbbtq3fiurRmDJrCo56BwvfW4ij3oGi6McJIVrO9bqhhBDNZbXuBAghUAyGNsf6trfGV26HP98OL/HaQVr4Eok/I8DV5CL78AlGTxlDcp9k3C43wSHB3HL/LXzy5ifUVtdis9vweDyczjlN4ekCQsJCSElPxRZgo7y0nOyj2UTFRGE0GcnPzaespIyCUwVYrBZUVQUNykrKKDxdQGxCHEmpSZSWlHLyRC6BQYGkZfXBYrUAUFNVQ86xHBrq6\u0026#43;mV1ItevRNxuVzU1dQRGhHa3IjUVteiaRpBIUFd/RQlXqTgSyT\u0026#43;jAaKQcEWYGPP1t2k90snNDwUYRZEx8fwwNMPYrFZcLlcfPn5SvZs30NkTAT1tQ1YrRZufeh29mzbze6tuwgMDMTj9lBUUMTRg0dY8P7n3PHIXZw\u0026#43;cZrDew9htppRVZXlny0jc0AWTY1NeFQ3hXlFZPTL4JYHb6WsuIyP3/wIRVEwmgysWbSG6\u0026#43;ZcR9bALN7953\u0026#43;YcP0kho8fTnlJOe//6z1GTxnDsLHDrkqvR3LpSMGXSPwcg8HAzFtm8uFrH/CHX/wvUbHRpGSk0HdQP1IyUjCbzezfsY8dG7dz/1MPkpSWhKPewXuvvMuqhV9y0303c\u0026#43;LICaJjopl75zwKTuWjulXuf/JB4pPi2bVxJ2Vnynj6Z88QHhXOis\u0026#43;X8\u0026#43;lbn/DD3/yItKw0co7m8J\u0026#43;/v01leSX7d\u0026#43;wjKiaKWx68FbPFzMaVX7Fl7WaGjx/BqImjWfbJEiKjI9iwYgNWu5X\u0026#43;Q/t39eOTtEIKvkTSDeidnsJTzz9DXs5pso9kk30km02rNtJ/6ABuf/gODuw6QObALHpn9Eb1qAQGBzJpxmQ\u0026#43;eeNjXE0uLFYLVpsVe4AdW4Adk9mMPdCOwWjAYDQwYNgAIqIjAIhNiCO9XwYJyQkAhEeGg4D62nqGjR1OU1MTJUUlOOoc5OXmUVlRicfjYeSkURTlF/HHX/6B\u0026#43;KQEHv7OI1hsFjRVWvf\u0026#43;ghR8icSPEULQUNdAwekCUtJTyByURdagvrhdbk5ln\u0026#43;KV//0Xu7fupq62jsSUxOYQS1VTCQ4JxmAw0ORsAk0fTNbQvKOeGpp37qqiKFisljbROja7DUUoaL7/vC6Z0jOlbFq1kYCgAMIjwxFCwWgyoWkaRpORPn3T\u0026#43;eDf7zNk9BDCIsOk2PsZMkpHIvFjhBBUVVTxzt/fpqToDAKBqqoYjAZSMlKI6xVHTWU1kdGRnCk8g6qqzRE3pcUleFQPFtvZs331vxVFnH/yldY2nFQAjQ4HSz9ZTOagLG598DZm3DqTjAEZCKE3GuVnylm5YAW3PHAb\u0026#43;Sfz2bVpZ5soHknXIz8NicSP0TSNiOgIIqIjWfj\u0026#43;QgpOFeCod1BbXcvWtVsoLiimT790Bo8aQu7RHHZt3oWjwUHBqQJWLljJgKEDCAwK0CeBea10xWCgoa6BU9mnaGxo1MW9lSWuaRqq1mppWw1UTUNTNRwNjTQ5nbhcLgpOFrB5zWaqK6upLKtkwXtfEBkTxS3338L0G69nyUeLOZ19\u0026#43;qqEZkouD\u0026#43;nSkUg6GCFEh6Ut0DQNi9XCHd\u0026#43;4k8UfLuLtl9/CYPTaaZpg7h1zSUlPQSiCWbfNZvWiL1m9eBWaqtE7PYWpc69DAxJ7JxEaHoaqqoSGhdJvSD9WfLGMwOBAYnvFYTAqaJo\u0026#43;6zY4JIjktN66da6B0WQkvW864VHhTJ19HV8uWMGOjTuw2WxkDshEUWD98nUIRa\u0026#43;P0WRk2LjhlBSVcHjfIRKSExBKx4m\u0026#43;bD4uH/nsJJKOIQT4UAhxw1M/foZHvvuNDg1FFELgdrupKq\u0026#43;iproGo9FIRHQEAYEBzdcRQlBdWU1FWQX2ADuRMZEYDAY0TcPlcqEIBYNRn5yqelQaGxuxWCzN6RWa96kqHrcHk9kE6I2Oq8mFyWxCCEFFWQU1ldWEhIUSFhlGk7MJt8uFyWzGZDGDpoEAj9uD2\u0026#43;XGbDF3iJWvKArF\u0026#43;cV874HvcOTA4SbgSeC1Tv2UuznSwpdIOgYHkKtpGmuWrWH4uBGkpPfu0FmhAoHFYiEqJgrQBbW6srrtMUIQGR0JQH1NfbMf3jeY2\u0026#43;a9gAZXQ/O5LfsAIXA0ONqU2\u0026#43;hoBMBkMhEZo6dzqK2qAa\u0026#43;YexyNbc/xXsPZ6OyQe29qamLZp0s5lXMSoAbI6cDHe00gLXyJpOOYBrwuhEiM7xVPfFKCHLTsQBrqGsg\u0026#43;nk1DXT3Af9DXHqi\u0026#43;slKvLaTgSyQdhxG4G3gOSKf7JPfqTsmS64ClwC\u0026#43;BY11dme5Gd/mQJZLuggF92cBR6H59f0YDwoAE4BD\u0026#43;nZdMoK8ilgNsBSq7ukISiUTS3ZiDPvDp742TRCKRSK4AC/AvoBS4rqsrI5FIJJKrx0DgBLor5w/IqD2JRCLpsfwQcKML/kEgs6srJJFIJJKOJwZYjy72GtAEPNXVlZJcXWSQsERybTIRyEIXeg09AmYeENnVFZNcPbpLnLBEIuk4LOiDtNuAcCAO\u0026#43;CdwEigBCrq6ghKJRCLpGIzo8fdhwEp06/5R9IYguKsrJ7l6SJeORHLt4UafuNR6hq0CONFz1Eh6KFLwJRKJ5BpBCr5EIpFcI0jBl0gkkmsEKfgSiURyjSAFXyKRSK4RpOBLJNcuvlm2AOqVFCTpHshkSRJJxyLQ88sPRp/U5K9rTmiAHYgGXMAYoBH/NgKb0PPhHwTqu7oy3RF//TJKJN0RBZiLvuLVIMDc1RW6CIy0LC7i71a\u0026#43;BlQAnwG/BfK7ukLdDSn4EknHMQ54A0iPiIwiLi4Bo8HYvDi45Mqor68j7/RJnE6nBz2P/w\u0026#43;Rlv4lIV06EknHYEJfzzY9M6sfP/rJC2T1HYgilKsq\u0026#43;AIBAjQNzl6hUHjtOY1z93UvBEJAQ0M9H77/Fq//\u0026#43;2WD0\u0026#43;m8GXgH2NjVtetOSMGXSDoGG5AuhGDmrPlMnnID4BPiq4emqaiqB4PB55nxIkBTVVRVxWAw0BM68waDwt33PszaNSs4cvhgGPrawVLwLwF/HqCRSLoTCmA0GAyER0SAEKiqiqZdvRcCCgvyePc/r1FXVwtozfsEkH3iKEsWf4bb7b6q9eisl8fjwW4PJCgoxPe8LV39oXc3pOBLJB1N62DHq4gAamqq2L1rO01NTefsNxgMWCwWBCCEQAiBoigYDAYUpe1PX99nOO8\u0026#43;g0HfJ0RLT0FRlOYyzz7n6j5cyeUiXToSSbdGF9yzHTaaphEdE4c9IBCEoKamGqPBSH7\u0026#43;KUpKzpDQK5GkpJRm0W5oqCc7\u0026#43;xi1NdUkJaUQn5DYLO4lZ4rIyTkBQGpaOtHRsXg8HvLyThEaEkppaQmgkZKa3qZBkPgfUvAlkh6IEAonjh9hx/bN3H3vI7z/7us4nY0AeDwqn3/2PnPm3sx102ZRUVHOO2\u0026#43;/Qm1tDQEBQaxcsYgpU2cwecr17Nu7kwVffERwUAgut4tlSz7n/gcfI7l3KosXfoyqatTX1TJq9HhSUvvQE8YKejJS8CWSHogQ0NTkpKamGk3TOJmbTVx8Ao88\u0026#43;jT2gABWrVzCmtUrGDtuMmtXL8dgMPLdZ58nICCQw4f28\u0026#43;EHb5GSksbmTesZP34KU6fNRNM0Xvv339iyeQPJvdMoOVOMzWbn0ce\u0026#43;TVh4RFffsuQikIIvkfRYdL89mkZgUBBjxk4iKCgETdPdL2tWr6Cmppp9e3fRKzGJXTu3oaoePB6VqqpKcnNOMPfG2zAajZw\u0026#43;fZL6\u0026#43;lrOFBcREhKKpmlYrFbGT5xKVHQMbre7q29WchFIwZdIejgaYDSasFqt3jkBGopQUBSBy9VEZWUFmqbhdDpRVX1QNCWlD1HRsWSfOMqBA3sICQkjMjIKk8nkHaDVsFhtBAeHoF7t2FNJhyEFXyLp5ggBwhspo3nFVwiFs8dPtTZ/69JvNpmJjY1j8tTrmTDxOjweDx6Phx3bN1NXV8uK5Yt46OEnSElNx2y2UFFeRmVlJbqvXs4h7m5IwZdIujkNjgYK8k9TV1fbLPhmkwmn09n8XlNV0DSvTOuoHhWL1Ur/AYNZvmwhScmpREREsm/vLpYu\u0026#43;ZwZM\u0026#43;fR0FCPR1VxuZrIPnGUHds3Ex0dS1OTE03VmsuUdA\u0026#43;k4EskHU0nKmBQUDAhIWF88N6bGIz6z1nTNEJCQhgydAQpKX0wGAykpPYhMCgYTdPQNLDZ7GRk9MVgMHLd9FmUlZfyr3/8EbPJjKqqzJo9n6HDRpGbc4I3XnuZoKAQgoKCuG7aTA4d2k9hQV6bMjv14coW5rKRj04i6RhCgI8VRZn\u0026#43;45/\u0026#43;ikcf\u0026#43;7Z3pu1VzKMjBKrqweFw4PF42uxThMBssQJgMplwNTVhMBoxGAy6F99rtZvNFoQQuN1uSs4UUV9fT2RUFGFhetSN2\u0026#43;3mTHEhjkYH0dGxBAUF43A0YDKZ0DQNg8FbZieIvqIolJae4fFH72bvnp1NwFPAq1f9wj0IaeFLJB2DEyhWVZVNG9dxw8x5xMX14urPDBXYbLZ29/g0WFU9zda/x\u0026#43;NuPs9oNKGqekMhhCA2LgEhBJqmNR8nhCAuvpd3u56bx\u0026#43;JtSHy0lHl179PlamLzxnWcOpkD4AAKO\u0026#43;HCPQpp4UskHccdwD9MJlPYoMHDyMzqpyc1k1EsV44QVFdXsW3rRoqLCgGWAw8AJV1dNYlEcm0SAPw/dBHS5OuqvFzAJmB8V3/Y3RFp4UskHYsNmABMBcLw/2xfNm89i7pBXT3AMWApkN0N6ut3SMGXSK4OCv6fjdaD3jDNBV4A6vBvTdC8dZZIJBLJJWIAfg\u0026#43;cAkZ2dWUkVx9/t0AkEsnVozcwA0gCZiP1QCKRSHos3wQa0V0l24DErq6QRCKRSDqeUGARLdEv9cB9XV0piUQikXQ81wOlgIou\u0026#43;CrwMRDU1RWTXD0MXV0BiUTS6ZiAm4Fi9IXAI4GPgAYgBzmDVSKRSHoMZiAFiAVWooc6fhOI8m6T9FBkLh2J5NqjCchF9\u0026#43;P74u4FuotH0oORYVgSiURyjSAtfImk41Hw7xmroA/UGmhr4cO1O67nG7zu0UjBl0iuHAt6DHtfIA2IAaxXVOLVR/PWsQ\u0026#43;62N8GZOL/DdXVQAVqgDz0XD3HgDLv9h7FtfjhSiQdRQB61sZbgYlAL\u0026#43;826SrtnjQB1cBhYAnwGXCCHiT8UvAlkktHAAOAZ4CbgCir1Up8QgJpqWnExsZisVq6uo5fcwOCpqYmvvzySwoLC5g0aRKZmVmoWo/RtotGUzVqamo4ffo0ubk5lJeX49FXdTkE/At4B6jq6np2BNKlI5FcGgZgFvArYEhgUJCYNHEi8\u0026#43;ffxIiRI4mLjcVqtaEoil\u0026#43;bU0IIqquqOXX6FMXFRdxx55088MCD5yyVeE2gabjdbmpra8nOzmbVqlV8seAL49EjRwZ5PJ7fA8OA/wJOdnVVrxQp\u0026#43;BLJxaOgT1h6Cejdv/8Avv3tbzN79mzCw8MBmtd27dyFvS/jRhQFg0FBCL1VUoSCQVGu2dW5jEYjVquVmJgYRo0axW233car//43777zH3t1dfWDQDjwLHo4a7dFCr5EcvFMAn4jhOg9ZcpUXnjhBYYNGwaAqnYvV0hzg3Rt6vs5\u0026#43;J6Hx\u0026#43;NBCEHfvn351QsvkJWZyYsv/sZQXFx8I1CLLvplXV3fy0UOLkkkF0cv4GdA\u0026#43;pixY/n973/PiBEj0DTN7635C\u0026#43;LHbqeuxOPxYLPZePDBB/nZz35GeHi4AtwOPEQ3Dl2VFr5E8vUowL3ApMSkJJ5//mf069fvvP5uRWlxlfgrQgi9nr73isBg6B46pqpqpzSymqZhNBq5\u0026#43;\u0026#43;57yM7O4c9//pPV4/E8BqwCdnf1c7gcpOBLJF9PCnC3wWAw3XfvfUycMOG8gqMB2dnZ7Nmzl6LiQtwud1fXvV2EAEdjI6dPn0bTNFasWEFlRQWq6r\u0026#43;9lcCgQDLSMxgyZAhBQUGdJvpWq5VvPPooX321ge3bt/cB7gT2A/754V4A/zZDJBL/4BHg5YzMTMu7775H36ysdn32qqqyYOFC/uellzhy5AhOpxPpJO84FEUhLCyMWbNm86Mf/5jUlJROGzsRQvDyyy/z/PM/xeVy7UUPxz3Z1c/kUpEWvkRyYSzAZMAyYfwE0lJT27UsFUVh06ZN/L\u0026#43;f/YyTJ3NJ6BVDr4QYhCJtqo5AAA0NjZw4cZp33vkPBoOB3/3udwQGBnaKpS\u0026#43;EYMqUKfTq1Yvc3Nw0YDBS8CWSHkcYkGU2Wxg1ahQWi6Vd331TUxOffPoJJ0/mMnRoX1783dNkZSVzcRa\u0026#43;r1G42GO1KyjnSo8RdE2vReB0unjv3RX89sXXWLJkMffddx/jx4/vlLkDmqaRlJREv379yc3NDQAGAl90wYO4IqTgSyQXJhyICQoKJDU1td0DhBA4HA6ys7MBmDtvEhMnDvJG8Fy4cCHA49HdEgaDcuHjNQ2Pqp53cNUXMaQoSrvXAUFTkwuDwYDRqJzXX\u0026#43;8bFDUaDefUx\u0026#43;PxdNmgtMGgcOed0/n4oy85evQkuSdPMn78\u0026#43;E65tqZp2O12UlJS9AcJyegLybg6/UFcATIsUyK5MEGA1Wq1EhwcfN6DNE1D9agIIQgN01cJVFWtWYTP92pqcvOvf33BG28sweXynPc4IaCgoIy33lxKXZ2j\u0026#43;Zot\u0026#43;wU7th/m8883tHtdp9PFwoUb\u0026#43;dUL/\u0026#43;aPf/yAEycKzinDV862rYf59X\u0026#43;9TlFRBUL4YtQ1GhqcvPH6EnJzipq3d\u0026#43;bL41Gx2S0EBQeiqvrs2LMRQo82uhrhsgaDgbCwMN/bELqhwSwFXyK5MAogfGGMFxSRVp6Qi9EaRVE4dfIMX23Yx8oV2ykoKEM5y\u0026#43;evz4g1YDAYqK6pZ9vWQ7iadKETomXGrMGgkJdXwv792edc22BQ2LHjKMuWbmbmzLGEBAfw5htLcDicnG2oCyHIyzvDf95eyn/eXkZTk6e5d\u0026#43;Byudm69SDlFTXNFr4usG1n7er1Fs2hn76/9fe6IPt6IW3Pv4hPQ2v\u0026#43;X5uIE99zamhoYPPmzSxYuBCHw9HhPZHgkGBfD8tCN9TPbtdCSSRdRUd7rjVNY9Om/UycOJTy8iq2bDlI796xgNbs6snJLqSgsIT4uCg8bg\u0026#43;KQc/Ro7uRmjh2LI/q6lr69EkEbwNwLoLSkkqiokKZNHkIEZEhHPjH5zidLmw2y7l3JgTjxg/l8OFTrFu3m\u0026#43;uvH6lb/4DSStiFEJw5U8GJE3kYjUYyMpIICwvC41E5feoMoWFBlJRUomka8fGRCCEoKakkL6\u0026#43;YhIRoUlLiOHOmkhMn8ggOCiAjMwmr1XTx2R2EbnV7PB4KCwvZvHkzixYtZOfOnTzzzLfbHW/x9QCEEJcRzy9QhP/PsbgQUvAlki5ACEFFRS0HD\u0026#43;by0MOzKS2p4osvNjBnzlgCA224XB4\u0026#43;/mg127YeIio6BJdLRVEU3G596n91dR3/\u0026#43;ucCSkoqCAsLZM3qPdTV1RMcHHBOsLWmqQwdlsH69XtYuXIHe/ecYPjwLIKD7e0KnqZq9O4dx7hxA/nwg1VkZCTRu3fMOfXfsuUgH7y/kpAQO5oGn3yyjocemk2fPr344IM1AFRX1zBx0hAOHTzFgQM5GA0Cl9tFfkEpw4f3o7amHpfLSV5eKUOHZvLQw7MxGC7CcBbgaHCwc9culi9fxrKlSzlw4CD19XWEhISwectmjh49cs79GU0mEnv1YsiQoQwYMIDQ0NBLcP90/xBbKfgSSRegKIK9e48TEGClT58E4uIi\u0026#43;PDDVRw6dJJx4wawa9cxNmzYx3e\u0026#43;ewcZ6b2oqq7jj3/4kMrKGhRFYfnyrVRW1vKjH99PWFgQp04V87Pn/4nZbDpnco2mQXRUGGFhQTz/k7/zwENzuPW2KV5ft3qORa0BqqYxZepQDhzI5q03l/Dcj\u0026#43;71jfx6LftK3vnPcubNG89104bj8ah88sla3n5rGc/96D6Ki8uwWi1893t3EhMTxj///gV5p4v51a\u0026#43;/SXR0GB99uJrXX1vES//7DAMGpHDwwEn\u0026#43;\u0026#43;pePmDN3HPHxEV8zAUwgEBw7dpz1G9azcsUK6uvrm/dWV1fzwfvvX\u0026#43;DZK4SHhzNmzFgefOhBrpt6HRaLpXunyLhIpOBLJF2A0\u0026#43;li3bo99EqIpKREn\u0026#43;EaGRnC2jW7GD26H/v2nmDAwFSyspJQVZXIyBBmzBxNXl4xjY1NHNifw7RpI4iODsXt9pCWlsCUKcPIzy9pcx0hBPX1jbz15jIsFjO33zGN8rJqmprcnMw9RVR0KJGRweeKnaZhMhm5974Z/OLnr7BixTYmTx6mu3UUwaGDudhsFiZNHoLRaMBkMjBr1hi2bD7Iydxi7HYrU6cOIy4uHFXVMBgNjBzVj7i4cECQlBxL/wFppKXFI4QgNi4coUB9XQMQyYWtad0i79evL9/\u0026#43;9jPMuGEGixYtYtu2rZSVlWG325k7dx6xsTHnNBx6NNUJ9u3bx6JFC9m6dQtPPPkkTzz\u0026#43;BCEhIT1e9KXgSySdjD5YW8i\u0026#43;PccoLjrDkSM5AJSVVdNQ30RRUTm1tfVERIQ2D2SqqkZISAA2qwW3y01Dg4PQ0LaTjsIjgikuLkfTmo1xhBCsW7ubgsJSfvSjezEZjfz1r5/w71cXUVZWzd33XE9UVPtCp/veI7j33pm89dYSEhKimweVKytrCA62Yzabms\u0026#43;12y0EBwdQV\u0026#43;fAarUQGtqS/kBRFKw2s69kBBAY4F03gJaU0toluE1MJhOpqakkJyczf/589u7dy5Ili1m3bj3Dhg3jiSeeOGdMQ1VVampq2L1nD6\u0026#43;/9m\u0026#43;WLFnC/7z0Es5GJz/84Q\u0026#43;x2Ww9WvSl4EsknYymaWzYsJex4wby6DdvRB\u0026#43;kFTQ1uXnp9\u0026#43;\u0026#43;wbdshIiJCKS2tQlVpjm4pLa2ivt6B2WwiMNBOSWllc/QLaBQVluNyuc\u0026#43;KdtHIySkkLTWBsLAgVFXl4Ufm8OMfvUxVVS3x8REXFDhV1Rg/YSD795/gzTeWUFvnQCCIjg6nomIPDoeTwEArCEFNdYPeEITYvVdux1d0/reXledFVVVUVSU4OJjJkyczduxYcnJyyMvPp7GxkYCAgDb350vPMH3aNIYMHkxqaiovv/wy//rXP8nIyOCuu\u0026#43;7q4m/H1aXbhRVJJN0ZIQTl5TXs3HmEyVOGERkZQlhYMKGhQcTFRTBh4hC\u0026#43;2rCPjMwkDh/OZfv2wzQ2NnHyZDFLFm\u0026#43;mqcmN2WJi2PBMVizfSk5OEY2NTnbvPs6GDXvPiSARQpCWlsCOHYc5diyfhoZGiovKURQFl8vN0SOnz6mjpmmorRZyMRoV7rr7ehoaGtm75xga0K9/CpoGixdtorbWQVVlLZ98spbIyBCSk2NxnxUdc/bAqKbpg8Ntrqlqlz0uqsfpezAYDGRmZjLtuuuw2\u0026#43;3n7bl4PB4iIiJ49tnvc/vtd1BVVcW//vVP8vLzzxPp1DOQFr5E0tEIzhtT7gtlTEuLp2/fZDyeltBAj0dl9Oi\u0026#43;HD6US0x0GDfOn8h776zgM5sJk8lM3769SUtLQFEE06YNp6iwnD/94QPsAWZsNhszZozRrW00fPayqmpMnDSYnJwC/vh/7xEQaMHjgXk3TiAgwMbOnUfoPyCFkJCAZlGOjQ3H0dDYXGff\u0026#43;MLjT9yE2WwgMNBKWFgQj35zHu/8Zzk7dhwEBIGBATzyyFwCA62kpsQTHKRH72iaRnxCJGaz0XuvguCQAFK9/ntNA5PJSFbf3tjtvvpf4Nl67\u0026#43;18R11sQjVVVQkLC\u0026#43;PxJx7nq682sGfPHtavX899997b1d\u0026#43;gq4YUfImkg9DFS6O\u0026#43;zgGIduO1NU0jPb0Xqam3YLWam8/zERMTzne\u0026#43;ewdms5HEpGhGjMiirKyKiIgQIiNDcbvdmM0mFEXwjUfnUlBQSn29g7i4SIKC7Li9qQ9aExRk44knb6awsJSamnpiosOJig5F02DUqCwsFnOb\u0026#43;o8fP5CxY/u3CY/UNI1hwzLo1\u0026#43;8ZzGYjqqoyYEAqP/3pA\u0026#43;QXlGA0GEjoFYPdbkHVVO68a6o3NYMuy9OmDfOWA6CRmdmLtLQ4zGY9TURwsJ0nnrgJs8XkHYM499kpiu72amho1OPpO8ASV1WVvn37MWXKFF577TU2bdrIHbfdjqnV2ERPQgq\u0026#43;RNIB2Gw2eiX0AmDlyi3MnDWG5OTY1hNDm/FpWX2989yChG6bO51uwE1QUADBwQFomh7ZA9DgaALvwGxUVBjR0eGomtq8v951brlCQGRkGFFR4Xqj5L22EApNTW7v9S5cP992p9ONpunHKwYDvXvHA3pPoK6usflYj6flON\u0026#43;5TU2es67R1Oa\u0026#43;Gxtd7U68EgLcbg/Llm4hO/s0QUGBJPTqdcWfm6ZpWC0Whg0bzhtvvkluTg519XWEmcOuuGx/RAq\u0026#43;RHKFaJqGxWLhxhtvZNmypXy1YRcPP/QCKSkJzVazv\u0026#43;JLm\u0026#43;DPddTrKWhoaGTP7iPU1tZz0003MHjQoA7Jhy\u0026#43;EIDIyErPJRF1dHU6n0\u0026#43;8/t8tFCr5E0gFomsbUqVP58Y9/wp/\u0026#43;9EcOH8rh4IETXV2tHofVamXGjBn86Mc/Jjw8vMMWQPFlIO2JIt8aKfgSSQfgs/IfeeQRho8YwebNmygsKERV1YtLCtbpCJxNTpYuWUJ\u0026#43;fj7XXTeN/v37\u0026#43;a3gaRrY7XaysvoyadJEYmNjO221q56EFHyJpIPQNA2DwcDI4SMYMXy4XwuSno\u0026#43;nmuPHjlNYWMitt93GQw8\u0026#43;2CmLiVxJnX0ZS/352fozUvAlkg7Go/oGJv3StG9bt1b/tEzi8l/8uUHqDkjBl0g6EJ9oqqrq1\u0026#43;Lkq6MQAsVgQEMXU3\u0026#43;vs8/XLi38y0MKvkTSQQghcDqdbN22ja82bKCysrKrq3RBXC4X\u0026#43;Xn52Kw2Pv/sMw7s3\u0026#43;\u0026#43;3PnwAg9FAep90rr/\u0026#43;epKSkvy6rv6KFHyJpAPwrWv793/8nb/99W\u0026#43;cOVPc1VW6JFasWM6KFcu7uhpfi8lkYuzYcfz6179m2LBhUvQvESn4EkkHIIRg5cqV/PEPf6CqupoBw0eR2re/N\u0026#43;d8V9eu\u0026#43;yME1FVXs3vLV6xfv47f/vZFXn7570RGRkrRvwSk4EskV4gQgsbGRhYtWkRFRQVjrruBZ3/7J6ITEru6aj0GIcDjdrNmwSf84afPsmnjRvbt28f06dP9etzB35CCL5F0AI2NjRQXFwEwavI0ElLS8Kjqxa1m3kEIIRDt5ZfxZb/soLo0D0x3YJkXg9lqYuTk6SSl9eHY/r0UFhV12rV7ClLwJZIOQkMXQ7PFoutgJ4t9dUUZG5YuotFRjxC68GuaSkRUDGOvn4XVHnDF7g/9OuUc37ebQWMmYLJYOu0eNU1DMRoxW6x6IyYjdS6Znpv4WSK5hhBCUF5cxLqFn2AymwkOCyc4NIzg0HDsQcEIRdFzuHmt8/bi7fXtygX3KYpCZekZ1iz4BGejowvi9lty5vv3jAH/RFr4EkmPQE/2FRYZxbT5txMSEdm8wIiGhurxIICmxkaqKyswmc2EhIXrDYGmr7jVUFdLXU01AYFBBAS3LHsohMBRX0dddTWBISF0h2RrkvaRgi\u0026#43;R9Fi8gu\u0026#43;dYJV34ihffvI\u0026#43;1VWVKEKQNXQEk\u0026#43;fdgtliZc/GdWxeuQSn04nZbGbMtJkMmTAFIQQHtm3iq6ULcDqdBIeEEhkX39U3JrlMpOBLJD0EgaC2upJdG9cR6LXQhRD0zsjCYrWx\u0026#43;J3X6dN/MLdcdwN1VZUsfud1AoNDSOqTyZrPP\u0026#43;K6m\u0026#43;8gtd9A8rOPseLjdwmPicVis7H0vbeYPO9msoaOoLy4iM9f/wc1leV\u0026#43;n4ZBci5S8CWSHoEGAuqqaziwfQs27wCtYjAQGhFJY3099bW1ZA4dgbOxEYs9gIxBQ9m/dROlRQWEx8QS3zsNR0M9kfGJRMbGc2DbZuyBgcT3TmHk1BsQikJYZAzjbpjL0vff6tRBaUnHIAVfIukR6H712MQk7nnqWd2Hr\u0026#43;lRLAajibVffEzO0UN8/MrfvKOdgqZGB5GxcRSczCHnyCEqKyq85wgaamsYNiGO0uIiouISUAwGVI8HFUF0Qi/sgUGXu964pAuRgi\u0026#43;R9CCEAKEoejy\u0026#43;N2pRABabnb5DhnPfd36EYjAiBNTX1lBfU83W1SsYP30W199xrz64KwQVJcWYzBZ2rltFY0N9m/IbGxpwuZq6\u0026#43;lYll4EMy5RIegqa1hI908rdomkaSX0yqK2qpKyogNDISAJDQtmzcS0Htm2iT/\u0026#43;B5B47hMvpJDQyGqPJzNoFn1B4MpvUfgM4fnAfpQX5KAYDjQ317Fy/ioa6WunD74ZIC18i6RFoGEwmgkLCEEpbIVZVldjEZEZOuZ7PXvs7yZn9aWyop7q8lFu\u0026#43;8S0iYuM5tm83b//hRRJS\u0026#43;1BeVIjFZiNr6EjMVhuHd23n3b/8DwmpfWiorabJ4aB3emZX37DkMpCCL5H0AFRVJS45hbueehZ7YPA5cfJCMTB1/m2k9u3PyeNHsdrsZA4eSkRMHAC3PfZtThzYS3HBaVKz\u0026#43;pMxeBgBQcEA3PjgY2Qf3EdR/mn6DhlOUkYWTocDW0CgjMfvZkjBl0h6CGaLjeheSWjtphzQI3bS\u0026#43;g\u0026#43;iz4AhgJ6awCfYVrudgWPGM4gJaGhorfaZrFb6jRxD/5Fjm/cFBoc2DwpLug9S8CWSHoPWPLv2fOj5Z84Vak3T0M6XdVLTZ\u0026#43;qefS1J90MO2kokEsk1ghR8iUQiuUaQLh2JpBvgy1Z5titFax2K6WcIRfG6mPyzftciUvAlEj9HCEFe9jF2rF/tFXc97FLTVFIy\u0026#43;zFk7MT2Fz7pQlxNTezfupG0fgMJjYzy20bpWsO/viUSieQcFEXh\u0026#43;L497Fy3CntgMIHBId5XKBarrTkx/Pny2fveny8P/oW4mDJp3qeXrygKLmcjaxZ8QvmZoubFWCRdj7TwJZJugKaqJPfJZOYd96IYDM1eEk1TUb3pjxsb6qmtrsJisxMUEooQAo/HjbPBgdVup662BsVgwGYPaOkReFeOUgyG5mv5ylMUhcaGemqqqjBb9EVVFMVwTplGkwlbYBAup55r32y2oCiKPttXWvZ\u0026#43;hRR8iaS74DOkNf1/\u0026#43;iqKuqAe3b2DtQs/paGhHqPRSN\u0026#43;hI5g09xYaaqtZ\u0026#43;fG7hEVEkXP0ENFxCYRERTNpzs0YjUZOHj3E2oWfcuMD3yQsOobG\u0026#43;jrWfPExwyZOpbaygrULP6WutgZVVek7ZDjTb7mL\u0026#43;lZlZh8\u0026#43;wMTZ8wmPjmXFR\u0026#43;9QUVaG1WYjuU8GrqamVta/xB\u0026#43;Qgi\u0026#43;RdAeE4ExBPjvWr0ZRFDQNzBYzffoPpqq0hAVvvcL4mfPoN2IMlaVn\u0026#43;OL1f2Kx2ug/YjT7t24ifcBg5t77CPV1tSx861WGjp9MeFQMh3duY\u0026#43;uqZQwaNY7IuHiK805xZPcOBo4ax8qP32XI\u0026#43;Mn0HzmWytIzfPSPP5HWbwBR8b1ayrzvGwSGhvH\u0026#43;X/\u0026#43;HuOQU5j7wKE2ORlZ//gH5OcfbHWiWdB1S8CWSboAQUFJUwJ7NG3QR1TQCgoLolZLG3i0biEtOYewNcxCKQkR0DFNvup31iz4jJas/FpuNiXNuIjE9k4a6WgKDQyjIPkFAUDAlhfmMv2Eup44dZtik68g9fICElDRCIyMZe/1ssoaNBAQBwSEgBGVnzhAVn4jZqpeZnNmPwzu30thQz7Sb7yQwJAwhBFNuvI19WzdJl46fIQVfIukGaJpG/2EjeejZn3p9\u0026#43;Jq\u0026#43;IDlQnH\u0026#43;axLR0DAYDHo8HDxCX1BtNVXHU1xIeFUNIRBQetxurzU5q3/5kH95PWHQMqsfDuBvmsG7Rp1SUnOHU8aMMGTeJgOBQjCYTy95/G01TMZnNVJWX6Y4kTSM8KoqQiCg0TaWi9AyBIWFY7QGoqp5eOTgsnPDo2Ob8\u0026#43;hL/QAq\u0026#43;RNId0PQlDBVF8bp0WhYYtwUE0lBb0\u0026#43;w4EULgqKvD43FjMJq8kTQtRfUZOIRVn77Pkd3biYiJJSk9E7PFxuEdW2hqdJDStz/H9u5i9RcfM\u0026#43;OOe4lNSsFitVJwMqfZYhdCAaG/tdoDcDU5UVUPBqMRhMDtctHoaJA\u0026#43;fD9DxktJJN0A3wBt64Fa0IU3a/Awju7dRUn\u0026#43;aQwGA02NDrauXk5Mr2QCg0O8\u0026#43;XO85WgasYnJoMH2NSvpndUfW2AQvVLTWLvwEyJj4wmNiKI47yQmi4X0gUMJi4yi/EwRuUcPoXpUPYGatw6aphKfnEJtVSXZB/Z5J1upHNi2iTN5p7zhm9Kt4y9IC18i8XM0wGK1YQ8KPsc5omoqfYePIvfoId79y0skpGZQU1GGo66W2x7/NiazhYCgYD1MEl3wbQGB9OqTwemc4/RK7YOmafTO7M/S998mrf8gFEXPqrl55VLe\u0026#43;sOLBAaH4KirJblPJkf37iQlsy\u0026#43;BwSF6T0NViYxLYMz1s1n8zuvs374Z1eOhrrqSzEFDMRpNXf34JK2Qgi\u0026#43;R\u0026#43;DmqqjJk/CT6jRh17oxaTcNssTLn3ofJPrSf/NxsktMzyRw0lODwSFxNTubc/w0CgkJaWeUaE2bOY9DYiQSHR\u0026#43;Jxu\u0026#43;mVls73fvdnwmNicXvcJKT04aEf/Iyj\u0026#43;3ajKArpA4cQFBJKeckZwmPjmHNf2zLHz5hLYlo6uUcPExQcQp\u0026#43;Bg1E9HgKC2vYwJF2LFHyJxN/RNIJCw7x/au3s1jCaLPQdOop\u0026#43;w0a3ymevYjSZiIxNaJO7XtM0AoJDCAgJbc6dbzSZiO\u0026#43;ditpqslRscgrxvVMBmrcHhoSiahr2gKA2ZQpFISWrP6l9B\u0026#43;huJ2\u0026#43;5mnfOgMQ/kIIvkXQDvj4XjYaqes5zbvv5788OmTzbEtdUFU975\u0026#43;Gb9sUFz79qyHHgy0YO2kokHYWmC6LqUWVwytVA6GFBHrdbRv9cJtLCl0g6AJPJREhICABH9u6krqZaXwZQujM6DAGcOnaE4vzTmEwmQkNDu7pK3Q4p\u0026#43;BLJFaJpGna7nalTp7J06RLWLvkCoSik9R8MipAu7A5ACHDU17Fx6UJKi4sYNnw4gwYPlmmXLxEp\u0026#43;BJJBzF//nx27tzJBx\u0026#43;8z\u0026#43;L33wbe7uoq9UiSkpL47ne/R1JioowAukSk4EskHYCmaURGRvKrX/2KQYMGsXr1KkpLS1FV/7VAhQC3x4OryYXVZvX7nojFYiYrqy\u0026#43;33347Y8eO9bn0JZeAFHyJpIPwif4TTzzBfffdh8Ph8GuXg6IoHDx0iM2bN3P/ffdhMvn3JCmj0UhgYCAWiwVVVaXYXwZS8CWSDsQn8IGBgQQGBl7yClOdzd49e1i0cAF33n47SUlJfu0i8T1bf66jvyMFXyK5CrSe1eqPCCEoLS1l6dIl7N\u0026#43;/n1WrV5OalibFtIcj4/AlkmsQRVHYtm0be/fuxePxsHjJYioqKvy\u0026#43;RyK5MqTgSyTXGEIIGhoaWLhoETU1NQDs3LGDXbt2NSdZu9bweDzeZ9Oz779n351EIjkHRVE4cvQI69eta95WUVHBwoULaWxsvOasfE3TKC0tpampiaAgfVDYX11xV4oUfInkGsPtdrNx40bS09PpnZKCwWBg4sRJFBUVkZObc00JvhCCxsZGdu7ciaqqpKX1ITAwsKurddWQg7YSyTVGk8vFmDFjmTFjJt/73nfJO53HHXfeyZjRo7FarD3Wum0PRVE4ePAga9euwWKxMG78eMxmc48dvJaCL5FcY1jMZkYMH051dbV3i4bRYGDgwIG4XK5rRvAVRaGsrIyXX/4bJ0\u0026#43;eZPz48UyeNKmrq3VVkYIvUQATYOjqinQwGuAC3F1dEX9E07zLFLbS9p5q1bZGCNH8Kioq4n//93/55JNPCA\u0026#43;P4LHHHicuLq5HPwcp\u0026#43;NcuUcAoYDSQCti6ukIdjAcoBnYDG4EcpPifF18D0NOte7fbTVVVFdu3b\u0026#43;e1115j1aovMZlMPPnkk8yZM6erq3fVkYJ/7WEDZgOPo4t9cFdX6CrjAo4D7wOvA/ldXSG/QughiZ9\u0026#43;9ilHjx7VV7bqqWgaVVVVHD9\u0026#43;nMOHD1FdXU18fDxPPfU0jzzyCFZrzx\u0026#43;/kIJ/bREKPAs8BYQDJcAG4ABQ1dWV62As6D2XUUAG8HNgDPBTYG9XV85f8MXjfLlyJV\u0026#43;uXNnV1ekUDAYDUVHR3HDDDB588EHGjx\u0026#43;PyWTq8WIPUvCvJezAD9AFXwE\u0026#43;Av4B7ABq8ftciZeFBegN3AU8ht6zsQNPAke6unL\u0026#43;gO9DnzJlKn37ZnndOl1dq6t3twEBgaSkpDBo0CAyMzMJCgq6JlxZPqTgXzvcBHwLXez/CvwWKOvqSl1lnMBR4DfAQeD3wBTgOeA76A3dtY2mW7x33HEHDz74YPOM056KEAJFURBCoKpqjx6gbQ8p\u0026#43;NcG8cATQBjwLvAiUN7VlepEXMCn6OMVfwRuBhYAn1\u0026#43;tC/oiQfwVIQRCEc1LwyqKgsHg/4FaHWGNX2si3xop\u0026#43;NcGE4ARQAHwMteW2PtQgU/Q3Tq3oov\u0026#43;MqCxIy\u0026#43;iKAoul4uKigocjg4tukMRQlBbW4OjUa9jWXk5J0\u0026#43;exOPxXzFUFEFISAjBwXqcwbXihulIpOD3fIzogm8DvkIPU7xWqQa\u0026#43;AOahN4BxQG5HFS6EIDc3l7feeos1a1ZTU\u0026#43;O/HiMhwONRKSgowONR\u0026#43;etf/sJ/3n7br0VUURRSUlK4\u0026#43;\u0026#43;67mT17do/OeXO1kILf87ECKd6/9wANXV2hLuYAeg8nBkiggwRfURTy8vJ47rnnWLZsKaBhNpv92q3jq3dAgI2amiqqqyu7ujoXxO32cPjwIbZu3UpFRQUPPfTQNZvd83KRgt/zMaJb9ypQ0dWV8QMqgRqgFxDUUYWqqsqnn37K8uXLCAsL5uFH5jNiZD9dkKQReuUIqK6q5f33V7Dqyy384x9/Z9KkSWRkZFzTPvlLRQp\u0026#43;z0ejRXKk9OgzcJtoSSlxxQghqK\u0026#43;vZ9PmTXg8Hm6\u0026#43;ZRo/\u0026#43;emD2Gzmrw9xFKB4ewFft\u0026#43;C5ECAUgaa2HzqpKBcuR1F8A8kaqnr\u0026#43;8EvfcWevG/t117\u0026#43;qeJ9TZmYyx4\u0026#43;dIjc3lwMHDpCZmdnJFene9DTBN6NHokSjR2Rc6/09Dd2KDfO\u0026#43;TwfG032eSyO6\u0026#43;6UUqKPjG6wOK8/tdlNfVw9AVlZvrFYzbvfFhTieyC1EURSSk2PPe4wQ0NDgpKiojKSkWIxGw1n7BSUl1TQ0NJKYGN3O\u0026#43;YLy8lpOHM8jJCSI1LR4DAal3ePOnKmirKyS9PSkNsd4PConTxYRExNOUJCt00VfUwSJSTHEx0dTUFBKbV1d51agB9BTBD8amAhMB4agD8YF0n2E7WoiaHkWTwGPdnWFLoEmdDdUNvqM4JXo8fRNXV2xdhEt4ZjaRbQlQgiqq\u0026#43;v5zX\u0026#43;/hdls5PcvPU1goK3dgUghFPLySnj1lS94/mcPExoa2OY4RVHYsuUAhw\u0026#43;f4vvfv5vWQwd6orByXv7bp3g8bhyOJiZOGsJNN03i7CEGRVHYtHE/L730Ni/\u0026#43;9ikmTRqCqqreVbKcvPzyp9x//yyGD8/o9IgeTfP1MhTf424Xn19funrOpbsLvp2WvDBjgECz2UxAQADBwcGYTGaudS\u0026#43;GqqoUFxfjcDiIjo62BwUF27vDM9E0qK\u0026#43;vo7a2NsbhcPRVVXUW\u0026#43;lyCj4FX0PPj\u0026#43;C8X8YgVRbB37wlCQ4Opq2vg0MGTjBnbD49HP1kIgaaB2\u0026#43;XGbFHQNI36\u0026#43;sZmoVcUBY/Hg8ejYjQacbncOBzOZmFsuY7Ctm2HUVUPP//Foxw4kM3bby1j2rQRhIQEnNPAuFxuPG6Nd95eTnp6InFx4WiaHgbZUO/A41ab6ycENDW5EUJgMhnRNN0NpKoaBoNeZ71\u0026#43;hmY3kdvtwWg0oCj6/blcbgwGBYNB\u0026#43;Vq3lv5c22sQW9xQhYWF5Ofn069/fwLsdhnJ04ruLPixwPeBR4QQ4TExMUycNIlJE/WBnIiICEymDnHRdlv0WOtavv/977N9\u0026#43;zaeeuppbr755m5h\u0026#43;WiaRl19PQUF\u0026#43;ezauYsvV31pOLB/f4rT6XwWvTf3ArrF322nhjqdLjZvOsD060dSUlLJhg17GTEys1m88vNKWLp0CwUFZ0hMjCMhIarZ3w\u0026#43;wd88JVq3aTm1tPf3796Gmpq7N/lZPk/DwYFwuD26Xm5rqekJCAjGZ2v/5q5rGxEnDCAyy8c5/lvPt79yO2WzULWohmnsydXUNrFixjf37jmMyGRkxoh\u0026#43;TJw/BYDSwbOlWoqLD2L/vBLGxEaSmJdBQ7\u0026#43;DYsTyOHs0lMTGWGTPGsH9/Njt3HsZmszB33kSyspIuSaCFEBgMBhwOB8eOHWPlypWs/HIls2fNZviI4RgMhnbL0zStW/wOOpruKvjx6KkB7rLb7abZc\u0026#43;bw6DceZdiwYc3Lk8lW3ecyqMZu1zMfR0dHk56e3m2mzwshGDZ0KLNnzebhhx9mwYIFvPrqK4Zjx46NQZ9A9hz6ZKpu92ErisKpk4WUllYxfHgmFRU1/OH/3qOoqJzExGhKSqr4y18\u0026#43;JikphrlzJ5CfX8YXX2ygvr4Bg8HAwYO5/OMfnzF16jBSUuI4cOAky5ZtoV\u0026#43;/3ue4aVRVY8SITFav2sEvf/lvAgJs3HLrZAICLO1a1JoGNpuZBx6YxW/\u0026#43;\u0026#43;w3WrNnNzJmj2hzT1OTmjdeXUFRUzqxZo3G53CxYsJGy8mpuuWUKmzYdoLq6nokTBzJ4cBpffrmTtWt3M3/\u0026#43;BGbPGc/nn63nJz/5OzfcMJrZs8eybdsRXn1lAb/45SMEBV2cVa6qKqWlpWzdto3Fixaxdu0a8vLyCAgIYNjQYfz71VfPub/AwEB69epFnz59iI2NxWg0XlPC3x0FPxg94\u0026#43;HdYWHhxu9\u0026#43;9zt84xuPEh4ejqqq3UbMOoOzIy18Vk13/IInJiby5JNPMmLECF544ZesX78\u0026#43;RdM0X4qINV1dv0tF0zQ2bz5An/RexMSEERYWSFRUGFu3HiI5OZatWw5isZh59Js3YrdbGKVBQ0MjCxduwONRWbF8G6NG9ePOu6YhhGDI0AyOHTuFy9X\u0026#43;9z83t4iGhkb27TvOvffNYsiQdJxON4oi2h28VVWV5OQY7rhzGu\u0026#43;/t5K\u0026#43;fZMJC9WjWBVFcPx4PgcP5vL8zx4kOTkWISA6OpyXX/6EceMG4nQ2MWxYOnffc7139vFW\u0026#43;vSJ56abJ2GxmnA2unnlX58zd944YmLCSEyK45e/eJXysmqCg\u0026#43;1fOyAshODQ4cOsX7\u0026#43;eZcuWtlq9C2pra/nzn//UbqNhMBgIDAwkNTWNGTNmcscdt5Oenu51n3U7u\u0026#43;GS6W6CL4A7gAeCgoKMP/zhD3n88cexWq1S6Hs4vkZqzJgxvPTS//C9Z7/Hxq\u0026#43;\u0026#43;6gM8j\u0026#43;7P7zZ57n2DtatXbyc6OpR/v/o5GlBUVEL5l1XMmTOOU6eK6ZOeiM2mR/sYDAoDBqayfv1uGhudnDlTzvgJgwB9QpLFYmLwkHSOHjmFRsuApqIIjh/L5/XXFjN33njuuvt63npzKf37pXD8RAHDh2eQmdmrXUtfVVUmTx7K7l3HeOvNpTz\u0026#43;xE0Ib/2zT\u0026#43;QTExtGXFwEbrfuw09NjScoKIDCgnJCQgIZMDANIfRyTCYTqam9MBoVPG4PFouZ3im9CAiwNd8fmorL7fLW/uvEVyMpKYnZs2YRHhHO6lWryMnJweVyYbfbGTFyJAEBAW2K0dCorqrm9OnT7N\u0026#43;/j71797B06WJ\u0026#43;\u0026#43;MPnmDNnzjWRIrm7CX4a8KQQIuj2O\u0026#43;7gkUe\u0026#43;gdVi6ZYWq\u0026#43;Ty8Hg8DBgwgJ/\u0026#43;5Kc88cTj5OXlTQLuBv6HbuLaURTBnj3HURSFAQNSmy3ssWMHsHr1bo4ePa0PeJ4lwi1iJABxjhWsqVobsfcdu27dHpKTY5kyZSgAlRW1vPLKF7hcbkaPzuJCAms2G7nv/pn8169eY/nybc0zh4UCZ1dAwzsHQOguK\u0026#43;NZydiUNj0JrXnewOWgaRAcHMz06dMZN348J3NzWb16NYsWLeLYsWPceutt3HnHHeec53Q6KSwsZPXq1bz77rvs3buXH/zgB9TV1XH33Xf3\u0026#43;Jm73U3w5wGDMjIyePyxxwkODpKW/cXg37P7LxlVVRk/fjz33HMvL730kklVPXei5/c/2dV1uxicThcb1u9hxsyx3HPPdFRVQwhdxGprnWxYv4fU1AQ2bNhLfX0jgYE2VFVjz\u0026#43;7jVFXVYrOaiYuLZN/e44wZ0w\u0026#43;j0UBDg5OdO49isZwbqKCh4XK50TQ9cmb8hIF8/tk6CgtKCAq0c67Yt7xXVZX4\u0026#43;AjuufcG/vKnj6ipqUMIQZ8\u0026#43;iXzx\u0026#43;Vfk5ZXQp08CAMeOnaampp74\u0026#43;Ag9q\u0026#43;XZ5Wrt/tm84ZJba03D4/FgMhrJyMggPT2d2267nW3bt1FerucHDAxsG74aEBBAZGQkAwYMYPr06fzqV79i0aKFvPjib\u0026#43;iVmMjUKVN6tAHZnZqzMGCWEMI4b96NZGVldanYK4qiWwNCt7b88SXaVfqur9cF6\u0026#43;yNurhQDhpN0/PU3HLLLfTunQzQDxjbZV\u0026#43;G9jhP9RVF4dSpMxQWlDF6dF9vWKXHO0lLY\u0026#43;KkwRw8mEtqWgKg8fLLn7F2zS7ee/dLdu48SkREGIpBMGPGKHbtOsqbby5l7ZpdvPH6EsrKqgkKOjfMcty4gRw8kM2//72INat38uorC7DazPTrn8qnn62jsdF1Th1b\u0026#43;/VVVWXs2AFMmDiYMyW6kPbpk8CwYZm8/PKnLF2ymQVfbOC1fy/iumnDiY2N0PPOt/oMFUW0segVcdbYgQDj13zuLc\u0026#43;17TG\u0026#43;sSlN04iICGf27NnceccdWK3W5u2tXx6PB03TGDBgAC\u0026#43;\u0026#43;\u0026#43;CLXXTeNU6dO8feX/0ZFRYXf5z\u0026#43;6ErqThZ8C9AsNDWPq1KmYTKYuEXwhBG63mz1797JlyxYqyv0407AQOBsbOZmbi6ZpLFq8mLz8fDQ/tWA0wGQykZmRwfjx44mKijqvT1VVVdLS0hg5ahQ5OTk29HkYH9GVC5VrLfnaxXkUX9M0PQLmwZkkJES18Z2rqkq/fr256\u0026#43;7pREeH8u3v3MGKFdvYsGEPSUlxPPX0rdTXObBYTGT1Tebb37mDNat3sGnTPvr1T\u0026#43;MnP7kfl8vdRrBUVaVv32S\u0026#43;\u0026#43;\u0026#43;zdrF27iw0b9pCSksBtt1\u0026#43;H0Whg/74TNDldWCymZuEcMSKLtLSENtE\u0026#43;BoPC/ffPICMzkV69ovT3D8xk7dpd7Nx5GKPJxK23TmXsuAEYDApz542lV6/o5vsbN35Amzj7lJQ45t04HqNRj9UPCLByz303EB0Vdt7P3NcLupAFrmkamseD0fj10ubxeEhLS\u0026#43;O73/seBw7sZ/369WzavJl5c\u0026#43;f2WM9BdxP8sF69EkhLS\u0026#43;uSwRUhBE6nk7feeos//emPnD59ult1/xYvWsjiRQu7uhpfi91u57pp0/jlL35J3759233GunDaGDJ4CB9/9BEejycdfSJeTVfU2Wg06oOEwKFDOTQ0OAkIsLQbbZKUFEPv3rHNE6xaExhoY9q0Ec2zWx95ZA4ejwdFMTQLsE80Bw5MZcCAFFRVbbN4SXsDsEOG9GHw4LTmSVC\u0026#43;Z3j9DSPPqUd6eq92y4mIDGHu3PHNkV9BQTZunD\u0026#43;BOXPGIbx\u0026#43;e98SiSNGtF0usW/f5DZlxsaFExcf0fzeHmDwzuo9f54eoQhO5hZSUHAGk8lEkDcv/pWgqipjRo9m4qRJfPLxx6xft46ZM2b0WF9\u0026#43;dxL8aMAcFRXdvA5lZyOEYM2aNbz44m8oLS0hKyuVjMzeGI0Gv18H1Gcd\u0026#43;TMCqKysYdeuQyxauBC7zc4f//hHgoODz5NuQBAXH\u0026#43;fr7UXQRYKvaRp2u53x48ezbNlSPvt0NUFBAYwc1Q\u0026#43;T0XjFI8kXilnxGeEXe42LiX\u0026#43;5nPpdSh0ul4ryKt5/fzn5ecX07z\u0026#43;AAf0HXLEO6L2LAMaMGcOnn3zCkSNHqKurIyQkpEdG7HQnwbcDitVq6ZIZtEIIGhsb\u0026#43;eKLzykpKWHipOG89D/fITU1/uvFVNDcxf\u0026#43;6L5Fo9lG2b\u0026#43;n49l\u0026#43;o2\u0026#43;ubkn\u0026#43;\u0026#43;MprL8Vb87IyIF7r\u0026#43;1X3G\u0026#43;oDme\u0026#43;\u0026#43;u5Bc//zurVq1i//59TJw4qd0uthACu83us26tdFD2y8tBURRuvfVWNm/ZzOJFi/nzn97BbDZdUSTK1Ue05P7RVL8XOJfLg9vtJjo6hqeffprU1JQO6WErikJCfAJms5mqqioaGxsJDQ31\u0026#43;\u0026#43;dxOXQnwQfo0gGV\u0026#43;vp6Tp48BcCMGWMZODD1or9wdXUOhICAANsFj3O7PTgcjQQE2NrtVjqdTbjdbgICrLQdvNL08QWXh4rKWqxW8wUnsDQ2NuFsdBIcHNDmmWqaRl1tA1ab5bxT768eGna7hblzx/P66ws4fuwUp0/nXfAMfxlg06NZ4vnd737PwAEDWb1mNVVVVX4dKKqqKvn5eTQ0NBAXF\u0026#43;cVua6u1fkxGg2kpfXhrrvu4oYbbmh2IXUEJpPJO1HR0yOF3ke3E/zOoMUX2faD1xM/6YNiNrsV3Qr\u0026#43;eovd4XDxu9\u0026#43;\u0026#43;jcVi4rkf3YfZbDxvPvO802f44INVfOupW72C3XKgwaBnMszOLuCRb8w9JyNiTU0D776zksOHc7DZrNx8yxRGjep7Th0NBoUNG/by9luL\u0026#43;dn/\u0026#43;waZmUnNPuP6\u0026#43;kb\u0026#43;\u0026#43;tePmX/TZPr37xgL6lLQNA2jyYjFYkbVNFzurhuDvZy6JyUm8txzz/HNxx6joaHBb/1oQghqamv57ne/w7atW3nqqae57bbbvBkw/bPOBoOB0NDQ5lDLnizMVwsp\u0026#43;K0QQpBfUMCpkyfp168f4eHhwHmiArSL\u0026#43;y0LReHY0dMUF1XibGoiO7uQfv16o2ktGQd93X5FUWh0NnHqVHGzC6P1foPBQGVVLYWFZWiaOCsjomDL5oMcPXqSZ5\u0026#43;9h/0Hsvnow9X069e7nZS7gqqqOnbuOMrrry3iZ//voeaeh57zvJj6\u0026#43;sbm8hVFaf5bj\u0026#43;TQmq\u0026#43;pab5/tVZZGkWbAUZfVkXf\u0026#43;6//oXqzRdL9phCoqoqiKERFRvpN76M9hBBUVVVhs1oBiIiMoHfv3n4dneIT\u0026#43;e4UKOFvXDOCr4vWhf3oQgisFguvvf4alRUVzJ07jylTppCcnHzZ65OqHpWNG/czbfoISkor2fjVvuaIBZ9FvWPHYU7mFpLcOx67zYLBIJr3l5RUsnXLQSoraxgwsA9ul\u0026#43;e8EQRutwe73UavxGjKK2oueK9oGlOuG0l9vZMFX2zkrrun\u0026#43;xIhIppXRtIFev/\u0026#43;E\u0026#43;zbewyT2cSwYVn06ZOAqqrs2nWCqKgwcrLzsVjNpKYkoGoqJ3OLOHb8FCkpCYwY0Zfs7AL27j1GSHAg4ycMIjw8uMdaZz6fuMvlwu3HvRMhBA6HA49XPJuaXDQ0NPi14AOYzWYMBoMU/cukxwu\u0026#43;oii43W7y8vI4euwYp07mUltbf97jhSKoq63jyy\u0026#43;/ZO3ataSnZ3D99dcze/ZsYmNjL2phi5ZrCwoLy8nJKWDO3HGUlVXxxutLqKioJSIiiPp6J//85\u0026#43;eUllTRr18Se3YfJ\u0026#43;/0GRyOJhRFobCwjD/\u0026#43;4QPCwoJISIhkxfJtnDiRR1JSTLsZEUeN7se6dXt4440lFOSXct204efNPKhqEBkZwrx5E3n5bx/Tf0AKQ4aktzlG02DRwo2sWrWDgQNTqa118Kc/fsgdd1zHmLEDWLxoM/UNTsLDApg6dTirVu1ky5aDpKcnEBRk5b13V7J82TaiosKIjAxi06b9HDiQw/eevQur1eSv3o7Lxiei69at48svV1JSUtrVVbpgXV0uF4cPHUZVVd584w3WrVt7TjoHf0JRFNLS0pg3bx6DBg3y6x6Uv9JjBd/3ZThy9CgfvP8\u0026#43;S5cuJTc3h4aGhq\u0026#43;1DnyZ85qamjh48AAHDx7g448/Ztas2dTW1F70F00IwY7tR4iNjSA5OYbo6FDMZiN79hznhhtGsmPHEfJOl/D88w8SExtGY6OLv/31E/I2FQOwZPFmoqJC\u0026#43;c5378BqNVNeXsOPnvsbjY3nLvgk0K15k9nAP//\u0026#43;KU9\u0026#43;6zZmzBh1wfqpqsrQoX2YMmUob7y\u0026#43;hF/88pEW95IQ5HnzsT/x5M0MH56Bpml8uXIHn366jsysZKqqaomNDec7372DgAAre3Yfx2hU\u0026#43;Maj8wgJCSA2Nop//ONT/vyX75OWFk92diEv/uYtSkurSEqK7lFWvk/s//yXP/Py3/7WPLW/eyDYuXMHO3fu6OqKfH1NheDzLz7n1//1a2bOnNnV1el29EjB982GXbx4Mb///e/Zv38fBoOBXr16kZqaRnBwMJxHtBUhOHnyJLt370JVVUJDwxg2bBhz5sxh4MBB7N2756KESnfXOFm9eieJiVFs2bwfTdNQFFj15XamTBnK0SOnGDAgleiYUG/GQyMTJw7m0MEcGhubyMkpYPbscc3ro0ZEBDNhwmCycwrOuVZpaRV///vnpPdJZOiPM9m27SAFBWXk5p4hJSWWxKSoc603TT/35lsms39fNp98spZbb53S7NY5fPgkEZHB9O\u0026#43;f4u3qC0aO6suiRZs4dfIMQUEBjBs/CLvdok/oMRkZPCSdwEA9e2lYWDD9\u0026#43;qYSHR3aHFkkhIazsZGrExHedfjmaLz8t79RXV3F1PHDGT2sH2aTqUfdZ1chEFTW1LJy/XYOHznCb3/7W/r27UtKSucHFnRneqTgq6rKp59\u0026#43;ys9\u0026#43;9jyFhYUMHDiQ\u0026#43;x94gOumXkd8fPx54/iFENTW1fH8889TUVHB1KlTmTt3LiNGjCAyMpKy8nIMZy0efT4URXDs6GkKCs4QEGBi5cqt\u0026#43;jXQOHbsFKdOFdPU1ERoaNvZgharGaPJgMej4nK5sVjNzQ2MvjCFxRtF1NJmCSFYtWonRqOBe\u0026#43;69HkUR1NXV8/LfPqWurpFvPXUzgvbXWdU0jZCQAB56eA7/\u0026#43;7/v0bt3XPMYgaOhEavF7F2qDoTQMJmMWK0WnE0uTGYjNpuluX5CCMzm1s9Ww2w2nRP22RPlz\u0026#43;VysXLlSsrLy5k\u0026#43;aSSv/v5ZkhOiurpaPQpV01i1cTQPf\u0026#43;93HDiwn\u0026#43;3bt5OamtrV1epW9DjBVxSFzZs389///WsKCwuZM2cOP//5L\u0026#43;jfv//XLnKgL/ZcxPjx4/j2M8\u0026#43;Qnp6BzdaSgEn1eC7aWPN4VNat28P06aN49JvzUDUNAbjdKr998W02bdxPbFwUx46exu1WMRgUFEVw8mQRNTX1WCxmwsKCOXWyiNGj\u0026#43;6IoCqqqcuJEPq4m9zkdlPLyaiIiQ5pzotx\u0026#43;xzS\u0026#43;/\u0026#43;yfKSosIzY2/IL3raoq/QekMHPWGN5\u0026#43;ayn19Q0IIUhMimHliu1UV9cRERGMEIIzZ0qoqKgiMjIYTW1nUPjCb7td1M3FIISgqamJoqJCAEYNziC5V5Q\u0026#43;UHJpBen/nn/G3deHhvkmzp23jPOkpfy6a18N99sllqsIwYhB6aSnJVK4aQ8VFRUdX6ceTo9KGOFb0u/vf/872dnZTJw4id/85kUGDhzYJqPe\u0026#43;V6qqpKYmMgD9z/AwIEDsVjMzZn1LsXfrCiCosJyDh3KYfyEQRiNBgze7Jo2m5mJEwezZcsBMtITyc8vYcEXX1FQUMrmzQdZtnQrimLAZDIwceJgvly5nY1f7aegoIRlS7eya\u0026#43;cxTO0khho0OJ2tWw6wbu0e8vJKWL9uN5qmERhoY926Pd746hY0TUNt1XMAmDd3PDExYRw6mIOmafTt25uIyBDefGMpOTmFHDlymjdeX0xWVm\u0026#43;SkmJ0N4/WtszWz8m3mHXr/R71cvLgdg9892o2XVwvsDVut4fyimqczqZ29zsanVRU1nyt\u0026#43;6KpyU1dvUN/xEKA4otMg7p6x3lXxGpsbKKu3nHOdk3TqKmtx\u0026#43;Xu2Ogdt8dDbW39JY/jKAJMBgO\u0026#43;L1FPGgfqDHqUha8oCrt27WLNmtWEhYXxzLefueQ1XH1JqL7WLyjOOwwAQH1DI1OmDCUtLaFNWaqqMXRYJnl5Z4iKDuXRb97Igi828NVXu4mMDOPG\u0026#43;RNoaGjEaFQYM7Y/tbUNfPHFejweD0lJcXzzsfnoHpeWpS5UVWXUqL5UVFSzYOEGPG434eGhPPb4TdisZrZvP0xtrYPQ0IBmUU5P70WA3domvt4eYOHxJ24mOjqMiIgQ7HYLjz9xEx9\u0026#43;uJq//PlDDAYDGRnJ3HrbFCwWEyNHZREdHdocg9\u0026#43;3XzImY8ui0TGxYYwe07fZBWW1mpkydRghoYFf80P1ihTdtG241EorCifyCvn\u0026#43;r/7BXTdO5f5brmtj\u0026#43;aoa/OvdZWzZdYg//fJJoiND27eMFYX9x06zZfdRHr9nJsUl5RSeqWDEoD64PSqvf7yaSaP6M7hfCrT\u0026#43;fisKa7bs51huAU8/MBeD0uwrpL6hkT/8\u0026#43;3NumT2RgZnJbc\u0026#43;7XBTBqdOlvPv5Gr7zyE0EB9kv3tLvll8I/6FHCb7H4\u0026#43;Grr76ioqKCmTNnMWH8hA4d0DEYDM3LoNXXOfDlIjkbTdPzhffpk9CyQlCrw8LCAnngwVkAxMdH0K9fb\u0026#43;rrHQQEWLFaLc2zXgFmzxnLpMlDaGpqIigoAJPJ2Ga/D7PFyPz5E5k\u0026#43;fQSNjU4CA\u0026#43;1YrWY0DTIyE1vVQ3drDR\u0026#43;WwbBhGWf51yE1NY5nv38XIFBVjfj4SJ555lZqaupRhEJQsL15JvLs2WNa5e2BMWP6temlp6TE0bt3bPM1AgNt3HXX9DZ1ORuhKDQ1uWh0OFGE4h307PnUNzg5caqYpWt3cOP1YwjxiaAQFJdUsHz9LmrqGnC63DRPmGjtMvJa8zX1jeQXlYMiOHqqmPVb9jNscDoGRWFgVgoRYcHniqsQlFfWkFdUdo6eejwqOaeLqWtobL1uYsvfaqsZiK16FO3u89VbUXA4m8jNK8btkQOunUmPEXwhBA0NDRw\u0026#43;fAiAkSNHnTfL4uUSEBBAWloq69evY9GiDUyYOJiMjMR2B0SFnjGtOYkZZ\u0026#43;9t5U4VAkwmI06nG2eju815vnKMBiMNDU7QnN797WSP9B5rMplobHThcLi8z8Z3Le0i6ifOOV4IgUExoAG1tQ7vtds5rtky185zDdGqQWj/mTQ6nHz44Spyc/MJDQuld\u0026#43;/eHf9l8UM0TSMjNRFFMbD/6EkmjOoPHl3wt\u0026#43;w5SnRkGBHhoaBBTW09VTX1JMZGNhsS\u0026#43;UWl2G1WFCFQFIXiMxXsP5xN7ulCtu8\u0026#43;wqCsFGIiQ7Fbze1e3zdhzPumjVAromUxnSa3hz2HjnPwaC6BAQGMG96XhNgIAMoqa9i86wjFxaXExkQyfkR/wkMDAb3Hu3XPMU6eLiQ5MQ67N/hA0rn0GMEHaGx0Ul5RgdFoJDGxF4qidNjMQU3TsFgs3HLLraxYsYJtW/fx8IO/JCUlAcVw6T7bzqa7BEHWVNdy\u0026#43;HAOjY1Obr9jJgMGDLgmwu40TSM4yM6IwRls3HGIscOyMCgKDkcjm3ceZtKoAWzefQShCPYcyuWr7Yf44eO3YDIqgODjxetJTownMiIMISCvqIxd\u0026#43;46RfaqIjdsPkNwrhvcWrmPW5OGMHZ6pNyZnoaoqTW43qip8zbP\u0026#43;3if\u0026#43;qsYHizaweddhhvTtTfbpIr7acYhvP3wjYSGB/N\u0026#43;rn2OzmOgVG876bQfYfTCH5x6/FU2Dv765iDNllQzISGTn/hOcKizB4Wy6oFtU0vH0KMFXVQ8et556wGwxX3mB55SvMmHCBH75yxf4v//7P06cOM6pU0VdfdsXQVsL3p8RQhASEszdd9/MD3/4HEFBQdeE4PsYN6wvr3\u0026#43;4nILiCpISozmSXUB9QyPDB/Zh087DALjcHhoanW3OczQ24WzSe3SqpjFiUDr33nI967ce4OmHbwZNw\u0026#43;l0eVMpiBa3jOZ7K9iy8yC//J839Ml33q5no7OJE7n5GI0GcvNL2LTzMM8\u0026#43;ejPp6YloHg\u0026#43;vf7CShau2MXZYX0KCAnnmkRuxB9o4daqYn7/0JiUV1eTkneFkQQm//N69xESH0eR08cdXP\u0026#43;d0/hk5W7aT6VGC3xmYTCbuvPNOhg0bzq5dO6mqrvZfCRWCRoeDt956kxMnTnD77XcwavRov17i0GgwkJqWxojhwwkNDb2mxF5VVRLjI4mJCmP7vmMk9Ypi3dYDDMzqTcRZ\u0026#43;YfOWUJRtB0T0d1weuI9o0HB7e3pKkJQUlrJsjXbcDgaCQywM3vaGADSeicwf\u0026#43;YEjIqC5k23XVfv4FRhGQBHs/PILzzDqg07WLtxJ0Io5OaXcKa8invmTyE6IpQjx09TXVNPbt4ZikvLaWpycfj4ad2lFBUKbg9ms5FJYwey70iujLLpZKTgXyKapv8QsrIy6devr19/YX1hqqtXryY7O5vrrruOhx56yL8TZHn9x6qqXlNi78NqNjFuRD9Wb9zDiIHpHMnO4\u0026#43;mH5qEI0dYl10bvtXaWNdTO87cu\u0026#43;iaTEY/HhMlkbB54j42OYPTwfhgVBe80bKprGgj9bA2aptHgaMRkNGBpNZkuLTmGCaP6k19UxmfLNhEfE0FiXCQJcVGEh\u0026#43;or0zU2OglrPcFQA5vZjMmo9Lh8Sv6OFPzLwPdldzqdfp4RUaHB4cCj6gLvbGryZkT035zn\u0026#43;mxdc4cubtGdUDWVYf1SWbBiC\u0026#43;9\u0026#43;sY7w0CAyesdTWt6ycqMvjbaqv8HR2MTpwnLSevdqv1BFafbZq5pGZGQod998Hc0\u0026#43;HSFa5lB41LaRNaqn\u0026#43;W1cTCRxsVHceuNUgoP19XsPHM7l6Ik8lqzeRlJ8JN\u0026#43;8ZxYYDZw8XYzL5UYxKMTHRnEkOw\u0026#43;Pd4IhiiA3r5iaugbpw\u0026#43;9kpOBfIkII6urq\u0026#43;HLVKtasWU1VZZXfusUFgiZXE4cP6xkR33rzTdavX\u0026#43;e/QqqBwWggMyOTG2\u0026#43;8kaysrK6uUWfeur5WgKoRGRFCRmoC/3pnMb/76aOYvek1fGsJJMSEk1dQwsZtB8lKS2D7vmxy8kqYbjC0rFeggdVi5mT\u0026#43;GbbsPMSAzN6tPnevsPtofV47FVNVFY9HpX9GEgJ4/b1l3DxzHDV1Dbz6/grGDe9LYICN4yeLOJlXTKPTxZK1Oykprya/sIxRQzJYvm4Hny3bxLhhWeQVlbFo9XYUxf\u0026#43;DHXoaUvAvAX1VqRp\u0026#43;97vf8frrr1FT0\u0026#43;nrZV8RO3ZsZ8eO7V1dja9FURQWLFjAiy\u0026#43;\u0026#43;yKRJk/y3geooNI3oiBBumDgUqzfYYMakYbhdLkYPyQRVI9BuYdq4QQTYLMRHh3Pr7Al8uGgdNouJvhkpfOOumSQlRBMRGsTYoZkIYEBGEmOGZLBl50HSeycwbngWcVGh58bhayoZqQl6qORZriKz2cj0CUOJiQwmOMjOdx65iXc/X8vvXv4Ag8HAiMGZzJs\u0026#43;irKKGl59fzm/e/kDgoICGT9iAE/cN5fCM\u0026#43;WMG9GPJ\u0026#43;\u0026#43;fw2fLNrFuyx4iI8K5ZcY46h2NmE1G/LW32RORgn9JCBYuXMir/34VV5OLcdNnkjFwiD47V35nrxwB1RXlbF69nL179/DSS78nMzOT2NjYnu3P1zSS4yN5\u0026#43;PbpKEKAqpKZEk/6ozfruU9UldDgAO69abK\u0026#43;H7ht1jhumDgEj9tDUFCAd7uGoiikJkajCEFosJ1v3T8Hj6piEAo3ThupuyPPtuRVjZED0xkxsE9z\u0026#43;Xq9wGYxc9/NU/XzPCrpveP4yVO3U1tbj9FoJCjIjiIgMS6S55\u0026#43;\u0026#43;k9raesxmE4EBdkDDo6oYFYWRg9IZmJlMfb0Du92mTwpUVf168rfTaUjBv0h8E7uWL19GfV0d0268le\u0026#43;\u0026#43;\u0026#43;AdCI6M5b0Kqq1aZ82zv6Dp0dvC\u0026#43;EKiqyrClC/jd97/Fzh072bd/P3FxcZ1Yia5BcO7M47OnJbUWYwGEBOl\u0026#43;9BaL/awZzJq\u0026#43;xeid4CQu4HvUJ8GeP2V4M5qG2WggIjyk5dreiXTnbG91bTQNq8Xk7cHoM3BlSGbnIwX/EnA4HJw5UwLAoNHjCI\u0026#43;O7fSIFyEEor0Zipo\u0026#43;4NdRCu2bealqnWhZaxoGg4F\u0026#43;w0cT2yuJ7MMHOFN8pvOu393oSlfXBZbOPP85zf\u0026#43;TdBFS8C8BTVOb89gYDIZO/70JIaiprGDLquU4GurbrNEbHhnFyKnXY7XZr9jn7btOzqH99BsxGpPZ0mn3qHmv35zErjMbHImkhyOTWXQjhBCUFRWw8qN3cDc1YTSZMBj1l2IwNnfIfdZ5u8nJLmafolBRUsyXn36A0\u0026#43;Hogq53S55M2elvhS8BWVdeX9KtkRZ\u0026#43;t0KPlw6LimbG7fcQEh6J5rWANa0lpXNjQz0NdXXYAgKwBbSkIhZCXGCfgtNRT31dLQFBwQhEzx4o7YbU1TsQQIDd2nbH2YuXKKKVb/0KaFWOy\u0026#43;WmyeXGbrfKRrgbIwW/G9M6X7zm9d8f2LaZTcsXUd/QgM1qY\u0026#43;wNsxk0ZgIAB7ZtanefQHBk1zY2LPmC\u0026#43;oZ6wsLCiUpI7Orbk/gQ4Gh08eu/vIfFbOL5p\u0026#43;9uWWRFCA4cPYXJZCQzNQG328P23cdJS4o9f978i8DtUVvKiQ5j38E8tu45yjfvugGTQToGuitS8LsdgrqaavZv20xASIg32kEhMa0P9TXVrPzoXSbOvYm0/oPJO3GUNZ9/RFhkNEaTiRUfvcukc/ZFYbHZWfSffzPuhjlkDR9FeVEhC956hZrKChlJ4Q8IhSPZ\u0026#43;eQXV\u0026#43;JsauL4qSL6ZyTpi5EoChu2HyIo0E5mRhIul5vPV27l1jkTiI4JB7fn/HnqffnpoW0vQQOXqrWUExtBZHgw/dKTWyJ2lFbuJX3WWNtyWpfdOi\u0026#43;\u0026#43;pEuRgt\u0026#43;t0BACaior2bF\u0026#43;NVa7PkCrGAzY7HayD\u0026#43;4jPCaW1L4D0TSVxD4ZRMUncGDbJgxGIxHt7tuMLSCQmMRkxs6Yi1AUomITKCsuZNmH/5E/VD9AU1XWbz3ADZOGcaasivXbDtA/PRENyM4t4GhOHnablX0HTlDvcHIqv5jd\u0026#43;48THxFMr7goausdbN1zjNN5RSTERTNmWBYhwXaqq\u0026#43;upqm2gweFk576jGAwGxg7vR0JsOPsP57SUExlMoN1GbFSorudCcDKvhK27D\u0026#43;NodNI/M5XBfXtjNhkpLq3Eo2rkF5Vx8GgOkeFhTBjZj/DQIPld8gOk4HcrdB9\u0026#43;XFIy9337hwSHR\u0026#43;jJ3NBnp65b/DmHdm2jsqJcz4gpBHXVVQwdN5Hikzkc3LX9nH3Dxk\u0026#43;mtKiAmIREFIMB1eNBRRCTmIw9MEgG0XU1QlB0poLjJwt59ps3U1pRzavvLaeiqo6wkAAOHj3FoaO5mM0mkuMjaHA0kXuqAKvJQGZyLKEhQfz59YVU1dSRmRLHum372bb3GN979Cb2HT3FP99ZRnpKAvFRwRScKefLjXv44eO3s2PvMXK85WSlxKGYLKz6ai/PP3Ubew5l8893l5KaGENosJ3XPljOyMEZPHTbdBat2s6mXUfJSIknKszOyq92sXXvUZ5/6k7sNrOMyuxipOB3Q4QAxWDAYDQ2i7cAAgIDGTd9FtNvvRvVo3flq8vLMFssrF/8GeOmzzxnn8VqZfualTQ6GtqU3\u0026#43;Rw4HH5b2K4awYh2LrnGHHR4SQnxhAdFYrJZGTngRNcP2ko864fzanCUgID7Dx8\u0026#43;zTqGhrJK67g1tkTGD\u0026#43;iLyvW7aSqpp6ffftuQsKDqa\u0026#43;t57d/\u0026#43;5AN2w9hMZuorK7mnpvuIT01noYGJz/\u0026#43;zb85mp3HQ3fO4MTpM3o5I/uydtN\u0026#43;mlwu6hxO/vPZGqaMGcSdN05CMSgcPZ7Pb1/\u0026#43;gJGDM6lrcGBQ4Mn7ZxMSGsip08X89Hevc7qwlKw\u0026#43;iSDDbLsUOfrS3fBlNfT\u0026#43;7ftXKAopWf3JO3EMISAyLh57YCBfLfmcwtxs0voNandfQc4JUrL6c\u0026#43;LgPsqLizAYjTgbG9m9cS31tTXSh9\u0026#43;VCHA4nHz51S4MBti68xB7DpzAZBCsWLcTt8uNoigYvC9hUDAqSnMOfATsPnCC0rJyPlm0llff\u0026#43;JwPPltF8ZlSDh47iUfVGJiVSnJCFHhU7BYTsVEh1Ducbcvx\u0026#43;v8VRVB4poKqmlqmjBmob3Z7yEiJJz21F/uPnMRsMjF6qO4ywu0hLCSQoAArjsamrn6aEqSF383QMBiNBAQGnyPEmqoycPR4Du/awVv/\u0026#43;yJJGVmUFuQhhCBz6AiMJhMHd2xtZ99wLFYbB3du4d2/vERSehZ1VZXUVVeSmNanq2/42kYoHM7O53RBCTaLgcWrtuhrl3vcHD5VxMn8UvqkxHsNgHYGRjWN\u0026#43;oZGLGYTBoPS/J0ZMySLQf3SqKpz6Pnw9YPxrSusH9aqrOY/9RWwhBBYLabm7UIRBAXYcDa5EQJvQjTfGd7ypN3gF0jB70aoqkZscgp3fOt7un\u0026#43;91Q9c0zTsgUHc\u0026#43;eR3ObJnB8X5eQwcPZ6\u0026#43;w0cSFBIGcMF9Nz/yJEf37qIo7xTJ6ZmkZPXH6WjAGhDQ87NV\u0026#43;imaqrJm016unzScb90/p/lzcHtUfvXHd1m/dT99UuIBfR4FitKSvUBRwGAgMT6awMAAHrhrdnMAzap1u3B71LY5cpov2uofXzlKSwRPdEQIGnCqsJSw8GBQNRocTk6cLGDm5BGczHfK74sfIwW/W6FhsdlJ6J3a7qQoTdOwBQYybNJ1zXnPNFVt/gFeaJ/FZmfwuEkMabWP8Ai/XQ6xxyMEhcXl7D9ykme/eTNGk6E5h73JbGTK2EF8uGg9t82egMViZvfBE4w4kkpKr1gANm0/QGJ0CBNG9uPXf3mfL5ZuZPTgDI6fKuK9Bet4\u0026#43;sF5NDQ2nZMD35cX3\u0026#43;BtPDZtP0BSTCga4PGoRIWHMGZoX9746EseVRRCguwsXrMDt9vDqCEZZJ8qamuI4M3zL9sAv0AKfndD01Av8OvRNA3tPAndLnmf/JV2HQLqGhqZOm4QGb3jW\u0026#43;LcQU9nPCidU/nF1Dc0Mm38YIpLyti\u0026#43;\u0026#43;wh9kuO5eeZYlqzayuHjp5k2fiiP3zubBSu3sHL9diwWK3fMncjgvikcycln9JCMlhTFQmPYwHTCw0IwGg3cMmMsS1Zv5cjx0yQkxDJ6aAYmg8I98yfz0eKv\u0026#43;Oc7i9E0jZjoSL77jZuJCAtmQEYyFovZG8\u0026#43;vZ9CcPHoQUWHB8vvkB0jBl0j8EVUjvXcc6b3jzs0Zr2mEhwTwjbtmoABCUXj\u0026#43;6btQNQ2jojB\u0026#43;eF9GD8lsdptPGtWfEQP7UN/gwGa1EBBgQ2gaWSkJZKbEt7h2NLhh0nA9TbKqMn5EX0Z7F1NRhKBPUgyKEATarTx42zRumTEGt9tDcFAAJpMRVJVJo/vr1/X2HKxmE3fdOFkfP5CC3\u0026#43;VIwZdIOpoOGqBUviZCytBqdqwiRCvh1jC2nlmradhtZuw2S/N7aD8H/tm571uX03yspqEAIcGBLeV5y2yvzl93H13xbK9VpOD7Ebr/VD3HEhKK8Nv1PzVVbT8//zWILwrG5fbDcY\u0026#43;rkYu\u0026#43;Cyx2TdMHrc9Z7MX/EYABON/kFsV7zFVdYEMKvp\u0026#43;gKAqHd23jy88\u0026#43;wmg2t0pDotFv6AgmzpqH8CPRF0JQVlzIjnWrmDLvFiz2gGu2y65pGiazmdhYfcB0\u0026#43;75j5BdX0Cs24pp9JleLfUdOkn2qAJPZRFhYWFdX51JIBx4FPgW2tLP/RsAKfAhcNYtBCr6fIIQgP\u0026#43;cE1eWl3PjgYyheq9mXDhnhXaZOUZr9oXqEhda83bdsnG7MaW2iJYQQ533fUqaedbP19uYyveX5jhVCUFtVxd5NGxh/wxys9oBreta82WRi\u0026#43;vRpfPLJJ6zZuIvHf/QHRg7pi0FmluwQBILa\u0026#43;gaWr93G6fxihgwZwogRI7pTCGgs8A2gP7rwF521fwQQhC74Vw0p\u0026#43;H6EQBAdn8DAUWNRfDHVeCNovFEapQV5lBQVEBQcQlxyCiazBVeTk8rSUoLDwigtLMBksRAaEYXFZgPA43bjdDRgCwhsdr846uswmc0YjCZKC/I4U1iAzW4noXcaVrv9nDIDQ0IIjYzmTP5pyouLiIiJRVM9KAaDXBgD/TO67rppPPb4Y/zrn/9kyarNLFm1uaur1SNJTU3jBz/4ISkpKd1pzQYB5ACBwGPAbwBXq/0qV9Gy9yEFvzvg9e1vWbGYbWtXYgsKxuVoJCImlnkPPorL6WThm/8kMCSUmqpKImPi0BDc\u0026#43;OA3MVksHNm1nS/eeoWHf/AzYpNTqK2q5IvX/8nUG28lP/cEW1evwGKz01BXS0RUDLd\u0026#43;8ykaHQ3NZVZVlDNp9k3s37qRXV\u0026#43;txR4UgiLAYrXh8ch8O6ALfkBAAN9/9gcMGTyElStXUl5RzvlGGQXQ4HDo59ntXdI7EuiL5jgaHdht9i5puH11qK2rJSgwqI2hczaKEPRO6c38G\u0026#43;czbNiwLnhiV3yrpcCrwDPALmDheY41AmFABW19\u0026#43;mb0XkAFlzkgIwXfnxCCE4cOsODtVxHCgIaGzWZnzLQbKCnIY\u0026#43;Oyhdz86LdI6TuA\u0026#43;upqPvrnn1m38FPGTp9FzpFDjJw8nXu//U2qyst4/2//S2VZCdHxvTh\u0026#43;YA\u0026#43;lBXnkHjlIfEofCnOzqSgpRgN2rlvFjNvvJX3QEGorK3nt9y\u0026#43;QfWg/vVLTyTlykJGTr\u0026#43;f\u0026#43;7z5G4clstq5azq3ffJrkjL7UVFbwwcv/J3Pmt0IXfTvz589n1qxZuNzu9n\u0026#43;WQhevTz/7jMbGRu6\u0026#43;6240OmCFqktEUQQFBQV89tln3H///QQHh3S6i0RRBMVnzvDaa6/x8EMPExcXe85ksObHJsBsNmM0GruTZd/mdoFtwEfAt4ADQO5Zx2hAMPB9YC2w3LvNBNwNRAB/BS4rOZEUfD9D94/rias0TTS7YPZv20xa/0FkDBrm9evHMHnuzSx59w0GjhpHaHgEo6fPIDAkDLPVSnh0DKePHSEoJIyKM8VMnnsLp08cY3STk\u0026#43;xD\u0026#43;0hOzyIyNp7Z9zxEaFQMpYUF1FSUU1tdTU1VFaAREqaXGRQWzvGFn5CS1Z\u0026#43;0/oPQNI2I2DjGXj\u0026#43;H0qJX5MBkK3xjHSaTCZPJ1O4xQgjq6upYvGgh9fUN3HLzzYSFhXWB2Crs3buX/7zzHyZMmMD48ePxeK5qkMg5GAwGDh44wIcffsCoUaPo0yftgnVojmTrvniAd4CR6Jb\u0026#43;84Cj1X4BVAIr0H3\u0026#43;KrAGuAeYAPwflyn2IAXfv9A00vr2Z959j3jDMDV9arrHQ1V5GUlpGQihrzWraiqhEZEoiqDJ4SAoNAxbQCCq6sFksdKn/2BOHj1EeHQsikFh2KSpLHvvLUoK8ijIzWbCrBtRFIWcIwcpXrEEe1AwQSEhej28uReCQkOxBQShqh5qqioJi4wCIfSUDKpKcFgYFpvtmh6sPR8XEm9FUdi3bx9btmzB6XSyc\u0026#43;dOrr/\u0026#43;\u0026#43;k4VMl\u0026#43;js2TJYk4cP86yZcsYOXJkc7BAZ9Whvr6ehQsXkp\u0026#43;Xx5LFi7l\u0026#43;\u0026#43;nQsFkt3Goy95NsGqoE/An8AbgLeO\u0026#43;sYDViNLvaPANPRrf7/BY5cycVlCIGfoaoaqseDx\u0026#43;PG4/GgejwoikJIeITuhvFGzSiKQmVZKW6PB7NVX9S6\u0026#43;SeiaaT1H0hF6RkObt9ETEIScUkpBIaEsnfTegCS0rM4sH0zB3dsZfqtdzHn3oeZPO9WIqJjz0qUqF8vODSMmsqK5qgdoSjUVFbQ2NAg58JcIi6Xi2XLllFSUkJVVRWLlyym0ensVNeYoigcPnyYr776CoAVK1aQn5/fqYKvKApHjhxh/Xr9O7lhw3qOHTvWqXXoQvYCb6Bb8X1pf8B2E1AM3Ats5wrFHqTg\u0026#43;xUaujugPdtm4MixZB/cx9E9O3G7XFScKWbdok/p028Q9qBgfVETL6qmERmXgNFkYvvaL0npOwCz1UpinwxWf/ExsYnJBIaEUl9bg9vt1nsGmsqR3TvIPrSfRkc9qupBa\u0026#43;VLTR80lOxD\u0026#43;zm\u0026#43;fw9ut4uyogI2r1iMy\u0026#43;ns6sfWrVAUhby8PFasWNFsxa5ZvZqc7OxOFXy3283y5cspLCwE4OjRI6xbt65Tn4XH42H58uXk5\u0026#43;cBcPr0aVZ\u0026#43;uRKPp1u7bC6FT4DDwHeAUNqO4piA\u0026#43;73bfwJMBmZwhXONpUvHT9A0jZDwSGJ7JZ3ziaqqSmq/gUyYfSOL33kda2AQLmcjUbFxTJl/G6rHTWxSMkajyVcYZouVzCEjqK2uJi5ZD19L6dufsOhYMgcPB6DvsFHs2/IVr7z4CwICgwgKCWH8DXM4ffwomYOGEpfcG6PRhOrxkNK3P6Oum8HCt18lIDgEgSCmVxIRMXF6aKbkolm7di3Hjx9rfn/y1Cm\u0026#43;/HIlWVlZnXJ9RVE4ffo0y5Yta3YjOZ1OFixcwPz58wkJufqDt4qikJ\u0026#43;fz9KlS5rr4PF4WLZ0Kffecy\u0026#43;xsbHd3VffHmf/tOuBP3tfGcDn3u0m4AFgPPB7dMs\u0026#43;Dz1\u0026#43;XwNWIqN0ujeqqjJ43EQGjB7XbqoCoSiMmzGPzMEjvHH4wcQm9cZktqB6PMy65xEsNmvzD1VVVUZOuZ7BYydhCwhA9XiI7ZXM0//1ElabHY/bTURMLA/\u0026#43;4GcUnsxBCEFccgoWq42GulpsAYHMvOdhLFa9TEUxMHneLfQfMZrykjOER0UTEROH29WE2Wrrjj5X31T3zrugEFRVVXHo0CHmzp3Hl1\u0026#43;uBCGYNXMWJ05kU1ZWTmRkRKc8y23bthESEkJmZiZHjx5l9OgxuF1u9u/fz8SJEzulDrt27SIuPp7\u0026#43;AwZw8MABpk2bRmBQMLt372bWrFlX/fqdjEb7aRWOA//wvnwzKYPQffb/Q4sbZ4333zT0BkFG6XR3TGYL5rNmxJ5NZHwCUQm9mmfa\u0026#43;ma/2tpZqMRoMmEym9vMnA0ICm5\u0026#43;r2kaAUHBZAwe1maWbXBYeHO6gLNn50b3SiImMbl5MpjRZOpuYu8AqtBjmuM7\u0026#43;\u0026#43;JCCB5//AmOHTvK8uXLiI2N5bnnnkNRFIzGzml/3G436enp/OY3v\u0026#43;FHP3qO4ydOcM\u0026#43;99zJ16lSanM5Osaw9Hg/9\u0026#43;w/gJz/\u0026#43;CU8/8zRGk4k777yL6dOvp6qqEo/H09PCfY\u0026#43;hh1NWtbNvGbr1XuF9X\u0026#43;k99uwGYi3wFW0nbF0S0ofvZ3ydeGqqiurxeH\u0026#43;U2teed/b29t7r5XnaNATnK9N3fd/M36sj9i1r4l2F0mvQrSYFvctsvwo30C6aphEcHExaWhq7du2itraWtLQ\u0026#43;xMbGkp6e3imuFNDdKUOHDsXpdHLs2DFCvZZ\u0026#43;Rnp6p7mVhBCkp/fh6LGjHDl8mIT4eAYNGkRcXCwZGRk9TexBT6WwFGhoZ58TWAxspsXKd3Hu19\u0026#43;3/bKRgn8J6NExugWuWyBdXaOeh0/mVVUfhO7Q1Lo6TcAq9B/eVGB0Z96foigcO3aUhYsWoigKkydPJigoqFPj34UQOBwOPv74Y4qLixk4cBBZmZm43e5O660ZDAZOnMjmlVdeoaGhgWnTptOnTx88Hk936zF2K6TgXwI2m42o6GgA9m/fTGVZCUqrZGLydeUvVVU5smcnxfn52Gw2or3Pu4NZC2wE4oDngOTO\u0026#43;P4oikJFRQV/\u0026#43;ctfOLB/P/37D2DWrFmdas36EuEtXLSQDz54H6vVym233UZkZGSnCK0QAoPBwOnTp3nxxf9m86ZNpKX14YEHH8Rm65ZjQd0K6cO/SDRNw263c/3117Ni\u0026#43;XLWL12Ey9lE5qChKAZFTjbtAISAmspKvlqxmKqKMiZNmsSgQYOuhgicAf4EDABuAF4CfokeInfeiwlBc8N0afclQAgK8vP5wx/\u0026#43;wLvvvkNISAjf\u0026#43;ta36NOnT/Pciqv7bPV6NzQ0sGDBAv7rv35FaWkpt912O/Pnz2/3\u0026#43;I6Kh/c1MqqqUlNTw\u0026#43;Ytm3n5by\u0026#43;zZs0awsPD\u0026#43;f4Pvs\u0026#43;woUN7YlSO3yEF/xKZf\u0026#43;N8Dh08yBtvvMm6pQtYt3RBV1epxyGEYMCAgfzwh89dzfC8FegZC38J3I6er/xNdHdPPrqv1APYAKFpGo2ORhoaHM3uJk2j\u0026#43;e/z4fF4qKioYMuWLbzzzjts2rQRo9HIN77xKLNnz6HB4bjqqSlUVaOurpajR4/y2Wef8emnn1JRUc7Uqdfxk5/8hIiIiOZnrCgKqqpSVlZGdnY2BQUFVFdXexuly6\u0026#43;D2\u0026#43;OhpKSEXbt2sX3bNioqKkhMTOQHP3yOO\u0026#43;\u0026#43;4U0\u0026#43;aJq2mq44U/EtA0zRCQ0N5/vmfMXz4CNasXUNVVdU5y8T5Gx6Ph/qGBoICA/16MExDw2gwkpmZwfz5NzFgwICrKQIu4BX0QdwfA4PRLf0C4JR3uwqEA8EVFRX8/Bc/J7g5ykmgoeFqarpgg\u0026#43;R0OikuLiIvLw\u0026#43;HQ0\u0026#43;ZYrPZ2bN3L898\u0026#43;5nmwe\u0026#43;rhhC43S7OFJ8hNzeXysoKAgICuOuuu3nuuefIzMxsI/Z5eXl89vnnLF68iMOHDlNbW4PLdUXjhEDbwf2wsDDm33QTjz/2OOPGjcdoNEix7ySk4F8ivkiLO\u0026#43;\u0026#43;8k5tuugm327/TAyuKwsmTJ/n4k0949NFHCQkO9usflxACi8WCwWDojC6\u0026#43;E/gPsAd9VuNMoDeQyFnjWw6Hg7Vr1lxi8S0oitLsIqmrq2X1qi\u0026#43;v9r21wWQyERERwcyZM7n11tuYNWsWYWFhLc9Y0yeE/e53v2Xz5s14PB4iIyMZOHAgYWHhV2woKIogKDiYzIxMxo4dy9BhwwgNCUFVVb/\u0026#43;PvY0pOBfBr6MiGazGbPZ3NXVuSCKorBr1y4\u0026#43;eP99pk2bxoQuyIh4qXRyRkQV2Af8FHgZyEIX/EB0f35v4JHQ0NDAhx9\u0026#43;hNi4WD3lhNDr6WpyXVCwjEYjBqOh01Mft8ZgMBAZGUlaWhppaWmEhoa2ecZCCJavWM6PfvwjThw/Tu\u0026#43;UFO68405mzJhBcnIyNputA3qGApPJ2KYxlz77zkcK/hXg75aJEILqmhoWL15Mbm4Oy5YuZVQnZ0TsRrjQc5OfnZ98DHBXYGBQ4D333svAAQPaaTAv9D3oehdaa7E\u0026#43;W2gVRWH//v288MILnDh\u0026#43;nIkTJ/Hzn/\u0026#43;cUaNGYfJOquvI77kvpNmf0DRobGxEUzUMRmOP/n1Iwe/BtKTh1ZfaW7lyBQ8//HB3Wxquq/GqpT6z\u0026#43;NItU/81CoQQ1Dc08I9//pN9\u0026#43;/YyZMhQfve73zFkyBA8Ho/fCfPVQtNUTp8\u0026#43;jbPJSUR4RI8OD\u0026#43;25TZlET8O7dAklJSUAHD16lHXrOzcjYk9Cw/97dZeCoigc2L\u0026#43;f5cuWEhAQwDPPPMPgwYOvGaGHlvxGX321AYABAwcQ0E6akp6CFPweiqIonDp1ihUrVzZ/eZ1OJwsXLNQji/w4WkfSOaiqysaNGykqKmL48BFMmzatxwrd\u0026#43;RBCYc2aNWzatImIyEimTpmK0dhzHR9S8Hsomqaxbds2eif3ZujQoQCMHTsWg9HAgQMHpOBf4wghcDqdHDx4AICRI0cSEdE5mTr9Ad\u0026#43;M37179/DHP/6B6upqZtwwg5EjR/Zod2ePasp8swn1hGA990O7GDweD4MHD2bixIn8\u0026#43;te/Zvfu3UydOpX7738A59fEjkuuDZxOJ6WlZSiKQu/evTGZTNeEO8fX2G3evJn//u9fs2PHDvr378\u0026#43;TTz5JYGBgj/5t9CjBN5lMBATYcbvdVFZWdnV1uhRFUejXrx8uV1Mbqy05OVnGPkuAVuGvQlBXX09\u0026#43;fsHXzhzu7jidTnJzc1m\u0026#43;fBmff/EFBfn5ZGRk8MKvfsWQIUN6tNhDDxJ8X66b5OTeaJrGgQMHcDqdzaFl1yKaN2f\u0026#43;2duu1echORchQPV4\u0026#43;Ntf/8q777zT1dW56jQ2NnLmTDE1NTVYLBamT5/OD37wQ8aPH9/VVesUeozgg27hjxw5krfeepMNGzZw/PhxBrQbNy2RSFpTUnKGioryrq7GVUUDDIpCeEQE48dPYPbs2cyePbunLqfYLj1K8AEmTJjIgAED2LVrF2\u0026#43;\u0026#43;\u0026#43;Sa/fOEFbFartGolknbQ0CNVvvnY40ybNq3HC5/FYiE2NpaE\u0026#43;HhCQkIAevw9t6ZHCb6qqiQlJfLgQw9z5MgR/vOft0lOTuaRRx7BbrdL37VEcjaanudm0MCBzJk9\u0026#43;5roDfvcmteS0Pv4/\u0026#43;yddXwdx/X2v7sXxMwsW7ZlZjtmiDF2EofjUINtk0KSNoWUk1/eQtqmTZMGGmZmxwwxM4NkEku2mOnSzvvH7BVZsiWDyPt8PtfWvUuzuzPPnDlzzjO9ivBBzsDfdNNNHD50iDfffIM///nP5OTkcM8999C5unL5AACAAElEQVQ3KQmPbq59c7GfhdlsMkIwDZwTmqZdVtm1lyt6HeELIQgMCODxxx9HCMEHH7zPCy/8l1WrVjF16lSGDBlCWFhYr9bLaAqXy0VWdlZXF8NAd4VhC1xW6HWED9JaiYyM5Mknn2To0KG8\u0026#43;eYbpKSkcuzYURRFwWKxXlbr0Toc3VvCubfBvewldF8pBkWXa3Y3A0VRUE0mqfzTXcusP1PDNXv\u0026#43;6JWED7JSBAQEcP/99zNr1iw2b97M9h3bycnOobKy4rKpMEIIsrKyKCnp3REY3QEKoAlIT09n3759FBQUoAmN7mhGK0BdfT05ObkIIVi7bi1VVVVo3bVdCIGHpwfJA5IZOXIk/v7\u0026#43;l6UP/kLRawkfGq2rvn370rdvX25dvJj6ujrsdntXF63T4HA4\u0026#43;O1vf8Onn37a1UXp9XBpGl9//TXPPPNPjh49is3WE\u0026#43;qZbCOffvIJn37SveuIqioEBgaxcOFCfv3rX5PYp8\u0026#43;lXzGsl6FXE74bbkvAarFgtVi6ujidBkVRcDjseHp6dnVRej1UVWXrtm388Y9/IDMzk\u0026#43;iYcCIjgru/61DR/\u0026#43;muln2TctbXOcjIOMV7772Loir8/em/4\u0026#43;vre9mM1i8GLgvCd\u0026#43;NyrBiaJrp9W\u0026#43;4NsNvtfPHF52RmZjJq1CD\u0026#43;\u0026#43;vRPSE6Oo316\u0026#43;O5eob37XsgLbe/xbe13odc//3LbbA4\u0026#43;/GA1f3/6TZYvW8Zdd97F5B6wglt3wmVF\u0026#43;AYMXAooikJdXR1pJ08CcPU1U5kyZThw7s5WaWJcK\u0026#43;0wtIUQZw2zbWu7oshyOp0aJpMUGWwpu9HiTCiKeoaRdK7rX0qYTCqLb5vD55\u0026#43;t5dixTDIyMy8bSYSLhcsjNtGAgUsMuXSfhqIoBAb5S40aTTQk\u0026#43;bT1cThcvPP2cj76cDVOp9bmfgCnTxfz0YerqampR3YmjR9FUdi37zjLlm1r9bp2u4s1a/bwt7\u0026#43;\u0026#43;zcsvfUV2dmFDuVueZ/fuo/zrmQ8pKipvWLsXBHV1Nj78YBVZWfl653Tu\u0026#43;7uYH5dLw8vLAz9/XzRN4HQa0WcdhUH4BgxcLDTxzLTHjaaqCjk5haxYvp2vv95Efn4JqqqcsY/JpGIyqZSVVbNx437sNkfDxVRVbdiekX6K3buPnnFtVVXZv/84n3\u0026#43;2jjFjB2F3OHnrzaXU19vPmGNQFIWM9FO8\u0026#43;MLnfPThalxO96Sogt3uZP36fRQWNi6gI3XlVVST2szyV1U5ilBVRf9bH2Xo9\u0026#43;O\u0026#43;z4bj25sXIxr\u0026#43;6YaxT90fBuEbMNCF2Lb1MJMmD2fgwD7s2J5CUxoTAnJzi9i1K5WsrAI0TZPE2OCecXHiRA57dh\u0026#43;VJKwqrRKnoijk5hQRHh7EggWTmDt3PMXF5dTX22mVNhWF8VcMZ8\u0026#43;eY2zberjhnAo0I3ZFUSgrq2Lv3mMcOphGdXVdw3oUp04VU1NTT3Z2IZmZ\u0026#43;dTV2bHZnJw\u0026#43;VcLuXank5hYDUFpayd49xzh\u0026#43;PAen8\u0026#43;L44mVHY1BbazB8\u0026#43;AYMdAHkWqrVHDqYxu13zqWwsIyVK3Yw/6oJeHt74HJpfLtkC\u0026#43;vX78XPzwtFNeHj7dXgNqquruPtt5aRlpaLr68XFouV\u0026#43;nobnp5nSocIoTFiZD82bTrAli2H2LP7KMOG9cPPz7vVQAahCfr1j2XM6GQ\u0026#43;\u0026#43;GAVSf1iiIkJPaP8\u0026#43;/ef4IP3V2IyyQ7AbLZwz70LiI\u0026#43;P4MMP1mE2m8jPL2bipGGoisKxY9nYbDaqq2spL6tm8pQRFBSUUVFRQUFBOZOnDOe222afF1k3XfyosLCQvLw8kpOT8fZu/R4vVxjdoAEDXQBVVTh4MB2rh4UBA\u0026#43;IYObI/NTV1HDuahdlsIiUlk5UrdnDPvQv5wx/v46GHrqesrJKy0kpUVWXN6l1kZubzi1/cwe//cC833jSDkydysNnOdNMIAbGxYYSE\u0026#43;POrXzyPpgluufVKLJbWdZbc2bZz5o4nNjac995did3ubBgMKIpCcXElb725lMmTh/OnJ\u0026#43;7n93\u0026#43;4lz59onj7reXU1tjIyyskN7eAh350PVdfPZG83CKOHEnnjjvn88T/fZ\u0026#43;Jk4bxzjvLmD59JL//w318/weL2LzpIMVFFR2aFHYvVehwOEhNTeWFF17ggQceYNOmTXh5eWEymTCbzc0\u0026#43;JpPpsh0BGBa\u0026#43;AQNdALvdyaaN\u0026#43;0lMjKS6uhaXSyMiIoj16/cxZuxA9u07zqDBfRg5sj9CCGJiQrlqwUTefGMJNpuDfftOMGfOOGLjwnC5NIYM6cP0GaM5nd88o1pRoL7ezkcfrgFg9pzx1NbWo6oqJ06cIjjYj6CgM2PZhRB4eVm463vzefKJ11n/3V4mTBwKyM4q5Ug6ZrOJufPG4\u0026#43;XlASgsWjSVJ554g8zMfDw8rEyfMZLExEiEJlBNJsZfMYTExAgURaFf/zgGD\u0026#43;7LwEEJWK1mEhIiUVWFquoaIpX2ra2rCUFZWRm7du9m6dJv\u0026#43;W7dOjIyMvDx8WHMmNG89957Z2Tjent7ExsbS9\u0026#43;\u0026#43;fQkLC8NkMl1WGbsG4Rsw0MlQVYXMzEJ27TpCaIgfhw\u0026#43;fACA/vwSnU1BQMJ\u0026#43;K8ipCQgIbon00TRAS4o\u0026#43;XlycOu4OamlpCQgKaRfGERwRRXFyOEDRY\u0026#43;YqisnHjAY4dy\u0026#43;aXv7odq9XCc//5lHfeXsHp0yXcfPNMgoP9WiVYTRPEx0dwy62z\u0026#43;eSTdURFhzVMthYVlxMY6IuHhxVNEyiKwNfPm4AAXyora/H29iQ0JFCWDxlS6eMrEwCFECiAv58PJlNj6KcQ7dfIURSFlJQUtmzezPLly5otaVpZWckzzzzTylECk8mMn58f/fv3Z978\u0026#43;dx040307du3oVy9HQbhGzDQ6VDYsvkg48YO5r4Hrm741W538q9nPmL3rlSCggIoLa1sIG9VVSgrraKurh6L1YK3txelpZW671oeX1RYjtPpauHSERw/lsWAAfGEhQeiuQT33X81v/vt/6iqqiEq\u0026#43;qazEp0QgpkzR3HoUBrvvL2Mulo50RsSEkB5eTU2mwMvL2vDvEJ5eRW\u0026#43;fl76lVuc9\u0026#43;xfOxh1I4iLjWXO7Nl4eXmxfv13ZGVl4XQ68fLyZuTIka367ysrK8nNzWH37t3s3r2bZUuX8stf/op58\u0026#43;ZhNpt7Pel3lPAjganADiC7le2jAQuwk65JxzNgoFvDHdmya2cqty6eTUyMdMmAtIKnTB3Bpk37ue666bz5xrccOpTOwIHxFBZWsHz5durq7Hh4WBgxoh\u0026#43;rV\u0026#43;9k2PAkQkL8SUvLYcOGffTvH3vG9eITIlm3dg852UWEhwdSU1OPxWKmrs5GVlY\u0026#43;oaEBzQvZZNQghMBqNXPnnXN5/NcvcmD/cQCGDOnLp5\u0026#43;sY82aXcydOx6XS2PJN5vx8/MmISGi4Z4aT9l8LWUhaPFdSOG2drKGEBAQGMhVV13FtGnTOHnyJGvWrGHZsqWkp6ez\u0026#43;LbbuOnGm2h5QpvNRm5eHuvWreXDDz9k9\u0026#43;7d/Oxnj/Lkk//Hrbfe2uvXjugo4fcD/gN8BfwSqGmx/VrAD9hFLyf8phK43Rkmk6lZGF1PKXePlMB1F1ehTQ0dRVHIyysmMjKYIUP74HI13qemaUyYMITDh9KIiAxm9pxxvPrKNwQF\u0026#43;4BQiI4OJSxMunnmzB1HdnYBf3/6PQICvAGVSZNHEBjooxfELSUsmD59JMeOZvP0X98hMMiH2lo7V84ag6\u0026#43;PFxs37Kdfv1gCAnx094sgOMSf2NjwJu9CEBkZwve/v4hXXvkSLy8roaEB3H3PAj78YBXbtx3S70Hl3vsW4ufnTXRMCD4\u0026#43;nnpOgCAsLBCrh7khR8DX14uY2DA9sgbMZhOJiVF6lNFZ3rvS8I\u0026#43;ejOXCarUyZMgQBg8ezG233ca2bdsoLy/HZFJb1dqJiIhg5IgRzJ41m6f\u0026#43;31OsWL6cv/zlz8TFxzN1ypRe7dPvKOGrQAUwGbgJeIfmb8dEL4/8cYd\u0026#43;uSVwCwsLuzUxuVwujh5NBWDnrl288MIL3ba8AvD09CA5OZkRw0f0OGEsd92oqa4DlNYjYISgX79ofvrIzfjqPu1G7XyIiQnl548txsvLgxtunM648YMoyC8hPCKY6OhQ7HYHXl4emEwqP/rxDWRknKKqqpb4\u0026#43;EiCgnxxOJy6n73x2oGBvjzy6M1kZuRTXlFJdHQ4MTFhgGDS5KF4e3s0ll8TTJs2gkmThurhlo3kOmHiEIYO64u3tweapjF2bDJ9\u0026#43;kSRkXEKs9lMnz7RBAT4oGkat98\u0026#43;Bw\u0026#43;PRhfJnLljG84DkDwwjj59o7BYTAD4\u0026#43;3vz45/chLe3h\u0026#43;7GOvPZqapM/qqrrZfROXqkTdPRQ1hYGIsWLcJms7U5IevW3hk1ahRP/\u0026#43;1p6mrr2LBhPS\u0026#43;9\u0026#43;AJDhwwhMDCwR9W7juB8CD8LWAF8DzgI7GuyXbTYVwWcrZyjtd97BJxOJ19\u0026#43;\u0026#43;SXPPvssR4\u0026#43;mYrfbe4A4mSzg6lWrWL1qdVcX5qxQVZXg4CCuvvoafvmrX5GYkNAjLC4vLy9iY6U7ZdWqbcy/agJ9EqPatFXNZhN1dY5Wt1mtFpxODadTIyIimMhIGbUidXBM2GyNTScxMapBF8fplIlZbZ03ITGSRCUKIYSedCU7WHmt5lLOJlPr5bNarTgcGg6H3N/b24thw/qBAE1o1Nba9OPVZvu5UVdnb3INlfr6xmtYLGbsdhfQegKW0\u0026#43;lixfJtnEzLxs/Pl5iYmDP2cZO/pR2quC6Xi/79\u0026#43;/Poz37GkSOH\u0026#43;W79erZv386CXry27/lO2n4DRAOPAD8DylpsF0AyMA94HyjWf7cA1wOVyE6jR0FVVTZv3swf//RHcrKziY4OJyIiqPtL4DabDuvOvZNCfb2djIxTvP32W5jMJv76l792\u0026#43;\u0026#43;QZIQQeHh4sWrSIFSuWs2XzPu675/9I6heHqijd/Inr99DVBTlXORWF6upa9u5JobqqhkWL5jBixIgLNgY0TWPSxIlMnTqNL7/8go0bNzBnzpxeG6d/voRfB7wAvATcBfwXaPnkC4Bw4OfAP5GuoFuBGcAz7b1Qd4GiKNjtdj7//HNysrMZO3YIf/7rj\u0026#43;nfP\u0026#43;bCT26gATabg/ffW8k//v42S7/9ljtuv4MJEyZ0e4tLCMGMmTN5/PHf8Oyz/\u0026#43;bIkZMN4ZYGLh48PT2ZN28\u0026#43;v/nNbwgKCrpgQ0AIga\u0026#43;vLxMnTuTLL78gJTWVmpoa/P39u7WRcb44X8JXkK6d/wK/BvYAW1psL0MS\u0026#43;2P6JxsYA/wLSO3qGz8fVFdXc\u0026#43;KEbMRXXzONKVOG67HD53hYF1kC92zXURQFl0trEK86uwRuo9/5Ylz/YsBkUlm8eC6ffrqG9LQ80jMymDBhQpeUpSMQQuBhtXLvvfcyesxotm3dRnFxMaKbLnEIMmLl22\u0026#43;XkJOTw5w5cxk6dGi3JTkZLeTBgAH9mT59OpGRkRetrKqqEhMTg4eHB2WlZdTV1REQENBtn8WF4ELj8FcDY4FHgROcOTIsRXYKrwLXAd8HUrr6ps8XLpcLu92Ooij4\u0026#43;ctoiHMRKoDTqfHhh6uwWizcdPOVZygiuqEoCqdPl7Bh/V6uuXYqPj4ezToHVVXZt/cYp06XMH/\u0026#43;hDNcSU6nxqZNB9i27SAhIYFcffVkYmLCzqi4qqqye1cqGzbu4\u0026#43;7vLSAkNEAneelj/fLLDUyePILExIh23d/FhKZpeHha8fb2QhNaj1qOUgiB2Wxm3LjxjBs7rlvPPUgtn3JSUlLIzc1l0XXXcffdd6N165GUVNa8FBFcVqtVN5BcvZLo3bhQR5UDSeYqcD/SR98UFqQfvwTYACwAgrv6ps8Gl8vVPrW9DkngFrF86Xa\u0026#43;\u0026#43;moj\u0026#43;fml55DArWLDhn1tSuCmp59i167UViVw9\u0026#43;07wWefrmP06IHYbQ7eemMptjYkcNPTT/Hifz/jw4/WNImZdkvg7qWwsOxMCdwWIZ1KWxK4ygVK4DaRv\u0026#43;2etvE5Sq9pDRov3fXj1pVxv0\u0026#43;TqmIxmzF3g7K1/VHPiOc30DFcjEzb08jY/P8DrMA2/XcrcAcwDfgbkI\u0026#43;M3f8F0q1T3OErXSS05a5QFIXMzEy2b9/O6NGj6du3Lx4eMgTt/F0cCtu3HWbi5OGUllSyY0cKcXHTcZOalMAtpqCghIiIYKk70iCBCw6Hi\u0026#43;zsU1RV1hCfEKVL4La2opFCbk4h4eFBXH31ZI4cyeClF76grt6OR2uxzYrC\u0026#43;CuGsWfXUbaNPMzUqSMaUt6bEru0BKvIysrHbDaRkBCFr68XmqaRf6oUf38fysoq0TRBeHgQiqJQWlpJfn4xEREhREWFUlZaRXb2aXx8vUlIiMRsNnXVq7/kUFWVqqoqMjIzqKyo7OritAlFUaiuqaG8vAwhBMePH2fDxo3d2sJXVIWIiAji4\u0026#43;KxWCwG8Z8HOkr4CjLWviXjbAa\u0026#43;BP6KzLLVgAHACOSErdtn/09kZM8M4LPOukm3xS5XGHKiaa429/P39\u0026#43;e79ev5xz/\u0026#43;wezZs1iwcCGjRo4iKCiogYg7ct3y8moOHjzJ7XdICdxVK3cwf/4VjRK4325l/Xd78fPzQFHM\u0026#43;Po2SuDWVNfz9tvLOXkyB19fTywWD2w2mWnZEkJoDB/Rj02b9rNly2H27E5l2PBzSeDGMXp0Mh\u0026#43;8v4qkpFhiYkLOKP\u0026#43;BAyd4//1VmFSBEApWq4W771lIfHw4H32wFrPFxOnTxUycNBRVMXH8eDb19fVUV9dQXl7DlCmjyM8vaZDAnTJlBItvm92mW6snQz6vAzz33HNs2rSJ6uoquvMYRQhBbW0Nmqbx4osv8Nprr3V1kc5WWhRFITwightuuIEf/uCHhIWFGaTfQXSU8E8Dyzkzw1YD3gX8gZPIWp4GPIX047tRiiT9TtHwcWtkV1RUcOjQIfbu3Ut6ejo1NTVtH6MqpKWd5OTJE5w4cZyPP/6YcePGc/U1VzN48JAORYtICdw0rFYpgRsdFcoXn63n2LFsxo0byKFD6axcvp0fPngdg4ckUlJSyX\u0026#43;e/aRBAnf1mt1kZJzmsV/cTmhoIGkn83jiidcYMCCuVQncuLhwQkMD\u0026#43;eUvnuPmm2c3SOC6l7xrtr9\u0026#43;0Ny54zhyOI3331vBoz\u0026#43;7tZkEbklJJW\u0026#43;\u0026#43;sZQZM0Yxb/4VuFwaH3\u0026#43;0lrffWsZjv7iN3LxCVFXlpw/fRGxsGK\u0026#43;9soTDh9P40xP3ERUVwkcfreHtt7/lz395iBEjkjh4II1XXvma2XPGytFML2qsqqqSnp7Or3/9azZt2oinh5WQ4EBMJlO3jnkM8vdpXMawG5cTBWw2O2knT/KvZ56huqqaP/7xj90\u0026#43;ZLe7oaPEewxJ6K2xXinwF/1vgQzdrGtlv6rOuDFFUXA4HGzcuJE33nyDzZs2UVpa2r7K0SSUpqSkhBUrlnPw0EEWXLWA6urqdrt3WkrgakIjIjKYDev3MmZMsi6Bm8jIUS0kcF/XJXD3Hmf2nHHExYVLCdyhfZhxNgncj9aiaYJZs8ZRVyclcE\u0026#43;ePE1QkO9ZJHCtfO97V/Hkk6\u0026#43;zfv0\u0026#43;JkwYAsjO6kiDBO4VejamwqLrpvJkCwncPn2kBK7JZGL8\u0026#43;MEkJkaiKAr9\u0026#43;8czeFAfBrklcBN1CdyqmoZkot4CIQRff/01W7ZsJiYyjN89cheTxg5pyAY1cOGorbfx/hdr\u0026#43;N\u0026#43;7X/PJJ59wzTXXMHXq1G4fstud0FHCF5w9Q7ZbPHlFUaipqeHV117jv88/T37\u0026#43;aYKCg5k\u0026#43;fTqDBw8hMCiozYG2oijs3LWLNatXYTKZ6NOnL1deeSULr15IbEwshw8fbhdRqapCVmYRu3YdISTEj8OHpehU/ulSnC5B4dkkcL0bJXBD2ymBu2nTAY4dzeIXv7wdDw8L/3n2E955ZwX5p0u56aYZZ5fATYjglltm8cnHa4mKCm1wtxQXSQlcT89GCVy/s0jgqiYVf19fWVHcErj\u0026#43;vuctgdtToCgK9fX17N\u0026#43;/D03TWDBrIvcvnofVar64VrOigKqAprV\u0026#43;Xreb7Hwjq9wV6mK8H1WRZbyY71pViAwLYvOuw\u0026#43;w/coJjx48xderUi3f\u0026#43;ywC9Th5ZURRsNhsvvfQS//znP7Db7Vx99TXc/8ADjB0zBn9/fznMbuPYoqIiTpw4wdSpU1l49TXMmjWLvn364OnpSWFRUQcmbxU2bznI2LGDue/\u0026#43;hfr5GyVwd\u0026#43;1KJSjIn9KyquYSuGXnkMAtal0C99jRbAYMiCc8IhBNE9z/wDWNErhRN55bAvfK0boE7nLqam2AQnBIABUVbUjg\u0026#43;uja5pdUArfnQNM0amtrAYgOD8RqMYHrIoZlKlBcWsXpghL6JUbj5dF8KUMhIDNb6jolxoajnkeQQVFZJaqiEBLod8HFPZVfiqeHleBA34vX6QmFAF8vQgL9EJqGw\u0026#43;7odcbDpUavHG\u0026#43;uWLmC//73eex2O/ff/wDPP/888\u0026#43;bObZh4dVvMrX3q6uq46667ePvtd/jRQw8xMDkZi8WCy\u0026#43;VCtDOuulECN4UZM0cTGxtOVFQokVGh9OkTzZQpI9m06QD9B8Rz5HAahw\u0026#43;l43Jp5OeXsnz5dup1CdzhI5JYvXonp0\u0026#43;V4HRqHE3NYuOGfWdUckVRiI\u0026#43;P4ODBE\u0026#43;TmFOGwO6mtbSKBm11wZiFbkcC94855FBaWNErgDu5Dvc3B2rW7sdsc1NbW8\u0026#43;2SLVICNzHykkvg9jwoTf69yFBV1m45wK0//gubdqWAqUnTVRRKKqp59ImX\u0026#43;fvLn\u0026#43;Jwah0vhKqyYv1e1m49BBfohhLAB199x3fbLvxcZ56811aeTkGvsvAVRaGwsJBXX3mF4uJibrrpZh5//HFCQ0Pb5ecTQhAbG0t8fHyzTsB97uYXO5cEbhEREUEMHdq3UQJXgIbGhIlDOHT4JJGRwcyaNZZXXvma4GBfhFCIigwlNFS6eebOHU92dgFPP/0eAYHeIFQmThxOYKAvLSVwp00fydGjWfztr\u0026#43;8QFORLTbWNmVeOwdfHkw0b9tKvX0yjBK4QBAf7ExMb1lBmTRNERYXwwPcX8cr/dAncsEDuvluXwN16ECGkt\u0026#43;Cee3UJ3OjmErihYQF4WC0NbdLH14uYmDMlcD3OJYHrVmikF/cN5wGb3YHDJVi//RAzJw7H4iZ9VWHPoROcKiojIjxEdqpI94\u0026#43;73ptMJukKgoaK69Qzst0uvNp6u3ze7nrt1gHS3XOoauvn07e5QzoVk4nq2nrqbXZ675iuZ6JXEb6qqmzfsYNdu3YRHR3Dgw89RFhYWIcnddrKkFRVtWFVHFu9rMxtS\u0026#43;DG8PAjN\u0026#43;PjK1f/aSmB\u0026#43;9hjt\u0026#43;kSuDMYP34w\u0026#43;fnFhEeEEBPTXAL3xz\u0026#43;\u0026#43;kYyMU1RW1pAQH0lgkB9OZ0sJXEFQkC\u0026#43;PPHoLmZmnKS\u0026#43;vJCY6vIHQJ08e1lwCVwimThvBpMlnSuBOnDiEoUP74O3tiaZpjBsnJXAzM/Iwmc307RvTKIF7x2ys1sZ46LlzxwKNUg0DB8bRt29khyRwpTSEC4fdgaoomE29qopeEISAsSMGUlhSQWZuIf37RIOmYbc52LI7hcljhzY807p6G2s2H2Df4eNoQjB2eDKzp4zE08NKflE5KzfuIT3rFIH\u0026#43;vlw1cxwD\u0026#43;8fpx\u0026#43;rvRFU5np5HaloeMycMw8vTzMatB9m\u0026#43;NwVNE4wfNYgZE4biYbXgdLrYuusIm3cdAeCKUYNwOF36\u0026#43;YwuuzuhV7Umh8PBtm1bqampYcGChYwYPvyiprf7\u0026#43;PgQHx8HwOrV25k3fwLx8eGtjjIVBcxmC/VtSuBacbp0CdzIYCKjQvQFHTRMJnODBK6iQGJitB44JNC0tiVwG/eN1iVw5T6eXp5nSOAqCphM5lbP4\u0026#43;HhoZfNrt\u0026#43;3F8OG9wfkSKBRAtfcbL8GsqmzN7tGcwlcS5sSuO5EsxXLt5OZmYefnx9xcbEYkBBCEB0eTGiwP9v2pErCV1VOZuVSVFLBtAkj2LnvKEIIPl26hUPHMpk3bRR2h5MvV2zDZDIxe8pIXnpvKR5WC1dOHsnxjFM8/9YSfv/w4sYOWFHYc/AE73/5HbOnjsLHy8o3a3awatM\u0026#43;Fswci0lVWf7dLioqq7nl6qms3LiPL1du5epZ4/Dx9mTb3qPs2HeMYcmJGBZ\u0026#43;90KvIXxFUairq\u0026#43;PkiZOAXNzA29v7ohG\u0026#43;EAJPT0\u0026#43;uufZaVq5cyYb1u7jn7idISopDUVS6tyXTM\u0026#43;SRFUWGbO7ZfYTq6lpuuOEqhg0b1q01aTobZrPK5LGD\u0026#43;XzZZq6bNxF/P28270phQN8YIsKDEAjsDhdOl8Z9i\u0026#43;cxeGAiOF2kZxdy6Gg6k8YOIiu3gHtunsP0ySOZOH4Y/ks3U1snJTgEsHbTfr5csZXF10xjyrjBlFVUs3brAb534ywmjh4IQFRECG98vIpxI5NZsWEPt183kyunjAQEQwYksn1PCq5O1mEycG70GsIHsNntVFZWYrFYiIiIuOiKj0IIZs\u0026#43;azS9/\u0026#43;Suef/45Dh86waGDx7v6tnsd3BK4v/rVr3r16kPnA00TDBmQwGdLN5F6MofkpFj2p6Rx/63zqKmzIQRYLSaumT2e1BM5fJKyDptDY\u0026#43;f\u0026#43;VAYkRuLv48WCmeP4ZOkm9h1Jp298JONG9KdPXARrt2is3rSX2to6ggJ9GTqoD6gqhSUVpB7P4NMlsGzNVgDqbHZyT\u0026#43;WTlnkKu8PB4H5x4HKBEESEBjJsUGJXPyoDraBXEb7QtAbdG9Ml0GtxW/k/\u0026#43;MEPGDd\u0026#43;PNu2btUlcLsnISkKuFwaa9asISXlCBMmTGTixImA6LbBDlarlYEDBzJt2nQiIyO67bPtKgghCPTzZuTgJLbuSaWqph4Pq5Uh/ePZceA4igJVNfW8/tEKvDw9GD0siejwEMoqqqiurkLTNK6aMZbxI5M5npFHyvFsVqzfzY\u0026#43;/dw2aJjCp8MdH7\u0026#43;Ddz9fy8dcb\u0026#43;OEd89GEIDDAj5mTRxGoS3UIIbPSg/z1/I5WBPoMdD/0KsLvDLglcCdccQVXjB/f7d0NDoeD0tJSUlKOcOWVM/ntb3\u0026#43;va7R3T7h1j3rkIuaXGA1rpCsKk8YM4p\u0026#43;vfsGx9FyunDQCTx/PhnUMsk8VcSIjl7//4QeEhQXhsjspLV\u0026#43;HWYWc/FLe/2ItD91zLXNnjWPO9DH883\u0026#43;fs33fUcxmE1dOHsXI4f3wtFr46wsfMyQ5gcH94wgODCAyPIRxYwYBkJ5xii\u0026#43;WbebmBVOwmM0cS88jMiIEEBQVlnHkWBZD\u0026#43;id09SMz0AIG4Z8nmsawd2fI8jUqc0rrvvuW2U1arS3McrlDVRS5ZKKmkRQfgZ\u0026#43;3BwePZvD7ny7WX658bsGBvjhdGl8u28LQAfEcTT9FRk4hVouK0\u0026#43;Wiqrael975lhlXDKWssoZjJ3O447qZpOcUoCoquFwM7BfDTQun8s7na/jjI7cz7YqhvPTOt5SUVuDpYWXJ2p0M6BNDXFQosyaP4J3P11BbW4ePtyebd6fi0gRWi4XuPGd0OcIg/A5CURScTif79u1jw4YN5ObmdPoiIe0vq3Tp7Ny5C4BVq1ZSUlLcbd05IGP1\u0026#43;/Xrz6xZs0hKSurq4nQfaIIrRg6gf2IUiiIX/L7/lrkUllYQFRYELo3\u0026#43;CZHcMG8C8VGhPHzvIpZ/t4usnNMMSe7L73\u0026#43;6mANHTuJhNvHIvYv4evU2lqzeho\u0026#43;PN4uvnc6UcYOJCA3EZFJ1aQbB3Kkj8bSacDqc3LJwCoH\u0026#43;vmzdnYJLczFhZDJXzRyLqipcfeV4fH282Lr7CKqqcsWoQcydOoogP5/zl3kwcElgEH4H4XQ6\u0026#43;eCDD/jHP/5OZmZmj7JC9\u0026#43;zZw549e7q6GOeEyWRm\u0026#43;PBhPPHEk8yaNatHPeNLBiEYmBQrfeWaXH1n6MBEdCEmEIKYyBBiokJAE4wb0Z/RQ5NwuTQsFjOKggzj1J/lD\u0026#43;9YgMPhxKSqcr5L0xjcP67hWgAeFjNzpo0B3QV4zezxzJ8\u0026#43;GhBYLOYGrRyrxcTcaaO4ctJwEGDW8y4uupaOgQuGQfgdgKqqbN\u0026#43;\u0026#43;nb/97a9kZ2czdGASIwb3wWLu3hK4PQYK1NbZ2bn/KPv27ePPf/4z/fr1IzExsdvPlXQKWspSiBbLrjXdrglM7uCFht8b91UAqzuwwf1sWyPnps9daI3ZvS0td01gVtvYZqDbwCD8DsDlcrFq1Sqys7MZPSyZV//xGEMHxDfELxu4MCiASxOs2byfB3/9L/bv38fWrVvp06dPVxfNgIFeAYPw2wm3vn5\u0026#43;fj4Ak8cPY/jgPpibaOe34yS6mJRoXeJW1be7tLOf0714bMOEbJMUdkU90/Jrdn2lwSXQ/Nrucl3Eruts12sDFovCtCuGMnRgH1au30lWVpbh0jFg4CKhV6plXkq4ycfTapEPrwNkZLM5WL52B9t2p5x5mKJwqqCUz5ds4HRB6VmU2aCmtp7te49SV2fTpQ7qEZrA5RLsPnCcguLyM49XFErLqti47ZAuatUc\u0026#43;w\u0026#43;f5ET6qbav21EoCuUV1WzZcRibzdH\u0026#43;4wSYVAUPi7RF2lqOstdBLiZ8NkW\u0026#43;9ilPuo2BNredx3GqcmkUEnrhMpfdHQbhnyc6bHMqCjV1Nv756uc89Z8PKKuoOaOBfb58C4/9v1c5mpHXduNWFMoqa/jgm01U1tRTXFrJyx\u0026#43;soKKqDpemsXHXUfIKylol/Oz8El7/ZBXVtfXNtgvgmzXb2bIntXkjPCd5tLJNocGyzyso4e3P11Jbb\u0026#43;tYR9LC33w5oLbOzuGjGZSWV7Xy7qCwpJzUE1nYHWdZf0iBqpo68gpKG9z27gGbJgS5\u0026#43;SVU19jOJG8FSsuryM0vPuOpuzSNzJwCamptF5X062x2snILcV7MNQMMnBMG4XcihBD4\u0026#43;fpQU\u0026#43;9gf2pGI7kqCsVllew9lEZifKw\u0026#43;TybO8K40eHAEDZLLNfV2jmecotZmx2xSWXzNVAboKoqtXd/pdLXKpS6XhquJfK7DpVFaVklVdS1Cad4J2BxOSkorqKyqodlVVIV6m5OSskps9XaErnxpeGTOAVXlZHY\u0026#43;dz36d978dPUZz8vp1Hj29a/48e9foKSs6iyWuMqhY9m8/fk6XEJwLOMUS7/bjSYEDqfG\u0026#43;19v4GjGKen2a3Hcd9sO8sbHq5vr3ygKtXU2/v3alxxNb\u0026#43;W4C7jfrLwinn39yzOMDwOXFoYPvxMhhMDH24sBfePZuieFaeMGYzapup55Gr4\u0026#43;XgzuHw8KnEg/xdG0XBbMGINJ7xhWbdpDaHAgUeHBqKpCbn4JXyzfyK79Kfzntc\u0026#43;588bZHDmRx8jBfRiYFN2qP15RFBSTKhfQaGAWBUVRpQGnKGTk5PPhNxs5nV\u0026#43;IyWJhyrihXDtrHFarhcPHs/ls2WaKS0pRFJVJY4dy4/yJWK0W9h5K44sVW6morCQsNJj46HBQFEMvsR1wOFxoQmH7vmMUlVYQHhIg34\u0026#43;qkJldxN4j6agmi7SI3a6Zpu9XlSMuu8NJVU0dqAq5BaXsOHCc\u0026#43;VeOxWJWufrK8USGBrbihlSoszmorDlzCWpNCCqqanA4nY2jN70jd2dFNxgXqlz3wOVyYTKZJI\u0026#43;7y6iTulSDVXC6NCqqarttDktvhUH4nQ7BhFEDWbt5L1mnikhKiMJuc7Bp52EmjhnEvsNpKED26WK27zvG/OmjMek65XsOHicxPoboCCmlHODnzfhRg0g9mceUK4YRHOTP3sMbiI0KASWm\u0026#43;RBc98BUVtew\u0026#43;\u0026#43;Bxgv19GjRQhIBTBcUkxEZQW13H/z5YTkJsBHddP4Pi8ire/mwtPl4eTB47mDc\u0026#43;Xs0VowYw9bZ55BWU8uK7S0lOiiUs2J8X313K3GmjmTx6IDn5Jbz64UpKyyoNXZV2QBOCpMQY/P192Xs4jfkzx4BLTshv2Z1CUkI0tXVSljq/sJTThaWMGNSnYSnDQynp\u0026#43;Pv5NpDw8bQ81m7YxZET2Xy9bBOzp4ymtLyaQH/vVq\u0026#43;vIDN5GybaBQ3k3qCTryhUVNWwatM\u0026#43;Uo5l4OPtxZVTRjFqcB8UReF4\u0026#43;ilWbdxDQVEJ4aHBLLxyPH3jIwE4XVjG8vW7yc7NJyEuiqiI4PNahtHAhcFw6XQyNE0QHRlMXHQY2/cdA1UhPaeAwpIKrhiV3LBGrGx3zRuEoqfWu\u0026#43;Hv683YYf2JjQpj4pjBhAYHSAse0JwuSsoqKC4pp7SsEs3pQlUUikvKWbJqK58t28hnyzbx\u0026#43;dJNfL5sI0fTslFVlSMnciirqOaq6aPx9fagT0w4U8YNZv32g9TU2bhy8kiunjWe0OAAEmMjsFrMnMqXnVNsVCg3XDWJmOgwJowdxNWzx6Oa1DPXvTVwJoTA29PKpNGD2LY3FbvNIQm2UnbQMyYMw2w2oagKqWm5fLV6p3S/6Fb38vW72HngOKoqR2oulwu7w4nT6cJmc2B3uli2fheZuUVtTpbW1dsoLimnuLic4pJySkrKKSmtwG53yqxtu5PXPlrJ3sMnmTRuCDFRYbz64Qr2HkknL7\u0026#43;E5978Bm8vT2ZNGYPD6eL5t5dQVV1HWUU1z7z6BYXF5UyfOByz2cQn326isqbO8OZ0MgwLvwtgMZuYPHYwX67cyvXzJrJ5Vwr9\u0026#43;0QTHR7cfIjbyuRaSwhdZExrEsqpqCpZp4p5\u0026#43;Z1vqKquISjQnx/dvQgBJMZF85uf3kFYkF\u0026#43;jHhDw/577EIDc00UcTj3JP176WDfwFKpq6gkLCcTHy4PIsEA\u0026#43;\u0026#43;Go9NrsD1STJ3iVc5OUXkxgbgdnsXrxbpW9cJP6\u0026#43;3oYPv50QQjB\u0026#43;xAB2HzxORk4hyf3jOHg0E1VVGZqcyMoNewFpNLRcT9jl0vSlDeVoYdCAeBbMnoiPry\u0026#43;3Xn8lTocTTROy8xXgbDLHYzapqKrCjr1H\u0026#43;L9n39WNCoGCQr3dwcnMPMwmE8cy8jiZdZrf/XQxsZEhCASq2cSKDXuYO20MY0ckc8eNM7FYzCQlRvObv71BSVkFR07mIgT89L5F\u0026#43;Ph4giaw2R0sWb0Nw\u0026#43;HXuTAIvwsgNMHwgYl88u1Gtu49yoHUdO68fqb05zfdrwlRakJQU\u0026#43;dow1pu3myEEMRFhvCzB67HpWmYVBNhIYEUlVSg6iGPVqtZ\u0026#43;lf19WZNelSQh9XC6OHJ/OqHN2JSVRQFampt2OxOjqbl8s7na7lp4RQGJETh5e1FenYeCPD0sDYP91Sg3u7A6dQMK66d0IQgIiyQvvGRbN8nV7TauOMw44YPIECXJXbjjEfa8gchGoyBphP4qqqQc6qY9z5fRXVtHQF\u0026#43;vtxzyzwAxo4cxG8eurlhzki6AOt44tn3EUBa1mmOnczkpbe/1qcMFApKKhACkuIj8Pb0YOXanVTV1HO6qIzColKcLo30rNMM6hePj7cHOF1gUhk1tB\u0026#43;bdhwyRn\u0026#43;dDIPwOxkyJ0oQEOjL8EF9eendb4mPCmNo/3g0XWdcCPDx8qCopIyaOjuBQb6czivi4NFMhgxI0M/jTpdXsDud2ByuBmVMIQRmq5nI8JDGC6uKLm0imqfgN1j5cvnE/n1i\u0026#43;GjJRqpqbXK1JE3jw682UFpeRXCgH95eFqaMH4rZYiIzK5/jablMGTeYQf3j\u0026#43;fDr9RQWVxAeFojd5mDD9oOUV9UYVlwHYDHJFa0\u0026#43;XbqJ0cP6k5VXyO3XTQdaBFc1eaRCj8JpD3UKAYH\u0026#43;3kybOAKH3YGHhxU/Hy\u0026#43;EEPh6exEVGYrZ1OjD966qwdPDKpff1DTiYiKYNdU9ryRHCn4\u0026#43;3uw7ks7y73YxaexgBvSNYWC/ePYfPq5r54szAnzOFvFr4NLBIPxOhKIq\u0026#43;Hp7YjJJDZMpYwfz3ueruWXhVHx8vbDV2/Hx8sBsUknuE4OqKPzj5U8YkBjF6ZIqwkKC8PLyRFUVfLw8URTw9/PGajbx71c/5Xs3z8XH20u6VVoKVwkFs0nF19uz1UlUb08PrBYz/RIimTJuMP969QuuGDmAquo6jmee5qf3XIuqKHy7dgf/\u0026#43;t9nBPr7kF9cSXRkKLsPHOen9ywiLiqUv73wCcOS4ykuq\u0026#43;J0YRl946ONZU07AE0TDB2QwCffbuK1D1cSHxNGQnQ4pwtLG/axmM1UVdfi1DQsJguVlTUczzjNgL5xZ55PCISq6hPAemiwnw\u0026#43;Txw1p3Ekf5cn0B0GzWNsGI0ToczZWhgzsQ0SENCY2bj3AwaNZZOcVMGxQIjdcMw0QpKRkUlpejcmkkhgXyeZdR6irt\u0026#43;Pl5QECDqZmUF5Z09WP\u0026#43;7KDQfidBSHw9/Hilz\u0026#43;8geiIEHBp9EuI5OW/PkxMhFQ4tJhN3HfrHIIDfAj09\u0026#43;G3P7mVzTsPY7PZuWr6aG5ZOBVPq4Ugfx9\u0026#43;eMc8Av29sVrMPP6jm8nKzScqLIjv3TCD4ADfBoXDxutr9ImL4Offvx5/X69mnYEC3LZoBp5WC4qicPeNsxianEjq8Uwiw4O4bt4k\u0026#43;sZHIjTB736ymJ37j2Iyqdy8cDKhQf7knCokwM\u0026#43;bR\u0026#43;5dxPZ9R8nMOc3IIUncfVMfamrr8fXyMFQTzwW31j0Cf39vRgzqw79f\u0026#43;5z/PvVTVF19UtXXCOgTF05RSTkffb2Bwf1jOXg0m8qa\u0026#43;gZVTEUXdwrw8\u0026#43;FkRi6fL1nP7KljUFV3xI3Q51l0mNQzAgKaQlXldQclxRIZFsi//vc518weT0VlLd\u0026#43;s3sEt10zDpMLmnUdIiAnHZnOyY/9xHE4nB49lMXHUIFZv3MtL7yxl0tiB5JwqZvPOFAL8/br6qV92MAi/E2Exm0hOipNkLCTBD\u0026#43;of36B9oyoKfeMjGqzzuKhQbrt\u0026#43;pjy4qcUuBEkJkQ0xzrGRIcRGh\u0026#43;o\u0026#43;eWhVllaAr7eHvH4rSVkJseENx3lYzEwaM4hJYwc1XA9NoCgweEAcg5PjG38XEBYSIM/poTB76ihQRjWWITTAUE88F4QgPiqEu2\u0026#43;cha\u0026#43;XJwjBvGmjCQnwYfSQPuDSCPTz4fZrpxHo542fjxc/ufsalq/fRXpWHuNGDOQXP7iR0CA/gvy9uWbmWFQFhg2I53s3zKKiohJVUbh21jgSY8NbVbocOyyJxNiw5gE8QuDlYeWORTNIjA7Dw8PKI/ctYsmanSxdswMPTyuLr53GtPFDqapJQghYvm4nQYH\u0026#43;XDVjDFdOHEptXT2hQb784oc3smTtDr5ZuZW4mEh\u0026#43;es81VNfU4uVpNYyBToRB\u0026#43;J2NlmR7xvcWcreuNhpDW/udre0IzrT8Wztfa\u0026#43;Vqtl9rKcC0LtpmtOVzQwgiQgOYO32MfO6aIDoimGvnTWrQuvfx9uDKKSMa3tPEMQMZN6I/miaw6rpD6HkVUeHBIASeHhYWzhovt2kaE0cPbNyvxfUH9I1lQMtkLsBqMTNr6ii909cIDfLnnptn43A4UVVFug81QaC/D/feMqeJxr5Kg/WhCRJiwvjRXQtxOl2YzSZUd89iGAOdCoPwDRjoDmjZGbfWeTYlR7f\u0026#43;vEqLuZqGf/T9WpyzzeuLtjvnFsZFcy19cZbfmx\u0026#43;ntnacgU6FkXhlwIABA5cJDMLvblDV9sngXiw0k19QDMlaAwZ6MQzC70bQhGDLriPs2Jt6xujaZnc0k8Zt\u0026#43;f18IIC6OnuDIFd\u0026#43;URl7DqYZglbdHW0ZBe3IzD4vtFBLNQLoey4Mwu8uUBSKSqv412tf8u/Xv2qul68oLP1uN\u0026#43;u2HWpYJKPZ94Zz0KFFLuwOJ298tobjmafBpJJ9uoSNu1Obpd2fs4EbBNCpaMsoaNZ5t/L9vK/nXmBHyKzsY2m5HM\u0026#43;4iAvlGOhUGITfXaAq7DxwjAF94wgK9GfP4ZMN7hUhIOd0MacKyxoSYZp\u0026#43;B0BRqLc5KCmrpK7e0dAg3VNnLiEoq6iisqpW5tUoCg6nxsnM05RV1YCmMSgpllsXTpELVSsKGlBZVUtZeRUOtyyv\u0026#43;5yKgt3porSskhpD07xzoCgUlbVuFLTsvJt9b2YUdKADVxQKSyv434crKa\u0026#43;qBVVh/9EsDh3L7pjVbxgF3QZGlE53gAJ1tTa27TnKvOmjKSgqZ8OOw8yYMAyTqvDtup0sW7cdq8WC1STw9vJi\u0026#43;brtWCxmPM1w09XT2Z\u0026#43;SwVertlFZWYmvry/Xzp7ApLEDOZ6ex95DadTZHBxKOUG93cmUcUNZMHMsH36znm27D1FRUYHLZiMsLIQDR7O4af4EbHU2vlixlV37jyKERnRUOLcunErfhCg27zhMQUkluacLScvIQVHN3HDVZKZfMdRIqr2UUBV27pdGQXllNXsOn2TOtFHgEg2d98ih/UDQ4rueZaso1NTUYXc48PPxxmIxSwMCpAHgcFJdXYuHpxUfL08AauvtHMvIo87uIEgTzJo0XJK3Jg0Ap0ujqroaVVXx8/WWyVtnO6cRc9\u0026#43;lMAi/O0BROZqeR22djZGD\u0026#43;1JWUc2ydTvJyClgQJ9oBibFkZwUj7eXJyOH9MNsNpPcLx4vT09GDutPZm4hr3\u0026#43;8koVXjmfM0L4cOZHDe199R1hIAHn5pbz8wXIeWDyfRx\u0026#43;4gdz8Ep5/8xsSYsIZM3wA67cfZuzIQSQlRnM8q4ADR9K4bs54Pl6ykQOpGdy/eD4Bft4sXbeb/7z5DU/\u0026#43;7E72Hk5j9ZYDPHLvtdx01SS27DnK6x\u0026#43;tZFBSHBFhgUajvhRowyiYOXEYNpuDdz5bw7bdh6isrKS8rJzsvKKGztxZX8fkccNY\u0026#43;t1uNu44iM1mJyoilMXXTCcpsZUO3GTmxqum0Dchitc\u0026#43;WMbufSk899rn3HfrfHILylEUhZmThpJfUMoHX28gPSsPk8nEkAGJ3LxwCkGBfq2e84b5hlHQ1TBcOt0AQtPYtOMwg/rH4e/rRXREMLHRoWzaeRgUhQH9YhmYFM\u0026#43;QAYkMHZLEwAHxJPeV3wcPTmLrnlSiwoOZNGYg3p4ejB3Wj7ioUDbtPIIQgn7xkSyaM56EuAgmjhnEgD7R5OYXM2poPxJiIxk7IpmY\u0026#43;EgUwGRSKSqtZOueFO65eTYjhiaRGBfJPTfPBtA11xUmjkpm9pQRxMaEM3f6aKwWE/mtLZ5u4OKghVEwfuQAcvIKSc8pwNPDwqhh/YiPjWLsiIEMTIpj5FD9\u0026#43;8hBJCXGsGHnEVas380tV0/n1w/dQnRkKK98uILKqlr2Hk7jrc/WMGRAIr/\u0026#43;0a1MHjuE1z5aic1mZ9yogcRGRzBx7FDCQgI5npFHWtZp6uvsPP/2EuwOJ48\u0026#43;cD0P3rmQ9JwC3vh0NZpLY8/hk2ec8/WPVlJYXGHUkS6EYeF3NRSFwuIK1m7ZS0igD6dOFwCQejyTtMw8bl44FX9/bzRNQ9M0PfMS/bsAp5O0rDx27E2hpKQUITQURaGotJKZk0ahCUF0ZCheHlbQNFQUvDzNCE1mTgqhIfTsTnd5ikrLEUKQEB0uNVeEwMfbk36J0ZwqKMVsNhEbFYaiKg0JQFarCU0YC1JfKrQ0Crw8rcRGhbJpx2EG9I1h5BDZeY8ZkUxSUhzRUTbZmY9MJioyjBffW86UcUNI7huN0ARzJo9g94HjHDqe1awDV1SFub7erNqwmzqbnfEjklm35RCTxg4hKNi/wSg4fDybwuIKHr3/esJC/AGFH9w\u0026#43;n6ee\u0026#43;5DMvCJUpfVz5heXExEeZIwCuwgG4Xc1VIXt\u0026#43;44SFRHCLQunNCwzN2HsEN79fB37U9KZNnE4wBkql4oelePj5cX8mVdw\u0026#43;7XTG9YaLS2vxtfXixNZ\u0026#43;WdeU66c1xxNvntYLQghsDmcDdnxQgiqa\u0026#43;oIDvCjrkGwx0CnQFEochsFAU2MghOZpGXlccvVUzGbzU06b03XwpcdeX1dPSfSszmZns32PYekZDFQWFyBrd6G2WxutQN3uUTDeYRuaMjiKGTl5hMRGiCF\u0026#43;lwaKBAZFkRQgB8FJRVYLGbDKOiGMAi/K6H7ZTfuOMRVM8Zx5bQxTSxtSM8uYN3WA0wZNxiAOpujcdES93cBQ5ITWLlhLx6eHgSFBFBfU8/bX65n1OC\u0026#43;WKzmZgtnuCF0LX3NpVFvdzRcV9M0osKD8fP1YdPOw9y8cAqK2cTJ9DyOpuUwf8ZYtu1Jbf18Rh9waaAqbNvfwiigqVGQwfiRA5oc0MIwUFWCAwO4ZvYVjB2W1LBaVkFxBXExYaSezKW1l3e2bt3L04N6u0MusKPr5jidLurqbVh1dU\u0026#43;jQnQ/GITflVBU0nMKqK23MX7EALkakJucVZXpVwzj2de/oqConMTYCN79Yg0\u0026#43;HiqLF80kMSac975ci6\u0026#43;nibnTJQk/9dyHDE\u0026#43;OJzO3iDqbg3EjBnD4eBZenh7NLuvpYcVqMWO1mIiKCOatj5ajaE4sFiteHlb8vD2547qZvPrhcnLyCgnw92bP4XQmjxnM8OQE9hw8gdViabT4AB9vjwadfwMXEW6jYPvhto2CLQcYNSQJTROy89Z1bTSXRr3NjpenlaSEaI6m5zF/5jjMHhZOnyrio283cd\u0026#43;tc1tdH8EtraOg4HC69CQ/OTLQNI3B/eP5eMlGDh/LYvSwfoBgx/5jOBxOEqPD2G4YBd0SBuF3JYQgMjSAn99/PRGhAS3WNNRI7hPNY9\u0026#43;/Hl8fT2ZPGUFUeBAWs4qKwpwpI4mOCMZiVgkJ9ONXD97E1r1Hyck9zcjBfZk8bgghQb4MT04gITpMCm3pwlo3LZyKh4cVgAdunUvqyWyiw4MJCvQjJjwYk6owfkR/QoL82L43lfp6G9\u0026#43;7cRajh/TFZFJZMHMsJpOqyzyDl6eVh\u0026#43;68hsiw4LbVOA2cH9xGQV19m0bBf974ipLyKmL0zls47Uy9YjhREcG8\u0026#43;dFyhMvB9fMn8fRLn/K3Fz4mJiKYg0ez6BMfSVJ8JJt3Hmm9A1cV/P28MJtU/v3qZ/zwzoV4eVoxKSqJsREsnDWel979ljFDk3C6NPYdSWfxNdMJCfbHajUbRkE3hEH4XQkhCAnyJyTYv1X1wEa9fEmsY4b3lxs0DU8PS7Pvgf4\u0026#43;LLhybKN/XpOytEEBvgQF\u0026#43;jY7f1x0eMP1gwJ8mTRuSMP2AH8f\u0026#43;beuuZ\u0026#43;UGKXvS4NUb3REcMPxINfD7dcn\u0026#43;uyKiwbOD26j4IG2jYKfP3A9wQE\u0026#43;3HfLXFJOZhEdHoRJVXng1rmknMwmOjyIPnFR/OnRO9i\u0026#43;J4WyikqumT2eCaMGYjGbWu3AH7zzGqLCgvD19uQ3P7qZzNx8ggP8mDd1pLtg3DB/Iv0Soth/5AQ\u0026#43;Xp489oMbGNg3FoTGwpnj2jynYRR0HQzC72qciySbyhycTUu/Le381s7fTE63xXFN99XaGIO3FmFx0fV3jNA9oGNGAYpculA0dvZNv8dFhRB37bQm6xm33YH3b9KBx0aFEhsTdoZMsllVGT2sH6OH92s8XpPHnOucBroGBuGfJ6TAmBGtcikgkJoxEj2H\u0026#43;N2ucNfFDjlst1HQsvM\u0026#43;x/emv59xzvYuxNOGtX7JjAKlSd2g1fkHA23DIPx2QgiByWTCz0\u0026#43;uw5lyPJPCkgoiI4yY4osKRSEzt5D07HxU1URYWFiPaNQWi4WQ0FAADh3LorismtAQf6NuXEwoCiezT5OZk4/ZbGloiwbaD4PwOwCz2cyUKVP44IP3\u0026#43;W7LXh7904tMvWKY7qvs6tL1AihQV29n6drtpJ7IIDGxL\u0026#43;PGjW81rLQ7QQiB1Wpl\u0026#43;rQZfP7Z56z8bgc/e\u0026#43;IlJoweZNSNiwUFamptfL1qC2mZuQxITmbUqFHdvm50NxiE3wEIIZg1axZ3330Pr732Kh9/s5ZPlqw7R6a4e2NXVszuUAYZ4ifOUQ6hJ3mFhobyk5/8hKFDh8gM424OIQTz58/jjjvu4J133ua9z1fy/herekTdkHpn3aF\u0026#43;nv1ZuOtGREQkDz/8CAMGDOgRdaM7wSD8DkAIga\u0026#43;vL7/\u0026#43;9a8ZNGgQK1au4FReHvX1tjYbttPpxOl04unp2WXl1jQNm82Gp6dnl7lHhIC6ulo8PDyl1dsGvL296dOnD4sWXcfsOXP0DNLub8UJIQgICOD3v/89Q4YMYfWa1eSfOo3Nbm\u0026#43;zbtjtdoQQeHh4dOxiFxEOh4P6\u0026#43;voudY8IIaivrz9n/fTx8SUpKYkbbriBGTNmYDKZekTd6E4wCL\u0026#43;DcDfsu\u0026#43;66ixtuuJHa2hpcLler\u0026#43;5pMKrt27ebYsWMsXnwritL5WnWqqpKbm8uyZcu47bbb8PX17fRGoigKNTU1vPvuuyxYsICEhIQ2LTOLxYKPjw9eXl5SAqAHNWghBMHBwdx///0sXryY2traNuuGqqqsXbuWmpoarrnmmi65T5PJxK5du1i3bh0/\u0026#43;clPGp55Z0JRFIqLi/n000\u0026#43;55ZZbCAkJabMMFosFX19fPD09e1zd6C4wCP884K5oPj7e\u0026#43;Ph4oyjKGXNz7mHyvv37\u0026#43;G7dd9x662JiYqJ1ouscK1tRJLFs3ryZr7/\u0026#43;igULFzJgwACdhDrL0peT3Tt37uSbb75m0KBBTJgwAU3T2pjPbJR46IlorBs\u0026#43;\u0026#43;Pj4tFk37HY7W7ZsobCwkFtuuZXAwIBOrxtCCPbt28fatWu47777SEpK6tS64a6f\u0026#43;/bt46uvvmTmzJkMGzasQfqhxZNt\u0026#43;Kun1o3uAEMe\u0026#43;QLgtjI0t8BUkw/AqdOnWbN6Dfv27WXDhvUN\u0026#43;7fc99J9BFVVVXz77bekpqayYvlyHA5Hp5fBbrezdOlSjh07xooVK6iqqjpLGXqH5XauunEyLY1NmzaybdtWdu/e1eSYznkvALm5uaxcuZKTJ0\u0026#43;ycuVKXC5Xp9eNmpoavv76a1mGVSux2e1nrRe9oW50JQzCv0RQFIUdO3aQmpqCzWbj66\u0026#43;/pqKiolN96KqqkpKSwpYtmwFYuXIlp06dQlU777Wrqkp2Tg7Lly8HYNu2rRw7dqxTy9DdIIRg/fr1ZGVlU1ZWxjfffE19fX2nz69s3ryZ1NQUhBAsX7GcgoKCTq8bKamprF\u0026#43;/HoB169aRm5NzWdeNSw3jyV4CKIpCbW0ty5cvo7q6GoDt27exZ\u0026#43;/eTq3MTqeTFStWcPr0aQBSUo6wZcuWTn8e69au5dixowDk5eWxZs2aNn3bvR2KolBWVsbKFctxOh3y\u0026#43;axbx7HjxzuN8BVFoaqqiiVLllBXVwfAwQMH2L59e6d2Ok6nk2VLl5KXlwvAyRMn2NwF9fNygkH4lwCqqnL8\u0026#43;Am2bN7c8FtxcTFff/VVp1ly7snaNWvWYDKZUBQFl8vFt98uobKyslPK4J6Q\u0026#43;\u0026#43;qrr7Db7YD0v65atZLCwsLL0pJz\u0026#43;6z37Nnb8FtWVhbLli7tNN\u0026#43;0qqocOHCAlJQj\u0026#43;Pj4oKoqFouF5cuXU11d3Wn1Mzs7m2XLGu\u0026#43;7vr6e5cuWUlVV1SOS7XoiLr8W1wlwuVxs3bqFpKR\u0026#43;DB48BIDk5GROnT7FyZMnO60yp6WnM3v2bObMmYuqqtxxx50MGJBMTk5OpxH\u0026#43;3r170YRGXFw8ABMmTsTDw5O9e/de4Nl7Jmw2G5s3b2bMmDH06dMHRVEYOnQoR48eJa\u0026#43;T3G1Op5Oq6mp\u0026#43;/evHGTduPGazmZ8\u0026#43;/Ajjr7iCkpKSTqkbQgi2bduGf0AA4eERmExmps\u0026#43;YQVVVNampqQbhXyIYhH8JYLfbGTlyJC\u0026#43;//DI33HADAOERETz6yKP4\u0026#43;vp1ysSTpmmMGT2axx57jLi4WIQQDB8\u0026#43;nF/\u0026#43;8pfEx8d3ijXpcrmIj4/n4YcfwcPDiqenJw89\u0026#43;BDPPfcckZGRl51bR1EU7HY7s2bN4uWXX\u0026#43;bKK2fJNYf79eOhH/0IcyfGlc\u0026#43;cMYNFixbh7e0ty5CUxL333ENkZGSn1A2n08nwESP4/gPfBwQBAf786pe/4m9PP42vr68RiXOJYBD\u0026#43;JYDVamXChAnExcUxc\u0026#43;ZMoqOj2bN7N2npaSQkxHdao/b398dqtepCb7IT8Pb2xtfXt1Our6oqSUlJ7Ni\u0026#43;jZMnTzJo8GDGjx9Pv379GDly5GVnxQkh8Pb2ZvLkycTExDBnzhz8/PzYuHETFeXlREdHd0rdUBQFDw8P/Vp63RAaZrMZs7lzIrXNZjOJCQmsXbuWwsJCxowdy/Dhwxk6ZAgDBw7slDJcjjAI/xJBCIHL5WLEiBEsWrSI2tpanv33s2zatAlVVTtt2NySQDortE1VVVwuF5999hlvvvkmHh4e3H7bbcTGxl52ln1LuOvGlClTmD17NkVFhTz99N84eOhQw3xLV5WrM6CqKna7nTfefJMvvvicgIBA7rzzLoKDgy/7unGpYSReXUIIIfDy8uIHP/ghBw4cYOvWrTz22GM8/vjjzJ07t9PS2RVVEoiqqp1CKEIISkpK\u0026#43;Pjjj/n3v/9FUVERt9xyK7fccqueiGTEUgshCAoK4uGHHyE19Sjbt2/n0Ucf4fFfP87UqVPx8vK6pNdXFKVZXVAVtVNWo9KEIO/UKd56801eeukl6urqefDBB7lq/nyjXnQCDMK/xNA0jf4DBvB///cUv/nNb9i1aycPP/xTZs\u0026#43;ezdy58\u0026#43;jXvx9enp6XREXXHZlTUlyCEIK8vFwOHDhwSf2j1dXVHD5ymGVLl7F582bsdhsLFy7kt7/9LaGhoYZvtgk0TWPs2LE89f/\u0026#43;H7//3e/Yvm0bP/zhD5k3bx6zZs2iT58\u0026#43;WK2WS1Y36uvrqaioRAhBVnYWBw4cuKQWdnlFBfv37ePbb5ewc9cuVEXhzjvv5Oc//zk\u0026#43;Pj5G3egEGITfCRCaxoQJE3jhhRd49tlnWbp0KZ9\u0026#43;\u0026#43;ilff/01vr6\u0026#43;l9xv6s5s/d///sc777xzSa9ldziorqrC6XQSGRnJ4sW38dBDDxEbG2s06DYwf948goOC\u0026#43;Pe//813363jnXfe5uOPP8LX1/eSWt1CCCorK3E6nfzzH//g\u0026#43;eeeu6T3abPZqK6uRtM0EhISuPvue7jvvvsMQ6ATYRB\u0026#43;J0EIwZAhQ3jmmWe4/vrrWbZsGfv27aO4uKgN7ZCLduUmZQCT6dK\u0026#43;cn9PT5IHJHPFFVewcOFCxo4di6enp9Ggz4EJEybw4osvsu67daxcsZJDhw5RVlbaMOF\u0026#43;KeCWWADdxWM2X1Kl5qAgb4YPH86kSZNZePXVDB82DLPZbNSNToRB\u0026#43;J0ITdPw8/NjwYIFzJo1i\u0026#43;KSEsrLynA6nVwKwSpFkfK3Tz/9NEuXfsutt97K97///UtIInIhkJCQEIKDg7FYLGiaZjTodkDTNIKDg7n5ppu5euHVFBcXU15RgXaJxMwURaG6uorf/u637Nmzhx//\u0026#43;Cdce\u0026#43;21l9T48PT0IDQ0lMDAQEwmk64zZPjtOxMG4Xcy3FEyVquVmOhoYqKjL\u0026#43;kkqsPhIDhYLigdGRnJiBEjLmkjaypyZURcdAzu5\u0026#43;bp6UlcXBzx8fGX7FqKolBeXo6fry8KEBcfz8iRIy/pO2taNwwjoGvQqwhfURTQZV/FJRwKXwx0Rnike9LWfR0hNMPi7gHorLrRVKJaaBoul8vopHs5elUcvtlswcvLC6fTRUVFRVcXx4ABAz0ETqcTIQRKJ\u0026#43;XIdBV6FeF7e3sRFxuHEBqpqakNgl0GDBgw0BaEEOTn52O3Owjw92\u0026#43;Shdz70GsI3\u0026#43;0XHzN2LGazmc1bNpOdnX1ZKjIaMGCgfXBLme/cuQMhNAYMSO6SZUA7C72ODadOmUL//v1JTUnhgw8/xG639\u0026#43;ohmoHOg1GLeh9UVWXP3r1s2LABHx8fpk2bhtVqbXVfpRfUgF5F\u0026#43;Jqm0bdvX26//Q5MJhOvv/Yan3zyCU6ny7D0DVwweqfNd/nCZDKRm5vL8889x6lTp5g4aRKTJ09uM6hBILDZbO7tLnpglehxUTrnGmmZzWbuvPNODhw8wGeffsYf//gHCgoLWHzrYqKiojpFL6S7oKVeSu/EJW9zdsDpdDp7/WhRUZRefX9N7xMgLS2NP//5zyxbtpSoqCgeevAhwsLC2iZ8ISgvL3dvrwV6XLhbTyL8ekCz2W2qTFRqHZqmER4ezp/\u0026#43;\u0026#43;Cc0l8aSJd/w/556iqVLlzJ71myGDRuGv78/l8UAXZHRB/n5\u0026#43;V1dkksCIQR1dfXuBmgDnBd4ytZQBlTW1NREFxYUdPUtX3zozcDpdGKz2Xp9WKbT6aSwsJDNmzfz1ttvsWvnTgICA3nsF7/gyiuvbNN3rygKDoeDgsKGOlAIOLr6fjqKnkT4RYCjpLjEXF1dTUBAQJsvx\u0026#43;3a\u0026#43;cc//sGgQYP44IP32bVzJzu2b8fT07NNH11vhXvd0t4GIQQFBfnuaKxSpNV1sVEKZNfU1Aw8cuQI8\u0026#43;bN6\u0026#43;rbvuhwuVy8\u0026#43;967bNmypddOVrpRVVVFWloamZkZ2Gw2\u0026#43;vcfwM9\u0026#43;/nNuveUWLBbLWe\u0026#43;/rKyMY0ePgiT6E0i3To9CTyL8LKAiNzfXKysri9jY2LPurGkakZGR/PKXv2TBggWsXr2anTt3kpOTTV19/eVg3wOSFAsLC3E4epwxclYoioLNZuPgwYNuqzSdS0P4lcBeTdPmbt6ymfvuu4/AwMBeQ4zudrBzxw527tjR1cXpFHh6ehGfkMCc2XO4/fbbGT58OKqqnvWdqqrK4cOHOX78OEAJsL\u0026#43;r7\u0026#43;N80JMIPw04VlpaErl\u0026#43;/XomTJhwzgM0TcNkMjFy5EiGDx9OTU0NlZWV2Gw2fY/eTftSS8fJk08\u0026#43;wVdffdnVxbnI96aQmZnJzp07QbpzdnBphtgasAZ4YNfOnaHbt29nwYIFvcb14aa4a69dxKhRo3pNR9b6fQq8vbxJSExk0MCBJCQk4OHhcU5NH0VRqK2r4\u0026#43;uvv6K0tBRgD5Da1fd0PuhJhF8CrNY0bcqSJUtMt9xyC/369WuXTIB7H19f305bdKQ7wL2Gam\u0026#43;8Z5fLxZIlS0hLSwM5vN56CS\u0026#43;3G9hYVlZ2wxtvvMHYsWPPOrnXoyBktMpVCxZwz91395qOrC24J6Y7oumjKAqbNm3k22\u0026#43;/BTmK/BQo7\u0026#43;p7OR/0pFhFAXwNnDhy5DBvvfUm9fX1HYoqcL/gy\u0026#43;3T26w2k8nEvn37eO\u0026#43;9d3E6nS7gC6RL51KhAngNKFi3bi1vvPEGNputd0W0NBE2680fTdcMam\u0026#43;7MJlMpKWl8a9nnqFATtqvBZZ19es6X/QkwgdIAV51uVz177zzDh9//DEul6t3NTwDZ4XJZCIjI4O//vWvnDhxAmAX8A6XfgJtHfB6fX2948UXX\u0026#43;C9997Dbrcb\u0026#43;R29GCaTiczMTP74pz\u0026#43;xZcsWgAzgX8gAkh6JnlZbNWTj/qykpEQ89dRTvPPOO9TV1V1W8fWXIxRFQVVVUlJSePzxx1m1aiVAHvA35PzOpYYNeA74tLi4WHvyySf597PPUlRUdBnkOlxecHfiu3fv5rHHHmPJN1\u0026#43;jaVoR8BSwsavLdyHoST58N4qBJ4CA06dPLfzDH36vHjlyhHvvvZfk5GSsVmuvc2FcCNQm6n\u0026#43;SNBV6Uj/v9reWlpayes1qXnzhBfbs2YMQogBZD5Z2YnEKgN8ClJQU3/SPvz9t3bN7N/fedx8TJkwgKDCwx1j87g7U3U8paucsYt7dYbfbyczM5JslS3j7rTfdUTmngf8DPqAHJls1RU8kfJAW3aNASXl5\u0026#43;S2vvPI/7zVr1jBv3jymTJ1Cv6R\u0026#43;enLV5Q13skhNjYxWrKysIjc3r8dMNjocDvLz89m/fz\u0026#43;rVq1k27ZtVFVVgYyQeAr4jEuTbHU2ZAE/BzLr6\u0026#43;vvX7ZsacS2bVsZM3YsU6ZMYeiQoYSFheHh4dHVj\u0026#43;\u0026#43;skCteVVNdXY0AcnNzmoa4XlYQQlBdXU12dja7d\u0026#43;9m0\u0026#43;ZNHD92DLvd7gL2An9BGhY9Pra5p49Dg4BbgQeAYYqiWL29vQkJDSXAPwBF7em3d\u0026#43;EQQpCXm0tpaSkREZFERkb0GAEQu81OcXERFRUVOBwOgfSdLgNeQDbEruy5PIEZyLo3HQhRVVXx9vbBy8vzkq8dfKFQFBm9VlZejt1mIyAgAG9v73NKl/Q2KPqCSXa7g9raGurrbYBwII3Kz5Au5JP0QN2cVu\u0026#43;3qwtwEaACCcB8YA4wBAgFLq902rPDEzmas\u0026#43;ufngINqAaygW3At8h4\u0026#43;5quLlgTBABjgFnAWCAe8KdnjJ4VvfxWoAoZctgbOKGjEEjplmLgOLAZ\u0026#43;A4Z7tvZI8hLit70chXAB4gCogHfXnZ/5wOBbMyPAtOQPsgP6DnPxYFshLnIPIzu3PhMyDoXAgTS/Q0OAfgh3RVjgL8DX9KTJngu7rOoQdaxcqB3apEYuCzgiSR5AfyxqwtjoFshAFiNDGn9flcXxsClx\u0026#43;XYm1\u0026#43;OcFv0xvs20BQKjXWjp4z6DFwADAIwYMCAgcsEBuEbMGDAwGUCg/ANGDBg4DKBQfgGDBgwcJnAIHwDBgwYuEzgTg5pOlvvhuDiZpe5zy/Osr0zs9k6\u0026#43;3oGDBgw0KUwI5Mv7gH60piqriAzMvcBq5ALOV8oxgB9kMkdGhCDTHKoAryBW5AZbic74b5jgHnA50itcwMGDBjo9TAjswMXIbUjjiPdPAKpU/MgMA6pSlh9gddKQJL\u0026#43;14AH8GvgK\u0026#43;TycVZggn79ziD8COA6YCUXh/AVZDp9PNAPmenrrW\u0026#43;rR6rtpSGFt8rp4Yp7BgwY6JkwI8mqBvgQWN9i\u0026#43;xXAM0ii3qD/5k4hV5CdgLOVc/rof9c02b6OxnVHvYBgGkmxCvgrMrXZDbdUggWp8WFrsc0Nb2SHUcOZOjHuDs1dFrfaneDikK4J6A9cBcxFkr27vO6yWPQyakCm/hyWIBUfe7z6ngEDPQxuXjG3\u0026#43;M2FbLcXS77DiuSH1mQaFCQH2i/i9c4GE9LIrj\u0026#43;XwFMqUgM8Rv8eh1SnTNS/n0au73hc/94fuBGpZ2NFaqC8h7Rs\u0026#43;yItYCtwGzAUWIwcSXwLTEUKZFUjU76vB0brha1EypNuRRLneOSIoRaYjNQuqUFKCOzVyzIE6SYK0R9wGbJTO3KRHmI08D3gTmQF2gU8CxzWn4tb4MsLOaIYrN/j3fpxnwJvcGmX5jNgoDvDhGyf8UhuCUYaSHak8ZeDFM4r4\u0026#43;KtaBYAPInkIzvN5xaPAW/RyGcXghnAMOSiOQLJWVnIRXt8gV8gPRz7LtXDbYK\u0026#43;wF3Af5sSfmsTmHFI5ckC/f8/AqeAl5A907XAn4DfI0WufqE/rOeQRPdDpHb4L5AEPBlJ2nuAK5EdyiFkb3ud/jCygJ8iCf0NIB/p7nkM2Vms08/1I\u0026#43;R8wEdIcl0M/AbphlKAx4GDyA5HADfpZXmEC5usVYBJ\u0026#43;n0PQlrr7\u0026#43;jXqm3jmJPAFuBdYCCyw7sDmAn8P\u0026#43;Q8yeUnRG7gcoUvkgAXABORBqKCHMW7kB2Bp/53HpIzliJ5o/Y8rtcUHsh2uxppHLojFQOAG5Dt8SdA4QVep6kXwROpVfSpfj/o99ZZQSN\u0026#43;wAjAy6xf1AM5iRlLcx/\u0026#43;fCSB79YfhhX4N40rtv8XeBppSX\u0026#43;KtPDfpHHJuf8iOwVP/eYFsrfejLSM9\u0026#43;qfYH2bCxiFJPhfIjsEkGtJBiAt4\u0026#43;36b3XA\u0026#43;0g3CUgynYycGK7Qf38T2RGB7E3/g7S2z/dBq8DVyGX1KpCdy1qkn749qAf2I0cZy4HfIbXd/4QcfXRnNUgDBi4UFiTB/xA52i1BcsEu5Ei3FOnmtCIt/yQkFyxAGnTfAf9D8tGFtJV6YCeNbmo39gCvI2Wu3QuVByA9HCqSrFsGsPjo272QhnEhkuvchq1AeiB89XP5IDutF2k\u0026#43;L2pGeg2CkdySR6Nb2KpfX0NytF\u0026#43;La4HsMENo7DzzketHuKMtNUC4Cd\u0026#43;CdJ9E0Bii6UROan6qF3Ac0uVS3qSQdfpDuxFJuMeQJPYV0nLPRJJs06FTUzT9zU3Co5FWfsvJ243IUYDbvXRUvyk3qvQH6Ks/6H8iO61kIBw5HxGp3\u0026#43;v5Yp5\u0026#43;3qPIEUTKeZ7HgZwvyUCu3PQUsrP7CGNC10DvRBDwA6SRVIg0mpYh3b5tkfdG5Ag9AWlo3Y3kmeeRxlzVeZaltTB0aJRHDtC/T0QapiDbpRW5KMpa/fsA5AI4Hvr5gpEj/k/0Y4cgOfQBYDhyLi8c\u0026#43;Bhp8S9BGoCByEjJYUj3tS\u0026#43;SO1/Vn9UsJC\u0026#43;WIw1aD6TH5TOkl0MgjfMbkd4OBdkpfII0LBvQdNL2v0gSUvXfNCRRC72gPjSfVHWjDNm72ZDRPDcAU/SLu5B\u0026#43;9Y868CIC9RtrOaFZoZ/Pn8YFC9pygwQCDyMnm8uRPV09F7ZwxnDgz0hL5BEkWV8ospDRSv9CWvm5XNpFko28AwNdgSik3/xq5Ej2v0hCa099dCCNv/8gyetnSNdtIlLLv7gd52gNTRVkBZILJyKN3jRkAMYvkFGF3yC55kqku7kCaVR\u0026#43;X//7eWSndSXwEHIEEokk/DeBV5CjlW/0j4J0sWzWy3Afck7z70hOiKDR/fwn/fndhpwj/AuSaxchO5Kd\u0026#43;jl\u0026#43;iOwMV\u0026#43;r3c7V\u0026#43;3p1Nn7Ob8AVnXw3Jgex5IlvZFoEkUk/9\u0026#43;/\u0026#43;QEx\u0026#43;hyOiVHyInMttjuQr9BfZF9mJNI3NCkL69snMcL5BupPFIyzlVL18CcpRyPjKw/vrLtyAXsc7XX2Cwvr0YOcQ6H//iaeTcyNvIinyc5iMXAwZ6MkKRhtIc5ELgb3N\u0026#43;C4y4J1V/gVyJ6udI/voDHQutdhuwP0K6ityEH4AMrFiGnI/7MdIA\u0026#43;4hGXlwCjEQas6lI7itBGpM25LyA0uT\u0026#43;NH3bKSQHFer7u13YGnLC\u0026#43;kokkR/Vj8sEXkZGSA7R981Gek5K9X3WId1csUj3z1fAChqN2hT9OiG0IHw4Nwk6kL7za5HDhAL99wDkcGMHssf9AdJizUfOsH\u0026#43;hP9Qw/aJNr6PQXNrBvW03coJ1mP43SKKfqz\u0026#43;IPNqWhHAP1WKQfvKdNHY0I5uUo6OYr7\u0026#43;UF5CW/u\u0026#43;RriIvfXuNfr3PkT1sZQfPfwL4B9LyuUn//0JhRU4QT0JWGpBurQX6c73QSSkDBs4FD\u0026#43;Rqa/NoNGoudJ6qmkaL\u0026#43;nEkKf\u0026#43;rg\u0026#43;fVkMRZQCOX5CC9EduRHDEQaYHbWxy3G\u0026#43;l\u0026#43;MSGt/58iuWAf0o29AdkBncuFjX6dvsjO4miLbZlIz0Syvl8WzXnFrh/niewMliLbel9kJzuERhd9A9w\u0026#43;/PaQ4HKk1fxbJJE7kMMGkL4ku/5A3OFGDiRJliIt/CgaSd\u0026#43;GJJxr9BeYoh\u0026#43;r6g9tBXLo9hHSAp6of56m0epvrczuXnM3MqrnJqQLZiCN/rG5yEmi9hJ/INKPJ5Ajlr7AAWTlzdDvp59\u0026#43;r88iI26eouPhlquQk1K3I/1yeR08vinigIdCQkJuHTp0WOygQYOsPj4\u0026#43;5ORkzztw8OCkjPT0nXa7/Xlk59ST1rg1cHHhDqS4WHkpLTEf6Xf/H9IX74MkIw8alxSsoeNGmB3p345HWup7kH719kBBWt2t5R254Y0czbcWjGFD8qYJyYPHkS7sIUg\u0026#43;y0UahO29Jyuys2rpntaQHOqhf3e0cU4N6dd/CmmAHkF2AHk0TuA2wIwkwaaRNW2hVD/p1cBC/UTpSKv3tL7PE0jf0nV6QXKRYU6FyB6woMnNvYAcHQTrD/ZdvQwa0ueVjpyh99SPfxLZGYC03DNaPKRa/RwZyBGGl/4ixtM4RFqF7PXy9Xtuz1BwpF6OEBpDT5e3OFZBVuobgV8hLY6f6PffXriT315GRht90oFjmyLJZDI9M3ny5IUPP/ywefr06dTU1FJQUEBycrKam5sT8O6778558803hxQWFj6hPwcjOujygglJlpOR7cGJHP2lIo2zi5F9HoFsA0eRHoDHkZE5kUiSq0VarSuRlnJHDZxapF//Cv06e2geUHIhsCG5KqmVbX2RHZUJuU70HiQvWZBejqeRhmFrbqvWCPs0coI1nObPPQDZOeYh3dHKWc53jf7/T/Rya0gj93sX42EoyF7Hk7aHLZ5n2d4RWJDEbTrP46368ReiCvoH5IPdg6xcZ4OKTBjLRL74ji5kHY4cRr5I80zA9sIfeOOqq67Sjh49Ktz45JNPxa23Lhbl5eVCCCHq6\u0026#43;vFiy\u0026#43;\u0026#43;KMLCwnKQVpiBywdhwC/9/Pz2jxkztubGm25y3XHHHdq8efPsCQkJBWaz\u0026#43;XPkaPV825wbdyGJcSXS6jyKNC4eBe5Hzld9ibRGv9OveT588T2kYXVdO/ePQCZ6zjzHfvOQPvuhTX7rg4xaXExjlMy1TbZ7IXOUHkTm2fwPyQE\u0026#43;yBHOzfp\u0026#43;wfp5ZujHvILsEN3WvBk5Ifyhvu/9SDdW0whD9zmmI43QptutyMnjg0jPxkik1yX\u0026#43;fEhF0HwytbXt7Y1LPxccXJj8wIW6K3yQ4VCVSOmHHefYX6NxYucO5AvZTftRgsxLGIV0JXU0AmFOv379bvjDH/6oJCcnNz5Eh53a2lqEkAaBh4cH9957L8ePH4997rnnfqRp2g4ujkCege6NGEVR/jJq1Ohbf/SjH3nMnTsHp9NFcUkxfRITLenp6eFvv/32DR999NHo0tLS3yNdqueTEOiLJMJg5Aj7Y\u0026#43;SI/hjN26QvchT\u0026#43;G337w8iJz47AHfZ4A9IVfC7uEUg38rl4ZQMyQevXyKRJh17WQ0h/eTUy4uZe5EigSN/fopdjPI1BHPVIt/WtSE5ZhRzRu5Ajgf8iXdB/RI6y\u0026#43;iAnkP9LY25CyxGDoFEKYi1yQvw3SA9Hov77cWSO1HK9vEbI9zkQjXRFfUNjbG57MBRp0fzyPK75oH7swA4e5wG8\u0026#43;fDDDwu73S6a4oMPPhDXXruowcJ3Y9euXaJPnz5FSEvDQO\u0026#43;GN/CfKVOnOnft3t1QBz777DNx\u0026#43;\u0026#43;13iIqKCiGEEDU1NeKf//ynCA4OzkBa3eeDEUh3TR0yrNDvHPsPREadbEGSXUegIEfhR5CJn\u0026#43;eCVS9fUDv29aAxUewhZDvxbrLdgoz8ewDpTrkB6TcH6boaSKN3IRDp0hqvn2NoizJEI0cAP0XO4/WlccQTjYz5V1pce5h\u0026#43;DgU5h/AAMrpoHnK03w/plQjV9/U8Hwv/ckKA/umojHImcj5iOGeGl54Lp/VrPqifp73DXB8fH59pEydOoraujqqCAlAUTCYTJSWl1NXVkXfqFNU1NQhNYDKbiI\u0026#43;PJ3ngwMCMjIzBiqKsd48ADPRKTI\u0026#43;Pj7/9T3/6k2nsmDENP9psNqqqqtA0afx5e3vz4EMPkZGRmfjSSy/\u0026#43;WNO0PXTcpz8E6Z78Eimzcq4EqaPI\u0026#43;cE3kBbp32n/pKdARtY8gCTYE\u0026#43;fY344MumgPbMhk021tbHcgA0B2tbItn\u0026#43;bh1eXApibfD7fY/xTSI9AaTrVx7UNNvh/hTJ2wShoTWIvh/PzElxO8kYR7qoPH2ZFDvBDkM\u0026#43;4I4dv06z7S0cJ6enoSEhLCq6\u0026#43;8yrfffouqqiiKQn5BPoUFBTz44INYzGY0IQgMCOQ3v/kNkRERZiDUx8eH6uoLVcA20E1hAa6ZO3de6NQpU5ptUBSl4eOGj7c33/veXSxd\u0026#43;u3UzMzMEXQ8GbA/0mXxFu13FW7TrzMfeI3WkzzbQgbSZdGv055oD4VB\u0026#43;GdHPY3Zxh2BC2nVuNVBO5Lh66tfbyuyV26PhS8AT4fDMa6\u0026#43;vi7o6qsXMmzYUBTdwl\u0026#43;zZi0bNqznZ48\u0026#43;iq\u0026#43;vL0IIPDw8iI6OpqqqWgNq6urOJxfGQA9BoLe397ApUyYDUF5eDoDZbKKmpgaHw0FFhTTihRCYTCaSkpIYNGhQUGZm5r1IIm1v4IOKnBBNo/2WNMi2tgXpQommY4RfjuxYIjFWsjsr3Jm2LfWhm8KBnBzoqofYVDvaLfRWT\u0026#43;dMQFQjLe7wDh7nQg4t5yIz4dpr5ajISeJq5Mz7ftoXLSEA35qamtcOHjx09TXXXMPAgY1TAIWFRaSmpnDllVcSENA4FXHy5ElOnDheC5x0uQyxzl4Mb29v7\u0026#43;Dw8HBeeeUVVqxYoY/\u0026#43;VHLzcjmVd4of/vCHWCwWNE0QEODPz3/\u0026#43;GJGRkWYa5bw7AhU579XRIWMBcjTSkfkykFzgRI6MVQzl2TZhRjr9/4DsxVtGtajImPd/c/EibzoKT2Qo1xpkr38vMsHpfDU0OoIKZA5Af2RF7EjE0DakW2YB0l/Xng4zCZnjUETjpFe74OPjU1NTU7N62bKl8\u0026#43;644w5LYmJCwzYhNIQQNPXRCyFYvnw5J06cSKVzNLkNdB2cTqfTbrPZmDBhAsEhIXL0p5rYtHkT27dt48abbsbHxxuhCTw9PQkNDaGurk4gDZdcOhYyOZhGTa6OoFo/7lyTvC1hpXFRJgNngRlpMQ9GhvY01YcG\u0026#43;QAL6dqVmczISaADdA7JN0UVciLkCqQ/viMaN4eQIWP3Iidrtp5j/wBkxzYcmeLdoTDJmpoagK9379590/PPPz/1T3/6E/7\u0026#43;je2m5Xzs5s1b\u0026#43;N///ldbV1f3NjKt3EDvRWVVVVV2SmrqyOuuu45x48Y1bNA0jdycHG6\u0026#43;6cZmo7/s7GxOnjxZh9R4\u0026#43;ZL2x\u0026#43;UryAnYYUhu6YiVfwpp5AykhcrjORCLdOcUYlj350Q0MtNt\u0026#43;ln2UZDDJRMytnYoMkzIq5X9wpAvO5nGpQ5b2z6A5iFObliQmWXDkS8xAJm0sFC/frj\u0026#43;v6lJmaL0/RM4U/7Yigz1GqZf231ce32SNyMJccF5PNtBSKLfjgzpasttloDMGnQvjfjgeVzLjbn\u0026#43;/v7HHnnkUXEyLU0IIcT\u0026#43;/QfE22\u0026#43;/I\u0026#43;rq6kR1dY348suvxJgxY2zI2Of2hKcZ6MFISEgA\u0026#43;NnUadMcOTk5zUJz33//fXHttdeKsrKyZr\u0026#43;//vobws/P7yDnNxH6U2Q8eUdDi32RyUyrkW21PTAhY9BraJ/ryYwMeRzeymcEMob9QhI1LxQqjZr3nsh5wAuRdD/j5t0423AoAOmeyERWAB\u0026#43;kxVuElBE4pRfqWmRaca1\u0026#43;brfmxZFWtrvXfn2dRl35YGR41QBkSJGKtOwtSJdIPFK46D/ICnEXMuxoMJLYw5EhUv/Tzx2BFHSLo3H93QNIIn6O9gmIbdPv7wZkrHBHXFupSF/83/T7/ByZlJGFtETCkIJHi5GCbxX650IkktdUVlb\u0026#43;6KWXXvztlq1bJs2eNdtz8OBBeHl78eqrr7Jl61axYf36U/n5\u0026#43;W/qz8BIuOrlyMrKAvh6586dt7z88ssTfvvb3\u0026#43;LtLW0tIaBlOO7\u0026#43;/ft56aUX7VVVVR9wfjLgqUijahBnioKdDdXI7NLnkG37Oc4t\u0026#43;zEHyQnVtG9pwgCkUGEUZ4aLmpDt/c90nQvbC5ns9SXSo/ALGhV6LwqikJlj9yNdJ017vGHIhIFQpMvnA2QWqTeyJ/yQxvDBq/RCzkD21CFIbZ03kB3EfGR6r3t7KFIg7V0aZ9d/gSTGfvqN90PG5B5BJhOMQE4GRSETHg7rLydBL9MEpHUwE/nynkJWmnh9\u0026#43;0jkKlk7kJ1Ae6AgE6iygNnn\u0026#43;YyTkEPjg/p5juh/pyOjGd7X7z0NucDKxejRY4AHVFV939vbe4ufn99Bq9W6Ain5MIXGNG4Dlw\u0026#43;uDg4Ozvjd734ncnPzhBBCbN26VTzzzDOitrZW2O12sW7dOjFjxkynoqjvIw2m80EMcu7veToeCeiDbLM5yIQnnzb2syI1ZA4hjcG1SM45FyKQEsi36OWMa/KJRxphXTkX4Ifkg4VIXryXjk9itwm3WqZbH/qWJtvcq179G6kj40KmBO/Xt2cifdOD9QLdiPS7rde3VyPJeyHSbdDa9jeRxH0lMpV5BtIadicLnESmZc\u0026#43;nMdzKrfAHchj3BZJEQc5BnEROsp5CLoDyOFKvA73sK5FDuvZC6GW4FqnBfYRGsbj2Ig2Zcfg6shON1599gX6\u0026#43;QqR0Q43\u0026#43;TC7GnEke8Jqmae/W1tYOQbqmXtCfi5FifXlieWlp6cP/\u0026#43;te/fr958\u0026#43;bR8\u0026#43;dfZR48eDBDhgzliy\u0026#43;\u0026#43;ZPPmzaxYsbw0MzPzQ6RhUHCe18lHBlksQo7WO7IyXA2yLXgh28wkpJBgCo3rbvTXz30t0gtQh\u0026#43;Sm0nZew4Vsc20JtpmRRmU5sq0OQkbr7af5fJcH0r2dpJfhEJKLRBvbDyK5qOmQKhgppRKqH5vRZHspUmeoVn8eoXqZhurlKkFyc9NRehiN0izHkXwYjOQsR9MVr15CxsE2nZwR\u0026#43;kl99H1aSv5W6fuHIXvOlroxOUj1xzj9AbbcXo600ofoD0LjzKUN0/VPy15XQVbIpklRLmRHYtEfSC2NZO9GKm3rVbeFbKTl/TzSEn\u0026#43;Cji\u0026#43;v5kASf0tVUg/kSGcuUlb1fJdNbAs2ZIW9ATlX0xEFTwO9Cy7g27q6upQNGzZct2XLlul\u0026#43;fn59zWazd21tbWFtbe1BIcTXSKPsQlaHcyHdlzchNaX\u0026#43;RMcUWU8jVWf3IsNCX0JyRTXSOA1GkuG7SO4YgNSw6kh27tn2DdDLnIfktxIkn9yF9BocQkoX/Ei/diqSI\u0026#43;9AJputaLI9Gdmm/ZAG9fs0rkqVhOQTG9KAHoXkLD8kF7q3/wbJn79CushMSA6bjxRr/BMyoGUoMvCjjEaDtxrZQT4OnHIT/rl6PB99n7ZemhnZ07bl9zLRqEPdEvX6C7S2cQ0XbWeqOmnbWm2vzn97sQz5cn\u0026#43;uP8Rn6PhCJy3hhZygfQR4BylWdbHzHdxCVgOQ0tZNF4UxcPlBII2OfzmdzpfLysomIF18ryHn5C7W\u0026#43;ggHkFIBtyOt1DUdPL4MORe3BJmbMhBJojXIUNE9SBft95AdQnvnCty5PHORAStNJ2g1ZIBFJZJsNaQRVojsaP6BJNhDNC7S9HukVW7Sy3IPso0tQrrFf9dk\u0026#43;zVITZ4MpBH7I2TH9Vckp/gh\u0026#43;WAIjWvohupldK877p6jrEN2Qi8iZa5XI8XnjiMN0zrknOZTSC\u0026#43;MCS5epm0FsmfqQ3MLNVi/8R36i0qkud6DRT8mHTkMdC/OW9ziHO7FU9oLBWmV\u0026#43;\u0026#43;rnbxpnPhw53OkosTr0h\u0026#43;upv6gwZAU437VtI5Ev6F7kkPVpLsyqagvDkaJNIOdZXqXRBWbg8oVA1rchyHrxDhd3MRwnUvZ3Mo3rNXdkAhca19TIRc7dNcUIJJkeQS5G1BEjxgKMRfJKU8J3InmjEkmYK2gM7KhF8shoZNufjXQnu9u/i0b3sjdyMrnl9hXIaL8r9e\u0026#43;DkNa7O3S1CjkKv5FGF7abpxRkh7yCxvycU8jOOxo5kohBusTd2wuR87OD3TeoNvnfF9nDBLb4\u0026#43;NC4dGBrbhUV2RtvQ2pShzbZNg9ZmYqRPef1TbaDnGTtixxCpiNdQNfQOGlp0Y\u0026#43;Pa3HjtPJ3U6j6\u0026#43;fYg1eMGIzuOGchFV853wY8aZFTSX/RyvYdcXDi4A\u0026#43;fw1\u0026#43;/xbeQQ8UWki6i9/seOwIS06t1rEQ/GUMY00IhQZF0czfkrY54NWUiyD0WOiAdcpPMORc4tWpBtpyNzam4X9r\u0026#43;Q1vRDTT4/RfKY21vRMorPph8fhGzHLTuwCmQknwnpFmoZNVSv/9YHGXppa6XsBUgebI1rS2m\u0026#43;yItbql5FutSrOTNXKQfZkSggLXyX/uUx5HCkKVRkD/qG/pBaEqUd2ZtoSPL7NXJlqp3IXnCCfmwh0nf1eJPt/sje/2PkZIYLOVRxhyGdQEbfhCA7C5d\u0026#43;HfeSaC5aXx7NvaCwExm\u0026#43;eS/SDVOvv5AVyAnM852Jd893HEH63v\u0026#43;J9DMuQcbc5\u0026#43;gP3qWXzYzs8WOQE9TXIq2LY8jOaCUdE1frCBKQFoX7Xj2RvvwvuXB3lIGejyuQddGCHIl/xsVZ7aopNiJ9z/9Ezuf9gcb23FGYkflCTyGN058jueR8YOPsIxqNc48aWsbruxeHUtvY7v7NbbmfzYhuq0yilf1B8rCFMxdd8qFJ1J8ZaZ0/SetWqrtXKUS\u0026#43;sJYToBuQvjqnvs//IWfVk5A90ZM0unAKkL2xe3sdMuTSTfYgJ2l\u0026#43;i/QpBiN9ZTtoXF6wHun6KNOP/wfNezwNOTStR/ayLiTpByDJrhipR32uRVzOBSeyJz\u0026#43;AHLrdiuwwf44cZp2mseH4IoeOMfrzPqo/h2\u0026#43;5iLG1bWAysnc/jrSu9iMbykguLNbfQM\u0026#43;HB9L4CNS/T0Ba\u0026#43;t9d5OsIpFuhHknUbyJdPR8jXTXtca2qSOPlTqQBl420yLd00bNzW9rDkPzlRixy1PC\u0026#43;vs9QGqMaQZLvIL3c2UgijqN5NFQM0vXdURd2GpLsR9G4iIwJyaWB7vO5k6N2teOkB1v57TTNhyQVnD0l\u0026#43;lzbQc5WZ7b4rajJ324FvtZ0rd3aH\u0026#43;g3\u0026#43;Tv95lfov1mQQ9csLk7CUQlyonUp0oc2GukTjUH61UB2LEeQ1tMe5Ix\u0026#43;\u0026#43;UW49rlg1p/FD5FWlTuS4RMufPk6Az0fyUj3phthSCt/MxdfSkVDtsNsZIDCI8hR9ldIwykNaZi4BRIVJHkFICNMZullC0FG//yX8587A8kD7lWqWkrJVCE7p9a0gBRk26lEBnHcgOSgVGQAxm1I10o2kuduRBJ\u0026#43;qn4/N\u0026#43;r3tFbfZx/SrZuF5JIQpPHo3\u0026#43;R6apO/21pSVkV2nkuQHY6vfs7RyA6mIaKwN8sjVyJfxveRM/yF\u0026#43;v9DkBMbF3OCqgoZcrobWSGsNJKqpl\u0026#43;rsxcKdyKHzp5NfnNx5sILBi4/KEgSLUeOSCORRok7Zryjk6vtxTHkSPhLZPTOvchM\u0026#43;FwkQRUgJ0d9kMTZB2k41SO9Ce6kyQsZnTuQRH8PMkyyKYm6M/uf18tT2\u0026#43;LYcmQko9DvIRCZlJmDJHIvZNJYNbIzC9K3ZyPdukHIuQd3Z/UyMozy/\u0026#43;nvIUA/11dI13G9Xg4njSHmTXlEIL0Ebinpt/TzTEJa9u48pofcB/R2dTkLjRoZfjROHqdz\u0026#43;WhmeyKH0YuRLrYnurpABrocnkhfeDHSrTodScT7kORx5PxP3aEy9EfOa41CumwCkcaSDTkCz9TLtAs5CrgYc10qchLZs43tNv0ZBNA46nDDG\u0026#43;kKK6dxfq4P0gVTi\u0026#43;wom\u0026#43;r4N91eh\u0026#43;zwilpcz\u0026#43;3mCUJ2fOnIjqMeaaD569czITmsnObzHwH6dwdy1JauH2vRr7kAafQ\u0026#43;QMfWGDDQQ\u0026#43;GJlMAQGGRvQMJt6AUg4\u0026#43;NdSEsbukY4zIQkvmBk7Hiw/t1wPbYf/si5kYeQHYaCfJavINv9RY3DN2DAQM9BayHObnRFUp474u5S5KFcLqhERkq6xSfLkZPI9cgRvgsMwr/ccLm4sQy0D0Z96F3YhJwg7o\u0026#43;0\u0026#43;L9FRuhdFpO2nQErF1Gr\u0026#43;hJAIId37mG6hcaF2bsrBF0zyX2xYUbWj\u0026#43;76rAXN3SZWmteV7ggN6WM3pEFah0DOERS1tUN3rYzdHd7I1OqFnL\u0026#43;EbGdAIBv0MGSo6HFkqGZ3fu8acrLuK2TWY1eutnY\u0026#43;cNeN1rRauhMEkuTHIScxDyCfe3euGw7kxOdXyJwdg/gNXHJ4IeP7S2jMmDM\u0026#43;F/\u0026#43;ThRSj6q6E2Rq8gT9i1I1L\u0026#43;dGQbotFdO/OqVvCeGAdxwLgLYvZHDZ1wkSuGDUKs9m9rICBC4GCQk1dHes2b2b/kcMIIVKRsdI9JXfgOuB1i8USPHn8eEYNGYqq9qT\u0026#43;qnujrr6e9Vu3kHL8OMicl8WcKTdu4CwwfPgdgxkpCBc2cew4Xnn6afrExnZ1mXodtu3dy/cefZT0rMx\u0026#43;yASSnkD4VqQxEDxtwgReefrvJERHn7F8oIHzhwC\u0026#43;27aN\u0026#43;3/xGLmnTg1FykEYhN8BGITfMZiRsa2MGjaMhJgYgE5t1AqgqCqa1jvdl4qiMGzgQJL79iU9K9NC954jaYqGsl4xciSJsbFywdhLDFVVURQFFAWEQGgaWi/tZEyqyphhw\u0026#43;iX2IfcU6es9Jy60W1gEP55wmySwQ2dbcHZnU5KysoIDQ5uKENvg6IomM0N99bj3I4WsxkFLjnxKopCbn4\u0026#43;qSdOUFZeTnhYGEMHDCAkKKhXjiyEED2\u0026#43;bnQ1DAdjD4KqKBSWlPDcW29TVlEhLbuLDEVRKK\u0026#43;s5OvVq6murb0k1\u0026#43;ggehxzdQbXaprGkrVr\u0026#43;fN//8u2vXvJKyhg7ZYtPPmf/7B9375zvjdVVTmZlcWqzZsveLSoKArb9u5l7\u0026#43;EjqJe6vvS42tC9YFj4PQmKgsvlorS8HJdLQ1UUhN7ANE1DURQURWn2NzSOQtzbQHYeguYjFLd7oLq2ljVbtjBl3Hj8fZVeaS32ZKiqyubdu/ls6VJ\u0026#43;fPfdjBk6FLPZjM1uZ\u0026#43;WGDbz8/vuEBAUxoE8fQL7jhneoKKiKgmIykX36NFt272H2lCnN6gvI\u0026#43;qSqasOxTetW03IgBIrJxP6UFHx9/Rg3aiQ4elok7eUDg/B7INyNr6C4hLzCAqpratixdy\u0026#43;KojBj0iRGDR5MUWkphSUl1NbVsm3PHux2B\u0026#43;NHjWLi6NFYzGZOZGZiNptJjI1FCIHT5eJwSgoB/v6s37aNkxkZLFm9inkzphMdHmGQfjeBoijU1dfz1cqVzJsxgwmjRqG5XGiahtViYeGsWRw\u0026#43;fpwla9bwyL33cuT4cWKioggJDASgqrqaE5kZ\u0026#43;Pr4snH7do4cO8aytWuZdsUV5BUUYLVY2Hv4MGmZmURFRDBn6lRiIyPJLyqiqLSUwf36NXQMqSdO4OnlRWl5OXsOHsTD04OkuFiuGDkSUy91N/Z0GC6dHgpVVUlNO8kT/36WLXv2kNwvCW9vb5555RXSc3JIy87m/z3/PMvWbyAhNo742Fg\u0026#43;\u0026#43;PprvlmzBkVRWLNlC5t372mw6uttNt757DNOZmVRWl5GTW0thcXF2Opt3cGtY0CHoigUlZRQUFLM\u0026#43;BEjpAWubxNCYDaZmDB6NEfT0iitqOSjb5eSnpMjrXpFIb\u0026#43;oiDc//ZTCklLKysuprqmmqKQEm93O\u0026#43;199xT9ffZXKqipGDhlCYUkJz7zyCoUlJaSePMkXK1bgajJ6/HbdWrbt3UtVdTUVVZWUV1RQWl5mGAfdGIaF34PhdDoxm1S\u0026#43;d/31xERHY7fZScvK4tDRo4SFhFBdU8Nd119Pv8REAOKjo3njk0\u0026#43;YccUENE3DpTVfZc5mtxMZGsqQa68j69Rp7lu8mPCQkF4bEdQToQDlVVUgIMDP70xyFYKQwEBq6\u0026#43;ups9XjdDnl\u0026#43;3NH8QgNm93OsIHJ2B3zWb99B3fffHODq3Bg377cv3gxJpOJWZMn8\u0026#43;R//sO6rVsJCwnB4WquduFwOBFCY\u0026#43;aUKRw5fhw/X18WzZuPy9nTVTF6LwwLvydDUUju14/Q4GA0nfyDAwKw2e0IYEhyMjGRkWhOJ5rLxcCkJITQOFVYgNJKQpCiKCBACA0hBFpT36\u0026#43;BbgEBeFjlsqV2h\u0026#43;PMMBV9tGZW1TaiuBQUJPkjBALR4Kf39/Nj9LBhmFQVl9OJp4cHwwcO5Fh6Ok5Nk8c1vxTg7khkfemUGWsD5w2D8Hs4TC2Iu6n3RVWbN1C3\u0026#43;8alybWQmzZgtx8fxQiE6M4QQhAWEoKH1Up6dnarHfex9HQiwsLw8/FpmHB1w\u0026#43;ly6e//TCiKckZmsEnP\u0026#43;WjZ8QvA6XQZlaWHwSD8Ho622psCHDl6jMLiYlSzGdVkIufUaVwujcjQMBRFoaqmWkZtmEwUlpSQV1DQLLKnIanHQLeBEIJAf38mjhnDV6tWUVZZiclkwqSqmEwmMnNzWbd1K7MmT8bTwwOhCapra0FVUUwmMnJzqayuRtGjtBAykU9RFCoqK9l3WCY1m0wmnC4XxzIySIiJwcvqQXVNLZoQqCYTNXW1nMzOxj2DIBeiVcCQkujWMHz4PRxKGz8qqorN6eS9r75i5gTps/9k6VKuGDWKyLBQ\u0026#43;ick8sannzKoXz8CfH1Zt22bbLSKgpeHB9U1NXy2dCnXzZ1LVHi44drpRlCAG\u0026#43;bN45nsbP7\u0026#43;8svMnTaNYH9/8goL\u0026#43;XbtGkYNGcz0K67AYjaTGBvD1ytX4O/tTZ3NxrqtW/Hw8EAIgZ\u0026#43;PLyczM/hm1SqmT5iAp6cHuw4e5NNly\u0026#43;iXkMD\u0026#43;lBQyc3K4Y9EiGRVWVMiXK1YwuH8/9qWkUlJejsUsKcTPx4fNu3bQNy6WCaNGGVE63RQG4fcguK276\u0026#43;fNxcfbi6T4eCxmc0O8tALMmDCRoMBACktLGTNsOMMGDmTZunXYHXYmjh7N1VdeCcCkMWMoKi1l6do1\u0026#43;Pv6MWnsWAb1709wYCDBgYHcd8stHD56lNq6OmkNGoTfbSCEIDgwkF89\u0026#43;CBrt27lu61bqKqqJigwkEVz5jJ13LgGP/8tV1/Nx0uW8MFXXxEdGcl18\u0026#43;ZRUVWFxWxm6ID\u0026#43;3HTVVZRXlONwOPD19mXy2HEUFBWxfc8eQoKCeOS\u0026#43;\u0026#43;0iMjUXTNL5/\u0026#43;\u0026#43;2s\u0026#43;O47DqQcYfSw4Txy332EBQeDy8W8adNwOp0Ul5YadaUbwyD8HgQhBP6\u0026#43;vsyfNg1NCBJiYkiIiWloYAKYMHo0qqqSv307ZrOJedOmMXfKFDQh8NRJQAiBl6cni6\u0026#43;5huvmzkVRFDys1mYNdcaECczQRwZGlE73gxCCAD8/bpw/n6tnzcLpdGI1m7FYLM0SrcJDQvjx3Xdjs9mwmM2YzWY03ThQFIWbFiwAoM5mw6W5iI\u0026#43;O4aarrqKurg6rxSL310MxZ06YwKTRo9E0raFDAXBpGpFhYTyweHHzJC8D3Q4G4fdAuDVaWmtYQo\u0026#43;U8PbyIjw4GEWAxWI5Y3/3354eHg1RFs2uYZB8t4ebXC0mE1azWUbKtHhv7pGfl6dnY9Zsi\u0026#43;MVRU7fh4eE4OlhRW2yf9PzaZqG1WyGVkZ8BtH3DBiE3wvh0jSGDRhA/4QETCb1rA3RaKS9A\u0026#43;d6j\u0026#43;eqAxazmXtuvBEvT882o3hADxIw6kyPhUH4vRQeVquM0jAap4F2QFEUAv39jfrSy2EQfidB0UWrWkLQcfeJ4s6aPMd\u0026#43;7W28qqK0KeXbNEzTmLy9NOiKutEaWnu3Rt3oXTAIv5NQWFxMUUlJcz860lcaHxPTEN52LgghKC4txdfHR/rfLxA2u52yigrCQkLOTOICKquqsNntBPr7U1JeTkhQUK/V4e8q9MS6AVBUWoqHxYKXlxclZWVG3egBMAi/EyCE4PVPPmHX/v30iYtr8IFqQhATFckDi29r13BaQS6A8tbnnzNn6lRGDx58Vn/ruaCqKtl5ebz28cf89sc/PqMMqsnEpl27OJaezuJrr\u0026#43;W1jz/mwdtvJzwkxLDmLhJ6at0AeP\u0026#43;rr\u0026#43;gbH8/E0aN55aOPjLrRA2AQfiehqrqGeTNncveNN\u0026#43;JyNYqWqaqCh8XaqEcuBEKAoioNQ2W3Nrk7mqasshK7wyGzGlvolgOt6uK7XQPNtqkqDpeLkrIyNE3o5ZGWnKZpoKrU1ddRVlGBv68vV82Yia\u0026#43;PTzPt9KZlcw/93ecQ\u0026#43;jXAiOI4G7qqbpy13jSpG64mdaOprn5FVSXVNbX4\u0026#43;fpy1YwZRt3oATAIv5OgKAqeVg\u0026#43;8vbwQTSwvIQQul4sjJ06gADsPHCC/sICxI0YyYtAgNu3cybG0NBLi4lgwYwaeHh6oqkpZRSWfLV3K8fQ0oiIimTN1KtHh4QDU1NayfscOjhw9io\u0026#43;PDzMnTWJQUhKKolBcWsraLVvIzMkhIS6e8JBg2QgVWcaTmVms27qF8ooKhg8ZQnVtHaqqomkCm92GEIK0rCzqbDaycnM5mJpCcGAQ86bPICFGLtqdmpbGhm3bqKqpZvzIUQQHBODv50e8sah3q\u0026#43;jMulFQXMyaLVvIzs0lJjKS2U22tVU3FEWS957Dh9m6ezcCwRUjR\u0026#43;NyaQ2\u0026#43;e5vdbtSNHgBD\u0026#43;KLTIKitq6WispKyioqGT119PU6Xi3e\u0026#43;\u0026#43;IIX3n0Pq8VCYlw8r330IU899xwVVVUMTU5m865dfLRkCQD19fV8tmwpBcXFDBs4iPyiIv75yisUFBfjdLl487PP\u0026#43;G7bNgb264eXlycvvPM2h44do7K6mn\u0026#43;//jpH09MZOmgg1TU1fPjNEqpralBVlROZmfzjlZexOxwMTh7AkePH\u0026#43;XbdOoSmUVFVyafLllFdU8vqzZt56vnnyco7xbCBg8grKOBfr71KdU0tKSdP8q9XX5VKnklJbNu7l9/\u0026#43;/e/s2L//DGEuA25c\u0026#43;rpRWFJCWUUF/379dbLz8hg\u0026#43;aBBFpaX85403KCotPWfd\u0026#43;G77dv73/vuEhoTQJy6eVZs2suvAAVSTSkVlJZ8uNepGT4Bh4XcSXC4XXyxbxrGTJxoTpzSN6RMncfWsWVTX1DBm6DDuuP56AHJOnSL7VB53XHcdHl5e\u0026#43;Pv78/myZdTbbFTX1JAYE8MPbr8di8XC7ClT\u0026#43;L///Ifvtm9n5ODBpJw4wW9//GPiY2L0JCxvVmzYwOD\u0026#43;/amtr\u0026#43;fxH/2IAH9/NJcLh8vJyvXrEULw7dq1DO7Xnx/ddRcms5mZNTWczMzEpi9Zp7lcgKC\u0026#43;vp6osDDuu\u0026#43;VmvLy9GTt8BL/6y5/JyMtl6dq1jB85ku8vXoyiqowbPoItu3ZJN4OBVtEpdWPbNny8vTGbzTx6//34eHszd9o0/v6/l9m8ezc\u0026#43;Xl5t1o2qmhqWrFnDzQsXctXMmQCMGjqUHfv2NrgK5doKRt3o7jAIv5OgmkzMnTGDWxYsaJxMEwJ/f38A/Hx9GdgvqUGnPCgwCG9vb6wWCzideHl6YrfbcLpcBPj7MXncOBVH008AABZoSURBVCxmMy592/BBgzieno6XhwdpmRm89cnHerifyumiQuwOJy6XiyEDBhDg54fL6cRkMjF\u0026#43;xAh27NtHXX09OadOccNVV2EymXA5nfh6ezNh1ChOZGToc4lSYdFssTB80CC8PD3RnE68vTzx9famrKKC7Lw85kydKmWYnU7CQ0IZMXgwhuZm2\u0026#43;iMupF68iQmk4ljJ0/y7GuvNvjXU48fx8PigYfVwpD\u0026#43;Z9aNnfv3U1JaSr3NxvBBgxAul5xQjohgxKDBDXKtChh1owfAIPxOgoJCeGgofRISmvlpEYI6mw1Vl7cFvQ0pNA9xE8Kd5oiqqJhbhOqZTCouTcPucBAeGsqoYcMbYruHaxqBAQFs2b27uYqhEJhMJrmguZ5G31Ll0GwynSGR3JpuunuXM\u0026#43;OxjQm5c\u0026#43;FS1w2zySQng4Wgb3w8o4cNR9NcgMLQgYPoExfH6k2bMJnUZud01w1NXz\u0026#43;h6TtXkBLKLdnaqBvdG4bjrBOhKFIv3B3JoCgKiptQBc3F7QVnJM/osRRUVFWyv4luucvl4nh6BvExMfSNj8fH24eJY8awcO5cFs6dS2hIKBk5OSTGxnEyI4N6m102VlUl5cQJyqsq8fT0JDw0lNSTJxrO63A4OXj0KHa7XW\u0026#43;0Z0vPBx8vb2Kjoti5fz8ul4bJbCavoIB9Rw539aPv9riUdeNYejp94uPp36cPPj4\u0026#43;zJk2nYVz5rJg9mxsdjtFpSUkxsVxIjPzzLpRWUlQYCAmk4mM7GwUkwmTyURZZSVH09LadW9G3eg\u0026#43;MCz8ToImNHbu3Yuvp2eD31MAvt7ejB0xgjMSLZUz/3b/5OXpxY4DB/h02TL6JyayPyWFjJwcFl97LZFhYQT6\u0026#43;/Of11/nujlzKK\u0026#43;q4pOlS1k0Zy6jhgzmu21beeOTj5k8ZgzZp06xbutWvL28Masqc6ZO5b9vv0WQfwB94\u0026#43;PZn5LC8YwMRgwa1EAoDQVvBRazievmzuOZV1/h36\u0026#43;/RmRYGCeysjCZTK2uzGRAojPqxm3XLsJkUlmzZTOvffgBE0eN4lhGBqs3beLnDzzA4H79WbVxYyt1w4tAf3\u0026#43;mjruCtz77DLvDgY\u0026#43;3F\u0026#43;u376C6thaL2UwLo71VGHWje8BIi\u0026#43;sYzMB1wNBJY8cxe8qUdvkf3cPcuro6KmuqqayuorK6ioqqShwOJwP69iXAz4/EuFh8vb0BMKkmoiMiiAwLk7HXikJQgD/9EhMJ9PdnwshRHE07ycbt23G6XHzvhhtJ7ttX6pwnJ5Nz\u0026#43;jQbd2wnO1f6TWdPnoS/nx/Jffty6Ngxtu7ejcPlYtGcOQwZMIDE2FjioqKICA1n657d7D10iJDgYG6YN4\u0026#43;k\u0026#43;HhiIyPx8fEmKT4eL08PYiMjmyXZeFitJCUmEh4cwqAB/amorKSyqoqp48ZRWVNNTGQEQ/oPOHcCkaLgcDr5YvkyjqenA6wHNnT1i28HrMCNQPL0CROZMXFiu9wVnVc3\u0026#43;hDg50f/Pn04kJLC1t27qa6pYfG11zJ0wAB8fXxarRuDBwygT1wcg5KSANiwfTvH0tIZmpzM/OnTSYyNJSxYzil0Rt2ot9n5bNlS0rOyBLAa2NbVL74nwZgv6Rg8gTeBxY89\u0026#43;BB/e/zxdj/ApskzTSFoXYukqU5J098a5GwVBafLhc1ux6OJbnnT/ep1/6\u0026#43;nh0fDNlVf07a\u0026#43;yXFNE19UVcXucOB0uqRUbpPknKbXb1k293zB5ytXUlZRwZ3XX4\u0026#43;n1Up6Tg5/fv55fnrPPYxqR/anoijU1NVxx09/wpLVqwGeAJ7s6hffDvgAHwDX/vHRn/HEz3/ebh2czqwbqqridDqx2e1YLRYsFku76oZbQrnebkcAnlZrwzU7s26UV1Zx648fYs3GjRrwK\u0026#43;CZrn7xPQmGS6eTcK5swtb0xdvax30uVVHwbkW33L2fl6enzHJsqmmuN8rWjgOZYGM2mfSheuvnba1sml6eUUOG8NK77/KnZ57B18ebU4VFjB0\u0026#43;nIFJSeersd/jjJKOLgPcmXXDHZ3j7eV15raz1A2hC7J5WCwNevitra9wyetGj6sN3QsG4XccAsDpcgKtRR50cmHOU\u0026#43;v\u0026#43;QvTT24ImBH1iY/ntj39MaloalVWVxEVF0y8xEau\u0026#43;ElN778npbJAY6HFhHA6nq1sU\u0026#43;lLUjfPVw2\u0026#43;tbsRGRdO/A3VD0a/tchmL85wvDMLvGJxAIcDeQ4fIzMmlb3zcGWGLlzuCAgKYPGaMNHWFQGhawwLp54IADh49yrH0NAAHkN/V99NOOIBigD2HDpF7\u0026#43;jRxUVFdXaZuh\u0026#43;DAQCaPGye/CAEdqRtCcCA1lbTMDJDPu7Cr76enwWCqjuMq4C2z2Rw\u0026#43;efx4xg0bjtlk4vwUyA00hYJCnc3Ghh3bOXDkCEKIFOAW4EhXl62duBl4xWq1Bs6cNJlJY8fio0\u0026#43;0GrgwCCEoKilhxfrvOJiSCogDyLpxvKvL1pNgEH7H4Qn8XP\u0026#43;EdHVhejEygT8gJ0J7yhjeF/gt8GPAX1EUI\u0026#43;TwYqH5nEIG8jl/TA90\u0026#43;XUlDMI/P3gDs4D5QERXF\u0026#43;YcEIAFCARK6P4NRCDJ/itgB9KN1pPgByygZ9QNkKHZgUAp3b9uuIATwBfAdnpe3ehyGIR/YbDon\u0026#43;4MDUgG7kaGsJXQvTOsBWBHNu6eDA9kbH53hgb0B\u0026#43;4H/gUU0b05QQD1/P/2zj04rqqO4588mqQtbVLoEwoNtPQFhULFgvKUVxFarCIgooxAxbcIOirIgDqo44MZkWEYO\u0026#43;qoo4ACgjwEhFZQQJ4tWEqhvNrS0kfoM0lJmmT943vu7M1mN48mm7vNfj8zmezevXv27t5zvud3fud3fsdCb0ynXAa8g0YlxsS5GFgLnJ70hZj8U8iWnukbRgDzgP2AuRT\u0026#43;iMT0H9XA2cC\u0026#43;qI4U\u0026#43;ojEGNMFp6JwwRSwHJia9AWZguEkFNqYAlYA05O\u0026#43;IJNfbOEPbAYhyy2KJpqEOgBjytGIb1R4PhG7dYzZo5mOLLdU7O8RYGTSF2YSZwpa3xCvG4uB0UlfmMkfzpY5sJmHQu52AuNQg94GrAHeTPriTKKchTr\u0026#43;JmAssAjYArwLvJ70xRljekY5svDHo8VLKeBaNHk7MemLM4lSBkyjY93YF4VpFnJopukFzqUzcGlBk7RVtG/Aa5O\u0026#43;MJM4rcArdKwb65K\u0026#43;MJNfPGlbXNhyM7lw3SgCLPjGGFMkWPCNMaZIsOAbY0yRYME3xpgiwYJvjDFFggXfGGOKBAu\u0026#43;McYUCRZ8Y4wpEiz4xhhTJFjwjTGmSLDgG2NMkWDBN8aYIsGCb4wxRYIF3xhjigQLfnHg1LcmF64bRYQFf\u0026#43;CTAjaijU\u0026#43;2Jn0xpqBw3Sgy3LsPfErQtoY1qHFvTPqCTMHgumGMMcYYY4wxxhhjjDHGGGOMMcYYY4wxfYrDMguXGmAGsASo76fPLAEqgZbwZwqDkcCHgUOBKmAd8BSwjJ7dp/Lw14Ri8PuKivC/OekfynROWdIXYHIyBfgh8DiwuZ8\u0026#43;czDwVdRw1yb9AxgAjgSuB44BdqB7Mw04HxgO/A/Y1c2yjgbmIyOiLzv081F9fTnpH8t0TnnSF2ByUooEuD9HYeXA4cArSX95A8ABwHXAcuBGYD3Qhqz844HvAg3Ab\u0026#43;iexT4G3d\u0026#43;\u0026#43;NvQmY\u0026#43;t\u0026#43;j8CCX9hEjXgQcATwLjAduXpagSeB55AITEONfwTwIWAY8AbwKLAFdRyHIivx7dhn1KAGuxZZkQeE928DnkYunuOAqUgolqFRR0PSP04RcA4S0p8DdbHj7wMPA/sAF4fH25GVvRS5bED3/JBw/l6k7\u0026#43;9ZyCXUhkYJO4ETgLFote0i0nVkAlCN7ntbOFaBOo53gUmo7rUAZwD/RfVtGnJDjUQj1H8BK\u0026#43;lbV5LpIc6lU/ikkHh/E7gKOAx4HTXm65AYA5wLXA2chxr/m6gRX4OEoRT4DHByRvm1wBXAOGA8Eoax4fkQ5OKZA6wGNiCB\u0026#43;Tx2B\u0026#43;ab4ajjfZD2Yh9nEXLnzAQOAi5H4hxRCnwKOB3VgTGoLtUCQ1EH8D3gi2jUsALYH7kSp4cyTgQuov39Hgp8DRkQ45CRsTfqHAYhN9RVsTLHAz9GhoVJEFv4ew6jkNV1E7LIylAjngM8gQRiMnAp6hAAFgM3APOAPyBrPfOeR66jdcBC4APAXcB9qAGfiDqSZ8P5q5DPtpr\u0026#43;m1soRqrR6Ou1Ts7Ziu5bLXL3VNLRBViB6sqjqI6A6lADEubDgd8Cj4TXHgC\u0026#43;gzr2b6P6UpFRZgkS8ybgVjSyaAZuCa9/DtWNW5Dl/zAyTmYAryb9wxYztvD3DEpQA12MxB7k0lmJhCES8WeQZR9Rh4bSxyBRzzacTpF7mN2IGvV5aGRRg9w816JRhMkf5ah9duYbb0MWfuVufkYpqkPPxY41o1HFVDQi6K4LJt7RrEejjrnIum8DfgT8sz9/QNMRW/h7Dk10FNlW1NBKwuN1pP2sEe\u0026#43;iIXcVPfef1qGh\u0026#43;KXAT5H/fyVwG86smG8a0D0f2ck5lciV8jS77xvfhHz8cTaizmAEnRsEubiH9PzCJaG8xcDd/fbrmaxY8Pccump4pcj/nkkVsgLjnUOcwcjvmo0yZP0tRZbaFOBMZK19hfaTv6Zv2YpGa8cC/0D3L5NJyIcehUNm3tvIXdcZQ\u0026#43;g4H1NJenSRrc6Uh3Oy1ccSNAr9FfAn4EDkJrwEuZRuxhO3iWGXzsAghe7lLDpO2s1EwlyPLMaajPdORQ0xaoTxxj0T\u0026#43;FYo5zXgXuTOSeEJuHzTDPwNCf4JWV6vQZPnK1AsfhMS4SGxc0agTjoXqfD6/hnHZ6DR5AYk3sNpbxRMCO\u0026#43;J15nocQXw5XDdG1DUzk3An4GjkAFiEsKCX9iUZTzOZsGVhuO70GYWF5COnJiHwjnvDq\u0026#43;/hPz5M1AjnoWifCI3UAsSjsNCWdtRpMgnkWthBDA7nLcm6R\u0026#43;nCHgc3btrULTUkaiDngP8Ao26folcMmvRnMtZyM0zBt3/vUmLcT0wGt3foei\u0026#43;V6LorcnIWDgKRXzdi\u0026#43;7/CmBfFPdfjaKB5tJeO3aE90\u0026#43;NHV\u0026#43;AQkKHIyv/UDRh24RJDIfWFS5DUGN9AllZ49AKyXiI3ggkvktQNM0KZBnOA04FDkbROf9Bjf4dJORno1WXByDf6mYUhVOPRONoJAyPo6icOcBHwmdMQkP1Z/DQPN\u0026#43;0onu7BYXTzgM\u0026#43;ijrxlWheJYp62Yl85WcAJ6HOvA655FaH87ejjuBo1EGMQhb3C6Hsk8Nri4G/IiPhPXSf55NO7/Ai8BZyJW0M1zc9/L0cPnM86hiOQ53FWuB3qHMwCeFcOoVLKRoeRxZRBWqA8UnZKJKjFfgJatg3ozj6KtRYt9FemCtQo69AE3b1aLjeHM6LQu4iX2y0DmBUeH8darQW\u0026#43;/5lL2QADELCvYWO6RFKkKtnH9RxbyTdxqP0C\u0026#43;Xo/jYCn0Yi/o1QfnUou4729awMjfCGobmFzeE6WkjPLVSGYzvDsXJUZ/ZCE9Cb6H4KCJMnPGlbuLTRPnoi21A4avBlpN07rXSeB6eZju6YeNkp0qGfETuwZZY09XSdRC\u0026#43;FOoItnZzTEisnqjNtSJA35XhPK/LHb4gdy6yPTRnHWlCEmCkgLPgDgxSauKvrbUGmqFiFXIdtvS3IGNO/VJA7vNKYbGRbRWuMMcYYY4wxxhhjAEW/VHdxziA6z4kTRU\u0026#43;VZbxnGH07FxdF8fTk/O7m8sn2Hboqe3QPzjdd4B/SmPwyGK2IfR\u0026#43;tg8jFKSh\u0026#43;/kWyT6IOA76OwiI3oDUUV6D1FqtQyOY\u0026#43;KBS3N8xGMfdL6d6uWCei2P8ldD35W43SKm8id4DBXmiB2WakT5eiqDFH/PQBXmlrTH6ZhRa7Le/ivAloBWyutTElSAyjifmz0WK8hSh1xjnhWG8ZhxZ2ddcYjNI5dGdNTyXwQdQ55WIsSucxGq0VeDN8r93NCGpiOCzTmPxRDpyGrN8o02kVWvhWiazxzSisto30gqXRKPVB/PV6lEahHgn/BCT0q5E4D0drLIai0US0IGp4KK8VWcmZmTGHhetpRSOQzpL0xVM2VyCR/zdapR0tqipFI40R4Ttvov3CvtbwfyhK2dCM0ik3hfKHh2uK8vc8idJFTEOjDtMLLPjG5I9xKDnZ7eH5QWhzkBok0kNQgrR7SIvghSgnzZDw/Hbg/vD8IpRq42jkStmJ3CQtyB3UhkR4IeoIjkM7XhE\u0026#43;bzPwa5QWgVDOhUiko4VSjeR2zRyLNlt5G40ong\u0026#43;fMyV8ZinKu3Q86U7nOdQ5PUB6wd9hqCOsQR3DGrRn78EoB8/BwJXA38NvsyZ89tKkb\u0026#43;iejgXfmPwxBYnnWiS4C5BF\u0026#43;4Pw/zTgMrRorg35rp8FfoYEcz7wJSR0DUiglwB/QcnKtiEBB1n9LWj3qvXIIr4SuBPtXlaFUhRfgTY/H4O2zXwAJWgrQfMBC9AcQTYrP0rO9x7Kv/NcuOaZ4f1zgY\u0026#43;hPXiXo5HFAuSSeQbNNQxD4n0jyv00FrgedSB/RHmaalEOqJfCd1qOOrQqOo5QTA\u0026#43;w4BuTP2rRJGsjcoGMR\u0026#43;Id5cG5D1nFu8L/jcjij1IYPAh8HE3QLkedQgtyvdSFct4I59aFciLrfS7yf99G2t2yEAntkSgJ2iaUtjgS0TuRGI/t5Dvti/I2LQrPZyJLvhoJ\u0026#43;90oJTLIpXMHmtSNp1JejDqA6JzHUOK1xnD99eHao1QPa5CbaBgW/F5hwTcmf\u0026#43;yNchC1kN468AvItfMCyix5PxK4UiR2W2Pvb0ICl23CMnNjkvjzKmThNyCxjYIzypFoTkcjhGW0F9BdaIRxao7vU4pGI89keW0EEuVlGcffQi6gKI13A\u0026#43;k9lyO2kZ4fKKHjd9sRfgPn0u8lFnxj8kcZEvvIur0dbSRzAtqX4AKU3vj7yHpvpm/y2kSZVgchYY9H4z2GXCWHk91a3kl6LiAb28id9bIty/VnTgK30vOsmVFyQNNLLPjG5I8dyOotRdbpDCS2z4bnk9B2kWfSN\u0026#43;mmozKakTvkDbTVYEQZmjCtQ374/bKUcQC5ty/sjC3IPXNI\u0026#43;I4RtWjStqcdWfzzh5EeJZle4F7TmPzxDnJ1VKCImytRBAvIul6J/NPRvrPdiWUvyXFuKlZOC/AUitIZHztnMnA16c1tZqFOJ6IWLQDLFYOfbX/bEqQj24GH0G5Zs1FY5WTgPNoblrnKiI6lwufH3VhjkKurq/TQpgts4RuTP14FzkcCuxp4GK26rUUW\u0026#43;CEouuYh5OLJzDGfIh3eGH9MODfuGlmOQj4vB25FG5/PQnsQL0LunVNQZM0yJNKzUQfwSCjjCDRZmqvj2ZXlGqNjKbRLVgWKPGpEHc9SYCLpfW/j3yGzjBIUOroRrci9K1z7xPBbNiRyFwcQTq1gTP5oQKLaiATrZWTR74d2g1oN/J70ZO0K2odEtqIJz5WhrLfRHMDOcN4K0pudvI0mQ3eEx9vQ5Or7qIMZjMTzjvD\u0026#43;FhRHvwPtOVuOOqT7gFdQTH6mW2dreG197LXo2AZklS9Bi7FeDOWtQqGai1FnEl3nzhzlNqJOYjuwLlz/uWhye1XSN9QYYzrjTDQpO9BTA5ShXD8LaG9Izkdivd/uFIrCRG9ALiLTS2zhG5NfNiJ3zWYGdgKwaA7hs2hEMRotlvoEGlU8sRtlVqAFWU/SdS4i0w28ibkx\u0026#43;edA5EJZ09uCCpxSlBZiNtr0vBGtN3ie3YuwqUQTv5kuIGOMMcZ0xv8BLoovXGI/nQsAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDQtMDJUMDA6MDk6MTgtMDQ6MDD3mUA3AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTA0LTAyVDAwOjA5OjE4LTA0OjAwhsT4iwAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAASUVORK5CYII=\"\r\n  alt=\"transformer\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ch3 id=\"31-add--norm\"\u003e§3.1 Add \u0026amp; Norm\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eAdd is similar to residual connections in \u003ca href=\"https://arxiv.org/abs/1512.03385\"\u003eResNet\u003c/a\u003e. By introducing \u0026ldquo;shortcut\u0026rdquo; or \u0026ldquo;identity mapping\u0026rdquo;, the transformed input is added together with input.\u003c/li\u003e\n\u003cli\u003eNorm is normalization layer.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"32-feed-forward\"\u003e§3.2 Feed Forward\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eComposed of two Linear Layers and an activation function.\u003c/li\u003e\n\u003cli\u003eThe $1^\\text{st}$ layer is $$\\text{Linear}(X) = XW_1+b_1 \\tag{7}$$\u003c/li\u003e\n\u003cli\u003eThen is activation function ReLU$$\\text{ReLU}(x)=\\max{(0,x)} \\tag{8}$$\u003c/li\u003e\n\u003cli\u003eThe $2^\\text{nd}$ layer is $$\\text{Linear}(X) = XW_2+b_2 \\tag{9}$$\u003c/li\u003e\n\u003cli\u003eSo that we will get $$\\text{FFN}(X)=(\\max{(0,XW_1+b_1)})W_2+b_2 \\tag{10}$$The output of Feed Forward will have the same dimension with input $X$ due to the selection of hyper-parameters.\u003c/li\u003e\n\u003c/ul\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230615-machine-learning-notes-transformer/",
      "date_published": "15066-15-09T60:1515:00+00:00",
      "date_modified": "15066-15-09T60:1515:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "46c720454cafb41fd3469529c425fcc188626b65",
      "title": "Machine Learning Notes: torch.nn",
      "summary": "",
      "content_text": "(Please refer to Wow It Fits! — Secondhand Machine Learning.)\nThis is a quick introduction to torch or how to build a neural network without writing the source code. For the purpose of each layer, see torch.nn and Dive into Deep Learning. Basically, after CNN, parts of the picture is highlighted and the number of channels (RGB $\\rightarrow$ many more) can be different (see CNN Explainer).\nIn the following code, first import the required packages:\nimport torch import torch.nn as nn import torch.nn.functional as F nn.Conv2d x = torch.randn(1, 3, 28, 28) print(x.shape) conv2d = nn.Conv2d(in_channels=3, out_channels=12, kernel_size=3) x = conv2d(x) print(x.shape) will get:\ntorch.Size([1, 3, 28, 28]) torch.Size([1, 12, 26, 26]) nn.MaxPool2d x = torch.randn(1, 3, 28, 28) print(x.shape) pool = nn.MaxPool2d(kernel_size=2) x = pool(x) print(x.shape) will get:\ntorch.Size([1, 3, 28, 28]) torch.Size([1, 3, 14, 14]) nn.BatchNorm2d See Fig.2 of [1803.08494] Group Normalization.\nbatchnorm = nn.BatchNorm2d(3) x = torch.randn(1, 3, 3, 3) print(x) x = batchnorm(x) print(x) will get:\ntensor([[[[-2.3440, 0.5965, 1.2750], [-0.8684, 1.4049, -1.5865], [ 0.0760, 0.3308, 1.4631]], [[-0.7283, 0.6978, 1.1655], [-0.2090, 1.4090, 1.0433], [-0.1820, 0.0191, 1.8880]], [[ 2.5024, 0.5590, 1.6343], [-0.2351, -0.8212, -1.0195], [-0.6536, 0.2503, 0.1578]]]]) tensor([[[[-1.8478, 0.4327, 0.9589], [-0.7034, 1.0596, -1.2603], [ 0.0290, 0.2266, 1.1048]], [[-1.5610, 0.1576, 0.7212], [-0.9351, 1.0146, 0.5739], [-0.9027, -0.6603, 1.5918]], [[ 2.0339, 0.2682, 1.2452], [-0.4533, -0.9858, -1.1660], [-0.8336, -0.0122, -0.0964]]]], grad_fn=\u0026lt;NativeBatchNormBackward0\u0026gt;) nn.Linear For fully connected layer.\nlinear = nn.Linear(3, 12) x = torch.randn(128, 3) x = linear(x) print(x.shape) will get:\ntorch.Size([128, 12]) nn.Dropout For fully connected layer. Using the samples in the Bernoulli distribution, some elements of the input tensor are randomly zeroed with probability $p$. To use it:\ndropout = nn.Dropout(p=0.5, inplace=False) x = dropout(x) x can be a tensor in any shape.\nnn.ReLU or F.relu Activation function, $\\text{ReLU}(x)=\\max{(0,x)}$, to use it：\nx = nn.ReLU(x) or:\nx = F.relu(x) x can be a tensor in any shape.\nnn.RNN input_size = 10 hidden_size = 20 num_layers = 2 seq_length = 5 batch_size = 3 rnn = nn.RNN(input_size, hidden_size, num_layers) input_data = torch.randn(seq_length, batch_size, input_size) output, hidden_state = rnn(input_data) print(output.shape) will get:\ntorch.Size([5, 3, 20]) nn.Module Construct a block of layers. It could be the entire model or just a block of the entire model or loss function, etc.\nclass MyBlock(nn.Module): def __init__(self): super().__init__() # define every layer self.conv1 = nn.Conv2d(1, 20, 5) self.conv2 = nn.Conv2d(20, 20, 5) def forward(self, x): # define forward propagation x = F.relu(self.conv1(x)) x = F.relu(self.conv2(x)) return x nn.Sequential Compared with nn.Module, nn.Sequential can add the layers more easily and don\u0026rsquo;t have to define forward propagation. This is more useful when building a simple neural network.\nFor example, to construct a model with a 2d convolution layer, a ReLU layer and a 2d convolution layer:\nmodel = nn.Sequential( nn.Conv2d(1, 20, 5), nn.ReLU(), nn.Conv2d(20, 64, 5), ) x = torch.randn(1, 1, 30, 30) y = model(x) print(y.shape) will get:\ntorch.Size([1, 64, 22, 22]) The Smallest Framework In practice, the whole project often looks like this:\n├── data │ ├── processed │ └── raw ├── src │ ├── __init__.py │ ├── config.json │ ├── loss.py │ ├── models.py │ └── utils.py ├── LICENSE ├── predict.py ├── prepare_dataset.py ├── README.md ├── requirements.txt └── train.py But this is just a simple model, so it\u0026rsquo;s just one file.\nclass MyNetwork(nn.Module): def __init__(self): super().__init__() # Define every layer self.conv1 = nn.Conv2d(3, 16, kernel_size=3, stride=1, padding=1) self.conv2 = nn.Conv2d(16, 32, kernel_size=3, stride=1, padding=1) self.fc1 = nn.Linear(32 * 32 * 32, 128) self.fc2 = nn.Linear(128, 10) def forward(self, x): # Define forward propagation x = F.relu(self.conv1(x)) x = F.relu(self.conv2(x)) x = x.view(x.size(0), -1) x = F.relu(self.fc1(x)) x = self.fc2(x) return x model = MyNetwork() criterion = nn.CrossEntropyLoss() optimizer = torch.optim.SGD(model.parameters(), lr=0.001) num_epochs = 10 inputs = torch.randn(64, 3, 32, 32) labels = torch.randint(0, 10, (64,)) # Train the model for epoch in range(num_epochs): # Forward propagation outputs = model(inputs) loss = criterion(outputs, labels) # Backward propagation and optimization optimizer.zero_grad() loss.backward() optimizer.step() # Print the training process if (epoch + 1) % 2 == 0: print(\u0026#39;Epoch [{}/{}], Loss: {:.4f}\u0026#39;.format(epoch + 1, num_epochs, loss.item())) # Predict with torch.no_grad(): outputs = model(inputs) _, predicted = torch.max(outputs.data, 1) print(outputs.shape) will get:\nEpoch [2/10], Loss: 2.2880 Epoch [4/10], Loss: 2.2841 Epoch [6/10], Loss: 2.2805 Epoch [8/10], Loss: 2.2769 Epoch [10/10], Loss: 2.2734 torch.Size([64, 10]) Start with torch\u0026rsquo;s example mnist (or What is torch.nn really?) is a great idea.\n",
      "content_html": "\u003cp\u003e(Please refer to \u003ca href=\"https://chenlinear.github.io/posts/20231011-wow-it-fits-secondhand-machine-learning/\"\u003e\u003cem\u003eWow It Fits! — Secondhand Machine Learning\u003c/em\u003e\u003c/a\u003e.)\u003c/p\u003e\n\u003cp\u003eThis is a quick introduction to torch or how to build a neural network without writing the source code. For the purpose of each layer, see \u003ca href=\"https://pytorch.org/docs/stable/nn.html\"\u003etorch.nn\u003c/a\u003e and \u003ca href=\"https://d2l.ai/\"\u003e\u003cem\u003eDive into Deep Learning\u003c/em\u003e\u003c/a\u003e. Basically, after CNN, parts of the picture is highlighted and the number of channels (RGB $\\rightarrow$ many more) can be different (see \u003ca href=\"https://poloclub.github.io/cnn-explainer/\"\u003eCNN Explainer\u003c/a\u003e).\u003c/p\u003e\n\u003cp\u003eIn the following code, first \u003ccode\u003eimport\u003c/code\u003e the required packages:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch.nn\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch.nn.functional\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"nnconv2d\"\u003enn.Conv2d\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e28\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e28\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003econv2d\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ein_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eout_channels\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003econv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 3, 28, 28\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 12, 26, 26\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"nnmaxpool2d\"\u003enn.MaxPool2d\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e28\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e28\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003epool\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eMaxPool2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epool\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 3, 28, 28\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 3, 14, 14\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"nnbatchnorm2d\"\u003enn.BatchNorm2d\u003c/h2\u003e\n\u003cp\u003eSee Fig.2 of \u003ca href=\"https://arxiv.org/abs/1803.08494\"\u003e[1803.08494] \u003cem\u003eGroup Normalization\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ebatchnorm\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eBatchNorm2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebatchnorm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[[[\u003c/span\u003e-2.3440,  0.5965,  1.2750\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.8684,  1.4049, -1.5865\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e 0.0760,  0.3308,  1.4631\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e-0.7283,  0.6978,  1.1655\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.2090,  1.4090,  1.0433\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.1820,  0.0191,  1.8880\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e 2.5024,  0.5590,  1.6343\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.2351, -0.8212, -1.0195\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.6536,  0.2503,  0.1578\u003cspan style=\"color:#f92672\"\u003e]]]])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etensor\u003cspan style=\"color:#f92672\"\u003e([[[[\u003c/span\u003e-1.8478,  0.4327,  0.9589\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.7034,  1.0596, -1.2603\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e 0.0290,  0.2266,  1.1048\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e-1.5610,  0.1576,  0.7212\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.9351,  1.0146,  0.5739\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.9027, -0.6603,  1.5918\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e 2.0339,  0.2682,  1.2452\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.4533, -0.9858, -1.1660\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-0.8336, -0.0122, -0.0964\u003cspan style=\"color:#f92672\"\u003e]]]]\u003c/span\u003e, \u003cspan style=\"color:#111\"\u003egrad_fn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026lt;NativeBatchNormBackward0\u0026gt;\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"nnlinear\"\u003enn.Linear\u003c/h2\u003e\n\u003cp\u003eFor fully connected layer.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elinear\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e128, 12\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"nndropout\"\u003enn.Dropout\u003c/h2\u003e\n\u003cp\u003eFor fully connected layer. Using the samples in the Bernoulli distribution, some elements of the input tensor are randomly zeroed with probability $p$. To use it:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eDropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ep\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einplace\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003edropout\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003ex\u003c/code\u003e can be a tensor in any shape.\u003c/p\u003e\n\u003ch2 id=\"nnrelu-or-frelu\"\u003enn.ReLU or F.relu\u003c/h2\u003e\n\u003cp\u003eActivation function, $\\text{ReLU}(x)=\\max{(0,x)}$, to use it：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eReLU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eor:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003ex\u003c/code\u003e can be a tensor in any shape.\u003c/p\u003e\n\u003ch2 id=\"nnrnn\"\u003enn.RNN\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ernn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eRNN\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_layers\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einput_data\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eseq_length\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ebatch_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput_size\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ehidden_state\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ernn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einput_data\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutput\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e5, 3, 20\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"nnmodule\"\u003enn.Module\u003c/h2\u003e\n\u003cp\u003eConstruct a block of layers. It could be the entire model or just a block of the entire model or loss function, etc.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMyBlock\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# define every layer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# define forward propagation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"nnsequential\"\u003enn.Sequential\u003c/h2\u003e\n\u003cp\u003eCompared with \u003ccode\u003enn.Module\u003c/code\u003e, \u003ccode\u003enn.Sequential\u003c/code\u003e can add the layers more easily and don\u0026rsquo;t have to define forward propagation. This is more useful when building a simple neural network.\u003c/p\u003e\n\u003cp\u003eFor example, to construct a model with a 2d convolution layer, a ReLU layer and a 2d convolution layer:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSequential\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eReLU\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e30\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e30\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ey\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e1, 64, 22, 22\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"the-smallest-framework\"\u003eThe Smallest Framework\u003c/h2\u003e\n\u003cp\u003eIn practice, the whole project often looks like this:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e├── data\n│   ├── processed\n│   └── raw\n├── src\n│   ├── __init__.py\n│   ├── config.json\n│   ├── loss.py\n│   ├── models.py\n│   └── utils.py\n├── LICENSE\n├── predict.py\n├── prepare_dataset.py\n├── README.md\n├── requirements.txt\n└── train.py\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eBut this is just a simple model, so it\u0026rsquo;s just one file.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMyNetwork\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eModule\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003esuper\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Define every layer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epadding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eConv2d\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ekernel_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estride\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epadding\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efc1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efc2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eLinear\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eforward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Define forward propagation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003econv2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eview\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esize\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e),\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eF\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erelu\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efc1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efc2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eMyNetwork\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ecriterion\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eCrossEntropyLoss\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoptim\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eSGD\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eparameters\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(),\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elr\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.001\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003enum_epochs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003einputs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandn\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003elabels\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003erandint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Train the model\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eepoch\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003erange\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enum_epochs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Forward propagation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eoutputs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einputs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ecriterion\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutputs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003elabels\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Backward propagation and optimization\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ezero_grad\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ebackward\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eoptimizer\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003estep\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Print the training process\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eepoch\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;Epoch [\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e], Loss: \u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{:.4f}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eformat\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eepoch\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enum_epochs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eloss\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eitem\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Predict\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003ewith\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eno_grad\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eoutputs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emodel\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einputs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epredicted\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etorch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emax\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutputs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eprint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eoutputs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eshape\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEpoch \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e2/10\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e, Loss: 2.2880\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEpoch \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e4/10\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e, Loss: 2.2841\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEpoch \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e6/10\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e, Loss: 2.2805\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEpoch \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e8/10\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e, Loss: 2.2769\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEpoch \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e10/10\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e, Loss: 2.2734\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etorch.Size\u003cspan style=\"color:#f92672\"\u003e([\u003c/span\u003e64, 10\u003cspan style=\"color:#f92672\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eStart with torch\u0026rsquo;s example \u003ca href=\"https://github.com/pytorch/examples/blob/main/mnist\"\u003emnist\u003c/a\u003e (or \u003ca href=\"https://pytorch.org/tutorials/beginner/nn_tutorial.html\"\u003e\u003cem\u003eWhat is torch.nn really?\u003c/em\u003e\u003c/a\u003e) is a great idea.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230614-machine-learning-notes-torch-nn/",
      "date_published": "14066-14-09T60:1414:00+00:00",
      "date_modified": "14066-14-09T60:1414:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "41c1a3cde60bb63b2907e46b75a2152ec1caf2fd",
      "title": "Contamination of LLM",
      "summary": "",
      "content_text": "This is the dark side of the Force.\nIn one of my previous posts, I talked about Ted Chiang\u0026rsquo;s idea on LLMs. At that time his idea only seems plausible, but now that more papers are published, I want to talk about how LLMs are contaminating the source material.\nTraining LLM with LLM-produced material will produce terrible results.1 This is $\\text{Ted Chiang\u0026rsquo;s idea}^n$.\nAnd the contamination can be divided into two parts in general:\nUnintentional:\nCode. This is what I\u0026rsquo;m most worried about. Will modify an article with ChatGPT make it worse? Intentional:\nAutomated YouTube, TikTok videos, with the help of ChatGPT, music-generator, mid-journey, ppt-generator, etc. Automated Reddit or other discussion board robots, including posts and replies. Automated Twitter robots, though I would say blue check is still definitely not a good idea. We are taking some measures, but they are probably not enough:\nThe co-founder of Wikipedia, Jimmy Wales, recently talked about regulation for the use of ChatGPT in Wikipedia in this podcast episode with Lex Fridman. I really like the part where he said that you, the person, should always be the last barrier.\nYes, for Wikipedia, you should do the fact check, and for code, you should run it on your computer. (The latter one is what Stack Overflow has been debating about I think.)\nTry not to use ChatGPT to write articles. I personally would not use ChatGPT to write my posts. Modifying academic papers with ChatGPT is ok I guess, but if you write academic papers by ChatGPT, there will be consequences.\nSee The Curse of Recursion: Training on Generated Data Makes Models Forget.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003eThis is the dark side of \u003cem\u003ethe Force\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eIn \u003ca href=\"https://chenlinear.github.io/posts/20230321-robin/\"\u003eone of my previous posts\u003c/a\u003e, I talked about Ted Chiang\u0026rsquo;s idea on LLMs. At that time his idea only seems plausible, but now that more papers are published, I want to talk about how LLMs are contaminating the source material.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eTraining LLM with LLM-produced material will produce terrible results.\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e This is $\\text{Ted Chiang\u0026rsquo;s idea}^n$.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAnd the contamination can be divided into two parts in general:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eUnintentional:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eCode. This is what I\u0026rsquo;m most worried about.\u003c/li\u003e\n\u003cli\u003eWill modify an article with ChatGPT make it worse?\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIntentional:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eAutomated YouTube, TikTok videos, with the help of ChatGPT, music-generator, mid-journey, ppt-generator, etc.\u003c/li\u003e\n\u003cli\u003eAutomated Reddit or other discussion board robots, including posts and replies.\u003c/li\u003e\n\u003cli\u003eAutomated Twitter robots, though I would say blue check is still definitely not a good idea.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eWe are taking some measures, but they are probably not enough:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eThe co-founder of Wikipedia, Jimmy Wales, recently talked about regulation for the use of ChatGPT in Wikipedia in \u003ca href=\"https://www.youtube.com/watch?v=diJp4zoQPqo\"\u003ethis podcast episode with Lex Fridman\u003c/a\u003e. I really like the part where he said that you, the person, should always be the last barrier.\u003c/p\u003e\n\u003cp\u003eYes, for Wikipedia, you should do the fact check, and for code, you should run it on your computer. (The latter one is what Stack Overflow has been debating about I think.)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eTry not to use ChatGPT to write articles. I personally would not use ChatGPT to write my posts. Modifying academic papers with ChatGPT is ok I guess, but if you write academic papers by ChatGPT, \u003ca href=\"https://english.elpais.com/science-tech/2023-04-02/one-of-the-worlds-most-cited-scientists-rafael-luque-suspended-without-pay-for-13-years.html\"\u003ethere will be consequences\u003c/a\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eSee \u003ca href=\"https://arxiv.org/abs/2305.17493\"\u003e\u003cem\u003eThe Curse of Recursion: Training on Generated Data Makes Models Forget\u003c/em\u003e\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230613-contamination-of-llm/",
      "date_published": "13066-13-09T60:1313:00+00:00",
      "date_modified": "13066-13-09T60:1313:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "f6f59bd9accae89ab883e9fcaaa9e4e6483a1152",
      "title": "Bon Iver",
      "summary": "",
      "content_text": "In this article, I want to explain why Bon Iver\u0026rsquo;s first album For Emma, Forever Ago is great in the perspective of physics. They\u0026rsquo;re not necessarily true but I just think this is fun.\nHe uses different voice when saying. It\u0026rsquo;s nothing like the way he talks or how he used to sing. You can say that his voice opened a new vision for us. Can you imagine seeing infrared with your own eyes for the first time?\nFirst we break the voice down with Fourier transformation:$$x(\\omega) = \\int_{-\\infty}^{\\infty} x(t) e^{-i \\omega t} \\space \\text{d}t, \\tag{1}$$then if we use inverse Fourier transformation, we will get the original sound $$x(t) = \\frac{1}{2 \\pi} \\int_{-\\infty}^{\\infty} x(\\omega) e^{i \\omega t} \\space \\text{d} \\omega. \\tag{2}$$But if you add a random number on $x(\\omega)$ and use inverse Fourier transform to put it back, we will get: $$x^{\\prime}(t) = \\frac{1}{2 \\pi} \\int_{-\\infty}^{\\infty} (x(\\omega)+ \\text{random}) e^{i \\omega t} \\space \\text{d} \\omega \\tag{3}$$or just pick out few frequencies and emphasize them, that\u0026rsquo;s probably how these songs sound like.\nIn this way, you can say that his music is the build-up and relief or tension.\nRevolutionizing Folk music, one of the oldest and probably the most popular pop music genre, is big. It\u0026rsquo;s like revolutionizing Newton\u0026rsquo;s law. They are still the same elements, but it felt different.\n",
      "content_html": "\u003cp\u003eIn this article, I want to explain why \u003ca href=\"https://boniver.org/\"\u003eBon Iver\u003c/a\u003e\u0026rsquo;s first album \u003cem\u003eFor Emma, Forever Ago\u003c/em\u003e is great in the perspective of physics. They\u0026rsquo;re not necessarily true but I just think this is fun.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eHe uses different voice when saying. It\u0026rsquo;s nothing like the way he talks or how he used to sing. You can say that his voice opened a new vision for us. Can you imagine seeing infrared with your own eyes for the first time?\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFirst we break the voice down with Fourier transformation:$$x(\\omega) = \\int_{-\\infty}^{\\infty} x(t) e^{-i \\omega t} \\space \\text{d}t, \\tag{1}$$then if we use inverse Fourier transformation, we will get the original sound $$x(t) = \\frac{1}{2 \\pi} \\int_{-\\infty}^{\\infty} x(\\omega) e^{i \\omega t} \\space \\text{d} \\omega. \\tag{2}$$But if you add a random number on $x(\\omega)$ and use inverse Fourier transform to put it back, we will get: $$x^{\\prime}(t) = \\frac{1}{2 \\pi} \\int_{-\\infty}^{\\infty} (x(\\omega)+ \\text{random}) e^{i \\omega t} \\space \\text{d} \\omega \\tag{3}$$or just pick out few frequencies and emphasize them, that\u0026rsquo;s probably how these songs sound like.\u003c/p\u003e\n\u003cp\u003eIn this way, you can say that his music is the build-up and relief or tension.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRevolutionizing Folk music, one of the oldest and probably the most popular pop music genre, is big. It\u0026rsquo;s like revolutionizing Newton\u0026rsquo;s law. They are still the same elements, but it felt different.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230612-bon-iver/",
      "date_published": "12066-12-09T60:1212:00+00:00",
      "date_modified": "12066-12-09T60:1212:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "1313bb26cc715f66db9a1f96265b6dac7e323049",
      "title": "immersive-translate",
      "summary": "",
      "content_text": "immersive-translate is a great translating extension, which has a nice format, can open .epub file and translate .epub file directly.\nThere\u0026rsquo;s a bug, when translating Feedly, the translated content in the side bar would convert with the original content. According to 高级自定义配置, I used:\n[ { \u0026#34;matches\u0026#34;: \u0026#34;feedly.com\u0026#34;, \u0026#34;excludeSelectors\u0026#34;: [ \u0026#34;nav\u0026#34;, \u0026#34;footer\u0026#34; ] } ] Learning a little html is really useful.\nFor the translation box, I used purple quotation-style.\n\u0026#34;translationTheme\u0026#34;: \u0026#34;blockquote\u0026#34;, \u0026#34;translationThemePatterns\u0026#34;: { \u0026#34;blockquote\u0026#34;: { \u0026#34;borderColor\u0026#34;: \u0026#34;#c325ef\u0026#34;, \u0026#34;zoom\u0026#34;: \u0026#34;80\u0026#34; }, \u0026#34;paper\u0026#34;: { \u0026#34;zoom\u0026#34;: \u0026#34;80\u0026#34; } ",
      "content_html": "\u003cp\u003e\u003ca href=\"https://github.com/immersive-translate/immersive-translate\"\u003eimmersive-translate\u003c/a\u003e is a great translating extension, which has a nice format, can open .epub file and translate .epub file directly.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eThere\u0026rsquo;s a bug, when translating \u003ca href=\"feedly.com\"\u003eFeedly\u003c/a\u003e, the translated content in the side bar would convert with the original content. According to \u003ca href=\"https://immersive-translate.owenyoung.com/advanced#user-rules\"\u003e高级自定义配置\u003c/a\u003e, I used:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[\n  {\n    \u0026#34;matches\u0026#34;: \u0026#34;feedly.com\u0026#34;,\n    \u0026#34;excludeSelectors\u0026#34;: [\n      \u0026#34;nav\u0026#34;,\n      \u0026#34;footer\u0026#34;\n    ]\n  }\n]\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eLearning a little html is really useful.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFor the translation box, I used purple quotation-style.\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e  \u0026#34;translationTheme\u0026#34;: \u0026#34;blockquote\u0026#34;,\n  \u0026#34;translationThemePatterns\u0026#34;: {\n    \u0026#34;blockquote\u0026#34;: {\n      \u0026#34;borderColor\u0026#34;: \u0026#34;#c325ef\u0026#34;,\n      \u0026#34;zoom\u0026#34;: \u0026#34;80\u0026#34;\n    },\n    \u0026#34;paper\u0026#34;: {\n      \u0026#34;zoom\u0026#34;: \u0026#34;80\u0026#34;\n    }\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\n\u003c/ol\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230602-immersive-translate/",
      "date_published": "2066-02-09T60:22:00+00:00",
      "date_modified": "2066-02-09T60:22:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "94afc2ae64f2073a16b5abb7a4b1e7840cb1372c",
      "title": "RARBG Shuts Down",
      "summary": "",
      "content_text": "RARBG shuts down, and here\u0026rsquo;s their announcement:\nHello guys,\nWe would like to inform you that we have decided to shut down our site.\nThe past 2 years have been very difficult for us - some of the people in our team died due to covid complications,\nothers still suffer the side effects of it - not being able to work at all.\nSome are also fighting the war in Europe - ON BOTH SIDES.\nAlso, the power price increase in data centers in Europe hit us pretty hard.\nInflation makes our daily expenses impossible to bare.\nTherefore we can no longer run this site without massive expenses that we can no longer cover out of pocket.\nAfter an unanimous vote we\u0026rsquo;ve decided that we can no longer do it.\nWe are sorry :(\nBye\nI\u0026rsquo;m not sad that it\u0026rsquo;s shut down. After all, you know what they say, \u0026ldquo;piracy is the oldest profession in the world\u0026rdquo;. Although it might shrink with the development of streaming service, such as Netflix and HBO. What I\u0026rsquo;m sad about is that we are experiencing the aftermath of Covid 19, and I didn\u0026rsquo;t know a piracy website has to take that too. :(\n",
      "content_html": "\u003cp\u003eRARBG shuts down, and here\u0026rsquo;s their announcement:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHello guys,\u003cbr\u003e\nWe would like to inform you that we have decided to shut down our site.\u003cbr\u003e\nThe past 2 years have been very difficult for us - some of the people in our team died due to covid complications,\u003cbr\u003e\nothers still suffer the side effects of it - not being able to work at all.\u003cbr\u003e\nSome are also fighting the war in Europe - ON BOTH SIDES.\u003cbr\u003e\nAlso, the power price increase in data centers in Europe hit us pretty hard.\u003cbr\u003e\nInflation makes our daily expenses impossible to bare.\u003cbr\u003e\nTherefore we can no longer run this site without massive expenses that we can no longer cover out of pocket.\u003cbr\u003e\nAfter an unanimous vote we\u0026rsquo;ve decided that we can no longer do it.\u003cbr\u003e\nWe are sorry :(\u003cbr\u003e\nBye\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eI\u0026rsquo;m not sad that it\u0026rsquo;s shut down. After all, you know what they say, \u0026ldquo;piracy is the oldest profession in the world\u0026rdquo;. Although it might shrink with the development of streaming service, such as Netflix and HBO. What I\u0026rsquo;m sad about is that we are experiencing the aftermath of Covid 19, and I didn\u0026rsquo;t know a piracy website has to take that too. :(\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230531-rarbg-shuts-down/",
      "date_published": "31056-31-09T50:3131:00+00:00",
      "date_modified": "31056-31-09T50:3131:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "f81faec7af3462c6a2a9f5dd4e9e60271b5f4e7b",
      "title": "Qingchun",
      "summary": "",
      "content_text": "I don\u0026rsquo;t really think awards are that important, but here goes my wildest guessing:\nQingchun (2023) is elected into Main Competition in the Cannes Festival this year. It has been 4 years since the last Chinese film, Nanfang chezhan de juhui (2019), was elected. Before that, there is only Chinese film that won the Palme d\u0026rsquo;Or, which is Ba wang bie ji (1993), directed by Kaige Chen, 30 years ago.\nAlthough the real reason may need another Frémaux\u0026rsquo;s diary to reveal, here are some external reasons for which it might won the Palme d\u0026rsquo;Or. I haven\u0026rsquo;t watched the film so I have no idea what are the internal reasons.\nThe director\u0026rsquo;s film have entered the Cannes Festival before, although in the middle he went to the Venice Film Festival and Berlin International Film Festival.\nBased on the previous films of this year\u0026rsquo;s chair man Ruben, he always cares about social problems and class differentiation and all that. And you know what, so does Ken Loach. And this tweet by Patrick Heidmann definitely triggered him:\nBest moment in my interview with Ken Loach just now at Cannes2023 was him very seriously asking:\nRuben Östlund? Who\u0026rsquo;s that?\nThe documentary All the Beauty and the Bloodshed (2022) won the Golden Lion in Venice Film Festival. The documentary Sur l\u0026rsquo;Adamant (2023) won the Golden Berlin Bear in Berlin International Film Festival. It would make a great story if documentaries got the Big Three in a roll.\nThis year\u0026rsquo;s Palme d\u0026rsquo;Or goes to Anatomie d\u0026rsquo;une chute (2023), directed by Justine Triet. It is only the 4th full-length film directed by her. Congrats! By the way, the other competitors who are about the same age are Alice Rohrwacher (5th full-length film) and Ramata-Toulaye Sy (1st full-length film). The rest of whom are mostly born in the 60s and 70s. Marco Bellocchio is born in 1939, when WWII just started.\n",
      "content_html": "\u003cp\u003eI don\u0026rsquo;t really think awards are that important, but here goes my wildest guessing:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.imdb.com/title/tt8469104/\"\u003e\u003cem\u003eQingchun\u003c/em\u003e (2023)\u003c/a\u003e is elected into Main Competition in the Cannes Festival this year. It has been 4 years since the last Chinese film, \u003ca href=\"https://www.imdb.com/title/tt9647768/\"\u003e\u003cem\u003eNanfang chezhan de juhui\u003c/em\u003e (2019)\u003c/a\u003e, was elected. Before that, there is only Chinese film that won the Palme d\u0026rsquo;Or, which is \u003ca href=\"https://www.imdb.com/title/tt0106332/\"\u003e\u003cem\u003eBa wang bie ji\u003c/em\u003e (1993)\u003c/a\u003e, directed by Kaige Chen, 30 years ago.\u003c/p\u003e\n\u003cp\u003eAlthough the real reason may need another Frémaux\u0026rsquo;s diary to reveal, here are some external reasons for which it might won the Palme d\u0026rsquo;Or. I haven\u0026rsquo;t watched the film so I have no idea what are the internal reasons.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eThe director\u0026rsquo;s film have entered the Cannes Festival before, although in the middle he went to the Venice Film Festival and Berlin International Film Festival.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBased on the previous films of this year\u0026rsquo;s chair man Ruben, he always cares about social problems and class differentiation and all that. And you know what, so does Ken Loach. And \u003ca href=\"https://twitter.com/patrickheidmann/status/1661697793507901441\"\u003ethis tweet\u003c/a\u003e by \u003ca href=\"https://twitter.com/patrickheidmann\"\u003ePatrick Heidmann\u003c/a\u003e definitely triggered him:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eBest moment in my interview with Ken Loach just now at \u003ca href=\"https://twitter.com/hashtag/Cannes2023?src=hashtag_click\"\u003eCannes2023\u003c/a\u003e was him very seriously asking:\u003c/p\u003e\n\u003cp\u003eRuben Östlund? Who\u0026rsquo;s that?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe documentary \u003ca href=\"https://www.imdb.com/title/tt21374850/\"\u003e\u003cem\u003eAll the Beauty and the Bloodshed\u003c/em\u003e (2022)\u003c/a\u003e won the Golden Lion in Venice Film Festival. The documentary \u003ca href=\"https://www.imdb.com/title/tt26448811/\"\u003e\u003cem\u003eSur l\u0026rsquo;Adamant\u003c/em\u003e (2023)\u003c/a\u003e won the Golden Berlin Bear in Berlin International Film Festival. It would make a great story if documentaries got the Big Three in a roll.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThis year\u0026rsquo;s Palme d\u0026rsquo;Or goes to \u003ca href=\"https://www.imdb.com/title/tt17009710/\"\u003e\u003cem\u003eAnatomie d\u0026rsquo;une chute\u003c/em\u003e (2023)\u003c/a\u003e, directed by Justine Triet. It is only the 4th full-length film directed by her. Congrats! By the way, the other competitors who are about the same age are Alice Rohrwacher (5th full-length film) and Ramata-Toulaye Sy (1st full-length film). The rest of whom are mostly born in the 60s and 70s. Marco Bellocchio is born in 1939, when WWII just started.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230528-qingchun/",
      "date_published": "28056-28-09T50:2828:00+00:00",
      "date_modified": "28056-28-09T50:2828:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "5af030f4151192bd854581611cd9d00d5a19bdb9",
      "title": "LaTeX Style",
      "summary": "",
      "content_text": "If you don\u0026rsquo;t know what it is, I recommend you should just play with it and don\u0026rsquo;t care about the style.\nBut I\u0026rsquo;d like to say TinyTeX (~500 MB) or Overleaf (0 MB) are better choices than TeX Live (~5 GB). I normally write in Markdown first, and then use Overleaf. If you\u0026rsquo;re using JupyterLab, jupyterlab-latex is basically the local version of Overleaf.\n§1 General About the name: $\\LaTeX$ ($\\LaTeX$) is great, LaTeX or latex is acceptable, lAtEx is brutal.\nYou should never start from scratch. Finding a template and modifying the template is so much easier. Starting from scratch is mission impossible.\nThe folder structure should look like this so that it\u0026rsquo;s more manageable:\n├── data\r│ └── i-tried.cls\r├── figures\r│ ├── figure1-amazing-plot.png\r│ ├── figure2-accurate-figure.svg\r│ └── figure3-beautiful-plot.pdf\r├── main.bbl\r├── main.tex\r└── pages\r├── abstract.tex\r├── appendix.tex\r├── chapter1.tex\r├── chapter2.tex\r├── chapter3.tex\r└── chapter4.tex This might be different for arXiv submission, check out this guide: Submit TeX/LaTeX - arXiv info, this template: arxiv-style and two python tools: arxiv-converter, flatex. Or just download the source of a paper you like and modify it.\n§2 This and That These are strange rules, and keep them.\n§2.1 Equations I normally use Supported Functions · KaTeX or LaTeX数学公式语法 to find how to write a certain symbol or equation.\n§2.1.1 When a Sentence End with an Equation Use \\, for the end of an equation, when followed by \u0026ldquo;.\u0026rdquo;.\nFor example: The Energy is given by $$E_0=mc^2 \\space . \\tag{1}$$\nThe Energy is given by \\[E_0=mc^2 \\, . \\tag{1}\\] (In the source code of this article, I have to use \\space rather than \\,. Because the latter one would compile as \u0026ldquo;$,$\u0026rdquo;.)\n§2.1.2 Number and Series Number Always use \\( \\) for number. For example: There are $24$ elements in total.\nThere are \\(24\\) elements in total. And for series number, for example: This is the $n^{\\textrm{th}}$ element.\nThis is the \\(n^{\\textrm{th}}\\) element. §2.1.3 Unit Use \\, between number and unit. Use \\mathrm{} for the unit. For example: $3 \\times 10^8 \\space \\mathrm{m/s}$\n\\(3 \\times 10^8 \\, \\mathrm{m/s}\\) §2.1.4 Integral \\mathrm{d} x for $\\mathrm{d} x$. \\, before $\\mathrm{d}x$. \\! between $\\int$ and what\u0026rsquo;s to be intergraded. For example: $\\int_0^{\\pi} f(x) \\space \\mathrm{d} x = 1$\n\\(\\int_0^{\\pi} \\! f(x) \\, \\mathrm{d} x = 1\\) §2.1.5 Transpose For example: $\\mathbf{A}^\\mathsf{T}$\n\\(\\mathbf{A}^\\mathsf{T}\\) §2.1.6 bracket For example: $\\lparen \\rparen$, $\\lbrack \\rbrack$, $\\lbrace \\rbrace$\n\\(\\lparen \\rparen\\) \\(\\lbrack \\rbrack\\) \\(\\lbrace \\rbrace\\) So that the bracket would get a proper length.\nAnd for $\\bra{\\phi}$, $\\ket{\\psi}$, $\\braket{\\phi\\vert\\psi}$ in Quantum Physics:\n\\(\\bra{\\phi}\\) \\(\\ket{\\psi}\\) \\(\\braket{\\phi\\vert\\psi}\\) §2.2 Text §2.2.1 \u0026ldquo;.\u0026rdquo; \u0026ldquo;!\u0026rdquo; \u0026ldquo;?\u0026rdquo; \u0026ldquo;.\u0026rdquo; would be considered as the end of a sentence, but sometimes it\u0026rsquo;s not right, for example: \u0026ldquo;e.g.\u0026rdquo; and \u0026ldquo;i.e.\u0026rdquo;. That\u0026rsquo;s when we use \\ :\nNeutron is composed of quarks, i.e.\\ it\u0026#39;s not fundamental. After a capital Letter, the \u0026ldquo;.\u0026rdquo; would be considered in the middle of a name, for example: \u0026ldquo;F. Scott Fitzgerald\u0026rdquo;. But sometimes we don\u0026rsquo;t want that, for example: \u0026ldquo;Then I asked ChatGPT. It\u0026rsquo;s of no use either.\u0026rdquo; That\u0026rsquo;s when we use \\@. to tell $\\LaTeX$ it is the end of a sentence:\nThen I asked ChatGPT\\@. It\u0026#39;s of no use either. It is the same for \u0026ldquo;!\u0026rdquo; and \u0026ldquo;?\u0026rdquo;.\n§2.2.2 Hyphens, En-dashes and Em-dashes Hyphens, for example: 5-year-old\n5-year-old En-dashes, for example: See pages 200-201.\nSee pages 200--201. Em-dashes, for example: Most newspapers — and all that follow AP style — insert a space before and after the em-dash.\nMost newspapers --- and all that follow AP style --- insert a space before and after the em-dash. §2.2.3 Quotation \u0026quot;\u0026quot;\n`` \u0026#39;\u0026#39; I understand, but this is just weird.\n§2.2.4 People\u0026rsquo;s name Use ~ instead of space to avoid a name being broken into two parts to the next line:\nF.~Scott~Fitzgerald is known as a writer. It is the same if you don\u0026rsquo;t want to break a phrase. e.g. rank $1$\nrank~\\(1\\) §2.3 Table LaTeX table generator can generate tables.\n§2.4 Code To quote a package, for example, $\\texttt{NumPy}$:\n\\texttt{NumPy} ",
      "content_html": "\u003cp\u003eIf you don\u0026rsquo;t know what it is, I recommend you should just play with it and don\u0026rsquo;t care about the style.\u003c/p\u003e\n\u003cp\u003eBut I\u0026rsquo;d like to say \u003ca href=\"https://github.com/rstudio/tinytex\"\u003eTinyTeX\u003c/a\u003e (~500 MB) or \u003ca href=\"https://www.overleaf.com/\"\u003eOverleaf\u003c/a\u003e (0 MB) are better choices than \u003ca href=\"https://www.tug.org/texlive/\"\u003eTeX Live\u003c/a\u003e (~5 GB). I normally write in Markdown first, and then use Overleaf. If you\u0026rsquo;re using JupyterLab, \u003ca href=\"https://github.com/jupyterlab/jupyterlab-latex\"\u003ejupyterlab-latex\u003c/a\u003e is basically the local version of Overleaf.\u003c/p\u003e\n\u003ch2 id=\"1-general\"\u003e§1 General\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eAbout the name: $\\LaTeX$ (\u003ccode\u003e$\\LaTeX$\u003c/code\u003e) is great, LaTeX or latex is acceptable, lAtEx is brutal.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eYou should never start from scratch. Finding a template and modifying the template is so much easier. Starting from scratch is \u003ca href=\"https://www.imdb.com/title/tt0117060/\"\u003emission impossible\u003c/a\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe folder structure should look like this so that it\u0026rsquo;s more manageable:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e├── data\r\n│   └── i-tried.cls\r\n├── figures\r\n│   ├── figure1-amazing-plot.png\r\n│   ├── figure2-accurate-figure.svg\r\n│   └── figure3-beautiful-plot.pdf\r\n├── main.bbl\r\n├── main.tex\r\n└── pages\r\n    ├── abstract.tex\r\n    ├── appendix.tex\r\n    ├── chapter1.tex\r\n    ├── chapter2.tex\r\n    ├── chapter3.tex\r\n    └── chapter4.tex\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis might be different for arXiv submission, check out this guide: \u003ca href=\"https://info.arxiv.org/help/submit_tex.html\"\u003eSubmit TeX/LaTeX - arXiv info\u003c/a\u003e, this template: \u003ca href=\"https://github.com/kourgeorge/arxiv-style\"\u003earxiv-style\u003c/a\u003e and two python tools: \u003ca href=\"https://github.com/sdatkinson/arxiv-converter\"\u003earxiv-converter\u003c/a\u003e, \u003ca href=\"https://github.com/johnjosephhorton/flatex\"\u003eflatex\u003c/a\u003e. Or just download the source of a paper you like and modify it.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"2-this-and-that\"\u003e§2 This and That\u003c/h2\u003e\n\u003cp\u003eThese are strange rules, and keep them.\u003c/p\u003e\n\u003ch3 id=\"21-equations\"\u003e§2.1 Equations\u003c/h3\u003e\n\u003cp\u003eI normally use \u003ca href=\"https://katex.org/docs/supported.html\"\u003eSupported Functions · KaTeX\u003c/a\u003e or \u003ca href=\"https://www.wolai.com/wolai/egjDbHiAfGfJmwR972fcEW\"\u003eLaTeX数学公式语法\u003c/a\u003e to find how to write a certain symbol or equation.\u003c/p\u003e\n\u003ch4 id=\"211-when-a-sentence-end-with-an-equation\"\u003e§2.1.1 When a Sentence End with an Equation\u003c/h4\u003e\n\u003cp\u003eUse \u003ccode\u003e\\,\u003c/code\u003e for the end of an equation, when followed by \u0026ldquo;.\u0026rdquo;.\u003c/p\u003e\n\u003cp\u003eFor example: The Energy is given by $$E_0=mc^2 \\space . \\tag{1}$$\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eThe Energy is given by \u003cspan style=\"color:#d88200\"\u003e\\[\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eE_\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003emc^\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e \u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e . \u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\tag\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\\]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e(In the source code of this article, I have to use \u003ccode\u003e\\space\u003c/code\u003e rather than \u003ccode\u003e\\,\u003c/code\u003e. Because the latter one would compile as \u0026ldquo;$,$\u0026rdquo;.)\u003c/p\u003e\n\u003ch4 id=\"212-number-and-series-number\"\u003e§2.1.2 Number and Series Number\u003c/h4\u003e\n\u003cp\u003eAlways use \u003ccode\u003e\\( \\)\u003c/code\u003e for number. For example: There are $24$ elements in total.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eThere are \u003cspan style=\"color:#d88200\"\u003e\\(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e24\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\\)\u003c/span\u003e elements in total.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd for series number, for example: This is the $n^{\\textrm{th}}$ element.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eThis is the \u003cspan style=\"color:#d88200\"\u003e\\(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003en^{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\textrm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e{th}}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\\)\u003c/span\u003e element.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"213-unit\"\u003e§2.1.3 Unit\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003eUse \u003ccode\u003e\\,\u003c/code\u003e between number and unit.\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003e\\mathrm{}\u003c/code\u003e for the unit.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eFor example: $3 \\times 10^8 \\space \\mathrm{m/s}$\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\\(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e \u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\times\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e \u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e^\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e \u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e \u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\mathrm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e{m\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#111\"\u003es}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\\)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"214-integral\"\u003e§2.1.4 Integral\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e\\mathrm{d} x\u003c/code\u003e for $\\mathrm{d} x$.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\,\u003c/code\u003e before $\\mathrm{d}x$.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\!\u003c/code\u003e between $\\int$ and what\u0026rsquo;s to be intergraded.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eFor example: $\\int_0^{\\pi} f(x) \\space \\mathrm{d} x = 1$\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\\(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\int\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e_\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e^{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\pi\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e} \u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\!\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e f\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e \u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\,\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e \u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\mathrm\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e{d} x \u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e \u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\\)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"215--transpose\"\u003e§2.1.5  Transpose\u003c/h4\u003e\n\u003cp\u003eFor example: $\\mathbf{A}^\\mathsf{T}$\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\\(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\mathbf\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e{A}^\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\mathsf\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e{T}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\\)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"216--bracket\"\u003e§2.1.6  bracket\u003c/h4\u003e\n\u003cp\u003eFor example: $\\lparen \\rparen$, $\\lbrack \\rbrack$, $\\lbrace \\rbrace$\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\\(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\lparen\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e \u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\rparen\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\\)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\\(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\lbrack\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e \u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\rbrack\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\\)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\\(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\lbrace\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e \u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\rbrace\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\\)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eSo that the bracket would get a proper length.\u003c/p\u003e\n\u003cp\u003eAnd for $\\bra{\\phi}$, $\\ket{\\psi}$, $\\braket{\\phi\\vert\\psi}$ in Quantum Physics:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\\(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\bra\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\phi\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\\)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\\(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\ket\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\psi\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\\)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\\(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\braket\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\\phi\\vert\\psi\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\\)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"22-text\"\u003e§2.2 Text\u003c/h3\u003e\n\u003ch4 id=\"221---\"\u003e§2.2.1 \u0026ldquo;.\u0026rdquo; \u0026ldquo;!\u0026rdquo; \u0026ldquo;?\u0026rdquo;\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u0026ldquo;.\u0026rdquo; would be considered as the end of a sentence, but sometimes it\u0026rsquo;s not right, for example: \u0026ldquo;e.g.\u0026rdquo; and \u0026ldquo;i.e.\u0026rdquo;. That\u0026rsquo;s when we use \u003ccode\u003e\\ \u003c/code\u003e :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNeutron is composed of quarks, i.e.\u003cspan style=\"color:#00a8c8\"\u003e\\ \u003c/span\u003eit\u0026#39;s not fundamental.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAfter a capital Letter, the \u0026ldquo;.\u0026rdquo; would be considered in the middle of a name, for example: \u0026ldquo;F. Scott Fitzgerald\u0026rdquo;. But sometimes we don\u0026rsquo;t want that, for example: \u0026ldquo;Then I asked ChatGPT. It\u0026rsquo;s of no use either.\u0026rdquo; That\u0026rsquo;s when we use \u003ccode\u003e\\@. \u003c/code\u003e to tell $\\LaTeX$ it is the end of a sentence:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eThen I asked ChatGPT\u003cspan style=\"color:#00a8c8\"\u003e\\@\u003c/span\u003e. It\u0026#39;s of no use either.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eIt is the same for \u0026ldquo;!\u0026rdquo; and \u0026ldquo;?\u0026rdquo;.\u003c/p\u003e\n\u003ch4 id=\"222-hyphens-en-dashes-and-em-dashes\"\u003e§2.2.2 Hyphens, En-dashes and Em-dashes\u003c/h4\u003e\n\u003cp\u003eHyphens, for example: 5-year-old\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e5-year-old\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eEn-dashes, for example: See pages 200-201.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSee pages 200--201.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eEm-dashes, for example: Most newspapers — and all that follow AP style — insert a space before and after the em-dash.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMost newspapers --- and all that follow AP style --- insert a space before and after the em-dash.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"223-quotation\"\u003e§2.2.3 Quotation\u003c/h4\u003e\n\u003cp\u003e\u0026quot;\u0026quot;\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e`` \u0026#39;\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eI understand, but this is just weird.\u003c/p\u003e\n\u003ch4 id=\"224-peoples-name\"\u003e§2.2.4 People\u0026rsquo;s name\u003c/h4\u003e\n\u003cp\u003eUse \u003ccode\u003e~\u003c/code\u003e instead of space to avoid a name being broken into two parts to the next line:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eF.~Scott~Fitzgerald is known as a writer.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIt is the same if you don\u0026rsquo;t want to break a phrase. e.g. rank $1$\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erank~\u003cspan style=\"color:#d88200\"\u003e\\(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\\)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"23-table\"\u003e§2.3 Table\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://www.tablesgenerator.com/\"\u003eLaTeX table generator\u003c/a\u003e can generate tables.\u003c/p\u003e\n\u003ch3 id=\"24-code\"\u003e§2.4 Code\u003c/h3\u003e\n\u003cp\u003eTo quote a package, for example, $\\texttt{NumPy}$:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-latex\" data-lang=\"latex\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003e\\texttt\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e{\u003c/span\u003eNumPy\u003cspan style=\"color:#111\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e",
      "url": "https://chenlinear.github.io/posts/20230521-latex-style/",
      "date_published": "21056-21-09T50:2121:00+00:00",
      "date_modified": "21056-21-09T50:2121:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "4bd782cf1a7240c62c592e2b95f9b34acf368ae2",
      "title": "Markdown Style",
      "summary": "",
      "content_text": "If you don\u0026rsquo;t know what it is, I recommend you should just play with it and don\u0026rsquo;t care about the style.\nObsidian is the text editor that I\u0026rsquo;m using. I like workspaces and double link feature.\n§1 General Markdown Guide is good as a quick introduction.\nThe thing about Markdown style is that every text editor has its own accent. I suggest using the universal ones, not the ones that a certain text editor created. Also, the best way to read this article is to copy and paste what\u0026rsquo;s in the code block, and see if it fits your text editor.\n§2 This and That §2.1 Use Blank Lines! Wrong:\nuse blank lines! use blank lines! Correct:\nuse blank lines! use blank lines! See Let Your Markdown Breathe! - Remember to insert blank lines between different Markdown elements.\n§2.2 Only Use _ for Bold and Italic Bold _and_ Italic Bold __and__ Italic Bold ___and___ Italic §2.3 In the Middle of a Sentence, use * for Bold and Italic Bold*and*Italic Bold**and**Italic Bold***and***Italic But to tell you the truth, I haven\u0026rsquo;t seen anyone write like this.\n§2.4 Only use - for Unordered Lists As I said, there are a lot of Markdown accent, but - is universal. Also, this is in agreement with §2.2, so that you can only use the -/_ key on the keyboard.\n- unordered lists §2.5 Four Spaces in Lists This is a fun coincidence with Python.\n- First paragraph Still first paragraph - Second paragraph Or:\n1. First paragraph Still first paragraph 2. Second paragraph To do list too:\n- [ ] hurry - [ ] up, - [ ] now! §2.6 Quote and Code Block in List Again, four spaces. But in Obsidian, these are shown correct in reading mode, shown werid in editing mode. See Code blocks nested in lists render in editor as if at top-level.\n- Quote: \u0026gt;This is the quote. - Code Block: ```python x = x + 1 ``` By the way, when you write verbatim text that contains three backticks (ie. code block in code block), you have to use four backticks to wrap the text. See The Two Surprisingly Hard Things about the Otherwise Simple Markdown - Writing three backticks verbatim, and understanding nested lists.\n§2.7 Equations Different Markdown accent handle equations differently, see 混乱的 Markdown 世界. And for Obsidian:\n1. display equations: $$\\begin{aligned} E_0\u0026amp;=mc^2 \\\\\\ E^2\u0026amp;=(mc^2)^2+(pc)^2 \\end{aligned} \\tag{1}$$where $c = 3 \\times 10^8 \\space \\mathrm{m/s}$ 2. or inline equations: $\\vec{F} = m \\ddot{\\vec{x}}$. §2.8 Two Pictures Alignment Use table (compared with inserting html \u0026lt;\u0026gt; and all that, this is easier to read):\n|![name](link)|![name](link)| |-|-| Most text editors show the picture with modified proper size. But for some text editors, when the picture is too big, you should reduce pixel size of the picture before showing it in the table. This is the case for remark and DrSlidelove. But you can solve it by putting it in a table.\n§3 使用中文时 §3.1 空格 中英文混排中的空格和盘古之白说在英文单词两边各空一空格。我的建议是在表示代码时也是如此，例如：\n我们可以 `from scipy import interpolate` 来解决这个 interpolation 问题。 §3.2 引用诗词 如何在 Markdown 中引用诗词或歌词的引用方式在 Obsidian 可能不是最好的解决方法，可以直接每行右边没有空格，见 Blockquotes with Multiple Paragraphs：\n\u0026gt;缺月昏昏漏未央，一灯明灭照秋床。 \u0026gt;病身最觉风露早，归梦不知山水长。 \u0026gt;坐感岁时歌慷慨，起看天地色凄凉。 \u0026gt;鸣蝉更乱行人耳，正抱疏桐叶半黄。 但是在我的个人网站中应该每行右边两个空格：\n\u0026gt;缺月昏昏漏未央，一灯明灭照秋床。 \u0026gt;病身最觉风露早，归梦不知山水长。 \u0026gt;坐感岁时歌慷慨，起看天地色凄凉。 \u0026gt;鸣蝉更乱行人耳，正抱疏桐叶半黄。 才能显示正确：\n缺月昏昏漏未央，一灯明灭照秋床。\n病身最觉风露早，归梦不知山水长。\n坐感岁时歌慷慨，起看天地色凄凉。\n鸣蝉更乱行人耳，正抱疏桐叶半黄。\n",
      "content_html": "\u003cp\u003eIf you don\u0026rsquo;t know what it is, I recommend you should just play with it and don\u0026rsquo;t care about the style.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://obsidian.md/\"\u003eObsidian\u003c/a\u003e is the text editor that I\u0026rsquo;m using. I like \u003ca href=\"https://help.obsidian.md/Plugins/Workspaces\"\u003eworkspaces\u003c/a\u003e and \u003ca href=\"https://help.obsidian.md/Getting+started/Link+notes\"\u003edouble link\u003c/a\u003e feature.\u003c/p\u003e\n\u003ch2 id=\"1-general\"\u003e§1 General\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://www.markdownguide.org/\"\u003e\u003cem\u003eMarkdown Guide\u003c/em\u003e\u003c/a\u003e is good as a quick introduction.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe thing about Markdown style is that every text editor has its own accent. I suggest using the universal ones, not the ones that a certain text editor created. Also, the best way to read this article is to copy and paste what\u0026rsquo;s in the code block, and see if it fits your text editor.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"2-this-and-that\"\u003e§2 This and That\u003c/h2\u003e\n\u003ch3 id=\"21-use-blank-lines\"\u003e§2.1 Use Blank Lines!\u003c/h3\u003e\n\u003cp\u003eWrong:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse blank lines!\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse blank lines!\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eCorrect:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse blank lines!\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse blank lines!\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eSee \u003ca href=\"https://yihui.org/en/2021/06/markdown-breath/\"\u003e\u003cem\u003eLet Your Markdown Breathe! - Remember to insert blank lines between different Markdown elements\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"22-only-use-_-for-bold-and-italic\"\u003e§2.2 Only Use \u003ccode\u003e_\u003c/code\u003e for Bold and Italic\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBold \u003cspan style=\"font-style:italic\"\u003e_and_\u003c/span\u003e Italic\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBold \u003cspan style=\"font-weight:bold\"\u003e__and__\u003c/span\u003e Italic\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBold \u003cspan style=\"font-weight:bold\"\u003e___and___\u003c/span\u003e Italic\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"23-in-the-middle-of-a-sentence-use--for-bold-and-italic\"\u003e§2.3 In the Middle of a Sentence, use \u003ccode\u003e*\u003c/code\u003e for Bold and Italic\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBold*and*Italic\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBold**and**Italic\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBold***and***Italic\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eBut to tell you the truth, I haven\u0026rsquo;t seen \u003cstrong\u003eany\u003c/strong\u003eone write like this.\u003c/p\u003e\n\u003ch3 id=\"24-only-use---for-unordered-lists\"\u003e§2.4 Only use \u003ccode\u003e-\u003c/code\u003e for Unordered Lists\u003c/h3\u003e\n\u003cp\u003eAs I said, there are a lot of Markdown accent, but \u003ccode\u003e-\u003c/code\u003e is universal. Also, this is in agreement with §2.2, so that you can only use the \u003ccode\u003e-\u003c/code\u003e/\u003ccode\u003e_\u003c/code\u003e key on the keyboard.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003e-\u003c/span\u003e unordered lists\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"25-four-spaces-in-lists\"\u003e§2.5 Four Spaces in Lists\u003c/h3\u003e\n\u003cp\u003eThis is a fun coincidence with Python.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003e-\u003c/span\u003e First paragraph\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Still first paragraph\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003e-\u003c/span\u003e Second paragraph\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eOr:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003e1.\u003c/span\u003e First paragraph\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tStill first paragraph\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003e2.\u003c/span\u003e Second paragraph\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eTo do list too:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003e- [ ]\u003c/span\u003e hurry\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#00a8c8\"\u003e- [ ]\u003c/span\u003e up,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003e- [ ]\u003c/span\u003e now!\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"26-quote-and-code-block-in-list\"\u003e§2.6 Quote and Code Block in List\u003c/h3\u003e\n\u003cp\u003eAgain, four spaces. But in Obsidian, these are shown correct in reading mode, shown werid in editing mode. See \u003ca href=\"https://forum.obsidian.md/t/code-blocks-nested-in-lists-render-in-editor-as-if-at-top-level/870/10\"\u003e\u003cem\u003eCode blocks nested in lists render in editor as if at top-level\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003e-\u003c/span\u003e Quote:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026gt;This is the quote.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003e-\u003c/span\u003e Code Block:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ```python\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    x = x + 1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ```\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eBy the way, when you write verbatim text that contains three backticks (ie. code block in code block), you have to use four backticks to wrap the text. See \u003ca href=\"https://yihui.org/en/2018/11/hard-markdown/\"\u003e\u003cem\u003eThe Two Surprisingly Hard Things about the Otherwise Simple Markdown - Writing three backticks verbatim, and understanding nested lists\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"27-equations\"\u003e§2.7 Equations\u003c/h3\u003e\n\u003cp\u003eDifferent Markdown accent handle equations differently, see \u003ca href=\"https://yihui.org/cn/2017/08/markdown-flavors/\"\u003e\u003cem\u003e混乱的 Markdown 世界\u003c/em\u003e\u003c/a\u003e. And for Obsidian:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003e1.\u003c/span\u003e display equations: $$\\begin{aligned} E_0\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026amp;\u003c/span\u003e=mc^2 \\\\\\ E^2\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026amp;\u003c/span\u003e=(mc^2)^2+(pc)^2 \\end{aligned} \\tag{1}$$where $c = 3 \\times 10^8 \\space \\mathrm{m/s}$\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003e2.\u003c/span\u003e or inline equations: $\\vec{F} = m \\ddot{\\vec{x}}$.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"28-two-pictures-alignment\"\u003e§2.8 Two Pictures Alignment\u003c/h3\u003e\n\u003cp\u003eUse table (compared with inserting html \u003ccode\u003e\u0026lt;\u0026gt;\u003c/code\u003e and all that, this is easier to read):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|![name](link)|![name](link)|\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|-|-|\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eMost text editors show the picture with modified proper size. But for some text editors, when the picture is too big, you should reduce pixel size of the picture before showing it in the table. This is the case for \u003ca href=\"https://github.com/gnab/remark\"\u003eremark\u003c/a\u003e and \u003ca href=\"https://github.com/chenlinear/DrSlidelove\"\u003eDrSlidelove\u003c/a\u003e. But you can solve it by putting it in a table.\u003c/p\u003e\n\u003ch2 id=\"3-使用中文时\"\u003e§3 使用中文时\u003c/h2\u003e\n\u003ch3 id=\"31-空格\"\u003e§3.1 空格\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://yihui.org/cn/2017/04/space\"\u003e\u003cem\u003e中英文混排中的空格\u003c/em\u003e\u003c/a\u003e和\u003ca href=\"https://yihui.org/cn/2017/05/pangu/\"\u003e\u003cem\u003e盘古之白\u003c/em\u003e\u003c/a\u003e说在英文单词两边各空一空格。我的建议是在表示代码时也是如此，例如：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e我们可以 \u003cspan style=\"color:#d88200\"\u003e`from scipy import interpolate`\u003c/span\u003e 来解决这个 interpolation 问题。\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"32-引用诗词\"\u003e§3.2 引用诗词\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://yihui.org/cn/2018/07/quote-poem/\"\u003e\u003cem\u003e如何在 Markdown 中引用诗词或歌词\u003c/em\u003e\u003c/a\u003e的引用方式在 Obsidian 可能不是最好的解决方法，可以直接每行右边没有空格，见 \u003ca href=\"https://www.markdownguide.org/basic-syntax/#blockquotes-with-multiple-paragraphs\"\u003e\u003cem\u003eBlockquotes with Multiple Paragraphs\u003c/em\u003e\u003c/a\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt;缺月昏昏漏未央，一灯明灭照秋床。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt;病身最觉风露早，归梦不知山水长。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt;坐感岁时歌慷慨，起看天地色凄凉。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt;鸣蝉更乱行人耳，正抱疏桐叶半黄。\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e但是在我的个人网站中应该每行右边两个空格：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt;缺月昏昏漏未央，一灯明灭照秋床。  \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt;病身最觉风露早，归梦不知山水长。  \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt;坐感岁时歌慷慨，起看天地色凄凉。  \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt;鸣蝉更乱行人耳，正抱疏桐叶半黄。  \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e才能显示正确：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e缺月昏昏漏未央，一灯明灭照秋床。\u003cbr\u003e\n病身最觉风露早，归梦不知山水长。\u003cbr\u003e\n坐感岁时歌慷慨，起看天地色凄凉。\u003cbr\u003e\n鸣蝉更乱行人耳，正抱疏桐叶半黄。\u003c/p\u003e\n\u003c/blockquote\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230521-markdown-style/",
      "date_published": "21056-21-09T50:2121:00+00:00",
      "date_modified": "21056-21-09T50:2121:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "9f89cadc42da74176548af07a303d0b7910765ad",
      "title": "Python Style",
      "summary": "",
      "content_text": "If you don\u0026rsquo;t know what it is, I recommend you should just play with it and don\u0026rsquo;t care about the style.\nBut I\u0026rsquo;d like to say Anaconda is a better choice than just Python itself. You can manage different packages in different environments with Anaconda.\nThis article is about what I find interesting in PEP 8 – Style Guide for Python Code1, PEP 257 – Docstring Conventions, Style guide — numpydoc v1.6.0rc1.dev0 Manual and SPT3G. This is not a guide, I recommend Google Style Guides2 as the guide.\n§1 General Readability counts. — PEP 20\nAlways break your code apart by defining functions, classes, or create a new .py file and from myproject.backend.hgwells import time_machine. Don\u0026rsquo;t write code like a long staircase of indentation, that would drive people crazy. Comments are of equal importance as code. It\u0026rsquo;s for your own good, because you can\u0026rsquo;t remember everything. §2 This and That If your project has a style guide already, always follow that rather than this one.\n§2.1 Naming Naming is a big deal, the biggest probably. And I generally follow these rules from SPT3G.\nFunction, Variable: lower_with_under Class: CapWords Constant: CAPS_WITH_UNDER, and use scipy.constants. Non-public class methods and instance variables should begin with a single underscore (this is baked into the way python implements classes). See this table for the full naming convention.\n§2.2 Four Spaces for Indentation Also according to SPT3G:\nCONSTANT_VALUE = 10 def function_name(variable_name, other): do_some_things class MyClass: CONSTANCE_INSTANCE_VARIABLE = 100 def __init__(self, input, other_input): self.instance_variable = input + other_input def class_method(self, input): do_things §2.3 Comments and Doc Strings You should assume the person who is reading the comments are more familiar with python than you, they just don\u0026rsquo;t understand what your code is doing:\n# wrong: x = x + 1 # Increment x # correct: x = x + 1 # Compensate for border Also according to SPT3G, for classes, modules and functions, write doc strings:\ndef get_fft_scale_fac(res=None, n1=None, n2=None, apod_mask=None, parent=None): \u0026#34;\u0026#34;\u0026#34; Returns a scale factor to convert a 2d fft of a map into sqrt(C_l) normalized units by scaling it by the sky area. In particular it returns: np.mean(apod_mask**2)**0.5 * (n1 * n2)**0.5 / reso_rad For forward transforms: fft2(mp) / scale_fac For inverse transforms: ifft2(mp) * scale_fac Arguments --------- res : float, default=None Resolution of the map in G3Units. Must be specified if parent is None. n1 : int, default=None Number of map pixels in x direction. Must be specified if parent is None. n2 : int, default=None Number of map pixels in y direction. Must be specified if parent is None. apod_mask : FlatSkyMap or ndarray, default=None An apodization mask. parent : FlatSkyMap, default=None Parent Map object containing resolution and shape info. Must be specified if res, n1, and n2 are None. Returns ------- float FFT normalization factor See Also ------- ft_to_map \u0026#34;\u0026#34;\u0026#34; By the way, ' and \u0026quot; are the same thing in code.\n§2.4 Maximum Line Length is 80 Characters If you need to wrap multiple lines, you should wrap them on the same level of syntax structure:\nbridgekeeper.answer( name=\u0026#34;Arthur\u0026#34;, quest=questlib.find(owner=\u0026#34;Arthur\u0026#34;, perilous=True)) answer = (a_long_line().of_chained_methods() .that_eventually_provides().an_answer()) if ( config is None or \u0026#39;editor.language\u0026#39; not in config or config[\u0026#39;editor.language\u0026#39;].use_spaces is False ): use_tabs() And follow the tradition from mathematics:\nincome = (gross_wages + taxable_interest + (dividends - qualified_dividends) - ira_deduction - student_loan_interest) §2.5 Import Order Python future import statements. Python standard library imports. Third-party module or package imports. Code repository sub-package. Absolute imports are recommended. For example:\nfrom __future__ import annotations import os import sys import numpy as np import tensorflow as tf from scipy import constants from myproject.backend.hgwells import time_machine 我和 ChatGPT 合著的中文版见 PEP-8-ZH.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n中文版见 Google 开源项目风格指南.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003eIf you don\u0026rsquo;t know what it is, I recommend you should just play with it and don\u0026rsquo;t care about the style.\u003c/p\u003e\n\u003cp\u003eBut I\u0026rsquo;d like to say \u003ca href=\"https://www.anaconda.com/\"\u003eAnaconda\u003c/a\u003e is a better choice than just \u003ca href=\"https://www.python.org/\"\u003ePython\u003c/a\u003e itself. You can manage different packages in different environments with Anaconda.\u003c/p\u003e\n\u003cp\u003eThis article is about what I find interesting in \u003ca href=\"https://peps.python.org/pep-0008/\"\u003e\u003cem\u003ePEP 8 – Style Guide for Python Code\u003c/em\u003e\u003c/a\u003e\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e, \u003ca href=\"https://peps.python.org/pep-0257/\"\u003e\u003cem\u003ePEP 257 – Docstring Conventions\u003c/em\u003e\u003c/a\u003e, \u003ca href=\"https://numpydoc.readthedocs.io/en/latest/format.html\"\u003e\u003cem\u003eStyle guide — numpydoc v1.6.0rc1.dev0 Manual\u003c/em\u003e\u003c/a\u003e and \u003ca href=\"https://github.com/CMB-S4/spt3g_software/blob/master/doc/styleguide.rst\"\u003eSPT3G\u003c/a\u003e. This is not a guide, I recommend \u003ca href=\"https://google.github.io/styleguide/\"\u003e\u003cem\u003eGoogle Style Guides\u003c/em\u003e\u003c/a\u003e\u003csup id=\"fnref:2\"\u003e\u003ca href=\"#fn:2\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e2\u003c/a\u003e\u003c/sup\u003e as the guide.\u003c/p\u003e\n\u003ch2 id=\"1-general\"\u003e§1 General\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eReadability counts. — \u003ca href=\"https://peps.python.org/pep-0020\" title=\"PEP 20 – The Zen of Python\"\u003ePEP 20\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003eAlways break your code apart by defining functions, classes, or create a new .py file and \u003ccode\u003efrom myproject.backend.hgwells import time_machine\u003c/code\u003e. Don\u0026rsquo;t write code like a long staircase of indentation, that would drive people crazy.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://irs.www.warnerbros.com/gallery-v2-jpeg/movies/node/91131/edit/joker_joaquin_phoenix_03.jpg\"\r\n  alt=\"Joker2019\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eComments are of equal importance as code. It\u0026rsquo;s for your own good, because you can\u0026rsquo;t remember everything.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"2-this-and-that\"\u003e§2 This and That\u003c/h2\u003e\n\u003cp\u003eIf your project has a style guide already, always follow that rather than this one.\u003c/p\u003e\n\u003ch3 id=\"21-naming\"\u003e§2.1 Naming\u003c/h3\u003e\n\u003cp\u003eNaming is a big deal, the biggest probably. And I generally follow these rules from SPT3G.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eFunction, Variable: \u003ccode\u003elower_with_under\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eClass: \u003ccode\u003eCapWords\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eConstant: \u003ccode\u003eCAPS_WITH_UNDER\u003c/code\u003e, and use \u003ca href=\"https://docs.scipy.org/doc/scipy/reference/constants.html\"\u003e\u003ccode\u003escipy.constants\u003c/code\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eNon-public class methods and instance variables should begin with a single underscore (this is baked into the way python implements classes).\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSee \u003ca href=\"https://google.github.io/styleguide/pyguide.html#3164-guidelines-derived-from-guidos-recommendations\"\u003ethis table\u003c/a\u003e for the full naming convention.\u003c/p\u003e\n\u003ch3 id=\"22-four-spaces-for-indentation\"\u003e§2.2 Four Spaces for Indentation\u003c/h3\u003e\n\u003cp\u003eAlso according to SPT3G:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eCONSTANT_VALUE\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003efunction_name\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003evariable_name\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eother\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003edo_some_things\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eMyClass\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003eCONSTANCE_INSTANCE_VARIABLE\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__init__\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eother_input\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003einstance_variable\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eother_input\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eclass_method\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003edo_things\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"23-comments-and-doc-strings\"\u003e§2.3 Comments and Doc Strings\u003c/h3\u003e\n\u003cp\u003eYou should assume the person who is reading the comments are more familiar with python than you, they just don\u0026rsquo;t understand what your code is doing:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# wrong:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e                 \u003cspan style=\"color:#75715e\"\u003e# Increment x\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# correct:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e                 \u003cspan style=\"color:#75715e\"\u003e# Compensate for border\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAlso according to SPT3G, for classes, modules and functions, write doc strings:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eget_fft_scale_fac\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eres\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003en1\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003en2\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                      \u003cspan style=\"color:#111\"\u003eapod_mask\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eparent\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#d88200\"\u003e\u0026#34;\u0026#34;\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    Returns a scale factor to convert a 2d fft of a map into\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    sqrt(C_l) normalized units by scaling it by the sky area.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    In particular it returns:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e      np.mean(apod_mask**2)**0.5 * (n1 * n2)**0.5 / reso_rad\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    For forward transforms: fft2(mp)  / scale_fac\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    For inverse transforms: ifft2(mp) * scale_fac\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    Arguments\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    ---------\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    res : float, default=None\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e        Resolution of the map in G3Units.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e        Must be specified if parent is None.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    n1 : int, default=None\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e        Number of map pixels in x direction.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e        Must be specified if parent is None.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    n2 : int, default=None\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e        Number of map pixels in y direction.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e        Must be specified if parent is None.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    apod_mask : FlatSkyMap or ndarray, default=None\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e        An apodization mask.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    parent : FlatSkyMap, default=None\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e        Parent Map object containing resolution and shape info.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e        Must be specified if res, n1, and n2 are None.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    Returns\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    -------\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    float\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e        FFT normalization factor\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    See Also\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    -------\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    ft_to_map\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#d88200\"\u003e    \u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eBy the way, \u003ccode\u003e'\u003c/code\u003e and \u003ccode\u003e\u0026quot;\u003c/code\u003e are the same thing in code.\u003c/p\u003e\n\u003ch3 id=\"24-maximum-line-length-is80-characters\"\u003e§2.4 Maximum Line Length is 80 Characters\u003c/h3\u003e\n\u003cp\u003eIf you need to wrap multiple lines, you should wrap them on the same level of syntax structure:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ebridgekeeper\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eanswer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#111\"\u003ename\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Arthur\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003equest\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#111\"\u003equestlib\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003efind\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eowner\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;Arthur\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eperilous\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#00a8c8\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#111\"\u003eanswer\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ea_long_line\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eof_chained_methods\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e           \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ethat_eventually_provides\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ean_answer\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#111\"\u003econfig\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eis\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eNone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;editor.language\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003econfig\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003econfig\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;editor.language\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003euse_spaces\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eis\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eFalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#111\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   \u003cspan style=\"color:#111\"\u003euse_tabs\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd follow the tradition from mathematics:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eincome\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egross_wages\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etaxable_interest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edividends\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#111\"\u003equalified_dividends\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eira_deduction\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#111\"\u003estudent_loan_interest\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"25-import-order\"\u003e§2.5 Import Order\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003ePython future import statements.\u003c/li\u003e\n\u003cli\u003ePython standard library imports.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://pypi.org/\"\u003eThird-party\u003c/a\u003e module or package imports.\u003c/li\u003e\n\u003cli\u003eCode repository sub-package. Absolute imports are recommended.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eFor example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e__future__\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eannotations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eos\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esys\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enumpy\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etensorflow\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etf\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003escipy\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003econstants\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#111\"\u003emyproject.backend.hgwells\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003etime_machine\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003e我和 ChatGPT 合著的中文版见 \u003ca href=\"https://github.com/chenlinear/PEP-8-ZH\"\u003ePEP-8-ZH\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn:2\"\u003e\n\u003cp\u003e中文版见 \u003ca href=\"https://zh-google-styleguide.readthedocs.io/en/latest/\"\u003e\u003cem\u003eGoogle 开源项目风格指南\u003c/em\u003e\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:2\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230521-python-style/",
      "date_published": "21056-21-09T50:2121:00+00:00",
      "date_modified": "21056-21-09T50:2121:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "413e183324ba0a73144268716715771d48e31705",
      "title": "New Repository: PEP-8-ZH",
      "summary": "",
      "content_text": "I created a repository called PEP-8-ZH. Basically, I translated PEP 8 with the help of ChatGPT, and with a little modification myself. The prompt that I use is:\n将下文翻译为中文 And I did not translate the comments, because you should try to write comments in English.\nIf you want to learn about Python style, I recommend Google Style Guides (中文版见 Google 开源项目风格指南) as the guide. Which is more up to date. I\u0026rsquo;ll write about Python style soon.\n",
      "content_html": "\u003cp\u003eI created a repository called \u003ca href=\"https://github.com/chenlinear/PEP-8-ZH\"\u003ePEP-8-ZH\u003c/a\u003e. Basically, I translated \u003ca href=\"https://peps.python.org/pep-0008/\"\u003e\u003cem\u003ePEP 8\u003c/em\u003e\u003c/a\u003e with the help of ChatGPT, and with a little modification myself. The prompt that I use is:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e将下文翻译为中文\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd I did not translate the comments, because you should try to write comments in English.\u003c/p\u003e\n\u003cp\u003eIf you want to learn about Python style, I recommend \u003ca href=\"https://google.github.io/styleguide/\"\u003e\u003cem\u003eGoogle Style Guides\u003c/em\u003e\u003c/a\u003e (中文版见 \u003ca href=\"https://zh-google-styleguide.readthedocs.io/en/latest/\"\u003e\u003cem\u003eGoogle 开源项目风格指南\u003c/em\u003e\u003c/a\u003e) as the guide. Which is more up to date. I\u0026rsquo;ll write about Python style soon.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230520-new-repository-pep-8-zh/",
      "date_published": "20056-20-09T50:2020:00+00:00",
      "date_modified": "20056-20-09T50:2020:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "a18d7696c35d8aa457a30a3a47f11765d386d2bc",
      "title": "LIGO O4: multi-messenger",
      "summary": "",
      "content_text": "LIGO is back on track with Observing Run 4 (O4)1. And I got this idea:\nActive Galactic Nucleus (AGN) is considered as a Gravitational Wave (GW) candidate that can be detected by LIGO-Virgo-Kagra2. And IceCube recently proposed a method to combine neutrino detection with radio detection in the observation of AGN3. So maybe these three messengers (GW, neutrino, radio) can work together to observe AGN. And maybe we should write a program that can synchronize these observations.\nIt\u0026rsquo;s exciting that we can make use of basically all the messengers that we know of. Except cosmic rays, but galactic cosmic rays mostly can\u0026rsquo;t reach earth anyway (because of their charge). However, their are few things we should consider:\nWe don\u0026rsquo;t observe many GWs4, so we can just do it by hand. A radio telescope can turn around, so it\u0026rsquo;s kind of urgent to focus on the target. But based on the way IceCube works, there\u0026rsquo;s no rush. IceCube, the basic part of which is a $1 \\space \\mathrm{km}^3$ ice cube, can\u0026rsquo;t turn around. LIGO can\u0026rsquo;t turn around either. See their news website or Gravitational wave detectors prepare for next observing run.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nSee Optical Emission Model for Binary Black Hole Merger Remnants Travelling through Discs of Active Galactic Nucleus. I later found out Virgo is delayed, see Virgo postpones entry into O4 observing run.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nSee Search for correlations of high-energy neutrinos detected in IceCube with radio-bright AGN and gamma-ray emission from blazars.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nSee Detection of gravitational waves.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003eLIGO is back on track with Observing Run 4 (O4)\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e. And I got this idea:\u003c/p\u003e\n\u003cp\u003eActive Galactic Nucleus (AGN) is considered as a Gravitational Wave (GW) candidate that can be detected by LIGO-Virgo-Kagra\u003csup id=\"fnref:2\"\u003e\u003ca href=\"#fn:2\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e2\u003c/a\u003e\u003c/sup\u003e. And IceCube recently proposed a method to combine neutrino detection with radio detection in the observation of AGN\u003csup id=\"fnref:3\"\u003e\u003ca href=\"#fn:3\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e3\u003c/a\u003e\u003c/sup\u003e. So maybe these three messengers (GW, neutrino, radio) can work together to observe AGN. And maybe we should write a program that can synchronize these observations.\u003c/p\u003e\n\u003cp\u003eIt\u0026rsquo;s exciting that we can make use of basically all the messengers that we know of. Except cosmic rays, but galactic cosmic rays mostly can\u0026rsquo;t reach earth anyway (because of their charge). However, their are few things we should consider:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eWe don\u0026rsquo;t observe many GWs\u003csup id=\"fnref:4\"\u003e\u003ca href=\"#fn:4\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e4\u003c/a\u003e\u003c/sup\u003e, so we can just do it by hand.\u003c/li\u003e\n\u003cli\u003eA radio telescope can turn around, so it\u0026rsquo;s kind of urgent to focus on the target. But based on the way IceCube works, there\u0026rsquo;s no rush. IceCube, the basic part of which is a $1 \\space \\mathrm{km}^3$ ice cube, can\u0026rsquo;t turn around. LIGO can\u0026rsquo;t turn around either.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eSee \u003ca href=\"https://www.ligo.org/news/index.php#ER15\"\u003etheir news website\u003c/a\u003e or \u003ca href=\"https://www.ligo.org/news/images/ER15-newsitem.pdf\"\u003e\u003cem\u003eGravitational wave detectors prepare for next observing run\u003c/em\u003e\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn:2\"\u003e\n\u003cp\u003eSee \u003ca href=\"https://arxiv.org/abs/2304.10567\"\u003e\u003cem\u003eOptical Emission Model for Binary Black Hole Merger Remnants Travelling through Discs of Active Galactic Nucleus\u003c/em\u003e\u003c/a\u003e. I later found out Virgo is delayed, see \u003ca href=\"https://www.virgo-gw.eu/news/virgo-postpones-entry-into-o4-observing-run/\"\u003e\u003cem\u003eVirgo postpones entry into O4 observing run\u003c/em\u003e\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:2\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn:3\"\u003e\n\u003cp\u003eSee \u003ca href=\"https://arxiv.org/abs/2304.12675\"\u003e\u003cem\u003eSearch for correlations of high-energy neutrinos detected in IceCube with radio-bright AGN and gamma-ray emission from blazars\u003c/em\u003e\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:3\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn:4\"\u003e\n\u003cp\u003eSee \u003ca href=\"https://www.ligo.org/detections.php\"\u003eDetection of gravitational waves\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:4\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230514-ligo-o4-multi-messenger/",
      "date_published": "14056-14-09T50:1414:00+00:00",
      "date_modified": "14056-14-09T50:1414:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "ac09c65ad77e0bddbc2f4ae675efba149d8e4171",
      "title": "Book Review: Love and Math: The Heart of Hidden Reality",
      "summary": "",
      "content_text": "This is a review of Love and Math: The Heart of Hidden Reality by Edward Frenkel.\nThis book is about love, or Langlands program1, or the generality of group theory, or beauty. Most of the content feels like text book to me, such as Discrete Groups, Group Representation, etc.\nUnlike physics, it\u0026rsquo;s much harder to write math popularization. I can quickly get what he is talking about because I\u0026rsquo;m learning Group Theory this semester. Without the theorems and equations I learned, I would have a much more vague idea of the content in the book. But anyway, the purpose of popularization is always get the reader to learn the real thing. I just did the latter one first.\nMath is beautiful and touching even, but physics is not, physics is messy and realistic. I mean, I\u0026rsquo;m still interested in and constantly amazed by all kinds of connections, even tiny and trivial ones, see δ. But connections are lack in real world, because people play different games in different aspects of life, see Book review: Ludwig Wittgenstein: The Duty of Genius. We have talked about Quantum Gravity for a really long time, yet here we are.\nThe story in chapter 2 is heartbroken. I\u0026rsquo;m sorry that it happened to him or anybody. His experience reminds of this quote:\nYou are the captain of your own ship. You have the power at any moment to CHOOSE. Make sure you\u0026rsquo;re choosing from a place of your vision and not in reaction to the circumstances that present themselves.\nAnd when you did choose, work harder.\nThis is a review article: [2307.02571] The work of Robert Langlands.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003eThis is a review of \u003ca href=\"https://www.amazon.com/Love-Math-Heart-Hidden-Reality/dp/0465050743\"\u003e\u003cem\u003eLove and Math: The Heart of Hidden Reality\u003c/em\u003e\u003c/a\u003e by \u003ca href=\"https://www.edwardfrenkel.com/\"\u003eEdward Frenkel\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThis book is about love, or \u003ca href=\"https://en.wikipedia.org/wiki/Langlands_program\"\u003eLanglands program\u003c/a\u003e\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e, or the generality of group theory, or \u003ca href=\"https://chenlinear.github.io/posts/20230304-book-review-lost-in-math/\"\u003ebeauty\u003c/a\u003e. Most of the content feels like text book to me, such as Discrete Groups, Group Representation, etc.\u003c/p\u003e\n\u003cp\u003eUnlike physics, it\u0026rsquo;s much harder to write math popularization. I can quickly get what he is talking about because I\u0026rsquo;m learning Group Theory this semester. Without the theorems and equations I learned, I would have a much more vague idea of the content in the book. But anyway, the purpose of popularization is always get the reader to learn the real thing. I just did the latter one first.\u003c/p\u003e\n\u003cp\u003eMath is beautiful and touching even, but physics is not, physics is messy and realistic. I mean, I\u0026rsquo;m still interested in and constantly amazed by all kinds of connections, even tiny and trivial ones, see \u003ca href=\"https://chenlinear.github.io/posts/20230314-delta-function/\"\u003e\u003cem\u003eδ\u003c/em\u003e\u003c/a\u003e. But connections are lack in real world, because people play different games in different aspects of life, see \u003ca href=\"https://chenlinear.github.io/posts/20230312-book-review-ludwig-wittgenstein-the-duty-of-genius/\"\u003e\u003cem\u003eBook review: Ludwig Wittgenstein: The Duty of Genius\u003c/em\u003e\u003c/a\u003e. We have talked about Quantum Gravity for a really long time, yet here we are.\u003c/p\u003e\n\u003cp\u003eThe story in chapter 2 is heartbroken. I\u0026rsquo;m sorry that it happened to him or anybody. His experience reminds of this quote:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eYou are the captain of your own ship. You have the power at any moment to CHOOSE. Make sure you\u0026rsquo;re choosing from a place of your vision and not in reaction to the circumstances that present themselves.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eAnd when you did choose, work harder.\u003c/p\u003e\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eThis is a review article: \u003ca href=\"https://arxiv.org/abs/2307.02571\"\u003e[2307.02571] \u003cem\u003eThe work of Robert Langlands\u003c/em\u003e\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230501-book-review-love-and-math-the-heart-of-hidden-reality/",
      "date_published": "1056-01-09T50:11:00+00:00",
      "date_modified": "1056-01-09T50:11:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "716495ca5b8f74a5cf6b5b04043682c0a9b1811b",
      "title": "List of a Folder",
      "summary": "",
      "content_text": "§1 path In Windows, to get the list of all the files in a folder:\nCreate a .txt file.\nOpen it with notepad. Copy and paste the following commands:\n@echo off dir %1 /s/b \u0026gt; %~n1.txt Or, if you don\u0026rsquo;t want the list of what\u0026rsquo;s in the subdirectory:\n@echo off dir %1 /b \u0026gt; %~n1.txt Rename it getList.bat (\u0026ldquo;getList\u0026rdquo; could be anything.)\nDrag the target folder to this .bat file.\n§2 path \u0026amp; size Only the code in step 2. is different:\n@echo off ( for /r %1 %%i in (*) do @echo %%~fi ^(%%~zi bytes^)) \u0026gt; %~n1.txt And, to convert bytes to GB, use this python code:\nimport re # open original.txt, create new.txt with open(\u0026#39;original.txt\u0026#39;, \u0026#39;r\u0026#39;) as f1, open(\u0026#39;new.txt\u0026#39;, \u0026#39;w\u0026#39;) as f2: for line in f1: # use regular expressions to match file size information match = re.search(r\u0026#39;(\\d+)\\sbytes\u0026#39;, line) if match: # get the file size information size_bytes = int(match.group(1)) # convert bit to GB size_gb = size_bytes / 1024**3 # write to new.txt new_line = re.sub(r\u0026#39;(\\d+)\\sbytes\u0026#39;, f\u0026#39;{size_gb:.2f} GB\u0026#39;, line) f2.write(new_line) else: # if file size information is not matched, write the original line f2.write(line) ",
      "content_html": "\u003ch2 id=\"1-path\"\u003e§1 path\u003c/h2\u003e\n\u003cp\u003eIn Windows, to get the list of all the files in a folder:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eCreate a .txt file.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eOpen it with notepad. Copy and paste the following commands:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e@echo off\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edir %1 /s/b \u0026gt; %~n1.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eOr, if you don\u0026rsquo;t want the list of what\u0026rsquo;s in the subdirectory:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e@echo off\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edir %1 /b \u0026gt; %~n1.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRename it getList.bat (\u0026ldquo;getList\u0026rdquo; could be anything.)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDrag the target folder to this .bat file.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"2-path--size\"\u003e§2 path \u0026amp; size\u003c/h2\u003e\n\u003cp\u003eOnly the code in step 2. is different:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e@echo off\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e /r %1 %%i in \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e*\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003edo\u003c/span\u003e @echo %%~fi ^\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e%%~zi bytes^\u003cspan style=\"color:#f92672\"\u003e))\u003c/span\u003e \u0026gt; %~n1.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd, to convert bytes to GB, use this python code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ere\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# open original.txt, create new.txt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#00a8c8\"\u003ewith\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eopen\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;original.txt\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;r\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ef1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eopen\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;new.txt\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;w\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ef2\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#00a8c8\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eline\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ef1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# use regular expressions to match file size information\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003ematch\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ere\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esearch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003er\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;(\\d+)\\sbytes\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eline\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ematch\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# get the file size information\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003esize_bytes\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ematch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003egroup\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# convert bit to GB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003esize_gb\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003esize_bytes\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# write to new.txt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003enew_line\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#111\"\u003ere\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esub\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003er\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;(\\d+)\\sbytes\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#111\"\u003esize_gb\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e.2f\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e GB\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003eline\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ef2\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ewrite\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enew_line\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#00a8c8\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# if file size information is not matched, write the original line\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003ef2\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003ewrite\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eline\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e",
      "url": "https://chenlinear.github.io/posts/20230423-list-of-a-folder/",
      "date_published": "23046-23-09T40:2323:00+00:00",
      "date_modified": "23046-23-09T40:2323:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "86e7c5e616419e973a91c2d045fb63795f9a4844",
      "title": "New Repository: DrSlidelove",
      "summary": "",
      "content_text": "Update 20230617: I\u0026rsquo;m so sorry that there\u0026rsquo;s already a Slidy. When I used that name for this repository, there\u0026rsquo;s no such a repository named Slidy and I thought it would be ok. To avoid any confusion, the name is changed from Slidy to DrSlidelove. Again, my apologies.\nI just created a new repository for slide, which is called Slidy. Well, technically I didn\u0026rsquo;t create it, I just moved stuff around.\nI use it for several reasons:\nMicrosoft PPT is just painful to use. And Marp is too much for me to handle. Even though I use Obsidian most often, I have to say that its slide function is not so convenient, I want to change to other windows when giving a presentation. I want it to be offline, because I don\u0026rsquo;t have access to the internet all the time. And I solved it by adding the KaTeX package in it and adding few commands in the Slidy.html file: \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;./layouts/katex/katex.min.css\u0026#34;\u0026gt; \u0026lt;script defer src=\u0026#34;./layouts/katex/katex.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script defer src=\u0026#34;./layouts/katex/contrib/auto-render.min.js\u0026#34; onload=\u0026#34;renderMathInElement(document.body);\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; document.addEventListener(\u0026#34;DOMContentLoaded\u0026#34;, function() { renderMathInElement(document.body, { delimiters: [ {left: \u0026#34;$$\u0026#34;, right: \u0026#34;$$\u0026#34;, display: true}, {left: \u0026#34;$\u0026#34;, right: \u0026#34;$\u0026#34;, display: false} ] }); }); \u0026lt;/script\u0026gt; ",
      "content_html": "\u003cp\u003eUpdate 20230617: I\u0026rsquo;m so sorry that there\u0026rsquo;s already a \u003ca href=\"https://www.w3.org/Talks/Tools/Slidy2/\"\u003eSlidy\u003c/a\u003e. When I used that name for this repository, there\u0026rsquo;s no such a repository named Slidy and I thought it would be ok. To avoid any confusion, the name is changed from Slidy to \u003ca href=\"https://github.com/chenlinear/DrSlidelove\"\u003eDrSlidelove\u003c/a\u003e. Again, my apologies.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eI just created a new repository for slide, which is called Slidy. Well, technically I didn\u0026rsquo;t create it, I just moved stuff around.\u003c/p\u003e\n\u003cp\u003eI use it for several reasons:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eMicrosoft PPT is just painful to use. And \u003ca href=\"https://marp.app/\"\u003eMarp\u003c/a\u003e is too much for me to handle.\u003c/li\u003e\n\u003cli\u003eEven though I use \u003ca href=\"https://obsidian.md/\"\u003eObsidian\u003c/a\u003e most often, I have to say that its slide function is not so convenient, I want to change to other windows when giving a presentation.\u003c/li\u003e\n\u003cli\u003eI want it to be offline, because I don\u0026rsquo;t have access to the internet all the time. And I solved it by adding the KaTeX package in it and adding few commands in the Slidy.html file:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003elink\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003erel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;stylesheet\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003ehref\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;./layouts/katex/katex.min.css\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003escript\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003esrc\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;./layouts/katex/katex.min.js\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003escript\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003escript\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003esrc\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;./layouts/katex/contrib/auto-render.min.js\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eonload\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;renderMathInElement(document.body);\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003escript\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003escript\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003edocument\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#75af00\"\u003eaddEventListener\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#d88200\"\u003e\u0026#34;DOMContentLoaded\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efunction\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e()\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75af00\"\u003erenderMathInElement\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#111\"\u003edocument\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#75af00\"\u003ebody\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#75af00\"\u003edelimiters\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    \u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#75af00\"\u003eleft\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;$$\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eright\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;$$\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003edisplay\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003etrue\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    \u003cspan style=\"color:#111\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#75af00\"\u003eleft\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;$\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003eright\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#34;$\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e,\u003c/span\u003e \u003cspan style=\"color:#75af00\"\u003edisplay\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#00a8c8\"\u003efalse\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#111\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#111\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#111\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#111\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003escript\u003c/span\u003e\u003cspan style=\"color:#111\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e",
      "url": "https://chenlinear.github.io/posts/20230423-new-repository-slidy/",
      "date_published": "23046-23-09T40:2323:00+00:00",
      "date_modified": "23046-23-09T40:2323:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "99cf9b1571d9ebfce821fd9bbc7b8d5ab68879aa",
      "title": "Starship",
      "summary": "",
      "content_text": "Well, I\u0026rsquo;m not in defense of Elon, and I\u0026rsquo;m well aware he\u0026rsquo;s getting more weird. But the truth is, the mission did not \u0026ldquo;fail\u0026rdquo;. It\u0026rsquo;s kind of like this rocket is meant to explode. Usually, there are several steps for this trip. This time, few engines were out, thus the first and second stages failed to separate. This is only the second or third step in the entire trip. The data collected in this mission, especially when we make the rocket intentionally took those few tumbles, will be used for future tests.\nThe biggest advantage of Starship is its cheapness, one of the reasons is that it\u0026rsquo;s made of several pieces of stainless steel. I know, crazy. If promising, it will only cost 100k dollars for one person. Compared to the 60s when we went to the moon for the first time, this is much cheaper and could be affordable to companies and even individuals.\nSo, do I want to go to the moon or Mars?\nYes! However, my interest is just not planetary astronomy, and there\u0026rsquo;s no observatory on the moon or Mars. (Not yet anyway.) So maybe I\u0026rsquo;ll do it later, and I hope it works by that time. By the way, all the meteorites we\u0026rsquo;re gonna deal with? It\u0026rsquo;s gonna be WWI out there. And with the cosmic rays, Star Wars.\n",
      "content_html": "\u003cp\u003eWell, I\u0026rsquo;m not in defense of Elon, and I\u0026rsquo;m well aware he\u0026rsquo;s getting more weird. But the truth is, the mission did not \u0026ldquo;fail\u0026rdquo;. It\u0026rsquo;s kind of like this rocket is meant to explode. Usually, there are \u003ca href=\"https://www.csmonitor.com/Science/2012/0516/SpaceX-launch-A-step-by-step-guide\"\u003eseveral steps for this trip\u003c/a\u003e. This time, few engines were out, thus the first and second stages failed to separate. This is only the second or third step in the entire trip. The data collected in this mission, especially when we make the rocket intentionally took those few tumbles, will be used for future tests.\u003c/p\u003e\n\u003cp\u003eThe biggest advantage of Starship is its cheapness, one of the reasons is that it\u0026rsquo;s made of several pieces of stainless steel. I know, crazy. If promising, it will only cost 100k dollars for one person. Compared to the 60s when we went to the moon for the first time, this is much cheaper and could be affordable to companies and even individuals.\u003c/p\u003e\n\u003cp\u003eSo, do I want to go to the moon or Mars?\u003c/p\u003e\n\u003cp\u003eYes! However, my interest is just not planetary astronomy, and there\u0026rsquo;s no observatory on the moon or Mars. (Not yet anyway.) So maybe I\u0026rsquo;ll do it later, and I hope it works by that time. By the way, all the meteorites we\u0026rsquo;re gonna deal with? It\u0026rsquo;s gonna be WWI out there. And with the cosmic rays, \u003cem\u003eStar Wars\u003c/em\u003e.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230420-starship/",
      "date_published": "20046-20-09T40:2020:00+00:00",
      "date_modified": "20046-20-09T40:2020:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "5ef351a95f13bd69393721040a685c5a07544fb9",
      "title": "Book Review: Boojums All the Way Through: Communicating Science in a Prosaic Age",
      "summary": "",
      "content_text": "This is a review of Boojums All the Way Through: Communicating Science in a Prosaic Age by N. David Mermin. His most famous quote is \u0026ldquo;Shut up and calculate!\u0026rdquo; for anyone who is confused about Quantum Mechanics, which the same attitude I have when I\u0026rsquo;m trying different neural networks.\nI find it funny that the 2nd article Commencement address feels like a personal attack to my How much energy does it take to hurt your feelings? article. In the article, he claimed that \u0026ldquo;10 million dollars can pile up half way to the moon\u0026rdquo; is a terrible way to visualize something or make a comparison. Sorry again for anyone who is bothered by how I use the conservation of energy.\nThe situation described in the 6th article What\u0026rsquo;s wrong with this library? is a mixed bag. On one hand, things have gotten worse as there are now even more articles to sift through. However, on the other hand, we no longer need to subscribe to gain access. Instead, we can simply subscribe online or make use of arXiv.\nAnd I really appreciate this joke in this article:\nAn extrapolation of its present rate of growth reveals that in the not too distant future Physical Review will fill bookshelves at a speed exceeding that of light. This is not forbidden by relativity, since no information is being conveyed.\nSome of the rest of the articles, which are about Quantum Mechanics, Special Relativity and Mathematical Musings, are familiar with me, because I\u0026rsquo;ve already learned about them on my previous courses. You can expect the surprise I have when I see the Stirling\u0026rsquo;s approximation.\nAn important reminder about Special Relativity is that, people don\u0026rsquo;t use rest mass and relativistic mass now. There is only one mass, and $$\\begin{aligned} E_0\u0026amp;=mc^2 \\\\ E^2\u0026amp;=(mc^2)^2+(pc)^2 \\end{aligned}$$. See the concept of mass.\nAnd what is interesting to me is that people use English differently, even just about 30 years ago, even in physics. All the new words merged into a GRE test to me. The equations are the same though.\n",
      "content_html": "\u003cp\u003eThis is a review of \u003ca href=\"http://www.cambridge.org/catalogue/catalogue.asp?isbn=0521388805\"\u003e\u003cem\u003eBoojums All the Way Through: Communicating Science in a Prosaic Age\u003c/em\u003e\u003c/a\u003e by \u003ca href=\"https://mermin.lassp.cornell.edu/\"\u003eN. David Mermin\u003c/a\u003e. His most famous quote is \u003ca href=\"https://physicstoday.scitation.org/doi/10.1063/1.1768652\"\u003e\u0026ldquo;Shut up and calculate!\u0026rdquo;\u003c/a\u003e for anyone who is confused about Quantum Mechanics, which the same attitude I have when I\u0026rsquo;m trying different neural networks.\u003c/p\u003e\n\u003cp\u003eI find it funny that the 2nd article \u003cem\u003eCommencement address\u003c/em\u003e feels like a personal attack to my \u003ca href=\"https://chenlinear.github.io/posts/20230314-how-much-energy-does-it-take-to-hurt-your-feelings/\"\u003e\u003cem\u003eHow much energy does it take to hurt your feelings?\u003c/em\u003e\u003c/a\u003e article. In the article, he claimed that \u0026ldquo;10 million dollars can pile up half way to the moon\u0026rdquo; is a terrible way to visualize something or make a comparison. Sorry again for anyone who is bothered by how I use the conservation of energy.\u003c/p\u003e\n\u003cp\u003eThe situation described in the 6th article \u003cem\u003eWhat\u0026rsquo;s wrong with this library?\u003c/em\u003e is a mixed bag. On one hand, things have gotten worse as there are now even more articles to sift through. However, on the other hand, we no longer need to subscribe to gain access. Instead, we can simply subscribe online or make use of \u003ca href=\"https://arxiv.org/\"\u003earXiv\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eAnd I really appreciate this joke in this article:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAn extrapolation of its present rate of growth reveals that in the not too distant future Physical Review will fill bookshelves at a speed exceeding that of light. This is not forbidden by relativity, since no information is being conveyed.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eSome of the rest of the articles, which are about Quantum Mechanics, Special Relativity and Mathematical Musings, are familiar with me, because I\u0026rsquo;ve already learned about them on my previous courses. You can expect the surprise I have when I see the \u003ca href=\"https://en.wikipedia.org/wiki/Stirling%27s_approximation\"\u003eStirling\u0026rsquo;s approximation\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eAn important reminder about Special Relativity is that, people don\u0026rsquo;t use rest mass and relativistic mass now. There is only one mass, and $$\\begin{aligned} E_0\u0026amp;=mc^2 \\\\ E^2\u0026amp;=(mc^2)^2+(pc)^2 \\end{aligned}$$. See \u003ca href=\"https://www.youtube.com/watch?v=6HlCfwEduqA\"\u003e\u003cem\u003ethe concept of mass\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eAnd what is interesting to me is that people use English differently, even just about 30 years ago, even in physics. All the new words merged into a GRE test to me. The equations are the same though.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230416-book-review-boojums-all-the-way-through/",
      "date_published": "16046-16-09T40:1616:00+00:00",
      "date_modified": "16046-16-09T40:1616:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "4ec1da642e9a1db3f01fce8592d74795c63b7924",
      "title": "Book Review: Existential Physics: A Scientist's Guide to Life's Biggest Questions",
      "summary": "",
      "content_text": "This is a review of Existential Physics: A Scientist\u0026rsquo;s Guide to Life\u0026rsquo;s Biggest Questions by Sabine Hossenfelder.\nFirst of all, Jean-Paul Sartre and Existentialism did not show up in the book. Just so you know.\nTo be honest, I\u0026rsquo;m not quite interested in the topics she covered in the book. Well, I mean I am interested but not right away. These problems belong to the \u0026ldquo;important but not hurry\u0026rdquo; problems. What she talked about in the book, pseudoscience, is like what Jostein Gaarder talked about in the final chapters of Sophie\u0026rsquo;s World, which is about pseudo-philosophy. And to be honest, what is really fascinating to me in Lost in Math is the level of detail, and that there\u0026rsquo;s clearly tons of research done. Although I\u0026rsquo;m pretty sure she did tons of research on this one too.\nSo the basic strategy in this book is something like this:\nYou can derive complicated theories from fundamental theory. It\u0026rsquo;s just that the math is too difficult. You may refer to the example where we derive the principle of Thermodynamics and Statistical Mechanics. How the composition interacts with each other is where \u0026ldquo;emergence\u0026rdquo; begins. There\u0026rsquo;s no free will, but I\u0026rsquo;m interested in the outcome of your thinking. She quoted from Ludwig Wittgenstein that \u0026ldquo;The freedom of the will consists in the fact that future actions cannot be known now.\u0026rdquo;1 Which is from Tractatus, an early work of Wittgenstein, which he turned his back on in his later life. Not to say he turned his back on this specific statement. I\u0026rsquo;m surprised she quoted from Wittgenstein, as well as she quoted from Louis C.K. in Lost in Math. Her ideas on these two subjects are consistent, so maybe they\u0026rsquo;re more convincing? After all, I didn\u0026rsquo;t do the thinking and research she\u0026rsquo;s done.\nBut to me, it\u0026rsquo;s an avoidance rather than answer:\nWe still have to think about the theory of complicated things, which is why we have emergence in the first place. We still have to think, which is why we don\u0026rsquo;t want to believe in free will in the first place. An interesting detail I noticed is the rabbit-duck picture, see the picture below. Sabine uses it to explain duel theories, which means that two theories are the same thing. And Wittgenstein use it to explain the idea of \u0026ldquo;seeing\u0026rdquo;, which means seeing the concept as a whole. And in How I Met Your Mother S05E15 Rabbit or Duck, it is used to fight about which one is better (in fur, flavor, etc), rabbit or duck, which is so true and ridiculous at the same time.\nAlso, reading this book feels like my childhood again, maybe writing some equations would be a good idea to get my interest. I\u0026rsquo;m more practical now I guess, which is kind of sad really. But the epilogue is beautiful, I\u0026rsquo;m glad Sabine is doing something she likes. Teaching and educating are a necessary part of the job, no matter how irritating and tiring that could be sometimes.\nFor more information, see Human Action and the Question of Responsibility in Ludwig Wittgenstein.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003eThis is a review of \u003ca href=\"https://www.amazon.com/Existential-Physics-Scientists-Biggest-Questions/dp/1984879456\"\u003e\u003cem\u003eExistential Physics: A Scientist\u0026rsquo;s Guide to Life\u0026rsquo;s Biggest Questions\u003c/em\u003e\u003c/a\u003e by \u003ca href=\"https://sabinehossenfelder.com/\"\u003eSabine Hossenfelder\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eFirst of all, Jean-Paul Sartre and Existentialism did not show up in the book. Just so you know.\u003c/p\u003e\n\u003cp\u003eTo be honest, I\u0026rsquo;m not quite interested in the topics she covered in the book. Well, I mean I am interested but not right away. These problems belong to the \u0026ldquo;important but not hurry\u0026rdquo; problems. What she talked about in the book, pseudoscience, is like what Jostein Gaarder talked about in the final chapters of \u003ca href=\"https://en.wikipedia.org/wiki/Sophie%27s_World\"\u003e\u003cem\u003eSophie\u0026rsquo;s World\u003c/em\u003e\u003c/a\u003e, which is about pseudo-philosophy. And to be honest, what is really fascinating to me in \u003cem\u003eLost in Math\u003c/em\u003e is the level of detail, and that there\u0026rsquo;s clearly tons of research done. Although I\u0026rsquo;m pretty sure she did tons of research on this one too.\u003c/p\u003e\n\u003cp\u003eSo the basic strategy in this book is something like this:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eYou can derive complicated theories from fundamental theory. It\u0026rsquo;s just that the math is too difficult. You may refer to the example where we derive the principle of Thermodynamics and Statistical Mechanics. How the composition interacts with each other is where \u0026ldquo;emergence\u0026rdquo; begins.\u003c/li\u003e\n\u003cli\u003eThere\u0026rsquo;s no free will, but I\u0026rsquo;m interested in the outcome of your thinking. She quoted from Ludwig Wittgenstein that \u0026ldquo;The freedom of the will consists in the fact that future actions cannot be known now.\u0026rdquo;\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e Which is from \u003cem\u003eTractatus\u003c/em\u003e, an early work of Wittgenstein, which he turned his back on in his later life. Not to say he turned his back on this specific statement. I\u0026rsquo;m surprised she quoted from Wittgenstein, as well as she quoted from Louis C.K. in \u003cem\u003eLost in Math\u003c/em\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eHer ideas on these two subjects are consistent, so maybe they\u0026rsquo;re more convincing? After all, I didn\u0026rsquo;t do the thinking and research she\u0026rsquo;s done.\u003c/p\u003e\n\u003cp\u003eBut to me, it\u0026rsquo;s an avoidance rather than answer:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eWe still have to think about the theory of complicated things, which is why we have emergence in the first place.\u003c/li\u003e\n\u003cli\u003eWe still have to think, which is why we don\u0026rsquo;t want to believe in free will in the first place.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eAn interesting detail I noticed is \u003ca href=\"https://en.wikipedia.org/wiki/Rabbit%E2%80%93duck_illusion\"\u003ethe rabbit-duck picture\u003c/a\u003e, see the picture below. Sabine uses it to explain \u003cem\u003eduel\u003c/em\u003e theories, which means that two theories are the same thing. And Wittgenstein use it to explain the idea of \u0026ldquo;seeing\u0026rdquo;, which means seeing the concept as a whole. And in \u003cem\u003eHow I Met Your Mother\u003c/em\u003e S05E15 \u003cem\u003eRabbit or Duck\u003c/em\u003e, it is used to fight about which one is better (in fur, flavor, etc), rabbit or duck, which is so true and ridiculous at the same time.\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://winterparkmag.com/wp-content/uploads/2019/07/duck-rabbit.jpg\"\r\n  alt=\"rabbit-duck-illusion\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eAlso, reading this book feels like my childhood again, maybe writing some equations would be a good idea to get my interest. I\u0026rsquo;m more practical now I guess, which is kind of sad really. But the epilogue is beautiful, I\u0026rsquo;m glad Sabine is doing something she likes. Teaching and educating are a necessary part of the job, no matter how irritating and tiring that could be sometimes.\u003c/p\u003e\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eFor more information, see \u003ca href=\"https://acjol.org/index.php/NJP/article/view/697\"\u003e\u003cem\u003eHuman Action and the Question of Responsibility in Ludwig Wittgenstein\u003c/em\u003e\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230406-book-review-existential-physics-a-scientists-guide-to-lifes-biggest-questions/",
      "date_published": "6046-06-09T40:66:00+00:00",
      "date_modified": "6046-06-09T40:66:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "0eec2cb8511c079fad874a23821c81a477b3f803",
      "title": "Statistics 101",
      "summary": "",
      "content_text": "Before do the math, here\u0026rsquo;s things you should consider to avoid bias:\nThe magnitude of axis. $\\log$? 2 quantities use separate axises? Dramatic? Duration of time. \u0026ldquo;Every Olympic is the best Olympic in the last 3 years.\u0026rdquo; Demography. Age, wealth, gender, race, etc. Does it cover all the target demography? From what media or institution. Different media have different biases themselves. (Although this statement is also a kind of bias.) For a more detailed research, see Machine-Learning media bias. Here\u0026rsquo;s some examples of bad (or maybe good in some sense?) axis:\nAlso, Simpson\u0026rsquo;s paradox is interesting, see 辛普森悖论.\n",
      "content_html": "\u003cp\u003eBefore do the math, here\u0026rsquo;s things you should consider to avoid \u003ca href=\"https://chenlinear.github.io/posts/20230304-book-review-lost-in-math/\"\u003ebias\u003c/a\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe magnitude of axis. $\\log$? 2 quantities use separate axises? Dramatic?\u003c/li\u003e\n\u003cli\u003eDuration of time. \u0026ldquo;Every Olympic is the best Olympic in the last 3 years.\u0026rdquo;\u003c/li\u003e\n\u003cli\u003eDemography. Age, wealth, gender, race, etc. Does it cover all the target demography?\u003c/li\u003e\n\u003cli\u003eFrom what media or institution. Different media have different biases themselves. (Although this statement is also a kind of bias.) For a more detailed research, see \u003ca href=\"https://arxiv.org/abs/2109.00024\"\u003e\u003cem\u003eMachine-Learning media bias\u003c/em\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eHere\u0026rsquo;s some examples of bad (or maybe good in some sense?) axis:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://pbs.twimg.com/media/FO6qE1cXoAEt3e8?format=jpg\u0026amp;name=900x900\"\r\n  alt=\"Oscar2022punches\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://pbs.twimg.com/media/Fs8yKKzWYAAG53w?format=jpg\u0026amp;name=orig\"\r\n  alt=\"Wisconsin\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eAlso, Simpson\u0026rsquo;s paradox is interesting, see \u003ca href=\"https://yufree.cn/cn/2021/08/27/simpson-paradox/\"\u003e\u003cem\u003e辛普森悖论\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230404-statistics-101/",
      "date_published": "4046-04-09T40:44:00+00:00",
      "date_modified": "4046-04-09T40:44:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "fb10ad7834bf86665b5f73ac14df4d46e9858e49",
      "title": "Conda 101",
      "summary": "",
      "content_text": "This article is a quick guidance to use Anaconda \u0026amp; Miniconda on Windows and Linux. I wrote it so that I can check the command myself.\n§1 Anaconda For Windows: Go the the official website Anaconda and download the default exe file. Open and install it.\nGet familiar with Jupyter Notebook. Feel free to check out some other articles and mess around, knowing that you can always delete the old environment and start from scratch, you\u0026rsquo;ll be fine. And that, is the most important message from this article.\n§2 Miniconda For Windows: Go the the official website Miniconda and download the default exe file. Open and install it.\nFor Linux: Use the commands shown in the website to download and install it. A few commands that could useful in a Linux system when conda init \u0026lt;SHELL_NAME\u0026gt;:\nTo see shell type:\necho $SHELL most Linux systems use bash, so in this case conda init \u0026lt;SHELL_NAME\u0026gt; would be:\nconda init bash To close and restart the shell (for bash):\nsource ~/.bashrc §2.1 Commands If you want to install new packages, such as TensorFlow, it\u0026rsquo;s necessary to create a new environment so that these environments don\u0026rsquo;t conflict, the official documents are always useful, and some commonly used commands after you opened the Anaconda Prompt (miniconda3) are:\nSee the environments created:\nconda info -e # or conda info --envs Create a new environment, such as envName (the name can be something you prefer):\nconda create -n envName # remember to change the name! # or conda create --name envName # with python=3.7 conda create -n envName python=3.7 Activate a certain environment, such as envName：\nconda activate envName Deactivate the current environment:\nconda deactivate Delete a certain environment, such as envName:\nconda remove -n envName --all Install packages, such as numpy, matplotlib, torch, torchinfo, jupyterlab:\npip install numpy # or pip install numpy -i https://mirrors.aliyun.com/pypi/simple/ # 临时从镜像阿里云下载 See the packages installed in the envName environment:\nconda activate envName conda list # or pip list Export the list of the packages installed in current environment as a .txt file:\nconda list --export \u0026gt; requirements.txt Export the list of the packages installed in the envName environment as a .yaml file with full environment information:\nconda env export --name envName --file requirements.yaml Clear cache (Remove index cache, lock files, unused cache packages, and tarballs):\nconda clean --all §2.2 Install Jupyter Notebook 7 in Miniconda Jupyter Notebook 7 looks a lot like JupyterLab. After v7.0.0a, v7.0.0b and so on, v7.0.1 is released on 31 July 2023. What I like best about Jupyter Notebook 7 is Table of Content, few buttons on the upper-right of each notebook block, and the Visual Debugger that can run code line by line and show variables.\nWhat\u0026rsquo;s worth mentioning is that installing Jupyter Notebook 7 will install JupyterLab too, so you might as well just install JupyterLab.\nSince the base environment of Miniconda is kind of empty, you can install Jupyter Notebook on a new environment.\nconda create -n jupyter activate jupyter pip install notebook Open Jupyter Notebook:\nactivate jupyter jupyter notebook For Windows: After this, there should be a jupyter-notebook.exe file in .\\miniconda3\\envs\\jupyter\\Scripts folder. Now run\njupyter notebook --generate-config You will see a jupyter_notebook_config.py file in C:\\Users\\yourUserName\\.jupyter folder. Then find this line:\n# c.ServerApp.notebook_dir = \u0026#39;\u0026#39; Change this line into:\nc.ServerApp.notebook_dir = \u0026#39;C:\\Folder\\You\\Like\u0026#39; Next time you can double click jupyter-notebook.exe and it will open Jupyter Notebook in C:\\Folder\\You\\Like folder. Now you can create a start menu shortcut for this .exe file or something. (And there should be a jupyter-lab.exe in the .\\miniconda3\\envs\\jupyter\\Scripts folder, you can open it as well.)\nIf you want to change to other environments such as envName when using Jupyter Notebook:\nconda activate jupyter conda install nb_conda_kernels conda activate envName conda install ipykernel python -m ipykernel install --user --name=envName Delete the envName environment in Jupyter Notebook:\nconda activate jupyter jupyter kernelspec uninstall envName Convert notebook.ipynb to .py:\njupyter nbconvert --to python notebook.ipynb ",
      "content_html": "\u003cp\u003eThis article is a quick guidance to use Anaconda \u0026amp; Miniconda on Windows and Linux. I wrote it so that I can check the command myself.\u003c/p\u003e\n\u003ch2 id=\"1-anaconda\"\u003e§1 Anaconda\u003c/h2\u003e\n\u003cp\u003eFor Windows: Go the the official website \u003ca href=\"https://www.anaconda.com/\"\u003eAnaconda\u003c/a\u003e and download the default exe file. Open and install it.\u003c/p\u003e\n\u003cp\u003eGet familiar with Jupyter Notebook. Feel free to check out some other articles and mess around, knowing that you can always delete the old environment and start from scratch, you\u0026rsquo;ll be fine. And that, is the most important message from this article.\u003c/p\u003e\n\u003ch2 id=\"2-miniconda\"\u003e§2 Miniconda\u003c/h2\u003e\n\u003cp\u003eFor Windows: Go the the official website \u003ca href=\"https://docs.conda.io/en/latest/miniconda.html\"\u003eMiniconda\u003c/a\u003e and download the default exe file. Open and install it.\u003c/p\u003e\n\u003cp\u003eFor Linux: Use the commands shown in the website to download and install it. A few commands that could useful in a Linux system when \u003ccode\u003econda init \u0026lt;SHELL_NAME\u0026gt;\u003c/code\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eTo see shell type:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003eecho\u003c/span\u003e \u003cspan style=\"color:#111\"\u003e$SHELL\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003emost Linux systems use \u003ccode\u003ebash\u003c/code\u003e, so in this case \u003ccode\u003econda init \u0026lt;SHELL_NAME\u0026gt;\u003c/code\u003e would be:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda init bash\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eTo close and restart the shell (for \u003ccode\u003ebash\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003esource\u003c/span\u003e ~/.bashrc\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"21-commands\"\u003e§2.1 Commands\u003c/h3\u003e\n\u003cp\u003eIf you want to install new packages, such as \u003ca href=\"https://docs.anaconda.com/anaconda/user-guide/tasks/tensorflow/\"\u003e\u003ccode\u003eTensorFlow\u003c/code\u003e\u003c/a\u003e, it\u0026rsquo;s necessary to create a new environment so that these environments don\u0026rsquo;t conflict, the official documents are always useful, and some commonly used commands after you opened the Anaconda Prompt (miniconda3) are:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eSee the environments created:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda info -e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda info --envs\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCreate a new environment, such as \u003ccode\u003eenvName\u003c/code\u003e (the name can be something you prefer):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda create -n envName\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# remember to change the name!\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda create --name envName\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# with python=3.7\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda create -n envName \u003cspan style=\"color:#111\"\u003epython\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e3.7\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eActivate a certain environment, such as \u003ccode\u003eenvName\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda activate envName\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDeactivate the current environment:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda deactivate\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDelete a certain environment, such as \u003ccode\u003eenvName\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda remove -n envName --all\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eInstall packages, such as \u003ca href=\"https://github.com/numpy/numpy\"\u003e\u003ccode\u003enumpy\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://github.com/matplotlib/matplotlib\"\u003e\u003ccode\u003ematplotlib\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://pytorch.org/\"\u003e\u003ccode\u003etorch\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://github.com/TylerYep/torchinfo\"\u003e\u003ccode\u003etorchinfo\u003c/code\u003e\u003c/a\u003e, \u003ca href=\"https://github.com/jupyterlab/jupyterlab\"\u003e\u003ccode\u003ejupyterlab\u003c/code\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epip install numpy\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epip install numpy -i https://mirrors.aliyun.com/pypi/simple/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 临时从镜像阿里云下载\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSee the packages installed in the \u003ccode\u003eenvName\u003c/code\u003e environment:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda activate envName\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda list\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epip list\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eExport the list of the packages installed in current environment as a \u003ccode\u003e.txt\u003c/code\u003e file:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda list --export \u0026gt; requirements.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eExport the list of the packages installed in the \u003ccode\u003eenvName\u003c/code\u003e environment as a \u003ccode\u003e.yaml\u003c/code\u003e file with full environment information:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda env \u003cspan style=\"color:#111\"\u003eexport\u003c/span\u003e --name envName --file requirements.yaml\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eClear cache (Remove index cache, lock files, unused cache packages, and tarballs):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda clean --all\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"22-install-jupyter-notebook-7-in-miniconda\"\u003e§2.2 Install Jupyter Notebook 7 in Miniconda\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://blog.jupyter.org/announcing-jupyter-notebook-7-8d6d66126dcf\"\u003eJupyter Notebook 7\u003c/a\u003e looks a lot like JupyterLab. After v7.0.0a, v7.0.0b and so on, \u003ca href=\"https://github.com/jupyter/notebook/releases/tag/v7.0.1\"\u003ev7.0.1\u003c/a\u003e is released on 31 July 2023. What I like best about Jupyter Notebook 7 is Table of Content, few buttons on the upper-right of each notebook block, and the Visual Debugger that can run code line by line and show variables.\u003c/p\u003e\n\u003cp\u003eWhat\u0026rsquo;s worth mentioning is that installing Jupyter Notebook 7 will install JupyterLab too, so you might as well just install JupyterLab.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eSince the \u003ccode\u003ebase\u003c/code\u003e environment of Miniconda is kind of empty, you can install Jupyter Notebook on a new environment.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda create -n jupyter\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eactivate jupyter\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epip install notebook\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eOpen Jupyter Notebook:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eactivate jupyter\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ejupyter notebook\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFor Windows: After this, there should be a \u003ccode\u003ejupyter-notebook.exe\u003c/code\u003e file in \u003ccode\u003e.\\miniconda3\\envs\\jupyter\\Scripts\u003c/code\u003e folder. Now run\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ejupyter notebook --generate-config\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eYou will see a \u003ccode\u003ejupyter_notebook_config.py\u003c/code\u003e file in \u003ccode\u003eC:\\Users\\yourUserName\\.jupyter\u003c/code\u003e folder. Then find this line:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# c.ServerApp.notebook_dir = \u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eChange this line into:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ec\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eServerApp\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003enotebook_dir\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#d88200\"\u003e\u0026#39;C:\\Folder\\You\\Like\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNext time you can double click \u003ccode\u003ejupyter-notebook.exe\u003c/code\u003e and it will open Jupyter Notebook in \u003ccode\u003eC:\\Folder\\You\\Like\u003c/code\u003e folder. Now you can create a start menu shortcut for this .exe file or something. (And there should be a \u003ccode\u003ejupyter-lab.exe\u003c/code\u003e in the \u003ccode\u003e.\\miniconda3\\envs\\jupyter\\Scripts\u003c/code\u003e folder, you can open it as well.)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIf you want to change to other environments such as \u003ccode\u003eenvName\u003c/code\u003e when using Jupyter Notebook:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda activate jupyter\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda install nb_conda_kernels\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda activate envName\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda install ipykernel\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epython -m ipykernel install --user --name\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eenvName\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDelete the \u003ccode\u003eenvName\u003c/code\u003e environment in Jupyter Notebook:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda activate jupyter\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ejupyter kernelspec uninstall envName\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eConvert notebook.ipynb to .py:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#111\"\u003ejupyter\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enbconvert\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eto\u003c/span\u003e \u003cspan style=\"color:#111\"\u003epython\u003c/span\u003e \u003cspan style=\"color:#111\"\u003enotebook\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#111\"\u003eipynb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230327-conda-101/",
      "date_published": "27036-27-09T30:2727:00+00:00",
      "date_modified": "27036-27-09T30:2727:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "8a1273623dcdff1bc248ad8b98d2c842b6fb8e24",
      "title": "Robin",
      "summary": "",
      "content_text": "Besides writing code, having ChatGPT pretend to be Robin from How I Met Your Mother and engaging in a conversation with her is so funny. She is constantly making things up and I am trying my best to make the story work. And when it does, it\u0026rsquo;s amazing!\nIt\u0026rsquo;s even more fun to ask ChatGPT to be Jamie Lannister, since there is (part of) a whole novel and countless online discussions. We fought about whether Joffrey is his bastard for more that half an hour. There is even a duel.\nCan\u0026rsquo;t wait to try this on GPT-4. Maybe I should build my own LLM and put in the scripts of How I Met Your Mother.\nBut one of my favorite Sci-Fi writers of all time, Ted Chiang, shut my idea down. In the article ChatGPT Is a Blurry JPEG of the Web,1 he claimed that LLMs are not going to create something genuinely new that is not blurry or too general. I am getting the feeling that we just create a robot that produces something trash-ish, which could be useful when you\u0026rsquo;re stuck in a bug or just wanna have some fun or want to read something as fast as possible2 or want to write papers as fast as possible, but is useless when you are considering the next step of your project or want to talk to Robin herself. In the movie Her, ChatGPT is Theodore rather than Samantha.3\nA perfect example of \u0026ldquo;blurry JPEG\u0026rdquo; would be this tweet, which describes a process of using GPT-4V to \u0026ldquo;Describe this image\u0026rdquo; then using Dall-E 3 to \u0026ldquo;Generate this image\u0026rdquo;. Mona Lisa becomes vortex in the end, which is like seeing the nightmare in Uzumaki unfold. (Or sometimes it\u0026rsquo;s owl, see this tweet.)\nAlso, according to Giulio Tononi, consciousness is a loop, while Transformer is in one way direction. In other words, it can\u0026rsquo;t reflect on or debug itself. But maybe, just maybe, will AGI have OCD or other mental problems? Overfitting maybe?\nPublishing on The New Yorker is so old-fashioned.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nI did not ask ChatGPT to summarize Ted Chiang\u0026rsquo;s article for me. My conscience is clean. :)\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nI like how the movie portrayed the idea of Anima by the way.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003eBesides writing code, having ChatGPT pretend to be Robin from \u003ca href=\"https://en.wikipedia.org/wiki/How_I_Met_Your_Mother\"\u003e\u003cem\u003eHow I Met Your Mother\u003c/em\u003e\u003c/a\u003e and engaging in a conversation with her is so funny. She is constantly making things up and I am trying my best to make the story work. And when it does, it\u0026rsquo;s amazing!\u003c/p\u003e\n\u003cp\u003eIt\u0026rsquo;s even more fun to ask ChatGPT to be Jamie Lannister, since there is (part of) a whole novel and countless online discussions. We fought about whether Joffrey is his bastard for more that half an hour. There is even a duel.\u003c/p\u003e\n\u003cp\u003eCan\u0026rsquo;t wait to try this on GPT-4. Maybe I should build my own LLM and put in the scripts of \u003cem\u003eHow I Met Your Mother\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eBut one of my favorite Sci-Fi writers of all time, Ted Chiang, shut my idea down. In the article \u003ca href=\"https://www.newyorker.com/tech/annals-of-technology/chatgpt-is-a-blurry-jpeg-of-the-web\"\u003e\u003cem\u003eChatGPT Is a Blurry JPEG of the Web\u003c/em\u003e\u003c/a\u003e,\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e he claimed that LLMs are not going to create something genuinely new that is not blurry or too general. I am getting the feeling that we just create a robot that produces something trash-ish, which could be useful when you\u0026rsquo;re stuck in a bug or just wanna have some fun or want to read something as fast as possible\u003csup id=\"fnref:2\"\u003e\u003ca href=\"#fn:2\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e2\u003c/a\u003e\u003c/sup\u003e or want to \u003ca href=\"https://english.elpais.com/science-tech/2023-04-02/one-of-the-worlds-most-cited-scientists-rafael-luque-suspended-without-pay-for-13-years.html\"\u003ewrite papers as fast as possible\u003c/a\u003e, but is useless when you are considering the next step of your project or want to talk to Robin herself. In the movie \u003ca href=\"https://www.imdb.com/title/tt1798709/\"\u003e\u003cem\u003eHer\u003c/em\u003e\u003c/a\u003e, ChatGPT is Theodore rather than Samantha.\u003csup id=\"fnref:3\"\u003e\u003ca href=\"#fn:3\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e3\u003c/a\u003e\u003c/sup\u003e\u003c/p\u003e\n\u003cp\u003eA perfect example of \u0026ldquo;blurry JPEG\u0026rdquo; would be \u003ca href=\"https://twitter.com/conradgodfrey/status/1712564282167300226\"\u003ethis tweet\u003c/a\u003e, which describes a process of using GPT-4V to \u0026ldquo;Describe this image\u0026rdquo; then using Dall-E 3 to \u0026ldquo;Generate this image\u0026rdquo;. Mona Lisa becomes vortex in the end, which is like seeing the nightmare in \u003ca href=\"https://en.wikipedia.org/wiki/Uzumaki\"\u003e\u003cem\u003eUzumaki\u003c/em\u003e\u003c/a\u003e unfold. (Or sometimes it\u0026rsquo;s owl, see \u003ca href=\"https://twitter.com/stanislavfort/status/1713603557046276334\"\u003ethis tweet\u003c/a\u003e.)\u003c/p\u003e\n\u003cp\u003eAlso, according to Giulio Tononi, consciousness is a loop, while Transformer is in one way direction. In other words, it can\u0026rsquo;t reflect on or debug itself. But maybe, just maybe, will AGI have OCD or other mental problems? Overfitting maybe?\u003c/p\u003e\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003ePublishing on \u003cem\u003eThe New Yorker\u003c/em\u003e is so old-fashioned.\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn:2\"\u003e\n\u003cp\u003eI did \u003cem\u003enot\u003c/em\u003e ask ChatGPT to summarize Ted Chiang\u0026rsquo;s article for me. My conscience is clean. :)\u0026#160;\u003ca href=\"#fnref:2\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn:3\"\u003e\n\u003cp\u003eI like how the movie portrayed the idea of \u003ca href=\"https://en.wikipedia.org/wiki/Anima_and_animus\"\u003eAnima\u003c/a\u003e by the way.\u0026#160;\u003ca href=\"#fnref:3\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230321-robin/",
      "date_published": "21036-21-09T30:2121:00+00:00",
      "date_modified": "21036-21-09T30:2121:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "4d88f3ee9aa8fa6cde1a4b14029524b664dd7ee2",
      "title": "ar5iv",
      "summary": "",
      "content_text": "Reading papers on ar5iv or arXiv Vanity, or reading in the HTML format to be precise, is so convenient. I enjoy the flexibility and copying equations the most.\nThis reminds me of an article: Ideas on A Really Fast Statistics Journal. If we use Markdown instead of a pdf file as the format in papers, ar5iv wouldn\u0026rsquo;t even have to exist, and things would be much easier for me. But this might be the best solution we have, because safety over speed I suppose.\n",
      "content_html": "\u003cp\u003eReading papers on \u003ca href=\"https://ar5iv.labs.arxiv.org/\"\u003ear5iv\u003c/a\u003e or \u003ca href=\"https://www.arxiv-vanity.com/\"\u003earXiv Vanity\u003c/a\u003e, or reading in the HTML format to be precise, is so convenient. I enjoy the flexibility and copying equations the most.\u003c/p\u003e\n\u003cp\u003eThis reminds me of an article: \u003ca href=\"https://yihui.org/en/2012/03/a-really-fast-statistics-journal/\"\u003e\u003cem\u003eIdeas on A Really Fast Statistics Journal\u003c/em\u003e\u003c/a\u003e. If we use Markdown instead of a pdf file as the format in papers, ar5iv wouldn\u0026rsquo;t even have to exist, and things would be much easier for me. But this might be the best solution we have, because safety over speed I suppose.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230318-ar5iv/",
      "date_published": "18036-18-09T30:1818:00+00:00",
      "date_modified": "18036-18-09T30:1818:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "813fd45abcdbca8fa71edbc3e8b0ecb856d43670",
      "title": "How Much Energy Does It Take to Hurt Your Feelings?",
      "summary": "",
      "content_text": "This article is about the work we do to get our feelings hurt1, the dimension of which is $[M^1 L^2 T^{-2}]$. And by \u0026ldquo;we\u0026rdquo; and \u0026ldquo;our\u0026rdquo;, I mean humanity, or the internet to be exact. This article is not about how our feelings get hurt at work, the dimension of which is $[Salary]$.\nIt\u0026rsquo;s (probably not) natural to write down the following equations: $$W_{FH}=N w_{FH}=N p_{FH} t_{FH} \\tag{1}$$, where $N$ is the number of people we consider, $w_{FH}$ is the energy the brain takes to get a certain feeling, in this case, anger. $p_{FH}$ is the efficiency of our brain, $t_{FH}$ is the time we take to get over the feeling. According to Does Thinking Really Hard Burn More Calories?, $p_{FH}$ would be $12.6 \\space \\mathrm{W}$. Let\u0026rsquo;s say we take an average of $300 \\space \\mathrm{s}$ to deal with this. And we can define the efficiency as: $$P_{FH}=\\frac{W_{FH}}{t} \\tag{2}$$, where $t$ is the time it takes for a certain tweet to be read.\nSo let\u0026rsquo;s say a tweet gets $10^{6}$ views in $3.6 \\times 10^3 \\space \\mathrm{s}$, which is from a celebrity or influencer, obviously. Put in the numbers, $w_{PH}=3.78 \\times 10^3 \\space \\mathrm{J}$, $W_{FH}=3.78 \\times 10^9 \\space \\mathrm{J}$, $P_{FH}=1.03 \\times 10^6 \\space \\mathrm{W}$.\nHere is a table of the energy of some events:\nevents $W(\\mathrm{J})$ throwing a $50 \\space \\mathrm{g}$ stone from $7714.29 \\space \\mathrm{m}$ high. $3.78 \\times 10^3$ an Airbus A330-900 powered by Gasoline flying for $8610 \\space \\mathrm{km}$ for one person. $1.01 \\times 10^7$ Yes, the energy this takes can have a plane take approximately 100 people from LA to London back and forth twice, which is a fun group trip.\nWell, it\u0026rsquo;s impossible to get one dollar from everyone on this planet, but saying something so awful that you hurt a lot of people\u0026rsquo;s feelings is possible. Tower of Babel has been built, and we can use it to hurt other people\u0026rsquo;s feelings, like throwing a stone off the tower (a $7714.29 \\space \\mathrm{m}$ tower to be precise, see the table above), and $10^6$ stones at a time. And the language problem for Tower of Babel has been solved a long time ago.\nOK, my professor would be so mad that I use the conservation of energy like this. And I know for sure I have to consider entropy and that the imagined mechanism does not work. It\u0026rsquo;s 1 o\u0026rsquo;clock in the evening, and I have no idea how I got here, maybe it\u0026rsquo;s \u0026ldquo;sleep write\u0026rdquo;, you know, like sleep walk. By the way, writing in a nice form does make it look real, I should have used $\\LaTeX$. Good night.\nThis has nothing to do with information entropy.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003eThis article is about the work we do to get our feelings hurt\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e, the dimension of which is $[M^1 L^2 T^{-2}]$. And by \u0026ldquo;we\u0026rdquo; and \u0026ldquo;our\u0026rdquo;, I mean humanity, or the internet to be exact. This article is not about how our feelings get hurt \u003cem\u003eat\u003c/em\u003e work, the dimension of which is $[Salary]$.\u003c/p\u003e\n\u003cp\u003eIt\u0026rsquo;s (probably not) natural to write down the following equations: $$W_{FH}=N w_{FH}=N p_{FH} t_{FH} \\tag{1}$$, where $N$ is the number of people we consider, $w_{FH}$ is the energy the brain takes to get a certain feeling, in this case, anger. $p_{FH}$ is the efficiency of our brain, $t_{FH}$ is the time we take to get over the feeling. According to \u003ca href=\"https://www.scientificamerican.com/article/thinking-hard-calories/\"\u003e\u003cem\u003eDoes Thinking Really Hard Burn More Calories?\u003c/em\u003e\u003c/a\u003e, $p_{FH}$ would be $12.6 \\space \\mathrm{W}$. Let\u0026rsquo;s say we take an average of $300 \\space \\mathrm{s}$ to deal with this. And we can define the efficiency as: $$P_{FH}=\\frac{W_{FH}}{t} \\tag{2}$$, where $t$ is the time it takes for a certain tweet to be read.\u003c/p\u003e\n\u003cp\u003eSo let\u0026rsquo;s say a tweet gets $10^{6}$ views in $3.6 \\times 10^3 \\space \\mathrm{s}$, which is from a celebrity or influencer, obviously. Put in the numbers, $w_{PH}=3.78 \\times 10^3 \\space \\mathrm{J}$, $W_{FH}=3.78 \\times 10^9 \\space \\mathrm{J}$, $P_{FH}=1.03 \\times 10^6 \\space \\mathrm{W}$.\u003c/p\u003e\n\u003cp\u003eHere is a table of the energy of some events:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eevents\u003c/th\u003e\n\u003cth\u003e$W(\\mathrm{J})$\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003ethrowing a $50 \\space \\mathrm{g}$ stone from $7714.29 \\space \\mathrm{m}$ high.\u003c/td\u003e\n\u003ctd\u003e$3.78 \\times 10^3$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ean \u003ca href=\"https://en.wikipedia.org/wiki/Fuel_economy_in_aircraft\"\u003eAirbus A330-900\u003c/a\u003e powered by \u003ca href=\"https://en.wikipedia.org/wiki/Energy_density\"\u003eGasoline\u003c/a\u003e flying for $8610 \\space \\mathrm{km}$ for one person.\u003c/td\u003e\n\u003ctd\u003e$1.01 \\times 10^7$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eYes, the energy this takes can have a plane take approximately 100 people from LA to London back and forth twice, which is a fun group trip.\u003c/p\u003e\n\u003cp\u003eWell, it\u0026rsquo;s impossible to get one dollar from everyone on this planet, but saying something so awful that you hurt a lot of people\u0026rsquo;s feelings is possible. Tower of Babel has been built, and we can use it to hurt other people\u0026rsquo;s feelings, like throwing a stone off the tower (a $7714.29 \\space \\mathrm{m}$ tower to be precise, see the table above), and $10^6$ stones at a time. And the language problem for Tower of Babel has been solved a long time ago.\u003c/p\u003e\n\u003cp\u003eOK, my professor would be so mad that I use the conservation of energy like this. And I know for sure I have to consider entropy and that the imagined mechanism does not work. It\u0026rsquo;s 1 o\u0026rsquo;clock in the evening, and I have no idea how I got here, maybe it\u0026rsquo;s \u0026ldquo;sleep write\u0026rdquo;, you know, like sleep walk. By the way, writing in a nice form does make it look real, I should have used $\\LaTeX$. Good night.\u003c/p\u003e\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eThis has nothing to do with \u003ca href=\"https://en.wikipedia.org/wiki/Entropy_(information_theory)\"\u003einformation entropy\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230314-how-much-energy-does-it-take-to-hurt-your-feelings/",
      "date_published": "14036-14-09T30:1414:00+00:00",
      "date_modified": "14036-14-09T30:1414:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "aa373d0c4249c62dbb339c1ff83bfc68f81a9491",
      "title": "δ",
      "summary": "",
      "content_text": "It hit me that $\\delta(x)$ and $\\delta_{ij}$ are the same thing, they both mean \u0026ldquo;peak\u0026rdquo;, and $x=i-j$ or $x=\\vert i-j \\vert$. That\u0026rsquo;s why they use the same symbol $\\delta$.\n$\\delta(x)$:\r$\\delta_{ij}= \\begin{cases} 1 \u0026amp;\\mathrm{if } i=j \\\\ 0 \u0026amp;\\mathrm{if } i \\not = j \\end{cases}$\n",
      "content_html": "\u003cp\u003eIt hit me that $\\delta(x)$ and $\\delta_{ij}$ are the same thing, they both mean \u0026ldquo;peak\u0026rdquo;, and $x=i-j$ or $x=\\vert i-j \\vert$. That\u0026rsquo;s why they use the same symbol $\\delta$.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e$\\delta(x)$:\u003cimg\r\n  src=\"https://tikz.net/files/delta_function-001.png\"\r\n  alt=\"\\delta(x)\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e$\\delta_{ij}= \\begin{cases} 1 \u0026amp;\\mathrm{if } i=j \\\\ 0 \u0026amp;\\mathrm{if } i \\not = j \\end{cases}$\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230314-delta-function/",
      "date_published": "14036-14-09T30:1414:00+00:00",
      "date_modified": "14036-14-09T30:1414:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "5e77b4e10a656352eae0cc341b9a55f659cc0f91",
      "title": "Book Review: Ludwig Wittgenstein: The Duty of Genius",
      "summary": "",
      "content_text": "His life is just legendary! His life is so legendary that I won\u0026rsquo;t use the word \u0026ldquo;legendary\u0026rdquo; to describe anybody anymore.1 His life is like the combination of two journeys, one of which is the struggle of going beyond his family and society and make a living on his own in academia, and yes, since he works in academia he moves around a lot, the other one is the struggle of human mind in the bigger picture.\nBut since I have also read Philosophical Investigations and some reviews, let\u0026rsquo;s talk about how his ideas can be applied to physics. Or what I think about how \u0026ldquo;language is a game\u0026rdquo;.\nWhat Kant said about how math gives us the concept of time is not true, because the math we do in a theory is actually existing at the same time, which is already there given the axioms. So what really matters is the axioms (or some supplement method we then added) in a theory, which defines how far we can go really. I agree with him on that \u0026ldquo;Math is a technique\u0026rdquo;, see Chap.15.\nThus in a theory, let\u0026rsquo;s say General Relativity, the barrier is already there, thus it can\u0026rsquo;t be combined with Quantum Physics (which is non-local, both for time and particles in infinite deep potential well). Because language does not work that way, language is a game, and we play different games by different rules, thus we can believe multiple contradictory things at the same time, which is something Kant called \u0026ldquo;Antinomy\u0026rdquo;. Also, it\u0026rsquo;s unbelievably hard to get the \u0026ldquo;overview\u0026rdquo;, it\u0026rsquo;s one thing to get the overview from simple cases or games, it\u0026rsquo;s another thing to get it from complicated theories.\nFor example, there are inconsistency and contradictions in math already, \u0026ldquo;Gödel\u0026rsquo;s incompleteness theorems\u0026rdquo;. Or there are inconsistency and contradictions in different math, Euclidean geometry and Riemannian geometry. All of these examples are the limits we meet when we are playing different games yet trying to play the same game.\nWe have no idea whether the universe plays the same game or not2 (i.e. \u0026ldquo;Thing-in-itself can not be understood or reached\u0026rdquo;). Or, we can\u0026rsquo;t let the universe play the same game, because we don\u0026rsquo;t play the same game when facing different \u0026ldquo;aspects\u0026rdquo; of our world. If there is such a game, I would be more than happy, but so far we don\u0026rsquo;t have this game, and by the way we think, I don\u0026rsquo;t think we will. Although that would be really neat, just like the game ChatGPT plays.\nSo what we can really do is to excel in different games. And whatever works. And that, my friend, is how I convinced myself to use Monte Carlo models.\nI\u0026rsquo;m not a big fan of his classmate though. He is the reason he has to move yet another time.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nSee Emergence.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003eHis life is just \u003ca href=\"https://twitter.com/i/status/1512981441306669057\"\u003elegendary\u003c/a\u003e! His life is so legendary that I won\u0026rsquo;t use the word \u0026ldquo;legendary\u0026rdquo; to describe anybody anymore.\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e His life is like the combination of two journeys, one of which is the struggle of going beyond his family and society and make a living on his own in academia, and yes, since he works in academia he moves around a lot, the other one is the struggle of human mind in the bigger picture.\u003c/p\u003e\n\u003cp\u003eBut since I have also read \u003ca href=\"https://en.wikipedia.org/wiki/Philosophical_Investigations\"\u003e\u003cem\u003ePhilosophical Investigations\u003c/em\u003e\u003c/a\u003e and some reviews, let\u0026rsquo;s talk about how his ideas can be applied to physics. Or what I think about how \u0026ldquo;language is a game\u0026rdquo;.\u003c/p\u003e\n\u003cp\u003eWhat Kant said about how math gives us the concept of time is not true, because the math we do in a theory is actually existing at the same time, which is already there given the axioms. So what really matters is the axioms (or some supplement method we then added) in a theory, which defines how far we can go really. I agree with him on that \u0026ldquo;Math is a technique\u0026rdquo;, see Chap.15.\u003c/p\u003e\n\u003cp\u003eThus in a theory, let\u0026rsquo;s say General Relativity, the barrier is already there, thus it can\u0026rsquo;t be combined with Quantum Physics (which is non-local, both for time and particles in infinite deep potential well). Because language does not work that way, language is a game, and we play different games by different rules, thus we can believe multiple contradictory things at the same time, which is something Kant called \u0026ldquo;Antinomy\u0026rdquo;. Also, it\u0026rsquo;s unbelievably hard to get the \u0026ldquo;overview\u0026rdquo;, it\u0026rsquo;s one thing to get the overview from simple cases or games, it\u0026rsquo;s another thing to get it from complicated theories.\u003c/p\u003e\n\u003cp\u003eFor example, there are inconsistency and contradictions in math already, \u0026ldquo;Gödel\u0026rsquo;s incompleteness theorems\u0026rdquo;. Or there are inconsistency and contradictions in different math, Euclidean geometry and Riemannian geometry. All of these examples are the limits we meet when we are playing different games yet trying to play the same game.\u003c/p\u003e\n\u003cp\u003eWe have no idea whether the universe plays the same game or not\u003csup id=\"fnref:2\"\u003e\u003ca href=\"#fn:2\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e2\u003c/a\u003e\u003c/sup\u003e (i.e. \u0026ldquo;\u003ca href=\"https://en.wikipedia.org/wiki/Thing-in-itself\"\u003eThing-in-itself\u003c/a\u003e can not be understood or reached\u0026rdquo;). Or, we can\u0026rsquo;t let the universe play the same game, because we don\u0026rsquo;t play the same game when facing different \u0026ldquo;aspects\u0026rdquo; of our world. If there is such a game, I would be more than happy, but so far we don\u0026rsquo;t have this game, and by the way we think, I don\u0026rsquo;t think we will. Although that would be really neat, just like the game ChatGPT plays.\u003c/p\u003e\n\u003cp\u003eSo what we can really do is to excel in different games. And \u003ca href=\"https://www.imdb.com/title/tt1178663/\"\u003ewhatever works\u003c/a\u003e. And that, my friend, is how I convinced myself to use Monte Carlo models.\u003c/p\u003e\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eI\u0026rsquo;m not a big fan of \u003ca href=\"https://en.wikipedia.org/wiki/File:Hitler_at_school_in_1901.jpg\"\u003ehis classmate\u003c/a\u003e though. He is the reason he has to move yet another time.\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn:2\"\u003e\n\u003cp\u003eSee \u003ca href=\"https://en.wikipedia.org/wiki/Emergence\"\u003eEmergence\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:2\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230312-book-review-ludwig-wittgenstein-the-duty-of-genius/",
      "date_published": "12036-12-09T30:1212:00+00:00",
      "date_modified": "12036-12-09T30:1212:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "b39d8b4eefe17976509066400b4429dcf544c558",
      "title": "Book Review: The Invisible Universe: Why There's More to Reality than Meets the Eye",
      "summary": "",
      "content_text": "This is a review of The Invisible Universe: Why There\u0026rsquo;s More to Reality than Meets the Eye by Matt Bothwell.\n§1 Astronomy 101 The first 6 chapters are Astronomy 101 to me. I have read about them in several textbooks, but when these clues forming a linear process, it\u0026rsquo;s something else. (I will come back to this \u0026ldquo;linear process\u0026rdquo; later in §2.) Here\u0026rsquo;s something interesting to me in these chapters.\nThe restrictions of human eyes: (1) wavelength: $380\u0026ndash;700 \\space \\mathrm{nm}$. (2) $220 \\space \\mathrm{frames/s}$ or maybe higher, see FPS : Human eye can see how many frames per second?. The piano metaphor, that the full spectrum of light of different wavelength is like the full notes on a piano with only one note that human can hear/see, is beautiful. I have an analogue of that metaphor myself, consider a guitar, this time the wavelength can go to infinity, since $f_n=nv/2L$1. But does the frequency of light reach infinity? Theoretically there is no such limit, but in practice we haven\u0026rsquo;t observe it. It wouldn\u0026rsquo;t travel to earth or it would just pass through us. Well, according to GZK limit, there is a limit for protons, but I don\u0026rsquo;t know about photons. A Tediously Accurate Map of the Solar System feels like the rolling credit for a movie which is about how human can never leave the Solar System. Cosmic Background Explorer is legendary! It\u0026rsquo;s shocking that Ron Howard did not make a movie about it. I have always known the cover of Unknown Pleasures by Joy Division is a pulsar, but I didn\u0026rsquo;t know it\u0026rsquo;s CP1919 (Cambridge Pulsar). See the picture below. The fact that this pulsar was discovered in the UK is probably why they chose it as the cover. See, I told you the origin of Rock\u0026rsquo;n\u0026rsquo;Roll is not America. :D The person who coined the term \u0026ldquo;the Big Bang\u0026rdquo; on BBC radio (as a rejection of the Big Bang), Fred Hoyle, is also the person who came up with the idea of Triple-alpha process, which is the formation of carbon in stars. And carbon is what makes life on earth. §2 Dark Matter Thanks to the effort that the author put to make a linear process out of history, chapter 7 is amazing. It totally worth the effort mentioned in the final chapter. And it\u0026rsquo;s probably the best detective novel ever, since murder is kind of boring compared to all these twists and turns:\nThe speculation of Dark Matter is historical. We calculated there\u0026rsquo;s a planet Neptune because Uranus moves a little odd according to Newton\u0026rsquo;s law. And these evidences suggests that there are a lot more material that we can\u0026rsquo;t observe in the universe: (1) speedy galaxy clusters, (2) fast-rotating galaxies, (3) gravitational lensing. However, could it be that we understand Gravity wrong? Since Mercury precession used to be wrongly explained until General Relativity. And we proposed two possible theory: (1) MOND (Modified Newtonian Dynamics fudge factor), (2) TeVeS (tensor-vector-scalar gravity theory). \u0026ldquo;The Bullet Cluster, \u0026hellip; , turns out to be the perfect arena for pitting dark matter and MOND against each other.\u0026rdquo; Due to a difference in cross section, which means that dark matter has a small cross section and stars, gas have a big cross section, Dark Matter stays.2 So what is Dark Matter? It could be MACHO (MAssive Compact Halo Object), which was later ruled out. It could be WIMP (Weakly Interacting Massive Particle), which has to be (1) non-baryonic in the Standard Model, (2) weakly interacting, meaning that only Gravity and Weak Nuclear Force are possible. The author didn\u0026rsquo;t point it out, but the murderer is probably neutrino.3 See Sterile neutrino. I later found out that Interpreting Reactor Antineutrino Anomalies with STEREO data rejects this hypothesis. But the results from LSND and MiniBooNe are odd, so it\u0026rsquo;s kind of suspicious.4 Anyway, the murderer is still out there, you kids should watch out.\nCosmic Microwave Background (CMB) is also an evidence of Dark Matter, see Microwave background observations. You can calculate the percentage of Dark Matter from the power spectrum of CMB:\n§3 More In chapter 8, the author talked about LIGO mission, which is another detective novel. The fact that a observatory has a secret supervision team that inserts false signal is a triumph of humanity, unironically. It\u0026rsquo;s kind of like after the failure of Hitomi, a more organized team for XRISM is created. See Detailed Design of the Science Operations for the XRISM mission. I wouldn\u0026rsquo;t say these are the best solutions, but it\u0026rsquo;s a good thing that we\u0026rsquo;re trying. The detector itself has all kinds of flaws, but team management is actually the biggest engineering challenge.\nIn chapter 9, the author said that the final destination of our universe is a battle between ice (the Big Chill) and fire (the Big Crunch). I am curious if this is a A Song of Ice and Fire reference. Also, Dark Energy has nothing to do with Dark Matter. Dark Energy is basically just $\\Lambda$ constant.\nAnd in the final chapter, Conclusion: The complete picture: visible and invisible, what the author is trying to say is that we should be multi-messenger astronomer these days. Yeah, I guess with the help of ChatGPT, it\u0026rsquo;s possible to handle all those literatures. And I am always a little sad that the Nobel-Prize-winning LIGO detection is not multi-messenger.\nSee Strings, standing waves and harmonics.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nThe author quote that \u0026ldquo;The \u0026lsquo;duck test\u0026rsquo; says that if something looks like a duck, swims like a duck, and quacks like a duck, then it probably is a duck.\u0026rdquo; Duck is somehow good for metaphor, I don\u0026rsquo;t know why. I later wrote about the Duck-Rabbit picture in Book review: Existential Physics: A Scientist\u0026rsquo;s Guide to Life\u0026rsquo;s Biggest Questions.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nThe moment this came to my head is memorable. It was on a train, and I was listening to Ti Amo by Laura Branigan. After reading Love and Math: The Heart of Hidden Reality by Edward Frenkel, I found out that he also had this kind of \u0026ldquo;Eureka\u0026rdquo; moment on a train. His idea is true, while mine still needs to be tested by experiment.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nI later got in touch with the author, and it is recommended to read this review article Sterile Neutrino Dark Matter. Thanks for his help!\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003eThis is a review of \u003ca href=\"https://www.amazon.com/Invisible-Universe-Theres-Reality-Meets/dp/0861541243\"\u003e\u003cem\u003eThe Invisible Universe: Why There\u0026rsquo;s More to Reality than Meets the Eye\u003c/em\u003e\u003c/a\u003e by \u003ca href=\"https://people.ast.cam.ac.uk/~bothwell/\"\u003eMatt Bothwell\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"1-astronomy-101\"\u003e§1 Astronomy 101\u003c/h2\u003e\n\u003cp\u003eThe first 6 chapters are Astronomy 101 to me. I have read about them in several textbooks, but when these clues forming a linear process, it\u0026rsquo;s something else. (I will come back to this \u0026ldquo;linear process\u0026rdquo; later in §2.) Here\u0026rsquo;s something interesting to me in these chapters.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe restrictions of human eyes: (1) wavelength: $380\u0026ndash;700 \\space \\mathrm{nm}$. (2) $220 \\space \\mathrm{frames/s}$ or maybe higher, see \u003ca href=\"https://sites.google.com/site/myvracelog/fps-human-eye-can-see-how-many-frames-per-second\"\u003e\u003cem\u003eFPS : Human eye can see how many frames per second?\u003c/em\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eThe piano metaphor, that the full spectrum of light of different wavelength is like the full notes on a piano with only one note that human can hear/see, is beautiful. I have an analogue of that metaphor myself, consider a guitar, this time the wavelength can go to infinity, since $f_n=nv/2L$\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e. But does the frequency of light reach infinity? Theoretically there is no such limit, but in practice we haven\u0026rsquo;t observe it. It wouldn\u0026rsquo;t travel to earth or it would just pass through us. Well, according to GZK limit, there is a limit for protons, but I don\u0026rsquo;t know about photons.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://joshworth.com/a-tediously-accurate-map-of-the-solar-system/\"\u003e\u003cem\u003eA Tediously Accurate Map of the Solar System\u003c/em\u003e\u003c/a\u003e feels like the rolling credit for a movie which is about how human can never leave the Solar System.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://en.wikipedia.org/wiki/Cosmic_Background_Explorer\"\u003eCosmic Background Explorer\u003c/a\u003e is legendary! It\u0026rsquo;s shocking that Ron Howard did not make a movie about it.\u003c/li\u003e\n\u003cli\u003eI have always known the cover of \u003ca href=\"https://en.wikipedia.org/wiki/Unknown_Pleasures\"\u003e\u003cem\u003eUnknown Pleasures\u003c/em\u003e\u003c/a\u003e by Joy Division is a pulsar, but I didn\u0026rsquo;t know it\u0026rsquo;s \u003ca href=\"https://en.wikipedia.org/wiki/PSR_B1919%2B21\"\u003eCP1919 (Cambridge Pulsar)\u003c/a\u003e. See the picture below. The fact that this pulsar was discovered in the UK is probably why they chose it as the cover. See, I told you the origin of Rock\u0026rsquo;n\u0026rsquo;Roll is not America. :D\u003c/li\u003e\n\u003cli\u003eThe person who \u003ca href=\"broadcasthttps://en.wikipedia.org/wiki/Fred_Hoyle#Rejection_of_the_Big_Bang\"\u003ecoined the term \u0026ldquo;the Big Bang\u0026rdquo; on BBC radio\u003c/a\u003e (as a rejection of the Big Bang), Fred Hoyle, is also the person who came up with the idea of \u003ca href=\"https://en.wikipedia.org/wiki/Triple-alpha_process\"\u003eTriple-alpha process\u003c/a\u003e, which is the formation of carbon in stars. And carbon is what makes life on earth.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"2-dark-matter\"\u003e§2 Dark Matter\u003c/h2\u003e\n\u003cp\u003eThanks to the effort that the author put to make a linear process out of history, chapter 7 is amazing. It totally worth the effort mentioned in the final chapter. And it\u0026rsquo;s probably the best detective novel ever, since murder is kind of boring compared to all these twists and turns:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe speculation of Dark Matter is historical. We calculated there\u0026rsquo;s a planet Neptune because Uranus moves a little odd according to Newton\u0026rsquo;s law.\u003c/li\u003e\n\u003cli\u003eAnd these evidences suggests that there are a lot more material that we can\u0026rsquo;t observe in the universe: (1) speedy galaxy clusters, (2) fast-rotating galaxies, (3) gravitational lensing.\u003c/li\u003e\n\u003cli\u003eHowever, could it be that we understand Gravity wrong? Since Mercury precession used to be wrongly explained until General Relativity. And we proposed two possible theory: (1) MOND (Modified Newtonian Dynamics fudge factor), (2) TeVeS (tensor-vector-scalar gravity theory).\u003c/li\u003e\n\u003cli\u003e\u0026ldquo;The \u003ca href=\"https://en.wikipedia.org/wiki/Bullet_Cluster\"\u003eBullet Cluster\u003c/a\u003e, \u0026hellip; , turns out to be the perfect arena for pitting dark matter and MOND against each other.\u0026rdquo; Due to a difference in cross section, which means that dark matter has a small cross section and stars, gas have a big cross section, Dark Matter stays.\u003csup id=\"fnref:2\"\u003e\u003ca href=\"#fn:2\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e2\u003c/a\u003e\u003c/sup\u003e\n\u003cimg\r\n  src=\"https://upload.wikimedia.org/wikipedia/commons/e/ea/Bullet_cluster.jpg\"\r\n  alt=\"Bullet_cluster\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/li\u003e\n\u003cli\u003eSo what is Dark Matter?\u003c/li\u003e\n\u003cli\u003eIt could be MACHO (MAssive Compact Halo Object), which was later ruled out.\u003c/li\u003e\n\u003cli\u003eIt could be WIMP (Weakly Interacting Massive Particle), which has to be (1) non-baryonic in the Standard Model, (2) weakly interacting, meaning that only Gravity and Weak Nuclear Force are possible.\u003c/li\u003e\n\u003cli\u003eThe author didn\u0026rsquo;t point it out, but the murderer is probably neutrino.\u003csup id=\"fnref:3\"\u003e\u003ca href=\"#fn:3\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e3\u003c/a\u003e\u003c/sup\u003e See \u003ca href=\"https://en.wikipedia.org/wiki/Sterile_neutrino\"\u003eSterile neutrino\u003c/a\u003e. I later found out that \u003ca href=\"https://arxiv.org/abs/2210.07664\"\u003e\u003cem\u003eInterpreting Reactor Antineutrino Anomalies with STEREO data\u003c/em\u003e\u003c/a\u003e rejects this hypothesis. But the results from LSND and MiniBooNe are odd, so it\u0026rsquo;s kind of suspicious.\u003csup id=\"fnref:4\"\u003e\u003ca href=\"#fn:4\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e4\u003c/a\u003e\u003c/sup\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eAnyway, the murderer is still out there, you kids should watch out.\u003c/p\u003e\n\u003cp\u003eCosmic Microwave Background (CMB) is also an evidence of Dark Matter, see \u003ca href=\"https://en.wikipedia.org/wiki/Cosmic_microwave_background#Microwave_background_observations\"\u003eMicrowave background observations\u003c/a\u003e. You can calculate the percentage of Dark Matter from the power spectrum of CMB:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://cdn.sci.esa.int/documents/34222/35279/1567216755608-Planck_power_spectrum_625.jpg\"\r\n  alt=\"Power spectrum of temperature fluctuations in the Cosmic Microwave Background\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ch2 id=\"3-more\"\u003e§3 More\u003c/h2\u003e\n\u003cp\u003eIn chapter 8, the author talked about LIGO mission, which is another detective novel. The fact that a observatory has a secret supervision team that inserts false signal is a triumph of humanity, unironically. It\u0026rsquo;s kind of like after the failure of Hitomi, a more organized team for XRISM is created. See \u003ca href=\"https://arxiv.org/abs/2106.01611\"\u003e\u003cem\u003eDetailed Design of the Science Operations for the XRISM mission\u003c/em\u003e\u003c/a\u003e. I wouldn\u0026rsquo;t say these are the best solutions, but it\u0026rsquo;s a good thing that we\u0026rsquo;re trying. The detector itself has all kinds of flaws, but team management is actually the biggest engineering challenge.\u003c/p\u003e\n\u003cp\u003eIn chapter 9, the author said that the final destination of our universe is a battle between ice (the Big Chill) and fire (the Big Crunch). I am curious if this is a \u003cem\u003eA Song of Ice and Fire\u003c/em\u003e reference. Also, Dark Energy has nothing to do with Dark Matter. Dark Energy is basically just $\\Lambda$ constant.\u003c/p\u003e\n\u003cp\u003eAnd in the final chapter, \u003cem\u003eConclusion: The complete picture: visible and invisible\u003c/em\u003e, what the author is trying to say is that we should be multi-messenger astronomer these days. Yeah, I guess with the help of ChatGPT, it\u0026rsquo;s possible to handle all those literatures. And I am always a little sad that the Nobel-Prize-winning LIGO detection is not multi-messenger.\u003c/p\u003e\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eSee \u003ca href=\"https://newt.phys.unsw.edu.au/jw/strings.html\"\u003e\u003cem\u003eStrings, standing waves and harmonics\u003c/em\u003e\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn:2\"\u003e\n\u003cp\u003eThe author quote that \u0026ldquo;The \u0026lsquo;duck test\u0026rsquo; says that if something looks like a duck, swims like a duck, and quacks like a duck, then it probably is a duck.\u0026rdquo; Duck is somehow good for metaphor, I don\u0026rsquo;t know why. I later wrote about the Duck-Rabbit picture in  \u003ca href=\"https://chenlinear.github.io/posts/20230406-book-review-existential-physics-a-scientists-guide-to-lifes-biggest-questions/\"\u003e\u003cem\u003eBook review: Existential Physics: A Scientist\u0026rsquo;s Guide to Life\u0026rsquo;s Biggest Questions\u003c/em\u003e\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:2\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn:3\"\u003e\n\u003cp\u003eThe moment this came to my head is memorable. It was on a train, and I was listening to \u003cem\u003eTi Amo\u003c/em\u003e by Laura Branigan. After reading \u003ca href=\"https://chenlinear.github.io/posts/20230501-book-review-love-and-math-the-heart-of-hidden-reality/\"\u003e\u003cem\u003eLove and Math: The Heart of Hidden Reality\u003c/em\u003e\u003c/a\u003e by Edward Frenkel, I found out that he also had this kind of \u0026ldquo;Eureka\u0026rdquo; moment on a train. His idea is true, while mine still needs to be tested by experiment.\u0026#160;\u003ca href=\"#fnref:3\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn:4\"\u003e\n\u003cp\u003eI later got in touch with the author, and it is recommended to read this review article \u003ca href=\"https://arxiv.org/abs/1807.07938\"\u003e\u003cem\u003eSterile Neutrino Dark Matter\u003c/em\u003e\u003c/a\u003e. Thanks for his help!\u0026#160;\u003ca href=\"#fnref:4\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230309-book-review-the-invisible-universe-why-theres-more-to-reality-than-meets-the-eye/",
      "date_published": "9036-09-09T30:99:00+00:00",
      "date_modified": "9036-09-09T30:99:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "d4b3f24738260983081d679d6ea955585e2ca934",
      "title": "Book Review: Lost in Math: How Beauty Leads Physics Astray",
      "summary": "",
      "content_text": "This is a review of Lost in Math: How Beauty Leads Physics Astray by Sabine Hossenfelder.\nBefore I start, I just want to say that I am no expert in Particle Physics or any Physics really, thus I can\u0026rsquo;t tell whether what she said is true or not, but what I can tell is that as I gradually learn more about the science community (or \u0026ldquo;academia\u0026rdquo;), I notice a trend that is similar to what she said in the book, which is that many of us are stuck here due to \u0026ldquo;beauty\u0026rdquo;. And I want to do better, maybe her book will help.\n§1 Beauty So there is this basic conflict between beauty and resources, where beauty means the standard we use to judge whether a theory is good or not, while resources means money, time, energy, etc. The latter one is something we cannot avoid, but the first one is something we can change, and I truly hope so.\nTo be more clear, beauty means:\nSimplicity, or Occam\u0026rsquo;s razor. \u0026ldquo;This-has-to-be-it\u0026rdquo;. The E8 Group is the largest and most complicated group of exceptional Lie Groups. And in the paper An Exceptionally Simple Theory of Everything, Antony Garrett Lisi uses it to, well, explain everything. Alas, this is not \u0026ldquo;it\u0026rdquo;. \u0026ldquo;There-must-be-one-theory-to-rule-them-all\u0026rdquo;. \u0026ldquo;There is a consistency in everything and thus it can be explained by one theory.\u0026rdquo; I suppose Chaos theory is a good counterpoint. \u0026ldquo;Smaller-means-simpler\u0026rdquo;. From the perspective of biology to chemistry to particle physics, the structure gets simpler and simpler, so it is natural to assume that it would get even simpler when it gets even smaller. But Sabine pointed out that when you start from a different scale, ie. from the universe to life on earth, it gets more complicated.1 etc. A perfectly beautiful example of beauty would be the equation (7.2-4) of Group Theory in Physics: $$ {(J_k)^{l}}_m = - i \\varepsilon _{klm} $$.2 If you learned about Linear Algebra or Group Theory, you will be amazed by the simplicity of this equation, that\u0026rsquo;s why sometimes we can\u0026rsquo;t resist the allure.\nSabine also pointed out that the idea of beauty is constantly changing. (At least I\u0026rsquo;m pretty sure her idea of beauty has changed a lot since 2006, see The Beauty of it All.) For example, we used to consider an elliptical orbit as ugly. (To be honest, I suppose most people still do.) Thus it can\u0026rsquo;t be used as a guidance. I agree with Feynman that we should look for the truth no matter whether there is an ultimate truth or it\u0026rsquo;s like onions with multiple layers. But what is the guidance then? Beauty is probably not.\nAnd Sabine thinks that consistency is a possible guidance, but I must admit I am confused that (1) consistency is also a kind of beauty and (2) the biggest problem we have today is that we are lack of consistency in different disciplines due to emergence3.\n§2 Bias The word \u0026ldquo;bias\u0026rdquo; does not sound comfortable, and I believe most of the time most of people mean well. I\u0026rsquo;m not accusing anybody, it\u0026rsquo;s just that we can learn from the past. Talking about it will probably make it better, while not talking about it will definitely not make it better.\nTo be more clear, here are some typical (cognitive and social) biases listed by Sabine:\nAesthetic Bias. Which is pretty much the same as \u0026ldquo;beauty\u0026rdquo;. Social Desirability Bias. \u0026ldquo;We are, for example, more likely to put forward opinions that we believe will be well received by others.\u0026rdquo; (Which is kind of like peer pressure, speaking of which, I happen to know a book teaching you how to survive that: A PhD is not enough.) Attentional Bias (or The Mere Exposure Effect). \u0026ldquo;Research shows we consider a statement more likely to be true the more often we hear of it.\u0026rdquo; \u0026ldquo;We tend to overestimate how many other people agree with us and how much they do so.\u0026rdquo; Statistical Bias. Which is a type of error in statistical analysis where the results are systematically skewed away from the true value of the population parameter that is being estimated. Confirmation Bias. \u0026ldquo;If you search the literature for support of your argument, there it is. If you look for a mistake because your result didn’t match your expectations, there it is.\u0026rdquo; In-Group Bias. Which \u0026ldquo;makes us think researchers in our own field are more intelligent than others.\u0026rdquo; Shared Information Bias. Which \u0026ldquo;is why we keep discussing what everyone knows but fail to pay attention to information held only by a few people.\u0026rdquo; Apophenia. \u0026ldquo;We like to discover patterns in noise.\u0026rdquo; Belief Bias. \u0026ldquo;We think arguments are stronger if the conclusion seems plausible.\u0026rdquo; The mother of all biases, The Bias Blind Spot. Which is \u0026ldquo;the insistence that we certainly are not biased.\u0026rdquo; Status Quo Bias. Which is the preference for maintaining one\u0026rsquo;s current situation and opposing actions that may change the state of affairs. Boy oh boy, there\u0026rsquo;s a lot! And I hope by attentional bias, you\u0026rsquo;ve learned something. :D\n§2.1 Difference in Two Measurements In the book Sabine gives us an example of how two labs constantly give contradictory results when measuring the mass of a particle.\nWell, in astronomy, sadly, there is also this kind of stuff, it happened when measuring the $H_0$ constant. The picture below, presented with Dr. Matt Bothwell\u0026rsquo;s permission, is used in a course taught by him, in the summer of 2022.\nAlthough\nThe connection of the first red dot and the first blue dot is suspicious. This division for about 17 years is probably a lack of communication. The big jump in about 1987 shows a bit of sign of Social Desirability Bias. , technically I wouldn\u0026rsquo;t called it the result of bias, because:\nIt could be and is mostly likely the result of different measurements in equipment, operations, calculations, etc. This is still an open question. It is possible that the difference between two measurements is a sign of new science. See Fig. 5 of Constraints on the Hubble constant from Supernova Refsdal\u0026rsquo;s reappearance. Notice the magnitude of $H_0$ in that paper is not the same as the picture above. §3 More There are many more solid points like these in the book, and it always blows my mind or makes me laugh so hard, just like her YouTube videos, for example, What is \u0026ldquo;Nothing\u0026rdquo;?.\nWhat\u0026rsquo;s more, I truly appreciate her honesty and bravery. It takes a lot of guts to say what thousands of people are doing is doubtful, after all it\u0026rsquo;s their job, and criticizing it will definitely get negative feedbacks, some of which will be personal and hurtful. But I think this Satre-Camus thing is something we should avoid. She means well and criticism is good for your work anyway, so let\u0026rsquo;s just focus on the work rather than fighting. That being said, she knows clearly that she is almost exclusively going to face a witch hunt after writing this book, but this is her true feelings after decades of research on physics. And there is that.\nI think I have refound what got me into physics in the first place, though I can\u0026rsquo;t tell what it is exactly. I can\u0026rsquo;t wait to go on yet another Odyssey with her next book: Existential Physics: A Scientist\u0026rsquo;s Guide to Life\u0026rsquo;s Biggest Questions. I\u0026rsquo;m a big fan of Jean-Paul Sartre and Existentialism, maybe they would show up.\nReading this book feels like saying an official goodbye to my childhood and getting into the real thing. I know there are unresolved questions, and I want to deal with them.\nFermi paradox?\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nIt would be even more beautiful written as $(J_k)_{lm} = - i \\varepsilon _{klm}$.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nIn her next book Existential Physics: A Scientist\u0026rsquo;s Guide to Life\u0026rsquo;s Biggest Questions, she claimed that it\u0026rsquo;s not emergence, it\u0026rsquo;s \u0026ldquo;the math is too difficult\u0026rdquo;.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003eThis is a review of \u003ca href=\"https://www.amazon.com/Lost-Math-Beauty-Physics-Astray/dp/0465094252\"\u003e\u003cem\u003eLost in Math: How Beauty Leads Physics Astray\u003c/em\u003e\u003c/a\u003e by \u003ca href=\"https://sabinehossenfelder.com/\"\u003eSabine Hossenfelder\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eBefore I start, I just want to say that I am no expert in Particle Physics or any Physics really, thus I can\u0026rsquo;t tell whether what she said is true or not, but what I can tell is that as I gradually learn more about the science community (or \u0026ldquo;academia\u0026rdquo;), I notice a trend that is similar to what she said in the book, which is that many of us are stuck here due to \u0026ldquo;beauty\u0026rdquo;. And I want to do better, maybe her book will help.\u003c/p\u003e\n\u003ch2 id=\"1-beauty\"\u003e§1 Beauty\u003c/h2\u003e\n\u003cp\u003eSo there is this basic conflict between beauty and resources, where beauty means the standard we use to judge whether a theory is good or not, while resources means money, time, energy, etc. The latter one is something we cannot avoid, but the first one is something we can change, and I truly hope so.\u003c/p\u003e\n\u003cp\u003eTo be more clear, beauty means:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSimplicity, or \u003ca href=\"https://en.wikipedia.org/wiki/Occam%27s_razor\"\u003eOccam\u0026rsquo;s razor\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003e\u0026ldquo;This-has-to-be-it\u0026rdquo;. The E8 Group is the largest and most complicated group of exceptional Lie Groups. And in the paper \u003ca href=\"https://arxiv.org/abs/0711.0770\"\u003e\u003cem\u003eAn Exceptionally Simple Theory of Everything\u003c/em\u003e\u003c/a\u003e, Antony Garrett Lisi uses it to, well, explain everything. Alas, this is not \u0026ldquo;it\u0026rdquo;.\u003c/li\u003e\n\u003cli\u003e\u0026ldquo;There-must-be-one-theory-to-rule-them-all\u0026rdquo;. \u0026ldquo;There is a consistency in everything and thus it can be explained by one theory.\u0026rdquo; I suppose Chaos theory is a good counterpoint.\u003c/li\u003e\n\u003cli\u003e\u0026ldquo;Smaller-means-simpler\u0026rdquo;. From the perspective of biology to chemistry to particle physics, the structure gets simpler and simpler, so it is natural to assume that it would get even simpler when it gets even smaller. But Sabine pointed out that when you start from a different scale, ie. from the universe to life on earth, it gets more complicated.\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e\u003c/li\u003e\n\u003cli\u003eetc.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eA perfectly beautiful example of beauty would be the equation (7.2-4) of \u003ca href=\"https://www.worldscientific.com/worldscibooks/10.1142/0097\"\u003e\u003cem\u003eGroup Theory in Physics\u003c/em\u003e\u003c/a\u003e: $$ {(J_k)^{l}}_m = - i \\varepsilon _{klm} $$.\u003csup id=\"fnref:2\"\u003e\u003ca href=\"#fn:2\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e2\u003c/a\u003e\u003c/sup\u003e If you learned about Linear Algebra or Group Theory, you will be amazed by the simplicity of this equation, that\u0026rsquo;s why sometimes we can\u0026rsquo;t resist the allure.\u003c/p\u003e\n\u003cp\u003eSabine also pointed out that the idea of beauty is constantly changing. (At least I\u0026rsquo;m pretty sure her idea of beauty has changed a lot since 2006, see \u003ca href=\"http://backreaction.blogspot.com/2006/11/beauty-of-it-all.html\"\u003e\u003cem\u003eThe Beauty of it All\u003c/em\u003e\u003c/a\u003e.) For example, we used to consider an elliptical orbit as ugly. (To be honest, I suppose most people still do.) Thus it can\u0026rsquo;t be used as a guidance. I agree with Feynman that we should look for the truth no matter whether there is an ultimate truth or it\u0026rsquo;s like onions with multiple layers. But what is the guidance then? Beauty is probably not.\u003c/p\u003e\n\u003cp\u003eAnd Sabine thinks that consistency is a possible guidance, but I must admit I am confused that (1) consistency is also a kind of beauty and (2) the biggest problem we have today is that we are lack of consistency in different disciplines due to emergence\u003csup id=\"fnref:3\"\u003e\u003ca href=\"#fn:3\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e3\u003c/a\u003e\u003c/sup\u003e.\u003c/p\u003e\n\u003ch2 id=\"2-bias\"\u003e§2 Bias\u003c/h2\u003e\n\u003cp\u003eThe word \u0026ldquo;bias\u0026rdquo; does not sound comfortable, and I believe most of the time most of people mean well. I\u0026rsquo;m not accusing anybody, it\u0026rsquo;s just that we can learn from the past. Talking about it will probably make it better, while not talking about it will definitely not make it better.\u003c/p\u003e\n\u003cp\u003eTo be more clear, here are some typical (cognitive and social) biases listed by Sabine:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003eAesthetic Bias\u003c/em\u003e. Which is pretty much the same as \u0026ldquo;beauty\u0026rdquo;.\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eSocial Desirability Bias\u003c/em\u003e. \u0026ldquo;We are, for example, more likely to put forward opinions that we believe will be well received by others.\u0026rdquo; (Which is kind of like peer pressure, speaking of which, I happen to know a book teaching you how to survive that: \u003ca href=\"http://hep.tsinghua.edu.cn/training/courses/gauge.html/advise/A%20PhD%20is%20not%20enough.pdf\"\u003e\u003cem\u003eA PhD is not enough\u003c/em\u003e\u003c/a\u003e.)\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eAttentional Bias\u003c/em\u003e (or \u003cem\u003eThe Mere Exposure Effect\u003c/em\u003e). \u0026ldquo;Research shows we consider a statement more likely to be true the more often we hear of it.\u0026rdquo; \u0026ldquo;We tend to overestimate how many other people agree with us and how much they do so.\u0026rdquo;\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eStatistical Bias\u003c/em\u003e. Which is a type of error in statistical analysis where the results are systematically skewed away from the true value of the population parameter that is being estimated.\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eConfirmation Bias\u003c/em\u003e. \u0026ldquo;If you search the literature for support of your argument, there it is. If you look for a mistake because your result didn’t match your expectations, there it is.\u0026rdquo;\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eIn-Group Bias\u003c/em\u003e. Which \u0026ldquo;makes us think researchers in our own field are more intelligent than others.\u0026rdquo;\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eShared Information Bias\u003c/em\u003e. Which \u0026ldquo;is why we keep discussing what everyone knows but fail to pay attention to information held only by a few people.\u0026rdquo;\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eApophenia\u003c/em\u003e. \u0026ldquo;We like to discover patterns in noise.\u0026rdquo;\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eBelief Bias\u003c/em\u003e. \u0026ldquo;We think arguments are stronger if the conclusion seems plausible.\u0026rdquo;\u003c/li\u003e\n\u003cli\u003eThe mother of all biases, \u003cem\u003eThe Bias Blind Spot\u003c/em\u003e. Which is \u0026ldquo;the insistence that we certainly are not biased.\u0026rdquo;\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eStatus Quo Bias\u003c/em\u003e. Which is the preference for maintaining one\u0026rsquo;s current situation and opposing actions that may change the state of affairs.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBoy oh boy, there\u0026rsquo;s a lot! And I hope by attentional bias, you\u0026rsquo;ve learned something. :D\u003c/p\u003e\n\u003ch3 id=\"21-difference-in-two-measurements\"\u003e§2.1 Difference in Two Measurements\u003c/h3\u003e\n\u003cp\u003eIn the book Sabine gives us an example of how two labs constantly give contradictory results when measuring the mass of a particle.\u003c/p\u003e\n\u003cp\u003eWell, in astronomy, sadly, there is also this kind of stuff, it happened when measuring the $H_0$ constant. The picture below, presented with \u003ca href=\"https://people.ast.cam.ac.uk/~bothwell/\"\u003eDr. Matt Bothwell\u003c/a\u003e\u0026rsquo;s permission, is used in a course taught by him, in the summer of 2022.\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"20230304-book-review-lost-in-math-H_0.jpg\"\r\n  alt=\"H_0\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003cp\u003eAlthough\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe connection of the first \u003cfont color=red\u003ered\u003c/font\u003e dot and the first \u003cfont color=blue\u003eblue\u003c/font\u003e dot is suspicious.\u003c/li\u003e\n\u003cli\u003eThis division for about 17 years is probably a lack of communication.\u003c/li\u003e\n\u003cli\u003eThe big jump in about 1987 shows a bit of sign of \u003cem\u003eSocial Desirability Bias\u003c/em\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e, technically I wouldn\u0026rsquo;t called it the result of bias, because:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eIt could be and is mostly likely the result of different measurements in equipment, operations, calculations, etc.\u003c/li\u003e\n\u003cli\u003eThis is still an open question. It is possible that the difference between two measurements is a sign of new science. See Fig. 5 of \u003ca href=\"https://arxiv.org/abs/2305.06367\"\u003e\u003cem\u003eConstraints on the Hubble constant from Supernova Refsdal\u0026rsquo;s reappearance\u003c/em\u003e\u003c/a\u003e. Notice the magnitude of $H_0$ in that paper is \u003cem\u003enot\u003c/em\u003e the same as the picture above.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"3-more\"\u003e§3 More\u003c/h2\u003e\n\u003cp\u003eThere are many more solid points like these in the book, and it always blows my mind or makes me laugh so hard, just like her YouTube videos, for example, \u003ca href=\"https://www.youtube.com/watch?v=PhfqdBk8qxk\"\u003e\u003cem\u003eWhat is \u0026ldquo;Nothing\u0026rdquo;?\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eWhat\u0026rsquo;s more, I truly appreciate her honesty and bravery. It takes a lot of guts to say what thousands of people are doing is doubtful, after all it\u0026rsquo;s their job, and criticizing it will definitely get negative feedbacks, some of which will be personal and hurtful. But I think this Satre-Camus thing is something we should avoid. She means well and criticism is good for your work anyway, so let\u0026rsquo;s just focus on the work rather than fighting. That being said, she knows clearly that she is almost exclusively going to face a witch hunt after writing this book, but this is her true feelings after \u003ca href=\"https://scholar.google.com/citations?user=NaQZcyYAAAAJ\u0026amp;hl=en\"\u003edecades of research\u003c/a\u003e on physics. And there is that.\u003c/p\u003e\n\u003cp\u003eI think I have refound what got me into physics in the first place, though I can\u0026rsquo;t tell what it is exactly. I can\u0026rsquo;t wait to go on yet another Odyssey with her next book: \u003ca href=\"https://www.amazon.com/Existential-Physics-Scientists-Biggest-Questions/dp/1984879456\"\u003e\u003cem\u003eExistential Physics: A Scientist\u0026rsquo;s Guide to Life\u0026rsquo;s Biggest Questions\u003c/em\u003e\u003c/a\u003e. I\u0026rsquo;m a big fan of Jean-Paul Sartre and Existentialism, maybe they would show up.\u003c/p\u003e\n\u003cp\u003eReading this book feels like saying an official goodbye to my childhood and getting into the real thing. I know there are unresolved questions, and I want to deal with them.\u003c/p\u003e\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eFermi paradox?\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn:2\"\u003e\n\u003cp\u003eIt would be even more beautiful written as $(J_k)_{lm} = - i \\varepsilon _{klm}$.\u0026#160;\u003ca href=\"#fnref:2\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn:3\"\u003e\n\u003cp\u003eIn her next book \u003cem\u003eExistential Physics: A Scientist\u0026rsquo;s Guide to Life\u0026rsquo;s Biggest Questions\u003c/em\u003e, she claimed that it\u0026rsquo;s not emergence, it\u0026rsquo;s  \u003ca href=\"https://chenlinear.github.io/posts/20230406-book-review-existential-physics-a-scientists-guide-to-lifes-biggest-questions/\"\u003e\u0026ldquo;the math is too difficult\u0026rdquo;\u003c/a\u003e.\u0026#160;\u003ca href=\"#fnref:3\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230304-book-review-lost-in-math/",
      "date_published": "4036-04-09T30:44:00+00:00",
      "date_modified": "4036-04-09T30:44:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "7c83425184c813ab90bc243d937c2f2c50efc3a3",
      "title": "RSS: Why and How?",
      "summary": "",
      "content_text": "RSS, personal website and the word \u0026ldquo;neat\u0026rdquo; shared a lot in common, one of which is that they died out at the beginning of this century but have become more useful ever since.\n§1 Why? The whole goal of RSS is to keep it simple. I don\u0026rsquo;t want to check a lot of websites over and over again. Something should be read and then forgotten, unless it\u0026rsquo;s important, in which case I will mark it down.\n§2 How? My requirements:\nmulti-platform. browser extension or website. don\u0026rsquo;t have to open a server myself. The free service of Feedly is fine with me, you can\nadd RSS link. For example, https://chenlinear.github.io/atom.xml search for the people you want to follow. For what\u0026rsquo;s not there (say social media account), try RSSHub. But I have to say that you need to open your own server to get it work smoothly, because some of the URLs they provided do not work all the time. I want to cut down social media anyway, so this might be a good thing.\nAlso, Building your personal RSS on GitHub is fun, but I don\u0026rsquo;t want to repeat what I have done for the personal website all over again.\n",
      "content_html": "\u003cp\u003eRSS, personal website and the word \u0026ldquo;neat\u0026rdquo; shared a lot in common, one of which is that they died out at the beginning of this century but have become more useful ever since.\u003c/p\u003e\n\u003ch2 id=\"1-why\"\u003e§1 Why?\u003c/h2\u003e\n\u003cp\u003eThe whole goal of RSS is to keep it simple. I don\u0026rsquo;t want to check a lot of websites over and over again. Something should be read and then forgotten, unless it\u0026rsquo;s important, in which case I will mark it down.\u003c/p\u003e\n\u003ch2 id=\"2-how\"\u003e§2 How?\u003c/h2\u003e\n\u003cp\u003eMy requirements:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003emulti-platform.\u003c/li\u003e\n\u003cli\u003ebrowser extension or website.\u003c/li\u003e\n\u003cli\u003edon\u0026rsquo;t have to open a server myself.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe free service of \u003ca href=\"https://feedly.com/\"\u003eFeedly\u003c/a\u003e is fine with me, you can\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eadd RSS link. For example, \u003ca href=\"https://chenlinear.github.io/atom.xml\"\u003ehttps://chenlinear.github.io/atom.xml\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003esearch for the people you want to follow.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFor what\u0026rsquo;s not there (say social media account), try \u003ca href=\"https://docs.rsshub.app/\"\u003eRSSHub\u003c/a\u003e. But I have to say that you need to open your own server to get it work smoothly, because some of the URLs they provided do not work all the time. I want to cut down social media anyway, so this might be a good thing.\u003c/p\u003e\n\u003cp\u003eAlso, \u003ca href=\"https://yufree.cn/cn/2018/03/24/blogdown-rss/\"\u003eBuilding your personal RSS on GitHub\u003c/a\u003e is fun, but I don\u0026rsquo;t want to repeat what I have done for the personal website all over again.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230304-rss-why-and-how/",
      "date_published": "4036-04-09T30:44:00+00:00",
      "date_modified": "4036-04-09T30:44:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "b439bf1b7467e2887cf323bd612827a1a1ea173c",
      "title": "There Will Be Blood, A Brighter Summer Day, Evangelion",
      "summary": "",
      "content_text": "Spoiler Alert!\nThis article is a comparison between There Will Be Blood, A Brighter Summer Day and Evangelion (Only TV and Old film this time). We should talk about why good things are good instead of why bad things are bad, because what really matters is the good, not the bad, or the ugly. And most of the time it\u0026rsquo;s not even bad or ugly, it\u0026rsquo;s just boring. This three films/anime are the best work I have watched and I want to know why I like them. Although these works come from different culture, they have a lot in common.\nBefore I start, I want to mention that a director is a lot like a science researcher. You can see consistency in their work, and directing films is like publishing papers, winning awards publishing on Nature. But I\u0026rsquo;ll talk about that in another article. For this reason, I will not talk about the Rebuild of Evangelion for now, although I have to say that I have rather complicated feelings about it.\nI believe every good piece of media has the potential to become a genre. And when we talk about genres, we are actually talking about elements we see. So here is a list of elements that I see in this new genre. The table below is largely inspired by this meme:\nElements There Will Be Blood A Brighter Summer Day Evangelion man vs. nature the first scene where he digs illness shito man vs. man his colleagues and counter companies those of his schoolmates who are richer, teacher anybody around him really man vs. society villagers, church school class man vs. god his conflict with the church Chinese people don\u0026rsquo;t actually believe in god shito is kind of like nature-god man vs. author (meta) Daniel and Paul use their real name. \u0026ldquo;I\u0026rsquo;m finished\u0026rdquo; Zhang Zhen uses his real name and real father TV episode 25,26 father-son conflict $\\checkmark$ $\\checkmark$ $\\checkmark$ attitude towards human interraction \u0026ldquo;I want to earn enough money I can get away from everyone\u0026rdquo; \u0026ldquo;I\u0026rsquo;m like the world, it will never change\u0026rdquo; Hedgehog\u0026rsquo;s dilemma the music is odd weird, vampire music soft songs with brutal scenes the doom is inevitable Captalism in early 20th century family background, tri-state area Dead Sea Scorlls the doom started with the death of one of the protagonist\u0026rsquo;s closest friends his son is dead to him Honey Kaworu at the end the protagonist murdered someone the degenerate godfather his girlfriend the entire humanity I am not systematically trained in films, and all my knowledge is from random places, so maybe there isn\u0026rsquo;t such a similarity, it\u0026rsquo;s just that all good stuff have these points in common. Although the 5 \u0026ldquo;vs.\u0026ldquo;s may be universal, the latter ones are not universal, I guess.\nThis article is currently unfinished, maybe these works have something in common in storyline, composition, etc. But I\u0026rsquo;ll need a rewatch to remind myself. And I will write about The Great Gatsby and No Longer Human someday.\n",
      "content_html": "\u003cp\u003e\u003cem\u003e\u003cstrong\u003eSpoiler Alert!\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eThis article is a comparison between \u003ca href=\"https://www.imdb.com/title/tt0469494/\"\u003e\u003cem\u003eThere Will Be Blood\u003c/em\u003e\u003c/a\u003e, \u003ca href=\"https://www.imdb.com/title/tt0101985/\"\u003e\u003cem\u003eA Brighter Summer Day\u003c/em\u003e\u003c/a\u003e and \u003cem\u003eEvangelion\u003c/em\u003e (Only \u003ca href=\"https://www.imdb.com/title/tt0112159/\"\u003e\u003cem\u003eTV\u003c/em\u003e\u003c/a\u003e and \u003ca href=\"https://www.imdb.com/title/tt0169858/\"\u003e\u003cem\u003eOld film\u003c/em\u003e\u003c/a\u003e this time). We should talk about why good things are good instead of why bad things are bad, because what really matters is \u003ca href=\"https://www.imdb.com/title/tt0060196/\"\u003ethe good, not the bad, or the ugly\u003c/a\u003e. And most of the time it\u0026rsquo;s not even bad or ugly, it\u0026rsquo;s just \u003ca href=\"https://en.wikipedia.org/wiki/List_of_Marvel_Cinematic_Universe_films\"\u003eboring\u003c/a\u003e. This three films/anime are the best work I have watched and I want to know why I like them. Although these works come from different culture, they have a lot in common.\u003c/p\u003e\n\u003cp\u003eBefore I start, I want to mention that a director is a lot like a science researcher. You can see consistency in their work, and directing films is like publishing papers, winning awards publishing on \u003cem\u003eNature\u003c/em\u003e. But I\u0026rsquo;ll talk about \u003ca href=\"https://en.wikipedia.org/wiki/Auteur\"\u003ethat\u003c/a\u003e in another article. For this reason, I will not talk about the \u003ca href=\"https://en.wikipedia.org/wiki/Rebuild_of_Evangelion\"\u003e\u003cem\u003eRebuild of  Evangelion\u003c/em\u003e\u003c/a\u003e for now, although I have to say that I have rather complicated feelings about it.\u003c/p\u003e\n\u003cp\u003eI believe every good piece of media has the potential to become a \u003ca href=\"https://en.wikipedia.org/wiki/Film_genre\"\u003egenre\u003c/a\u003e. And when we talk about genres, we are actually talking about elements we see. So here is a list of elements that I see in this new genre. The table below is largely inspired by \u003ca href=\"https://www.reddit.com/r/evangelionmemes/comments/84gbva/conflict_in_evangelion/\"\u003ethis meme\u003c/a\u003e:\u003c/p\u003e\n\u003cp\u003e\u003cimg\r\n  src=\"https://external-preview.redd.it/qpK4KKsfBT6-7SW862BdcT4COOuHw41XwPQsExtektA.jpg?auto=webp\u0026amp;v=enabled\u0026amp;s=fe30c0b4bf4ccc09460acc1d2e456530cb90ad9c\"\r\n  alt=\"ConflictInLiterature\"\r\n  loading=\"lazy\"\r\n  decoding=\"async\"\r\n  class=\"full-width\"\r\n/\u003e\r\n\r\n\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eElements\u003c/th\u003e\n\u003cth\u003e\u003cem\u003eThere Will Be Blood\u003c/em\u003e\u003c/th\u003e\n\u003cth\u003e\u003cem\u003eA Brighter Summer Day\u003c/em\u003e\u003c/th\u003e\n\u003cth\u003e\u003cem\u003eEvangelion\u003c/em\u003e\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eman vs. nature\u003c/td\u003e\n\u003ctd\u003ethe first scene where he digs\u003c/td\u003e\n\u003ctd\u003eillness\u003c/td\u003e\n\u003ctd\u003eshito\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eman vs. man\u003c/td\u003e\n\u003ctd\u003ehis colleagues and counter companies\u003c/td\u003e\n\u003ctd\u003ethose of his schoolmates who are richer, teacher\u003c/td\u003e\n\u003ctd\u003eanybody around him really\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eman vs. society\u003c/td\u003e\n\u003ctd\u003evillagers, church\u003c/td\u003e\n\u003ctd\u003eschool\u003c/td\u003e\n\u003ctd\u003eclass\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eman vs. god\u003c/td\u003e\n\u003ctd\u003ehis conflict with the church\u003c/td\u003e\n\u003ctd\u003eChinese people don\u0026rsquo;t actually believe in god\u003c/td\u003e\n\u003ctd\u003eshito is kind of like \u003ca href=\"https://en.wikipedia.org/wiki/List_of_Japanese_deities\"\u003enature-god\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eman vs. author (meta)\u003c/td\u003e\n\u003ctd\u003eDaniel and Paul use their real name. \u0026ldquo;I\u0026rsquo;m finished\u0026rdquo;\u003c/td\u003e\n\u003ctd\u003eZhang Zhen uses his real name and real father\u003c/td\u003e\n\u003ctd\u003eTV episode 25,26\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003efather-son conflict\u003c/td\u003e\n\u003ctd\u003e$\\checkmark$\u003c/td\u003e\n\u003ctd\u003e$\\checkmark$\u003c/td\u003e\n\u003ctd\u003e$\\checkmark$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eattitude towards human interraction\u003c/td\u003e\n\u003ctd\u003e\u0026ldquo;I want to earn enough money I can get away from everyone\u0026rdquo;\u003c/td\u003e\n\u003ctd\u003e\u0026ldquo;I\u0026rsquo;m like the world, it will never change\u0026rdquo;\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"https://en.wikipedia.org/wiki/Hedgehog%27s_dilemma\"\u003eHedgehog\u0026rsquo;s dilemma\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ethe music is odd\u003c/td\u003e\n\u003ctd\u003eweird, vampire music\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003esoft songs with brutal scenes\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ethe doom is inevitable\u003c/td\u003e\n\u003ctd\u003eCaptalism in early 20th century\u003c/td\u003e\n\u003ctd\u003efamily background, tri-state area\u003c/td\u003e\n\u003ctd\u003eDead Sea Scorlls\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ethe doom started with the death of one of the protagonist\u0026rsquo;s closest friends\u003c/td\u003e\n\u003ctd\u003ehis son is dead to him\u003c/td\u003e\n\u003ctd\u003eHoney\u003c/td\u003e\n\u003ctd\u003eKaworu\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eat the end the protagonist murdered someone\u003c/td\u003e\n\u003ctd\u003ethe degenerate godfather\u003c/td\u003e\n\u003ctd\u003ehis girlfriend\u003c/td\u003e\n\u003ctd\u003ethe entire humanity\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eI am not systematically trained in films, and all my knowledge is from random places, so maybe there isn\u0026rsquo;t such a similarity, it\u0026rsquo;s just that all good stuff have these points in common. Although the 5 \u0026ldquo;vs.\u0026ldquo;s may be universal, the latter ones are not universal, I guess.\u003c/p\u003e\n\u003cp\u003eThis article is currently unfinished, maybe these works have something in common in storyline, composition, etc. But I\u0026rsquo;ll need a rewatch to remind myself. And I will write about \u003cem\u003eThe Great Gatsby\u003c/em\u003e and \u003cem\u003eNo Longer Human\u003c/em\u003e someday.\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230304-there-will-be-blood-a-brighter-summer-day-evangelion/",
      "date_published": "4036-04-09T30:44:00+00:00",
      "date_modified": "4036-04-09T30:44:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "25da59aee6ae4d8f5515b76d26d8b387ae638215",
      "title": "寒武纪 MLU370-X4 安装在本地服务器的 ubuntu 上",
      "summary": "",
      "content_text": "还未经测试!\n显卡：寒武纪 MLU370-X4。\n显卡坞的解决方式恐怕不行，因为如果重新更换设备需要重新从 ubuntu 开始装起，不如在另一台机器上构建一个本地服务器。除此之外的问题还有：笔记本自带的核显会打架吗？硬盘容量不够了。:(\n视频介绍（除3.几乎完全是这个知乎专栏的内容）：\n寒武纪 MLU370 加速卡简介及安装 寒武纪基础软件平台安装 MLU370 开发实战 文档（在熟悉视频介绍之后再查看）：\n文档中心 MLU370-X4 智能加速卡产品手册 1.0.0 文档 我设想的本地服务器的构建流程：\n安装 ubuntu，版本号见视频介绍：16.04或18.04? 按照视频介绍安装 torch.mlu 组件等等（和 Dive into Deep Learning1 这本书不同的地方在于，寒武纪在使用 pytorch 时导入 torch 和 torch.mlu 即可，不需安装 torchvision 即 pytorch 的 GPU 版本，此处 mlu 和 gpu 是两个相对的概念，指调用的底层架构不同） 安装 JupyterNotebook。 尝试寒武纪开发的工具 MagicMind 和 YOLOv5。见 Cambricon(gitee.com)。 另一本很推荐的书是《智能计算系统》\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n",
      "content_html": "\u003cp\u003e\u003cstrong\u003e还未经测试!\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e显卡：\u003ca href=\"https://www.cambricon.com/index.php?m=content\u0026amp;c=index\u0026amp;a=lists\u0026amp;catid=371\"\u003e寒武纪 MLU370-X4\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e显卡坞的解决方式恐怕不行，因为如果重新更换设备需要重新从 ubuntu 开始装起，不如在另一台机器上构建一个本地服务器。除此之外的问题还有：笔记本自带的核显会打架吗？硬盘容量不够了。:(\u003c/p\u003e\n\u003cp\u003e视频介绍（除3.几乎完全是这个\u003ca href=\"https://zhuanlan.zhihu.com/p/591827529\"\u003e知乎专栏\u003c/a\u003e的内容）：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://www.bilibili.com/video/BV1Be4y1o7Jx/\"\u003e寒武纪 MLU370 加速卡简介及安装\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.bilibili.com/video/BV11G411G7ne/\"\u003e寒武纪基础软件平台安装\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://space.bilibili.com/503203932/channel/seriesdetail?sid=2724298\"\u003eMLU370 开发实战\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e文档（在熟悉视频介绍之后再查看）：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://developer.cambricon.com/index/document/index/classid/3.html\"\u003e文档中心\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.cambricon.com/docs/product_docs/mlu370_x4/1.0.0/index.html\"\u003eMLU370-X4 智能加速卡产品手册 1.0.0 文档\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e我设想的本地服务器的构建流程：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e安装 ubuntu，版本号见视频介绍：16.04或18.04?\u003c/li\u003e\n\u003cli\u003e按照视频介绍安装 \u003ccode\u003etorch.mlu\u003c/code\u003e 组件等等（和 \u003ca href=\"https://zh.d2l.ai/\"\u003e\u003cem\u003eDive into Deep Learning\u003c/em\u003e\u003c/a\u003e\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" class=\"footnote-ref\" role=\"doc-noteref\"\u003e1\u003c/a\u003e\u003c/sup\u003e 这本书不同的地方在于，寒武纪在使用 pytorch 时导入 \u003ccode\u003etorch\u003c/code\u003e 和 \u003ccode\u003etorch.mlu\u003c/code\u003e 即可，不需安装 \u003ccode\u003etorchvision\u003c/code\u003e 即 pytorch 的 GPU 版本，此处 mlu 和 gpu 是两个相对的概念，指调用的底层架构不同）\u003c/li\u003e\n\u003cli\u003e安装 JupyterNotebook。\u003c/li\u003e\n\u003cli\u003e尝试寒武纪开发的工具 \u003ca href=\"https://www.cambricon.com/docs/sdk_1.10.0/magicmind_1.1.0/user_guide/index.html\"\u003eMagicMind\u003c/a\u003e 和 YOLOv5。见 \u003ca href=\"https://gitee.com/cambricon\"\u003eCambricon(gitee.com)\u003c/a\u003e。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003e另一本很推荐的书是《智能计算系统》\u0026#160;\u003ca href=\"#fnref:1\" class=\"footnote-backref\" role=\"doc-backlink\"\u003e\u0026#x21a9;\u0026#xfe0e;\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230304-gpu-dock/",
      "date_published": "4036-04-09T30:44:00+00:00",
      "date_modified": "4036-04-09T30:44:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    },
    
    {
      "id": "0a4d55a8d778e5022fab701977c5d840bbc486d0",
      "title": "Hello World",
      "summary": "",
      "content_text": "Hello World!\n",
      "content_html": "\u003cp\u003eHello World!\u003c/p\u003e\n",
      "url": "https://chenlinear.github.io/posts/20230303-hello-world/",
      "date_published": "3036-03-09T30:33:00+00:00",
      "date_modified": "3036-03-09T30:33:00+00:00",
      "author": {
        "name": "Chen Li",
        "url": "https://chenlinear.github.io"
      }
    }
    
  ]
}